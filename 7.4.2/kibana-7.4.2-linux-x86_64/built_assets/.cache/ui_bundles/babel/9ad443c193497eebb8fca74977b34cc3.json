{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/home/components/tutorial/tutorial.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/home/components/tutorial/tutorial.js","mtime":1572296410288},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlR1dG9yaWFsID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX2Zvb3RlciA9IHJlcXVpcmUoIi4vZm9vdGVyIik7Cgp2YXIgX2ludHJvZHVjdGlvbiA9IHJlcXVpcmUoIi4vaW50cm9kdWN0aW9uIik7Cgp2YXIgX2luc3RydWN0aW9uX3NldCA9IHJlcXVpcmUoIi4vaW5zdHJ1Y3Rpb25fc2V0Iik7Cgp2YXIgX3NhdmVkX29iamVjdHNfaW5zdGFsbGVyID0gcmVxdWlyZSgiLi9zYXZlZF9vYmplY3RzX2luc3RhbGxlciIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBTdGF0dXNDaGVja1N0YXRlcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vc3RhdHVzX2NoZWNrX3N0YXRlcyIpKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfY2hyb21lID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ1aS9jaHJvbWUiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBJTlNUUlVDVElPTlNfVFlQRSA9IHsKICBFTEFTVElDX0NMT1VEOiAnZWxhc3RpY0Nsb3VkJywKICBPTl9QUkVNOiAnb25QcmVtJywKICBPTl9QUkVNX0VMQVNUSUNfQ0xPVUQ6ICdvblByZW1FbGFzdGljQ2xvdWQnCn07Cgp2YXIgaG9tZVRpdGxlID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi5ob21lLmJyZWFkY3J1bWJzLmhvbWVUaXRsZScsIHsKICBkZWZhdWx0TWVzc2FnZTogJ0hvbWUnCn0pOwoKdmFyIGFkZERhdGFUaXRsZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4uaG9tZS5icmVhZGNydW1icy5hZGREYXRhVGl0bGUnLCB7CiAgZGVmYXVsdE1lc3NhZ2U6ICdBZGQgZGF0YScKfSk7Cgp2YXIgVHV0b3JpYWxVaSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoVHV0b3JpYWxVaSwgX1JlYWN0JENvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFR1dG9yaWFsVWkocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHV0b3JpYWxVaSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVHV0b3JpYWxVaSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldEluc3RydWN0aW9ucyIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFfdGhpcy5zdGF0ZS50dXRvcmlhbCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpbnN0cnVjdGlvblNldHM6IFtdCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgc3dpdGNoIChfdGhpcy5zdGF0ZS52aXNpYmxlSW5zdHJ1Y3Rpb25zKSB7CiAgICAgICAgY2FzZSBJTlNUUlVDVElPTlNfVFlQRS5FTEFTVElDX0NMT1VEOgogICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXRlLnR1dG9yaWFsLmVsYXN0aWNDbG91ZDsKCiAgICAgICAgY2FzZSBJTlNUUlVDVElPTlNfVFlQRS5PTl9QUkVNOgogICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXRlLnR1dG9yaWFsLm9uUHJlbTsKCiAgICAgICAgY2FzZSBJTlNUUlVDVElPTlNfVFlQRS5PTl9QUkVNX0VMQVNUSUNfQ0xPVUQ6CiAgICAgICAgICByZXR1cm4gX3RoaXMuc3RhdGUudHV0b3JpYWwub25QcmVtRWxhc3RpY0Nsb3VkOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiAna2JuLmhvbWUudHV0b3JpYWwudW5oYW5kbGVkSW5zdHJ1Y3Rpb25UeXBlRXJyb3JEZXNjcmlwdGlvbicsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5oYW5kbGVkIGluc3RydWN0aW9uIHR5cGUge3Zpc2libGVJbnN0cnVjdGlvbnN9JwogICAgICAgICAgfSwgewogICAgICAgICAgICB2aXNpYmxlSW5zdHJ1Y3Rpb25zOiBfdGhpcy5zdGF0ZS52aXNpYmxlSW5zdHJ1Y3Rpb25zCiAgICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImdldEluc3RydWN0aW9uU2V0cyIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF90aGlzLmdldEluc3RydWN0aW9ucygpLmluc3RydWN0aW9uU2V0czsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImluaXRJbnN0cnVjdGlvbnNTdGF0ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGluc3RydWN0aW9ucyA9IF90aGlzLmdldEluc3RydWN0aW9ucygpOwoKICAgICAgdmFyIHBhcmFtVmFsdWVzID0ge307CgogICAgICBpZiAoaW5zdHJ1Y3Rpb25zLnBhcmFtcykgewogICAgICAgIGluc3RydWN0aW9ucy5wYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICAgIHBhcmFtVmFsdWVzW3BhcmFtLmlkXSA9IHBhcmFtLmRlZmF1bHRWYWx1ZTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHN0YXR1c0NoZWNrU3RhdGVzID0gbmV3IEFycmF5KGluc3RydWN0aW9ucy5pbnN0cnVjdGlvblNldHMubGVuZ3RoKS5maWxsKFN0YXR1c0NoZWNrU3RhdGVzLk5PVF9DSEVDS0VEKTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBwYXJhbVZhbHVlczogcGFyYW1WYWx1ZXMsCiAgICAgICAgc3RhdHVzQ2hlY2tTdGF0ZXM6IHN0YXR1c0NoZWNrU3RhdGVzCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2V0VmlzaWJsZUluc3RydWN0aW9ucyIsIGZ1bmN0aW9uIChpbnN0cnVjdGlvbnNUeXBlKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICB2aXNpYmxlSW5zdHJ1Y3Rpb25zOiBpbnN0cnVjdGlvbnNUeXBlCiAgICAgIH0sIF90aGlzLmluaXRJbnN0cnVjdGlvbnNTdGF0ZSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRQYXJhbWV0ZXIiLCBmdW5jdGlvbiAocGFyYW1JZCwgbmV3VmFsdWUpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZpb3VzU3RhdGUpIHsKICAgICAgICB2YXIgcGFyYW1WYWx1ZXMgPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmVEZWVwKHByZXZpb3VzU3RhdGUucGFyYW1WYWx1ZXMpOwoKICAgICAgICBwYXJhbVZhbHVlc1twYXJhbUlkXSA9IG5ld1ZhbHVlOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBwYXJhbVZhbHVlczogcGFyYW1WYWx1ZXMKICAgICAgICB9OwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNoZWNrSW5zdHJ1Y3Rpb25TZXRTdGF0dXMiLAogICAgLyojX19QVVJFX18qLwogICAgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoaW5zdHJ1Y3Rpb25TZXRJbmRleCkgewogICAgICAgIHZhciBpbnN0cnVjdGlvblNldCwgZXNIaXRzQ2hlY2tDb25maWcsIHN0YXR1c0NoZWNrU3RhdGU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25TZXQgPSBfdGhpcy5nZXRJbnN0cnVjdGlvblNldHMoKVtpbnN0cnVjdGlvblNldEluZGV4XTsKICAgICAgICAgICAgICAgIGVzSGl0c0NoZWNrQ29uZmlnID0gX2xvZGFzaC5kZWZhdWx0LmdldChpbnN0cnVjdGlvblNldCwgInN0YXR1c0NoZWNrLmVzSGl0c0NoZWNrIik7CgogICAgICAgICAgICAgICAgaWYgKCFlc0hpdHNDaGVja0NvbmZpZykgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZmV0Y2hFc0hpdHNTdGF0dXMoZXNIaXRzQ2hlY2tDb25maWcpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBzdGF0dXNDaGVja1N0YXRlID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ2hlY2tTdGF0ZXM6IF9vYmplY3RTcHJlYWQoe30sIHByZXZTdGF0ZS5zdGF0dXNDaGVja1N0YXRlcywgX2RlZmluZVByb3BlcnR5KHt9LCBpbnN0cnVjdGlvblNldEluZGV4LCBzdGF0dXNDaGVja1N0YXRlKSkKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZldGNoRXNIaXRzU3RhdHVzIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoZXNIaXRzQ2hlY2tDb25maWcpIHsKICAgICAgICB2YXIgc2VhcmNoSGVhZGVyLCBzZWFyY2hCb2R5LCByZXNwb25zZSwgcmVzdWx0cywgbnVtSGl0czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgc2VhcmNoSGVhZGVyID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICBpbmRleDogZXNIaXRzQ2hlY2tDb25maWcuaW5kZXgKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgc2VhcmNoQm9keSA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgcXVlcnk6IGVzSGl0c0NoZWNrQ29uZmlnLnF1ZXJ5LAogICAgICAgICAgICAgICAgICBzaXplOiAxCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBmZXRjaChfdGhpcy5wcm9wcy5hZGRCYXNlUGF0aCgnL2VsYXN0aWNzZWFyY2gvX21zZWFyY2gnKSwgewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICAgICAgICAgICAgYm9keTogIiIuY29uY2F0KHNlYXJjaEhlYWRlciwgIlxuIikuY29uY2F0KHNlYXJjaEJvZHksICJcbiIpLAogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LW5kanNvbicsCiAgICAgICAgICAgICAgICAgICAgJ2tibi14c3JmJzogJ2tpYmFuYScKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3BvbnNlLnN0YXR1cyA+IDMwMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgU3RhdHVzQ2hlY2tTdGF0ZXMuRVJST1IpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXN1bHRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBudW1IaXRzID0gX2xvZGFzaC5kZWZhdWx0LmdldChyZXN1bHRzLCAncmVzcG9uc2VzLlswXS5oaXRzLmhpdHMubGVuZ3RoJywgMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbnVtSGl0cyA9PT0gMCA/IFN0YXR1c0NoZWNrU3RhdGVzLk5PX0RBVEEgOiBTdGF0dXNDaGVja1N0YXRlcy5IQVNfREFUQSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJJbnN0cnVjdGlvblNldHNUb2dnbGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghX3RoaXMucHJvcHMuaXNDbG91ZEVuYWJsZWQgJiYgX3RoaXMuc3RhdGUudHV0b3JpYWwub25QcmVtRWxhc3RpY0Nsb3VkKSB7CiAgICAgICAgdmFyIHNlbGZNYW5hZ2VkTGFiZWwgPSBfdGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICdrYm4uaG9tZS50dXRvcmlhbC5zZWxmTWFuYWdlZEJ1dHRvbkxhYmVsJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VsZiBtYW5hZ2VkJwogICAgICAgIH0pOwoKICAgICAgICB2YXIgY2xvdWRMYWJlbCA9IF90aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2tibi5ob21lLnR1dG9yaWFsLmVsYXN0aWNDbG91ZEJ1dHRvbkxhYmVsJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRWxhc3RpYyBDbG91ZCcKICAgICAgICB9KTsKCiAgICAgICAgdmFyIHJhZGlvQnV0dG9ucyA9IFt7CiAgICAgICAgICBpZDogSU5TVFJVQ1RJT05TX1RZUEUuT05fUFJFTSwKICAgICAgICAgIGxhYmVsOiBzZWxmTWFuYWdlZExhYmVsCiAgICAgICAgfSwgewogICAgICAgICAgaWQ6IElOU1RSVUNUSU9OU19UWVBFLk9OX1BSRU1fRUxBU1RJQ19DTE9VRCwKICAgICAgICAgIGxhYmVsOiBjbG91ZExhYmVsCiAgICAgICAgfV07CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAiY2VudGVyIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uR3JvdXAsIHsKICAgICAgICAgIG9wdGlvbnM6IHJhZGlvQnV0dG9ucywKICAgICAgICAgIGlkU2VsZWN0ZWQ6IF90aGlzLnN0YXRlLnZpc2libGVJbnN0cnVjdGlvbnMsCiAgICAgICAgICBvbkNoYW5nZTogX3RoaXMuc2V0VmlzaWJsZUluc3RydWN0aW9ucywKICAgICAgICAgIGNvbG9yOiAicHJpbWFyeSIKICAgICAgICB9KSkpOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblN0YXR1c0NoZWNrIiwgZnVuY3Rpb24gKGluc3RydWN0aW9uU2V0SW5kZXgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBzdGF0dXNDaGVja1N0YXRlczogX29iamVjdFNwcmVhZCh7fSwgcHJldlN0YXRlLnN0YXR1c0NoZWNrU3RhdGVzLCBfZGVmaW5lUHJvcGVydHkoe30sIGluc3RydWN0aW9uU2V0SW5kZXgsIFN0YXR1c0NoZWNrU3RhdGVzLkZFVENISU5HKSkKICAgICAgICB9OwogICAgICB9LCBfdGhpcy5jaGVja0luc3RydWN0aW9uU2V0U3RhdHVzLmJpbmQobnVsbCwgaW5zdHJ1Y3Rpb25TZXRJbmRleCkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVySW5zdHJ1Y3Rpb25TZXRzIiwgZnVuY3Rpb24gKGluc3RydWN0aW9ucykgewogICAgICB2YXIgb2Zmc2V0ID0gMTsKICAgICAgcmV0dXJuIGluc3RydWN0aW9ucy5pbnN0cnVjdGlvblNldHMubWFwKGZ1bmN0aW9uIChpbnN0cnVjdGlvblNldCwgaW5kZXgpIHsKICAgICAgICB2YXIgY3VycmVudE9mZnNldCA9IG9mZnNldDsKICAgICAgICBvZmZzZXQgKz0gaW5zdHJ1Y3Rpb25TZXQuaW5zdHJ1Y3Rpb25WYXJpYW50c1swXS5pbnN0cnVjdGlvbnMubGVuZ3RoOwogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9pbnN0cnVjdGlvbl9zZXQuSW5zdHJ1Y3Rpb25TZXQsIHsKICAgICAgICAgIHRpdGxlOiBpbnN0cnVjdGlvblNldC50aXRsZSwKICAgICAgICAgIGluc3RydWN0aW9uVmFyaWFudHM6IGluc3RydWN0aW9uU2V0Lmluc3RydWN0aW9uVmFyaWFudHMsCiAgICAgICAgICBzdGF0dXNDaGVja0NvbmZpZzogaW5zdHJ1Y3Rpb25TZXQuc3RhdHVzQ2hlY2ssCiAgICAgICAgICBzdGF0dXNDaGVja1N0YXRlOiBfdGhpcy5zdGF0ZS5zdGF0dXNDaGVja1N0YXRlc1tpbmRleF0sCiAgICAgICAgICBvblN0YXR1c0NoZWNrOiBmdW5jdGlvbiBvblN0YXR1c0NoZWNrKCkgewogICAgICAgICAgICBfdGhpcy5vblN0YXR1c0NoZWNrKGluZGV4KTsKICAgICAgICAgIH0sCiAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRPZmZzZXQsCiAgICAgICAgICBwYXJhbXM6IGluc3RydWN0aW9ucy5wYXJhbXMsCiAgICAgICAgICBwYXJhbVZhbHVlczogX3RoaXMuc3RhdGUucGFyYW1WYWx1ZXMsCiAgICAgICAgICBzZXRQYXJhbWV0ZXI6IF90aGlzLnNldFBhcmFtZXRlciwKICAgICAgICAgIHJlcGxhY2VUZW1wbGF0ZVN0cmluZ3M6IF90aGlzLnByb3BzLnJlcGxhY2VUZW1wbGF0ZVN0cmluZ3MsCiAgICAgICAgICBrZXk6IGluZGV4CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVyU2F2ZWRPYmplY3RzSW5zdGFsbGVyIiwgZnVuY3Rpb24gKCkgewogICAgICBpZiAoIV90aGlzLnN0YXRlLnR1dG9yaWFsLnNhdmVkT2JqZWN0cykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NhdmVkX29iamVjdHNfaW5zdGFsbGVyLlNhdmVkT2JqZWN0c0luc3RhbGxlciwgewogICAgICAgIGJ1bGtDcmVhdGU6IF90aGlzLnByb3BzLmJ1bGtDcmVhdGUsCiAgICAgICAgc2F2ZWRPYmplY3RzOiBfdGhpcy5zdGF0ZS50dXRvcmlhbC5zYXZlZE9iamVjdHMsCiAgICAgICAgaW5zdGFsbE1zZzogX3RoaXMuc3RhdGUudHV0b3JpYWwuc2F2ZWRPYmplY3RzSW5zdGFsbE1zZwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckZvb3RlciIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGxhYmVsOwogICAgICB2YXIgdXJsOwoKICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5oYXMoX3RoaXMuc3RhdGUsICd0dXRvcmlhbC5hcnRpZmFjdHMuYXBwbGljYXRpb24nKSkgewogICAgICAgIGxhYmVsID0gX3RoaXMuc3RhdGUudHV0b3JpYWwuYXJ0aWZhY3RzLmFwcGxpY2F0aW9uLmxhYmVsOwogICAgICAgIHVybCA9IF90aGlzLnByb3BzLmFkZEJhc2VQYXRoKF90aGlzLnN0YXRlLnR1dG9yaWFsLmFydGlmYWN0cy5hcHBsaWNhdGlvbi5wYXRoKTsKICAgICAgfSBlbHNlIGlmIChfbG9kYXNoLmRlZmF1bHQuaGFzKF90aGlzLnN0YXRlLCAndHV0b3JpYWwuYXJ0aWZhY3RzLmRhc2hib2FyZHMnKSkgewogICAgICAgIHZhciBvdmVydmlld0Rhc2hib2FyZCA9IF90aGlzLnN0YXRlLnR1dG9yaWFsLmFydGlmYWN0cy5kYXNoYm9hcmRzLmZpbmQoZnVuY3Rpb24gKGRhc2hib2FyZCkgewogICAgICAgICAgcmV0dXJuIGRhc2hib2FyZC5pc092ZXJ2aWV3OwogICAgICAgIH0pOwoKICAgICAgICBpZiAob3ZlcnZpZXdEYXNoYm9hcmQpIHsKICAgICAgICAgIGxhYmVsID0gb3ZlcnZpZXdEYXNoYm9hcmQubGlua0xhYmVsOwogICAgICAgICAgdXJsID0gX3RoaXMucHJvcHMuYWRkQmFzZVBhdGgoIi9hcHAva2liYW5hIy9kYXNoYm9hcmQvIi5jb25jYXQob3ZlcnZpZXdEYXNoYm9hcmQuaWQpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh1cmwgJiYgbGFiZWwpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZm9vdGVyLkZvb3RlciwgewogICAgICAgICAgbGFiZWw6IGxhYmVsLAogICAgICAgICAgdXJsOiB1cmwKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIG5vdEZvdW5kOiBmYWxzZSwKICAgICAgcGFyYW1WYWx1ZXM6IHt9LAogICAgICBzdGF0dXNDaGVja1N0YXRlczogW10sCiAgICAgIHR1dG9yaWFsOiBudWxsCiAgICB9OwoKICAgIGlmIChwcm9wcy5pc0Nsb3VkRW5hYmxlZCkgewogICAgICBfdGhpcy5zdGF0ZS52aXNpYmxlSW5zdHJ1Y3Rpb25zID0gSU5TVFJVQ1RJT05TX1RZUEUuRUxBU1RJQ19DTE9VRDsKICAgIH0gZWxzZSB7CiAgICAgIF90aGlzLnN0YXRlLnZpc2libGVJbnN0cnVjdGlvbnMgPSBJTlNUUlVDVElPTlNfVFlQRS5PTl9QUkVNOwogICAgfQoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhUdXRvcmlhbFVpLCBbewogICAga2V5OiAiY29tcG9uZW50V2lsbE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2NvbXBvbmVudERpZE1vdW50ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIHR1dG9yaWFsOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5nZXRUdXRvcmlhbCh0aGlzLnByb3BzLnR1dG9yaWFsSWQpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0dXRvcmlhbCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc01vdW50ZWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmICh0dXRvcmlhbCkgewogICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tZGlkLW1vdW50LXNldC1zdGF0ZQogICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICB0dXRvcmlhbDogdHV0b3JpYWwKICAgICAgICAgICAgICAgICAgfSwgdGhpcy5pbml0SW5zdHJ1Y3Rpb25zU3RhdGUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L25vLWRpZC1tb3VudC1zZXQtc3RhdGUKICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgbm90Rm91bmQ6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2Nocm9tZS5kZWZhdWx0LmJyZWFkY3J1bWJzLnNldChbewogICAgICAgICAgICAgICAgICB0ZXh0OiBob21lVGl0bGUsCiAgICAgICAgICAgICAgICAgIGhyZWY6ICcjL2hvbWUnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIHRleHQ6IGFkZERhdGFUaXRsZSwKICAgICAgICAgICAgICAgICAgaHJlZjogJyMvaG9tZS90dXRvcmlhbF9kaXJlY3RvcnknCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHR1dG9yaWFsID8gdHV0b3JpYWwubmFtZSA6IHRoaXMucHJvcHMudHV0b3JpYWxJZAogICAgICAgICAgICAgICAgfV0pOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgICByZXR1cm4gX2NvbXBvbmVudERpZE1vdW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb21wb25lbnREaWRNb3VudDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgY29udGVudDsKCiAgICAgIGlmICh0aGlzLnN0YXRlLm5vdEZvdW5kKSB7CiAgICAgICAgY29udGVudCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgIGNsYXNzTmFtZTogImhvbVR1dG9yaWFsX19ub3RGb3VuZFBhbmVsIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAia2JuLmhvbWUudHV0b3JpYWwubm9UdXRvcmlhbExhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVW5hYmxlIHRvIGZpbmQgdHV0b3JpYWwge3R1dG9yaWFsSWR9IiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICB0dXRvcmlhbElkOiB0aGlzLnByb3BzLnR1dG9yaWFsSWQKICAgICAgICAgIH0KICAgICAgICB9KSkpKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc3RhdGUudHV0b3JpYWwpIHsKICAgICAgICB2YXIgcHJldmlld1VybDsKCiAgICAgICAgaWYgKHRoaXMuc3RhdGUudHV0b3JpYWwucHJldmlld0ltYWdlUGF0aCkgewogICAgICAgICAgcHJldmlld1VybCA9IHRoaXMucHJvcHMuYWRkQmFzZVBhdGgodGhpcy5zdGF0ZS50dXRvcmlhbC5wcmV2aWV3SW1hZ2VQYXRoKTsKICAgICAgICB9CgogICAgICAgIHZhciBleHBvcnRlZEZpZWxkc1VybDsKCiAgICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5oYXModGhpcy5zdGF0ZSwgJ3R1dG9yaWFsLmFydGlmYWN0cy5leHBvcnRlZEZpZWxkcycpKSB7CiAgICAgICAgICBleHBvcnRlZEZpZWxkc1VybCA9IHRoaXMucHJvcHMucmVwbGFjZVRlbXBsYXRlU3RyaW5ncyh0aGlzLnN0YXRlLnR1dG9yaWFsLmFydGlmYWN0cy5leHBvcnRlZEZpZWxkcy5kb2N1bWVudGF0aW9uVXJsKTsKICAgICAgICB9CgogICAgICAgIHZhciBpbnN0cnVjdGlvbnMgPSB0aGlzLmdldEluc3RydWN0aW9ucygpOwogICAgICAgIGNvbnRlbnQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9pbnRyb2R1Y3Rpb24uSW50cm9kdWN0aW9uLCB7CiAgICAgICAgICB0aXRsZTogdGhpcy5zdGF0ZS50dXRvcmlhbC5uYW1lLAogICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMucHJvcHMucmVwbGFjZVRlbXBsYXRlU3RyaW5ncyh0aGlzLnN0YXRlLnR1dG9yaWFsLmxvbmdEZXNjcmlwdGlvbiksCiAgICAgICAgICBwcmV2aWV3VXJsOiBwcmV2aWV3VXJsLAogICAgICAgICAgZXhwb3J0ZWRGaWVsZHNVcmw6IGV4cG9ydGVkRmllbGRzVXJsLAogICAgICAgICAgaWNvblR5cGU6IHRoaXMuc3RhdGUudHV0b3JpYWwuZXVpSWNvblR5cGUsCiAgICAgICAgICBpc0JldGE6IHRoaXMuc3RhdGUudHV0b3JpYWwuaXNCZXRhCiAgICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJldWktdGV4dENlbnRlciIKICAgICAgICB9LCB0aGlzLnJlbmRlckluc3RydWN0aW9uU2V0c1RvZ2dsZSgpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYW5lbCwgewogICAgICAgICAgcGFkZGluZ1NpemU6ICJsIgogICAgICAgIH0sIHRoaXMucmVuZGVySW5zdHJ1Y3Rpb25TZXRzKGluc3RydWN0aW9ucyksIHRoaXMucmVuZGVyU2F2ZWRPYmplY3RzSW5zdGFsbGVyKCksIHRoaXMucmVuZGVyRm9vdGVyKCkpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlLCB7CiAgICAgICAgcmVzdHJpY3RXaWR0aDogMTIwMAogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUJvZHksIG51bGwsIGNvbnRlbnQpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBUdXRvcmlhbFVpOwp9KF9yZWFjdC5kZWZhdWx0LkNvbXBvbmVudCk7CgpUdXRvcmlhbFVpLnByb3BUeXBlcyA9IHsKICBhZGRCYXNlUGF0aDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBpc0Nsb3VkRW5hYmxlZDogX3Byb3BUeXBlcy5kZWZhdWx0LmJvb2wuaXNSZXF1aXJlZCwKICBnZXRUdXRvcmlhbDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICByZXBsYWNlVGVtcGxhdGVTdHJpbmdzOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIHR1dG9yaWFsSWQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcuaXNSZXF1aXJlZCwKICBidWxrQ3JlYXRlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkCn07CnZhciBUdXRvcmlhbCA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKFR1dG9yaWFsVWkpOwpleHBvcnRzLlR1dG9yaWFsID0gVHV0b3JpYWw7"},null]}