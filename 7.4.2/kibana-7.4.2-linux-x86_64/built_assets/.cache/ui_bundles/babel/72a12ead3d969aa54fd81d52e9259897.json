{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/tile_map/common/tms_service.js","dependencies":[{"path":"src/legacy/core_plugins/tile_map/common/tms_service.js","mtime":1572296411320},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkyKHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5MihvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5UTVNTZXJ2aWNlID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfb3JpZ2luID0gcmVxdWlyZSgiLi9vcmlnaW4iKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgVE1TU2VydmljZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFRNU1NlcnZpY2UoY29uZmlnLCBlbXNDbGllbnQsIHByb3h5UGF0aCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVE1TU2VydmljZSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfZ2V0UmFzdGVyU3R5bGVKc29uIiwgX2xvZGFzaC5kZWZhdWx0Lm9uY2UoCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciByYXN0ZXJVcmwsIHVybDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJhc3RlclVybCA9IF90aGlzLl9nZXRTdHlsZVVybEZvckxvY2FsZSgncmFzdGVyJyk7CiAgICAgICAgICAgICAgdXJsID0gX3RoaXMuX3Byb3h5UGF0aCArIHJhc3RlclVybDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBfdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0KF90aGlzLl9lbXNDbGllbnQuZXh0ZW5kVXJsV2l0aFBhcmFtcyh1cmwpKSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfZ2V0VmVjdG9yU3R5bGVKc29uUmF3IiwgX2xvZGFzaC5kZWZhdWx0Lm9uY2UoCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICB2YXIgdmVjdG9yVXJsLCB1cmwsIHZlY3Rvckpzb247CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgdmVjdG9yVXJsID0gX3RoaXMuX2dldFN0eWxlVXJsRm9yTG9jYWxlKCd2ZWN0b3InKTsKICAgICAgICAgICAgICB1cmwgPSBfdGhpcy5fcHJveHlQYXRoICsgdmVjdG9yVXJsOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2Vtc0NsaWVudC5nZXRNYW5pZmVzdChfdGhpcy5fZW1zQ2xpZW50LmV4dGVuZFVybFdpdGhQYXJhbXModXJsKSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgdmVjdG9ySnNvbiA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfb2JqZWN0U3ByZWFkKHt9LCB2ZWN0b3JKc29uKSk7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9nZXRWZWN0b3JTdHlsZUpzb25JbmxpbmVkIiwgX2xvZGFzaC5kZWZhdWx0Lm9uY2UoCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICB2YXIgdmVjdG9ySnNvbiwgaW5saW5lZFNvdXJjZXMsIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24sIF9kaWRJdGVyYXRvckVycm9yLCBfaXRlcmF0b3JFcnJvciwgX2l0ZXJhdG9yLCBfc3RlcCwgc291cmNlTmFtZSwgc291cmNlVXJsLCBleHRlbmRlZFVybCwgc291cmNlSnNvbiwgZXh0ZW5kZWRUaWxlVXJsczsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5fZ2V0VmVjdG9yU3R5bGVKc29uUmF3KCk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgdmVjdG9ySnNvbiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIGlubGluZWRTb3VyY2VzID0ge307CiAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDc7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmVjdG9ySnNvbi5zb3VyY2VzKVtTeW1ib2wuaXRlcmF0b3JdKCk7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzb3VyY2VOYW1lID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgc291cmNlVXJsID0gX3RoaXMuX3Byb3h5UGF0aCArIHZlY3Rvckpzb24uc291cmNlc1tzb3VyY2VOYW1lXS51cmw7CiAgICAgICAgICAgICAgZXh0ZW5kZWRVcmwgPSBfdGhpcy5fZW1zQ2xpZW50LmV4dGVuZFVybFdpdGhQYXJhbXMoc291cmNlVXJsKTsKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE1OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0KGV4dGVuZGVkVXJsKTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgc291cmNlSnNvbiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIGV4dGVuZGVkVGlsZVVybHMgPSBzb3VyY2VKc29uLnRpbGVzLm1hcChmdW5jdGlvbiAodGlsZVVybCkgewogICAgICAgICAgICAgICAgdmFyIHVybCA9IF90aGlzLl9wcm94eVBhdGggKyB0aWxlVXJsOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9lbXNDbGllbnQuZXh0ZW5kVXJsV2l0aFBhcmFtcyh1cmwpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlubGluZWRTb3VyY2VzW3NvdXJjZU5hbWVdID0gX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgICAgICB0eXBlOiAndmVjdG9yJwogICAgICAgICAgICAgIH0sIHNvdXJjZUpzb24sIHsKICAgICAgICAgICAgICAgIHRpbGVzOiBleHRlbmRlZFRpbGVVcmxzCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyNzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAyMzsKICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oNyk7CiAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gX2NvbnRleHQzLnQwOwoKICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDI3OwogICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMjg7CgogICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMzA7CgogICAgICAgICAgICAgIGlmICghX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMzM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOwoKICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmZpbmlzaCgzMCk7CgogICAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuZmluaXNoKDI3KTsKCiAgICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgICAgX2NvbnRleHQzLnQxID0gX29iamVjdFNwcmVhZDsKICAgICAgICAgICAgICBfY29udGV4dDMudDIgPSB7fTsKICAgICAgICAgICAgICBfY29udGV4dDMudDMgPSB2ZWN0b3JKc29uOwogICAgICAgICAgICAgIF9jb250ZXh0My50NCA9IGlubGluZWRTb3VyY2VzOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNDE7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9nZXRTcHJpdGVTaGVldFJvb3RQYXRoKCk7CgogICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgIF9jb250ZXh0My50NSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0My50NiA9IHsKICAgICAgICAgICAgICAgIHNvdXJjZXM6IF9jb250ZXh0My50NCwKICAgICAgICAgICAgICAgIHNwcml0ZTogX2NvbnRleHQzLnQ1CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgKDAsIF9jb250ZXh0My50MSkoX2NvbnRleHQzLnQyLCBfY29udGV4dDMudDMsIF9jb250ZXh0My50NikpOwoKICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzLCBudWxsLCBbWzcsIDIzLCAyNywgMzVdLCBbMjgsLCAzMCwgMzRdXSk7CiAgICB9KSkpKTsKCiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7CiAgICB0aGlzLl9lbXNDbGllbnQgPSBlbXNDbGllbnQ7CiAgICB0aGlzLl9wcm94eVBhdGggPSBwcm94eVBhdGg7CiAgfQoKICBfY3JlYXRlQ2xhc3MoVE1TU2VydmljZSwgW3sKICAgIGtleTogIl9nZXRGb3JtYXRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Rm9ybWF0cyhmb3JtYXRUeXBlLCBsb2NhbGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5mb3JtYXRzLmZpbHRlcihmdW5jdGlvbiAoZm9ybWF0KSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdC5sb2NhbGUgPT09IGxvY2FsZSAmJiBmb3JtYXQuZm9ybWF0ID09PSBmb3JtYXRUeXBlOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZ2V0U3R5bGVVcmxGb3JMb2NhbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRTdHlsZVVybEZvckxvY2FsZShmb3JtYXRUeXBlKSB7CiAgICAgIHZhciB2ZWN0b3JGb3JtYXRzID0gdGhpcy5fZ2V0Rm9ybWF0cyhmb3JtYXRUeXBlLCB0aGlzLl9lbXNDbGllbnQuZ2V0TG9jYWxlKCkpOwoKICAgICAgaWYgKCF2ZWN0b3JGb3JtYXRzLmxlbmd0aCkgewogICAgICAgIC8vZmFsbGJhY2sgdG8gZGVmYXVsdCBsb2NhbGUKICAgICAgICB2ZWN0b3JGb3JtYXRzID0gdGhpcy5fZ2V0Rm9ybWF0cyhmb3JtYXRUeXBlLCB0aGlzLl9lbXNDbGllbnQuZ2V0RGVmYXVsdExvY2FsZSgpKTsKICAgICAgfQoKICAgICAgaWYgKCF2ZWN0b3JGb3JtYXRzLmxlbmd0aCkgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCAiLmNvbmNhdChmb3JtYXRUeXBlLCAiIHRpbGUgbGF5ZXIgZm9yIGxvY2FsZSAiKS5jb25jYXQodGhpcy5fZW1zQ2xpZW50LmdldExvY2FsZSgpLCAiIG9yICIpLmNvbmNhdCh0aGlzLl9lbXNDbGllbnQuZ2V0RGVmYXVsdExvY2FsZSgpKSk7CiAgICAgIH0KCiAgICAgIHZhciBkZWZhdWx0U3R5bGUgPSB2ZWN0b3JGb3JtYXRzWzBdOwoKICAgICAgaWYgKGRlZmF1bHRTdHlsZSAmJiBkZWZhdWx0U3R5bGUuaGFzT3duUHJvcGVydHkoJ3VybCcpKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHlsZS51cmw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREZWZhdWx0UmFzdGVyU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXREZWZhdWx0UmFzdGVyU3R5bGUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJhc3RlclN0eWxlSnNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ0LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXREZWZhdWx0UmFzdGVyU3R5bGUoKSB7CiAgICAgICAgcmV0dXJuIF9nZXREZWZhdWx0UmFzdGVyU3R5bGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldERlZmF1bHRSYXN0ZXJTdHlsZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldFVybFRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0VXJsVGVtcGxhdGUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICB2YXIgdGlsZUpzb24sIGRpcmVjdFVybDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJhc3RlclN0eWxlSnNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0aWxlSnNvbiA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgZGlyZWN0VXJsID0gdGhpcy5fcHJveHlQYXRoICsgdGlsZUpzb24udGlsZXNbMF07CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgdGhpcy5fZW1zQ2xpZW50LmV4dGVuZFVybFdpdGhQYXJhbXMoZGlyZWN0VXJsKSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldFVybFRlbXBsYXRlKCkgewogICAgICAgIHJldHVybiBfZ2V0VXJsVGVtcGxhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFVybFRlbXBsYXRlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0VXJsVGVtcGxhdGVGb3JWZWN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRVcmxUZW1wbGF0ZUZvclZlY3RvciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KHNvdXJjZUlkKSB7CiAgICAgICAgdmFyIHRpbGVKc29uLCBkaXJlY3RVcmw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRWZWN0b3JTdHlsZUpzb25JbmxpbmVkKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRpbGVKc29uID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEoIXRpbGVKc29uLnNvdXJjZXNbc291cmNlSWRdIHx8ICF0aWxlSnNvbi5zb3VyY2VzW3NvdXJjZUlkXS50aWxlcykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGRpcmVjdFVybCA9IHRoaXMuX3Byb3h5UGF0aCArIHRpbGVKc29uLnNvdXJjZXNbc291cmNlSWRdLnRpbGVzWzBdOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2Vtc0NsaWVudC5leHRlbmRVcmxXaXRoUGFyYW1zKGRpcmVjdFVybCkpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRVcmxUZW1wbGF0ZUZvclZlY3RvcihfeCkgewogICAgICAgIHJldHVybiBfZ2V0VXJsVGVtcGxhdGVGb3JWZWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFVybFRlbXBsYXRlRm9yVmVjdG9yOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0VmVjdG9yU3R5bGVTaGVldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldFZlY3RvclN0eWxlU2hlZXQgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFZlY3RvclN0eWxlSnNvbklubGluZWQoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0Ny5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0VmVjdG9yU3R5bGVTaGVldCgpIHsKICAgICAgICByZXR1cm4gX2dldFZlY3RvclN0eWxlU2hlZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFZlY3RvclN0eWxlU2hlZXQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRWZWN0b3JTdHlsZVNoZWV0UmF3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0VmVjdG9yU3R5bGVTaGVldFJhdyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VmVjdG9yU3R5bGVKc29uUmF3KCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDguc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldFZlY3RvclN0eWxlU2hlZXRSYXcoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRWZWN0b3JTdHlsZVNoZWV0UmF3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRWZWN0b3JTdHlsZVNoZWV0UmF3OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0U3ByaXRlU2hlZXRNZXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0U3ByaXRlU2hlZXRNZXRhID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgdmFyIGlzUmV0aW5hLAogICAgICAgICAgICBtZXRhVXJsLAogICAgICAgICAgICBzcHJpdGVQbmdzLAogICAgICAgICAgICBtZXRhVXJsRXh0ZW5kZWQsCiAgICAgICAgICAgIGpzb25NZXRhLAogICAgICAgICAgICBfYXJnczkgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlzUmV0aW5hID0gX2FyZ3M5Lmxlbmd0aCA+IDAgJiYgX2FyZ3M5WzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczlbMF0gOiBmYWxzZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNwcml0ZVNoZWV0SnNvblBhdGgoaXNSZXRpbmEpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBtZXRhVXJsID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTcHJpdGVTaGVldFBuZ1BhdGgoaXNSZXRpbmEpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBzcHJpdGVQbmdzID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICBtZXRhVXJsRXh0ZW5kZWQgPSB0aGlzLl9lbXNDbGllbnQuZXh0ZW5kVXJsV2l0aFBhcmFtcyhtZXRhVXJsKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0KG1ldGFVcmxFeHRlbmRlZCk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBqc29uTWV0YSA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgcG5nOiBzcHJpdGVQbmdzLAogICAgICAgICAgICAgICAgICBqc29uOiBqc29uTWV0YQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTksIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRTcHJpdGVTaGVldE1ldGEoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRTcHJpdGVTaGVldE1ldGEuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFNwcml0ZVNoZWV0TWV0YTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIl9nZXRTcHJpdGVTaGVldFJvb3RQYXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0U3ByaXRlU2hlZXRSb290UGF0aDIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgdmFyIHZlY3RvclN0eWxlSnNvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VmVjdG9yU3R5bGVKc29uUmF3KCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHZlY3RvclN0eWxlSnNvbiA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgdGhpcy5fcHJveHlQYXRoICsgdmVjdG9yU3R5bGVKc29uLnNwcml0ZSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX2dldFNwcml0ZVNoZWV0Um9vdFBhdGgoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRTcHJpdGVTaGVldFJvb3RQYXRoMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX2dldFNwcml0ZVNoZWV0Um9vdFBhdGg7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRTcHJpdGVTaGVldEpzb25QYXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0U3ByaXRlU2hlZXRKc29uUGF0aCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgICB2YXIgaXNSZXRpbmEsCiAgICAgICAgICAgIHNwcml0ZVNoZWV0Um9vdFBhdGgsCiAgICAgICAgICAgIHN1ZmZpeCwKICAgICAgICAgICAgX2FyZ3MxMSA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlzUmV0aW5hID0gX2FyZ3MxMS5sZW5ndGggPiAwICYmIF9hcmdzMTFbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTFbMF0gOiBmYWxzZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0U3ByaXRlU2hlZXRSb290UGF0aCgpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBzcHJpdGVTaGVldFJvb3RQYXRoID0gX2NvbnRleHQxMS5zZW50OwogICAgICAgICAgICAgICAgc3VmZml4ID0gaXNSZXRpbmEgPyAnQDJ4JyA6ICcnOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBzcHJpdGVTaGVldFJvb3RQYXRoICsgc3VmZml4ICsgJy5qc29uJyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0U3ByaXRlU2hlZXRKc29uUGF0aCgpIHsKICAgICAgICByZXR1cm4gX2dldFNwcml0ZVNoZWV0SnNvblBhdGguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFNwcml0ZVNoZWV0SnNvblBhdGg7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRTcHJpdGVTaGVldFBuZ1BhdGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRTcHJpdGVTaGVldFBuZ1BhdGggPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoKSB7CiAgICAgICAgdmFyIGlzUmV0aW5hLAogICAgICAgICAgICBzcHJpdGVTaGVldFJvb3RQYXRoLAogICAgICAgICAgICBzdWZmaXgsCiAgICAgICAgICAgIF9hcmdzMTIgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpc1JldGluYSA9IF9hcmdzMTIubGVuZ3RoID4gMCAmJiBfYXJnczEyWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczEyWzBdIDogZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFNwcml0ZVNoZWV0Um9vdFBhdGgoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgc3ByaXRlU2hlZXRSb290UGF0aCA9IF9jb250ZXh0MTIuc2VudDsKICAgICAgICAgICAgICAgIHN1ZmZpeCA9IGlzUmV0aW5hID8gJ0AyeCcgOiAnJzsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIiwgc3ByaXRlU2hlZXRSb290UGF0aCArIHN1ZmZpeCArICcucG5nJyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0U3ByaXRlU2hlZXRQbmdQYXRoKCkgewogICAgICAgIHJldHVybiBfZ2V0U3ByaXRlU2hlZXRQbmdQYXRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRTcHJpdGVTaGVldFBuZ1BhdGg7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXREaXNwbGF5TmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9lbXNDbGllbnQuZ2V0VmFsdWVJbkxhbmd1YWdlKHRoaXMuX2NvbmZpZy5uYW1lKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBdHRyaWJ1dGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEF0dHJpYnV0aW9ucygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmF0dHJpYnV0aW9uLm1hcChmdW5jdGlvbiAoYXR0cmlidXRpb24pIHsKICAgICAgICB2YXIgdXJsID0gX3RoaXMyLl9lbXNDbGllbnQuZ2V0VmFsdWVJbkxhbmd1YWdlKGF0dHJpYnV0aW9uLnVybCk7CgogICAgICAgIHZhciBsYWJlbCA9IF90aGlzMi5fZW1zQ2xpZW50LmdldFZhbHVlSW5MYW5ndWFnZShhdHRyaWJ1dGlvbi5sYWJlbCk7CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgIGxhYmVsOiBsYWJlbAogICAgICAgIH07CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEhUTUxBdHRyaWJ1dGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SFRNTEF0dHJpYnV0aW9uKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBhdHRyaWJ1dGlvbnMgPSB0aGlzLl9jb25maWcuYXR0cmlidXRpb24ubWFwKGZ1bmN0aW9uIChhdHRyaWJ1dGlvbikgewogICAgICAgIHZhciB1cmwgPSBfdGhpczMuX2Vtc0NsaWVudC5nZXRWYWx1ZUluTGFuZ3VhZ2UoYXR0cmlidXRpb24udXJsKTsKCiAgICAgICAgdmFyIGxhYmVsID0gX3RoaXMzLl9lbXNDbGllbnQuZ2V0VmFsdWVJbkxhbmd1YWdlKGF0dHJpYnV0aW9uLmxhYmVsKTsKCiAgICAgICAgdmFyIGh0bWwgPSB1cmwgPyAiPGEgcmVsPVwibm9yZWZlcnJlciBub29wZW5lclwiIGhyZWY9XCIiLmNvbmNhdCh1cmwsICJcIj4iKS5jb25jYXQobGFiZWwsICI8L2E+IikgOiBsYWJlbDsKICAgICAgICByZXR1cm4gX3RoaXMzLl9lbXNDbGllbnQuc2FuaXRpemVIdG1sKCIiLmNvbmNhdChodG1sKSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuICI8cD4iLmNvbmNhdChhdHRyaWJ1dGlvbnMuam9pbignIHwgJyksICI8L3A+Iik7IC8vISEhdGhpcyBpcyB0aGUgY3VycmVudCBjb252ZW50aW9uIHVzZWQgaW4gS2liYW5hCiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWFya2Rvd25BdHRyaWJ1dGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFya2Rvd25BdHRyaWJ1dGlvbigpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgYXR0cmlidXRpb25zID0gdGhpcy5fY29uZmlnLmF0dHJpYnV0aW9uLm1hcChmdW5jdGlvbiAoYXR0cmlidXRpb24pIHsKICAgICAgICB2YXIgdXJsID0gX3RoaXM0Ll9lbXNDbGllbnQuZ2V0VmFsdWVJbkxhbmd1YWdlKGF0dHJpYnV0aW9uLnVybCk7CgogICAgICAgIHZhciBsYWJlbCA9IF90aGlzNC5fZW1zQ2xpZW50LmdldFZhbHVlSW5MYW5ndWFnZShhdHRyaWJ1dGlvbi5sYWJlbCk7CgogICAgICAgIHJldHVybiAiWyIuY29uY2F0KGxhYmVsLCAiXSgiKS5jb25jYXQodXJsLCAiKSIpOwogICAgICB9KTsKCiAgICAgIHJldHVybiBhdHRyaWJ1dGlvbnMuam9pbignfCcpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE1pblpvb20iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRNaW5ab29tID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICAgIHZhciB0aWxlSnNvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UmFzdGVyU3R5bGVKc29uKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRpbGVKc29uID0gX2NvbnRleHQxMy5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iLCB0aWxlSnNvbi5taW56b29tKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRNaW5ab29tKCkgewogICAgICAgIHJldHVybiBfZ2V0TWluWm9vbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0TWluWm9vbTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldE1heFpvb20iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRNYXhab29tID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KCkgewogICAgICAgIHZhciB0aWxlSnNvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UmFzdGVyU3R5bGVKc29uKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRpbGVKc29uID0gX2NvbnRleHQxNC5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KCJyZXR1cm4iLCB0aWxlSnNvbi5tYXh6b29tKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRNYXhab29tKCkgewogICAgICAgIHJldHVybiBfZ2V0TWF4Wm9vbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0TWF4Wm9vbTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldElkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5pZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYXNJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzSWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5pZCA9PT0gaWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0T3JpZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPcmlnaW4oKSB7CiAgICAgIHJldHVybiBfb3JpZ2luLk9SSUdJTi5FTVM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVE1TU2VydmljZTsKfSgpOwoKZXhwb3J0cy5UTVNTZXJ2aWNlID0gVE1TU2VydmljZTs="},null]}