{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/objects_table.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/objects_table.js","mtime":1572296410660},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdHNUYWJsZSA9IGV4cG9ydHMuUE9TU0lCTEVfVFlQRVMgPSB2b2lkIDA7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKdmFyIF9maWxlc2F2ZXIgPSByZXF1aXJlKCJAZWxhc3RpYy9maWxlc2F2ZXIiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfaGVhZGVyID0gcmVxdWlyZSgiLi9jb21wb25lbnRzL2hlYWRlciIpOwoKdmFyIF9mbHlvdXQgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvZmx5b3V0Iik7Cgp2YXIgX3JlbGF0aW9uc2hpcHMgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvcmVsYXRpb25zaGlwcyIpOwoKdmFyIF90YWJsZSA9IHJlcXVpcmUoIi4vY29tcG9uZW50cy90YWJsZSIpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2xpYiA9IHJlcXVpcmUoIi4uLy4uL2xpYiIpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307IGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgUE9TU0lCTEVfVFlQRVMgPSBfY2hyb21lLmRlZmF1bHQuZ2V0SW5qZWN0ZWQoJ2ltcG9ydEFuZEV4cG9ydGFibGVUeXBlcycpOwoKZXhwb3J0cy5QT1NTSUJMRV9UWVBFUyA9IFBPU1NJQkxFX1RZUEVTOwoKdmFyIE9iamVjdHNUYWJsZVVJID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhPYmplY3RzVGFibGVVSSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIE9iamVjdHNUYWJsZVVJKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9iamVjdHNUYWJsZVVJKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihPYmplY3RzVGFibGVVSSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZldGNoQ291bnRzIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIF9wYXJzZVF1ZXJ5LCBxdWVyeVRleHQsIHZpc2libGVUeXBlcywgZmlsdGVyZWRUeXBlcywgZmlsdGVyZWRTYXZlZE9iamVjdENvdW50cywgZXhwb3J0QWxsT3B0aW9ucywgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zLCBzYXZlZE9iamVjdENvdW50czsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfcGFyc2VRdWVyeSA9ICgwLCBfbGliLnBhcnNlUXVlcnkpKF90aGlzLnN0YXRlLmFjdGl2ZVF1ZXJ5KSwgcXVlcnlUZXh0ID0gX3BhcnNlUXVlcnkucXVlcnlUZXh0LCB2aXNpYmxlVHlwZXMgPSBfcGFyc2VRdWVyeS52aXNpYmxlVHlwZXM7CiAgICAgICAgICAgICAgZmlsdGVyZWRUeXBlcyA9IF90aGlzLnNhdmVkT2JqZWN0VHlwZXMuZmlsdGVyKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIXZpc2libGVUeXBlcyB8fCB2aXNpYmxlVHlwZXMuaW5jbHVkZXModHlwZSk7CiAgICAgICAgICAgICAgfSk7IC8vIFRoZXNlIGFyZSB0aGUgc2F2ZWQgb2JqZWN0cyB2aXNpYmxlIGluIHRoZSB0YWJsZS4KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuICgwLCBfbGliLmdldFNhdmVkT2JqZWN0Q291bnRzKShfdGhpcy5wcm9wcy4kaHR0cCwgZmlsdGVyZWRUeXBlcywgcXVlcnlUZXh0KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBmaWx0ZXJlZFNhdmVkT2JqZWN0Q291bnRzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBleHBvcnRBbGxPcHRpb25zID0gW107CiAgICAgICAgICAgICAgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zID0ge307CiAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZmlsdGVyZWRTYXZlZE9iamVjdENvdW50cykuZm9yRWFjaChmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgICAgIC8vIEFkZCB0aGlzIHR5cGUgYXMgYSBidWxrLWV4cG9ydCBvcHRpb24uCiAgICAgICAgICAgICAgICBleHBvcnRBbGxPcHRpb25zLnB1c2goewogICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgIGxhYmVsOiAiIi5jb25jYXQoaWQsICIgKCIpLmNvbmNhdChmaWx0ZXJlZFNhdmVkT2JqZWN0Q291bnRzW2lkXSB8fCAwLCAiKSIpCiAgICAgICAgICAgICAgICB9KTsgLy8gU2VsZWN0IGl0IGJ5IGRlZmF5dWx0LgoKICAgICAgICAgICAgICAgIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9uc1tpZF0gPSB0cnVlOwogICAgICAgICAgICAgIH0pOyAvLyBGZXRjaCBhbGwgdGhlIHNhdmVkIG9iamVjdHMgdGhhdCBleGlzdCBzbyB3ZSBjYW4gYWNjdXJhdGVseSBwb3B1bGF0ZSB0aGUgY291bnRzIHdpdGhpbgogICAgICAgICAgICAgIC8vIHRoZSB0YWJsZSBmaWx0ZXIgZHJvcGRvd24uCgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RDb3VudHMpKF90aGlzLnByb3BzLiRodHRwLCBfdGhpcy5zYXZlZE9iamVjdFR5cGVzLCBxdWVyeVRleHQpOwoKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBzYXZlZE9iamVjdENvdW50cyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLCB7CiAgICAgICAgICAgICAgICAgIHNhdmVkT2JqZWN0Q291bnRzOiBzYXZlZE9iamVjdENvdW50cywKICAgICAgICAgICAgICAgICAgZXhwb3J0QWxsT3B0aW9uczogZXhwb3J0QWxsT3B0aW9ucywKICAgICAgICAgICAgICAgICAgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zOiBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImZldGNoU2F2ZWRPYmplY3RzIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTZWFyY2hpbmc6IHRydWUKICAgICAgfSwgX3RoaXMuZGVib3VuY2VkRmV0Y2gpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVib3VuY2VkRmV0Y2giLCAoMCwgX2xvZGFzaC5kZWJvdW5jZSkoCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICB2YXIgaW50bCwgX3RoaXMkc3RhdGUsIHF1ZXJ5LCBwYWdlLCBwZXJQYWdlLCBfcGFyc2VRdWVyeTIsIHF1ZXJ5VGV4dCwgdmlzaWJsZVR5cGVzLCBmaW5kT3B0aW9ucywgcmVzcDsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgICAgICAgICAgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSwgcXVlcnkgPSBfdGhpcyRzdGF0ZS5hY3RpdmVRdWVyeSwgcGFnZSA9IF90aGlzJHN0YXRlLnBhZ2UsIHBlclBhZ2UgPSBfdGhpcyRzdGF0ZS5wZXJQYWdlOwogICAgICAgICAgICAgIF9wYXJzZVF1ZXJ5MiA9ICgwLCBfbGliLnBhcnNlUXVlcnkpKHF1ZXJ5KSwgcXVlcnlUZXh0ID0gX3BhcnNlUXVlcnkyLnF1ZXJ5VGV4dCwgdmlzaWJsZVR5cGVzID0gX3BhcnNlUXVlcnkyLnZpc2libGVUeXBlczsgLy8gInNlYXJjaEZpZWxkcyIgaXMgbWlzc2luZyBmcm9tIHRoZSAiZmluZE9wdGlvbnMiIGJ1dCBnZXRzIGluamVjdGVkIHZpYSB0aGUgQVBJLgogICAgICAgICAgICAgIC8vIFRoZSBBUEkgZXh0cmFjdHMgdGhlIGZpZWxkcyBmcm9tIGVhY2ggdWlFeHBvcnRzLnNhdmVkT2JqZWN0c01hbmFnZW1lbnQgImRlZmF1bHRTZWFyY2hGaWVsZCIgYXR0cmlidXRlCgogICAgICAgICAgICAgIGZpbmRPcHRpb25zID0gewogICAgICAgICAgICAgICAgc2VhcmNoOiBxdWVyeVRleHQgPyAiIi5jb25jYXQocXVlcnlUZXh0LCAiKiIpIDogdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgcGVyUGFnZTogcGVyUGFnZSwKICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UgKyAxLAogICAgICAgICAgICAgICAgZmllbGRzOiBbJ2lkJ10sCiAgICAgICAgICAgICAgICB0eXBlOiBfdGhpcy5zYXZlZE9iamVjdFR5cGVzLmZpbHRlcihmdW5jdGlvbiAodHlwZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gIXZpc2libGVUeXBlcyB8fCB2aXNpYmxlVHlwZXMuaW5jbHVkZXModHlwZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGlmIChmaW5kT3B0aW9ucy50eXBlLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgIGZpbmRPcHRpb25zLnNvcnRGaWVsZCA9ICd0eXBlJzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgcmV0dXJuICgwLCBfbGliLmZpbmRPYmplY3RzKShmaW5kT3B0aW9ucyk7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDUpOwoKICAgICAgICAgICAgICBpZiAoX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBpc1NlYXJjaGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICAgIHRpdGxlOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnVuYWJsZUZpbmRTYXZlZE9iamVjdHNOb3RpZmljYXRpb25NZXNzYWdlJywKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgZmluZCBzYXZlZCBvYmplY3RzJwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQoX2NvbnRleHQyLnQwKQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGlmIChfdGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVF1ZXJ5ID0gX3JlZjMuYWN0aXZlUXVlcnk7CgogICAgICAgICAgICAgICAgLy8gaWdub3JlIHJlc3VsdHMgZm9yIG9sZCByZXF1ZXN0cwogICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVF1ZXJ5LnRleHQgIT09IHF1ZXJ5LnRleHQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgIHNhdmVkT2JqZWN0czogcmVzcC5zYXZlZE9iamVjdHMsCiAgICAgICAgICAgICAgICAgIGZpbHRlcmVkSXRlbUNvdW50OiByZXNwLnRvdGFsLAogICAgICAgICAgICAgICAgICBpc1NlYXJjaGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbNSwgMTFdXSk7CiAgICB9KSksIDMwMCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlZnJlc2hEYXRhIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbX3RoaXMuZmV0Y2hTYXZlZE9iamVjdHMoKSwgX3RoaXMuZmV0Y2hDb3VudHMoKV0pOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTMpOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNlbGVjdGlvbkNoYW5nZWQiLCBmdW5jdGlvbiAoc2VsZWN0aW9uKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogc2VsZWN0aW9uCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25RdWVyeUNoYW5nZSIsIGZ1bmN0aW9uIChfcmVmNSkgewogICAgICB2YXIgcXVlcnkgPSBfcmVmNS5xdWVyeTsKCiAgICAgIC8vIFRPRE86IFVzZSBpc1NhbWVRdWVyeSB0byBjb21wYXJlIG5ldyBxdWVyeSB3aXRoIHN0YXRlLmFjdGl2ZVF1ZXJ5IHRvIGF2b2lkIHJlLWZldGNoaW5nIHRoZQogICAgICAvLyBzYW1lIGRhdGEgd2UgYWxyZWFkeSBoYXZlLgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgYWN0aXZlUXVlcnk6IHF1ZXJ5LAogICAgICAgIHBhZ2U6IDAsCiAgICAgICAgLy8gUmVzZXQgdGhpcyBvbiBlYWNoIHF1ZXJ5IGNoYW5nZQogICAgICAgIHNlbGVjdGVkU2F2ZWRPYmplY3RzOiBbXQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZmV0Y2hTYXZlZE9iamVjdHMoKTsKCiAgICAgICAgX3RoaXMuZmV0Y2hDb3VudHMoKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblRhYmxlQ2hhbmdlIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWY2ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQodGFibGUpIHsKICAgICAgICB2YXIgX3JlZjcsIHBhZ2UsIHBlclBhZ2U7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfcmVmNyA9IHRhYmxlLnBhZ2UgfHwge30sIHBhZ2UgPSBfcmVmNy5pbmRleCwgcGVyUGFnZSA9IF9yZWY3LnNpemU7CgogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlLAogICAgICAgICAgICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogW10KICAgICAgICAgICAgICAgIH0sIF90aGlzLmZldGNoU2F2ZWRPYmplY3RzKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNob3dSZWxhdGlvbnNoaXBzIiwgZnVuY3Rpb24gKG9iamVjdCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTaG93aW5nUmVsYXRpb25zaGlwczogdHJ1ZSwKICAgICAgICByZWxhdGlvbnNoaXBPYmplY3Q6IG9iamVjdAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uSGlkZVJlbGF0aW9uc2hpcHMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1Nob3dpbmdSZWxhdGlvbnNoaXBzOiBmYWxzZSwKICAgICAgICByZWxhdGlvbnNoaXBPYmplY3Q6IHVuZGVmaW5lZAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRXhwb3J0IiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWY4ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoaW5jbHVkZVJlZmVyZW5jZXNEZWVwKSB7CiAgICAgICAgdmFyIGludGwsIHNlbGVjdGVkU2F2ZWRPYmplY3RzLCBvYmplY3RzVG9FeHBvcnQsIGJsb2I7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGludGwgPSBfdGhpcy5wcm9wcy5pbnRsOwogICAgICAgICAgICAgICAgc2VsZWN0ZWRTYXZlZE9iamVjdHMgPSBfdGhpcy5zdGF0ZS5zZWxlY3RlZFNhdmVkT2JqZWN0czsKICAgICAgICAgICAgICAgIG9iamVjdHNUb0V4cG9ydCA9IHNlbGVjdGVkU2F2ZWRPYmplY3RzLm1hcChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaWQ6IG9iai5pZCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiBvYmoudHlwZQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDM7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZmV0Y2hFeHBvcnRPYmplY3RzKShvYmplY3RzVG9FeHBvcnQsIGluY2x1ZGVSZWZlcmVuY2VzRGVlcCk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGJsb2IgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSA5OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1WyJjYXRjaCJdKDMpOwoKICAgICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0LmRhbmdlck5vdGlmaWNhdGlvbicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gZ2VuZXJhdGUgZXhwb3J0JwogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQ1LnQwOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgKDAsIF9maWxlc2F2ZXIuc2F2ZUFzKShibG9iLCAnZXhwb3J0Lm5kanNvbicpOwoKICAgICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoewogICAgICAgICAgICAgICAgICB0aXRsZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmV4cG9ydC5zdWNjZXNzTm90aWZpY2F0aW9uJywKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1lvdXIgZmlsZSBpcyBkb3dubG9hZGluZyBpbiB0aGUgYmFja2dyb3VuZCcKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1LCBudWxsLCBbWzMsIDldXSk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gyKSB7CiAgICAgICAgcmV0dXJuIF9yZWY4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRXhwb3J0QWxsIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgIHZhciBpbnRsLCBfdGhpcyRzdGF0ZTIsIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucywgaXNJbmNsdWRlUmVmZXJlbmNlc0RlZXBDaGVja2VkLCBleHBvcnRUeXBlcywgYmxvYjsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgICAgICAgICAgX3RoaXMkc3RhdGUyID0gX3RoaXMuc3RhdGUsIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucyA9IF90aGlzJHN0YXRlMi5leHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMsIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZCA9IF90aGlzJHN0YXRlMi5pc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQ7CiAgICAgICAgICAgICAgZXhwb3J0VHlwZXMgPSBPYmplY3QuZW50cmllcyhleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMpLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIF9yZWYxMCkgewogICAgICAgICAgICAgICAgdmFyIF9yZWYxMSA9IF9zbGljZWRUb0FycmF5KF9yZWYxMCwgMiksCiAgICAgICAgICAgICAgICAgICAgaWQgPSBfcmVmMTFbMF0sCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSBfcmVmMTFbMV07CgogICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgIGFjY3VtLnB1c2goaWQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBhY2N1bTsKICAgICAgICAgICAgICB9LCBbXSk7CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAzOwogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZmV0Y2hFeHBvcnRCeVR5cGUpKGV4cG9ydFR5cGVzLCBpc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGJsb2IgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDYudDAgPSBfY29udGV4dDZbImNhdGNoIl0oMyk7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICB0aXRsZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgaWQ6ICdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5leHBvcnRBbGwuZGFuZ2VyTm90aWZpY2F0aW9uJywKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gZ2VuZXJhdGUgZXhwb3J0JwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQ2LnQwOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAoMCwgX2ZpbGVzYXZlci5zYXZlQXMpKGJsb2IsICdleHBvcnQubmRqc29uJyk7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFN1Y2Nlc3MoewogICAgICAgICAgICAgICAgdGl0bGU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0QWxsLnN1Y2Nlc3NOb3RpZmljYXRpb24nLAogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1lvdXIgZmlsZSBpcyBkb3dubG9hZGluZyBpbiB0aGUgYmFja2dyb3VuZCcKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbDogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNiwgbnVsbCwgW1szLCA5XV0pOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJmaW5pc2hJbXBvcnQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLmhpZGVJbXBvcnRGbHlvdXQoKTsKCiAgICAgIF90aGlzLmZldGNoU2F2ZWRPYmplY3RzKCk7CgogICAgICBfdGhpcy5mZXRjaENvdW50cygpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2hvd0ltcG9ydEZseW91dCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzU2hvd2luZ0ltcG9ydEZseW91dDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhpZGVJbXBvcnRGbHlvdXQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1Nob3dpbmdJbXBvcnRGbHlvdXQ6IGZhbHNlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25EZWxldGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWw6IHRydWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkZWxldGUiLAogICAgLyojX19QVVJFX18qLwogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgdmFyIHNhdmVkT2JqZWN0c0NsaWVudCwgX3RoaXMkc3RhdGUzLCBzZWxlY3RlZFNhdmVkT2JqZWN0cywgaXNEZWxldGluZywgaW5kZXhQYXR0ZXJucywgb2JqZWN0cywgZGVsZXRlczsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc2F2ZWRPYmplY3RzQ2xpZW50ID0gX3RoaXMucHJvcHMuc2F2ZWRPYmplY3RzQ2xpZW50OwogICAgICAgICAgICAgIF90aGlzJHN0YXRlMyA9IF90aGlzLnN0YXRlLCBzZWxlY3RlZFNhdmVkT2JqZWN0cyA9IF90aGlzJHN0YXRlMy5zZWxlY3RlZFNhdmVkT2JqZWN0cywgaXNEZWxldGluZyA9IF90aGlzJHN0YXRlMy5pc0RlbGV0aW5nOwoKICAgICAgICAgICAgICBpZiAoIWlzRGVsZXRpbmcpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzRGVsZXRpbmc6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJucyA9IHNlbGVjdGVkU2F2ZWRPYmplY3RzLmZpbHRlcihmdW5jdGlvbiAob2JqZWN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gb2JqZWN0LnR5cGUgPT09ICdpbmRleC1wYXR0ZXJuJzsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaWYgKCFpbmRleFBhdHRlcm5zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDk7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByb3BzLmluZGV4UGF0dGVybnMuY2xlYXJDYWNoZSgpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgcmV0dXJuIHNhdmVkT2JqZWN0c0NsaWVudC5idWxrR2V0KHNlbGVjdGVkU2F2ZWRPYmplY3RzKTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgb2JqZWN0cyA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgIGRlbGV0ZXMgPSBvYmplY3RzLnNhdmVkT2JqZWN0cy5tYXAoZnVuY3Rpb24gKG9iamVjdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNhdmVkT2JqZWN0c0NsaWVudC5kZWxldGUob2JqZWN0LnR5cGUsIG9iamVjdC5pZCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNTsKICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoZGVsZXRlcyk7CgogICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIC8vIFVuc2V0IHRoaXMKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogW10KICAgICAgICAgICAgICB9KTsgLy8gRmV0Y2hpbmcgYWxsIGRhdGEKCgogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZldGNoU2F2ZWRPYmplY3RzKCk7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZldGNoQ291bnRzKCk7CgogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIC8vIEFsbG93IHRoZSB1c2VyIHRvIGludGVyYWN0IHdpdGggdGhlIHRhYmxlIG9uY2UgdGhlIHNhdmVkIG9iamVjdHMgaGF2ZSBiZWVuIHJlLWZldGNoZWQuCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsOiBmYWxzZSwKICAgICAgICAgICAgICAgIGlzRGVsZXRpbmc6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTcpOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRSZWxhdGlvbnNoaXBzIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWYxMyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KHR5cGUsIGlkKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2xpYi5nZXRSZWxhdGlvbnNoaXBzKSh0eXBlLCBpZCwgX3RoaXMuc2F2ZWRPYmplY3RUeXBlcywgX3RoaXMucHJvcHMuJGh0dHAsIF90aGlzLnByb3BzLmJhc2VQYXRoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0OC5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDMsIF94NCkgewogICAgICAgIHJldHVybiBfcmVmMTMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2hhbmdlSW5jbHVkZVJlZmVyZW5jZXNEZWVwIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaXNJbmNsdWRlUmVmZXJlbmNlc0RlZXBDaGVja2VkOiAhc3RhdGUuaXNJbmNsdWRlUmVmZXJlbmNlc0RlZXBDaGVja2VkCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZUV4cG9ydEFsbE1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF90aGlzLnNhdmVkT2JqZWN0VHlwZXMgPSBQT1NTSUJMRV9UWVBFUzsKICAgIF90aGlzLnN0YXRlID0gewogICAgICB0b3RhbENvdW50OiAwLAogICAgICBwYWdlOiAwLAogICAgICBwZXJQYWdlOiBwcm9wcy5wZXJQYWdlQ29uZmlnIHx8IDUwLAogICAgICBzYXZlZE9iamVjdHM6IFtdLAogICAgICBzYXZlZE9iamVjdENvdW50czogX3RoaXMuc2F2ZWRPYmplY3RUeXBlcy5yZWR1Y2UoZnVuY3Rpb24gKHR5cGVUb0NvdW50TWFwLCB0eXBlKSB7CiAgICAgICAgdHlwZVRvQ291bnRNYXBbdHlwZV0gPSAwOwogICAgICAgIHJldHVybiB0eXBlVG9Db3VudE1hcDsKICAgICAgfSwge30pLAogICAgICBhY3RpdmVRdWVyeTogX2V1aS5RdWVyeS5wYXJzZSgnJyksCiAgICAgIHNlbGVjdGVkU2F2ZWRPYmplY3RzOiBbXSwKICAgICAgaXNTaG93aW5nSW1wb3J0Rmx5b3V0OiBmYWxzZSwKICAgICAgaXNTZWFyY2hpbmc6IGZhbHNlLAogICAgICBmaWx0ZXJlZEl0ZW1Db3VudDogMCwKICAgICAgaXNTaG93aW5nUmVsYXRpb25zaGlwczogZmFsc2UsCiAgICAgIHJlbGF0aW9uc2hpcE9iamVjdDogdW5kZWZpbmVkLAogICAgICBpc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWw6IGZhbHNlLAogICAgICBpc1Nob3dpbmdFeHBvcnRBbGxPcHRpb25zTW9kYWw6IGZhbHNlLAogICAgICBpc0RlbGV0aW5nOiBmYWxzZSwKICAgICAgZXhwb3J0QWxsT3B0aW9uczogW10sCiAgICAgIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9uczoge30sCiAgICAgIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZDogdHJ1ZQogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhPYmplY3RzVGFibGVVSSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTsKICAgICAgdGhpcy5mZXRjaFNhdmVkT2JqZWN0cygpOwogICAgICB0aGlzLmZldGNoQ291bnRzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsKICAgICAgdGhpcy5kZWJvdW5jZWRGZXRjaC5jYW5jZWwoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJGbHlvdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckZseW91dCgpIHsKICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzU2hvd2luZ0ltcG9ydEZseW91dCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZmx5b3V0LkZseW91dCwgewogICAgICAgIGNsb3NlOiB0aGlzLmhpZGVJbXBvcnRGbHlvdXQsCiAgICAgICAgZG9uZTogdGhpcy5maW5pc2hJbXBvcnQsCiAgICAgICAgc2VydmljZXM6IHRoaXMucHJvcHMuc2VydmljZXMsCiAgICAgICAgaW5kZXhQYXR0ZXJuczogdGhpcy5wcm9wcy5pbmRleFBhdHRlcm5zLAogICAgICAgIG5ld0luZGV4UGF0dGVyblVybDogdGhpcy5wcm9wcy5uZXdJbmRleFBhdHRlcm5VcmwsCiAgICAgICAgc2F2ZWRPYmplY3RUeXBlczogdGhpcy5wcm9wcy5zYXZlZE9iamVjdFR5cGVzLAogICAgICAgIGNvbmZpcm1Nb2RhbFByb21pc2U6IHRoaXMucHJvcHMuY29uZmlybU1vZGFsUHJvbWlzZQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJSZWxhdGlvbnNoaXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJSZWxhdGlvbnNoaXBzKCkgewogICAgICBpZiAoIXRoaXMuc3RhdGUuaXNTaG93aW5nUmVsYXRpb25zaGlwcykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVsYXRpb25zaGlwcy5SZWxhdGlvbnNoaXBzLCB7CiAgICAgICAgc2F2ZWRPYmplY3Q6IHRoaXMuc3RhdGUucmVsYXRpb25zaGlwT2JqZWN0LAogICAgICAgIGdldFJlbGF0aW9uc2hpcHM6IHRoaXMuZ2V0UmVsYXRpb25zaGlwcywKICAgICAgICBjbG9zZTogdGhpcy5vbkhpZGVSZWxhdGlvbnNoaXBzLAogICAgICAgIGdldERhc2hib2FyZFVybDogdGhpcy5wcm9wcy5nZXREYXNoYm9hcmRVcmwsCiAgICAgICAgZ29JbnNwZWN0T2JqZWN0OiB0aGlzLnByb3BzLmdvSW5zcGVjdE9iamVjdCwKICAgICAgICBjYW5Hb0luQXBwOiB0aGlzLnByb3BzLmNhbkdvSW5BcHAKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRGVsZXRlQ29uZmlybU1vZGFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJEZWxldGVDb25maXJtTW9kYWwoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHN0YXRlNCA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBpc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWwgPSBfdGhpcyRzdGF0ZTQuaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsLAogICAgICAgICAgaXNEZWxldGluZyA9IF90aGlzJHN0YXRlNC5pc0RlbGV0aW5nLAogICAgICAgICAgc2VsZWN0ZWRTYXZlZE9iamVjdHMgPSBfdGhpcyRzdGF0ZTQuc2VsZWN0ZWRTYXZlZE9iamVjdHM7CiAgICAgIHZhciBpbnRsID0gdGhpcy5wcm9wcy5pbnRsOwoKICAgICAgaWYgKCFpc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWwpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIG1vZGFsOwoKICAgICAgaWYgKGlzRGVsZXRpbmcpIHsKICAgICAgICAvLyBCbG9jayB0aGUgdXNlciBmcm9tIGludGVyYWN0aW5nIHdpdGggdGhlIHRhYmxlIHdoaWxlIGl0cyBjb250ZW50cyBhcmUgYmVpbmcgZGVsZXRlZC4KICAgICAgICBtb2RhbCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMb2FkaW5nS2liYW5hLCB7CiAgICAgICAgICBzaXplOiAieGwiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIG9uQ2FuY2VsID0gZnVuY3Rpb24gb25DYW5jZWwoKSB7CiAgICAgICAgICBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBpc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWw6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgb25Db25maXJtID0gZnVuY3Rpb24gb25Db25maXJtKCkgewogICAgICAgICAgX3RoaXMyLmRlbGV0ZSgpOwogICAgICAgIH07CgogICAgICAgIG1vZGFsID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbmZpcm1Nb2RhbCwgewogICAgICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsVGl0bGUiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZSBzYXZlZCBvYmplY3RzIgogICAgICAgICAgfSksCiAgICAgICAgICBvbkNhbmNlbDogb25DYW5jZWwsCiAgICAgICAgICBvbkNvbmZpcm06IG9uQ29uZmlybSwKICAgICAgICAgIGJ1dHRvbkNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsLmNhbmNlbEJ1dHRvbkxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDYW5jZWwiCiAgICAgICAgICB9KSwKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBpc0RlbGV0aW5nID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwuZGVsZXRlUHJvY2Vzc0J1dHRvbkxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGluZ1x1MjAyNiIKICAgICAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwuZGVsZXRlQnV0dG9uTGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRlbGV0ZSIKICAgICAgICAgIH0pLAogICAgICAgICAgZGVmYXVsdEZvY3VzZWRCdXR0b246IF9ldWkuRVVJX01PREFMX0NPTkZJUk1fQlVUVE9OCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsRGVzY3JpcHRpb24iLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGlzIGFjdGlvbiB3aWxsIGRlbGV0ZSB0aGUgZm9sbG93aW5nIHNhdmVkIG9iamVjdHM6IgogICAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUluTWVtb3J5VGFibGUsIHsKICAgICAgICAgIGl0ZW1zOiBzZWxlY3RlZFNhdmVkT2JqZWN0cywKICAgICAgICAgIGNvbHVtbnM6IFt7CiAgICAgICAgICAgIGZpZWxkOiAndHlwZScsCiAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6ICdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwudHlwZUNvbHVtbk5hbWUnLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVHlwZScKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHdpZHRoOiAnNTBweCcsCiAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHR5cGUsIG9iamVjdCkgewogICAgICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AiLAogICAgICAgICAgICAgICAgY29udGVudDogKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RMYWJlbCkodHlwZSkKICAgICAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgICAgICAgdHlwZTogb2JqZWN0Lm1ldGEuaWNvbiB8fCAnYXBwcycKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHsKICAgICAgICAgICAgZmllbGQ6ICdpZCcsCiAgICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6ICdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwuaWRDb2x1bW5OYW1lJywKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0lkJwogICAgICAgICAgICB9KQogICAgICAgICAgfSwgewogICAgICAgICAgICBmaWVsZDogJ21ldGEudGl0bGUnLAogICAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsLnRpdGxlQ29sdW1uTmFtZScsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaXRsZScKICAgICAgICAgICAgfSkKICAgICAgICAgIH1dLAogICAgICAgICAgcGFnaW5hdGlvbjogdHJ1ZSwKICAgICAgICAgIHNvcnRpbmc6IGZhbHNlCiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBtb2RhbCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRXhwb3J0QWxsT3B0aW9uc01vZGFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJFeHBvcnRBbGxPcHRpb25zTW9kYWwoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHN0YXRlNSA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBpc1Nob3dpbmdFeHBvcnRBbGxPcHRpb25zTW9kYWwgPSBfdGhpcyRzdGF0ZTUuaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsLAogICAgICAgICAgZmlsdGVyZWRJdGVtQ291bnQgPSBfdGhpcyRzdGF0ZTUuZmlsdGVyZWRJdGVtQ291bnQsCiAgICAgICAgICBleHBvcnRBbGxPcHRpb25zID0gX3RoaXMkc3RhdGU1LmV4cG9ydEFsbE9wdGlvbnMsCiAgICAgICAgICBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMgPSBfdGhpcyRzdGF0ZTUuZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zLAogICAgICAgICAgaXNJbmNsdWRlUmVmZXJlbmNlc0RlZXBDaGVja2VkID0gX3RoaXMkc3RhdGU1LmlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZDsKCiAgICAgIGlmICghaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpT3ZlcmxheU1hc2ssIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlNb2RhbCwgewogICAgICAgIG9uQ2xvc2U6IHRoaXMuY2xvc2VFeHBvcnRBbGxNb2RhbAogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlNb2RhbEhlYWRlclRpdGxlLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0T2JqZWN0c0NvbmZpcm1Nb2RhbFRpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkV4cG9ydCB7ZmlsdGVyZWRJdGVtQ291bnQsIHBsdXJhbCwgb25leyMgb2JqZWN0fSBvdGhlciB7IyBvYmplY3RzfX0iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgZmlsdGVyZWRJdGVtQ291bnQ6IGZpbHRlcmVkSXRlbUNvdW50CiAgICAgICAgfQogICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxCb2R5LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5leHBvcnRPYmplY3RzQ29uZmlybU1vZGFsRGVzY3JpcHRpb24iLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTZWxlY3Qgd2hpY2ggdHlwZXMgdG8gZXhwb3J0IgogICAgICAgIH0pLAogICAgICAgIGxhYmVsVHlwZTogImxlZ2VuZCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNoZWNrYm94R3JvdXAsIHsKICAgICAgICBvcHRpb25zOiBleHBvcnRBbGxPcHRpb25zLAogICAgICAgIGlkVG9TZWxlY3RlZE1hcDogZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShvcHRpb25JZCkgewogICAgICAgICAgdmFyIG5ld0V4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucyA9IF9vYmplY3RTcHJlYWQoe30sIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucywge30sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgb3B0aW9uSWQsICFleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnNbb3B0aW9uSWRdKSk7CgogICAgICAgICAgX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zOiBuZXdFeHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3dpdGNoLCB7CiAgICAgICAgbmFtZTogImluY2x1ZGVSZWZlcmVuY2VzRGVlcCIsCiAgICAgICAgbGFiZWw6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmV4cG9ydE9iamVjdHNDb25maXJtTW9kYWwuaW5jbHVkZVJlZmVyZW5jZXNEZWVwTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJJbmNsdWRlIHJlbGF0ZWQgb2JqZWN0cyIKICAgICAgICB9KSwKICAgICAgICBjaGVja2VkOiBpc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMuY2hhbmdlSW5jbHVkZVJlZmVyZW5jZXNEZWVwCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsRm9vdGVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAganVzdGlmeUNvbnRlbnQ6ICJmbGV4RW5kIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uRW1wdHksIHsKICAgICAgICBvbkNsaWNrOiB0aGlzLmNsb3NlRXhwb3J0QWxsTW9kYWwKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmV4cG9ydE9iamVjdHNDb25maXJtTW9kYWwuY2FuY2VsQnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ2FuY2VsIgogICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgZmlsbDogdHJ1ZSwKICAgICAgICBvbkNsaWNrOiB0aGlzLm9uRXhwb3J0QWxsCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5leHBvcnRPYmplY3RzQ29uZmlybU1vZGFsLmV4cG9ydEFsbEJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkV4cG9ydCBhbGwiCiAgICAgIH0pKSkpKSkpKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHN0YXRlNiA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0cyA9IF90aGlzJHN0YXRlNi5zZWxlY3RlZFNhdmVkT2JqZWN0cywKICAgICAgICAgIHBhZ2UgPSBfdGhpcyRzdGF0ZTYucGFnZSwKICAgICAgICAgIHBlclBhZ2UgPSBfdGhpcyRzdGF0ZTYucGVyUGFnZSwKICAgICAgICAgIHNhdmVkT2JqZWN0cyA9IF90aGlzJHN0YXRlNi5zYXZlZE9iamVjdHMsCiAgICAgICAgICBmaWx0ZXJlZEl0ZW1Db3VudCA9IF90aGlzJHN0YXRlNi5maWx0ZXJlZEl0ZW1Db3VudCwKICAgICAgICAgIGlzU2VhcmNoaW5nID0gX3RoaXMkc3RhdGU2LmlzU2VhcmNoaW5nLAogICAgICAgICAgc2F2ZWRPYmplY3RDb3VudHMgPSBfdGhpcyRzdGF0ZTYuc2F2ZWRPYmplY3RDb3VudHM7CiAgICAgIHZhciBzZWxlY3Rpb25Db25maWcgPSB7CiAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2U6IHRoaXMub25TZWxlY3Rpb25DaGFuZ2VkCiAgICAgIH07CiAgICAgIHZhciBmaWx0ZXJPcHRpb25zID0gdGhpcy5zYXZlZE9iamVjdFR5cGVzLm1hcChmdW5jdGlvbiAodHlwZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2YWx1ZTogdHlwZSwKICAgICAgICAgIG5hbWU6IHR5cGUsCiAgICAgICAgICB2aWV3OiAiIi5jb25jYXQodHlwZSwgIiAoIikuY29uY2F0KHNhdmVkT2JqZWN0Q291bnRzW3R5cGVdIHx8IDAsICIpIikKICAgICAgICB9OwogICAgICB9KTsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgewogICAgICAgIGhvcml6b250YWxQb3NpdGlvbjogImNlbnRlciIKICAgICAgfSwgdGhpcy5yZW5kZXJGbHlvdXQoKSwgdGhpcy5yZW5kZXJSZWxhdGlvbnNoaXBzKCksIHRoaXMucmVuZGVyRGVsZXRlQ29uZmlybU1vZGFsKCksIHRoaXMucmVuZGVyRXhwb3J0QWxsT3B0aW9uc01vZGFsKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2hlYWRlci5IZWFkZXIsIHsKICAgICAgICBvbkV4cG9ydEFsbDogZnVuY3Rpb24gb25FeHBvcnRBbGwoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM0LnNldFN0YXRlKHsKICAgICAgICAgICAgaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIG9uSW1wb3J0OiB0aGlzLnNob3dJbXBvcnRGbHlvdXQsCiAgICAgICAgb25SZWZyZXNoOiB0aGlzLnJlZnJlc2hEYXRhLAogICAgICAgIGZpbHRlcmVkQ291bnQ6IGZpbHRlcmVkSXRlbUNvdW50CiAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogInhzIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdGFibGUuVGFibGUsIHsKICAgICAgICBpdGVtSWQ6ICdpZCcsCiAgICAgICAgc2VsZWN0aW9uQ29uZmlnOiBzZWxlY3Rpb25Db25maWcsCiAgICAgICAgc2VsZWN0ZWRTYXZlZE9iamVjdHM6IHNlbGVjdGVkU2F2ZWRPYmplY3RzLAogICAgICAgIG9uUXVlcnlDaGFuZ2U6IHRoaXMub25RdWVyeUNoYW5nZSwKICAgICAgICBvblRhYmxlQ2hhbmdlOiB0aGlzLm9uVGFibGVDaGFuZ2UsCiAgICAgICAgZmlsdGVyT3B0aW9uczogZmlsdGVyT3B0aW9ucywKICAgICAgICBvbkV4cG9ydDogdGhpcy5vbkV4cG9ydCwKICAgICAgICBjYW5EZWxldGU6IHRoaXMucHJvcHMudWlDYXBhYmlsaXRpZXMuc2F2ZWRPYmplY3RzTWFuYWdlbWVudC5kZWxldGUsCiAgICAgICAgb25EZWxldGU6IHRoaXMub25EZWxldGUsCiAgICAgICAgZ29JbnNwZWN0T2JqZWN0OiB0aGlzLnByb3BzLmdvSW5zcGVjdE9iamVjdCwKICAgICAgICBwYWdlSW5kZXg6IHBhZ2UsCiAgICAgICAgcGFnZVNpemU6IHBlclBhZ2UsCiAgICAgICAgaXRlbXM6IHNhdmVkT2JqZWN0cywKICAgICAgICB0b3RhbEl0ZW1Db3VudDogZmlsdGVyZWRJdGVtQ291bnQsCiAgICAgICAgaXNTZWFyY2hpbmc6IGlzU2VhcmNoaW5nLAogICAgICAgIG9uU2hvd1JlbGF0aW9uc2hpcHM6IHRoaXMub25TaG93UmVsYXRpb25zaGlwcywKICAgICAgICBjYW5Hb0luQXBwOiB0aGlzLnByb3BzLmNhbkdvSW5BcHAKICAgICAgfSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE9iamVjdHNUYWJsZVVJOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKX2RlZmluZVByb3BlcnR5KE9iamVjdHNUYWJsZVVJLCAicHJvcFR5cGVzIiwgewogIHNhdmVkT2JqZWN0c0NsaWVudDogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdC5pc1JlcXVpcmVkLAogIGluZGV4UGF0dGVybnM6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QuaXNSZXF1aXJlZCwKICAkaHR0cDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBiYXNlUGF0aDogX3Byb3BUeXBlcy5kZWZhdWx0LnN0cmluZy5pc1JlcXVpcmVkLAogIHBlclBhZ2VDb25maWc6IF9wcm9wVHlwZXMuZGVmYXVsdC5udW1iZXIsCiAgbmV3SW5kZXhQYXR0ZXJuVXJsOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLmlzUmVxdWlyZWQsCiAgY29uZmlybU1vZGFsUHJvbWlzZTogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBzZXJ2aWNlczogX3Byb3BUeXBlcy5kZWZhdWx0LmFycmF5LmlzUmVxdWlyZWQsCiAgdWlDYXBhYmlsaXRpZXM6IF9wcm9wVHlwZXMuZGVmYXVsdC5vYmplY3QuaXNSZXF1aXJlZCwKICBnb0luc3BlY3RPYmplY3Q6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgY2FuR29JbkFwcDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZAp9KTsKCnZhciBPYmplY3RzVGFibGUgPSAoMCwgX3JlYWN0Mi5pbmplY3RJMThuKShPYmplY3RzVGFibGVVSSk7CmV4cG9ydHMuT2JqZWN0c1RhYmxlID0gT2JqZWN0c1RhYmxlOw=="},null]}