{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/components/relationships/relationships.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/components/relationships/relationships.js","mtime":1572296410676},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlJlbGF0aW9uc2hpcHMgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfbGliID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vbGliIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgUmVsYXRpb25zaGlwc1VJID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhSZWxhdGlvbnNoaXBzVUksIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBSZWxhdGlvbnNoaXBzVUkocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVsYXRpb25zaGlwc1VJKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihSZWxhdGlvbnNoaXBzVUkpLmNhbGwodGhpcywgcHJvcHMpKTsKICAgIF90aGlzLnN0YXRlID0gewogICAgICByZWxhdGlvbnNoaXBzOiB1bmRlZmluZWQsCiAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgIGVycm9yOiB1bmRlZmluZWQKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUmVsYXRpb25zaGlwc1VJLCBbewogICAga2V5OiAiY29tcG9uZW50V2lsbE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7CiAgICAgIHRoaXMuZ2V0UmVsYXRpb25zaGlwRGF0YSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7CiAgICAgIGlmIChuZXh0UHJvcHMuc2F2ZWRPYmplY3QuaWQgIT09IHRoaXMucHJvcHMuc2F2ZWRPYmplY3QuaWQpIHsKICAgICAgICB0aGlzLmdldFJlbGF0aW9uc2hpcERhdGEoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldFJlbGF0aW9uc2hpcERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRSZWxhdGlvbnNoaXBEYXRhID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3RoaXMkcHJvcHMsIHNhdmVkT2JqZWN0LCBnZXRSZWxhdGlvbnNoaXBzLCByZWxhdGlvbnNoaXBzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsIHNhdmVkT2JqZWN0ID0gX3RoaXMkcHJvcHMuc2F2ZWRPYmplY3QsIGdldFJlbGF0aW9uc2hpcHMgPSBfdGhpcyRwcm9wcy5nZXRSZWxhdGlvbnNoaXBzOwogICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFJlbGF0aW9uc2hpcHMoc2F2ZWRPYmplY3QudHlwZSwgc2F2ZWRPYmplY3QuaWQpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICByZWxhdGlvbnNoaXBzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICByZWxhdGlvbnNoaXBzOiByZWxhdGlvbnNoaXBzLAogICAgICAgICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICAgICAgICAgICAgICBlcnJvcjogdW5kZWZpbmVkCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgZXJyb3I6IF9jb250ZXh0LnQwLm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcywgW1syLCA5XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRSZWxhdGlvbnNoaXBEYXRhKCkgewogICAgICAgIHJldHVybiBfZ2V0UmVsYXRpb25zaGlwRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0UmVsYXRpb25zaGlwRGF0YTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInJlbmRlckVycm9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJFcnJvcigpIHsKICAgICAgdmFyIGVycm9yID0gdGhpcy5zdGF0ZS5lcnJvcjsKCiAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMucmVuZGVyRXJyb3JNZXNzYWdlIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRXJyb3IiCiAgICAgICAgfSksCiAgICAgICAgY29sb3I6ICJkYW5nZXIiCiAgICAgIH0sIGVycm9yKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJSZWxhdGlvbnNoaXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJSZWxhdGlvbnNoaXBzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSB0aGlzLnByb3BzLAogICAgICAgICAgaW50bCA9IF90aGlzJHByb3BzMi5pbnRsLAogICAgICAgICAgZ29JbnNwZWN0T2JqZWN0ID0gX3RoaXMkcHJvcHMyLmdvSW5zcGVjdE9iamVjdCwKICAgICAgICAgIHNhdmVkT2JqZWN0ID0gX3RoaXMkcHJvcHMyLnNhdmVkT2JqZWN0OwogICAgICB2YXIgX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgcmVsYXRpb25zaGlwcyA9IF90aGlzJHN0YXRlLnJlbGF0aW9uc2hpcHMsCiAgICAgICAgICBpc0xvYWRpbmcgPSBfdGhpcyRzdGF0ZS5pc0xvYWRpbmcsCiAgICAgICAgICBlcnJvciA9IF90aGlzJHN0YXRlLmVycm9yOwoKICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyRXJyb3IoKTsKICAgICAgfQoKICAgICAgaWYgKGlzTG9hZGluZykgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ0tpYmFuYSwgewogICAgICAgICAgc2l6ZTogInhsIgogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgY29sdW1ucyA9IFt7CiAgICAgICAgZmllbGQ6ICd0eXBlJywKICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgaWQ6ICdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5yZWxhdGlvbnNoaXBzLmNvbHVtblR5cGVOYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVHlwZScKICAgICAgICB9KSwKICAgICAgICB3aWR0aDogJzUwcHgnLAogICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICBkZXNjcmlwdGlvbjogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUucmVsYXRpb25zaGlwcy5jb2x1bW5UeXBlRGVzY3JpcHRpb24nLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUeXBlIG9mIHRoZSBzYXZlZCBvYmplY3QnCiAgICAgICAgfSksCiAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHR5cGUsIG9iamVjdCkgewogICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUb29sVGlwLCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wIiwKICAgICAgICAgICAgY29udGVudDogKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RMYWJlbCkodHlwZSkKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICAgICJhcmlhLWxhYmVsIjogKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RMYWJlbCkodHlwZSksCiAgICAgICAgICAgIHR5cGU6IG9iamVjdC5tZXRhLmljb24gfHwgJ2FwcHMnLAogICAgICAgICAgICBzaXplOiAicyIKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ3JlbGF0aW9uc2hpcCcsCiAgICAgICAgbmFtZTogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUucmVsYXRpb25zaGlwcy5jb2x1bW5SZWxhdGlvbnNoaXBOYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGlyZWN0IHJlbGF0aW9uc2hpcCcKICAgICAgICB9KSwKICAgICAgICBkYXRhVHlwZTogJ3N0cmluZycsCiAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgIHdpZHRoOiAnMTI1cHgnLAogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHJlbGF0aW9uc2hpcCkgewogICAgICAgICAgaWYgKHJlbGF0aW9uc2hpcCA9PT0gJ3BhcmVudCcpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgICAgICAgc2l6ZTogInMiCiAgICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5yZWxhdGlvbnNoaXBzLmNvbHVtblJlbGF0aW9uc2hpcC5wYXJlbnRBc1ZhbHVlIiwKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlBhcmVudCIKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChyZWxhdGlvbnNoaXAgPT09ICdjaGlsZCcpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgICAgICAgc2l6ZTogInMiCiAgICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5yZWxhdGlvbnNoaXBzLmNvbHVtblJlbGF0aW9uc2hpcC5jaGlsZEFzVmFsdWUiLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ2hpbGQiCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ21ldGEudGl0bGUnLAogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuY29sdW1uVGl0bGVOYW1lJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGl0bGUnCiAgICAgICAgfSksCiAgICAgICAgZGVzY3JpcHRpb246IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuY29sdW1uVGl0bGVEZXNjcmlwdGlvbicsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1RpdGxlIG9mIHRoZSBzYXZlZCBvYmplY3QnCiAgICAgICAgfSksCiAgICAgICAgZGF0YVR5cGU6ICdzdHJpbmcnLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih0aXRsZSwgb2JqZWN0KSB7CiAgICAgICAgICB2YXIgX3JlZiA9IG9iamVjdC5tZXRhLmluQXBwVXJsIHx8IHt9LAogICAgICAgICAgICAgIHBhdGggPSBfcmVmLnBhdGg7CgogICAgICAgICAgdmFyIGNhbkdvSW5BcHAgPSBfdGhpczIucHJvcHMuY2FuR29JbkFwcChvYmplY3QpOwoKICAgICAgICAgIGlmICghY2FuR29JbkFwcCkgewogICAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIHsKICAgICAgICAgICAgICBzaXplOiAicyIKICAgICAgICAgICAgfSwgdGl0bGUgfHwgKDAsIF9saWIuZ2V0RGVmYXVsdFRpdGxlKShvYmplY3QpKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgaHJlZjogX2Nocm9tZS5kZWZhdWx0LmFkZEJhc2VQYXRoKHBhdGgpCiAgICAgICAgICB9LCB0aXRsZSB8fCAoMCwgX2xpYi5nZXREZWZhdWx0VGl0bGUpKG9iamVjdCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuY29sdW1uQWN0aW9uc05hbWUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdBY3Rpb25zJwogICAgICAgIH0pLAogICAgICAgIGFjdGlvbnM6IFt7CiAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuY29sdW1uQWN0aW9ucy5pbnNwZWN0QWN0aW9uTmFtZScsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5zcGVjdCcKICAgICAgICAgIH0pLAogICAgICAgICAgZGVzY3JpcHRpb246IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUucmVsYXRpb25zaGlwcy5jb2x1bW5BY3Rpb25zLmluc3BlY3RBY3Rpb25EZXNjcmlwdGlvbicsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5zcGVjdCB0aGlzIHNhdmVkIG9iamVjdCcKICAgICAgICAgIH0pLAogICAgICAgICAgdHlwZTogJ2ljb24nLAogICAgICAgICAgaWNvbjogJ2luc3BlY3QnLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhvYmplY3QpIHsKICAgICAgICAgICAgcmV0dXJuIGdvSW5zcGVjdE9iamVjdChvYmplY3QpOwogICAgICAgICAgfSwKICAgICAgICAgIGF2YWlsYWJsZTogZnVuY3Rpb24gYXZhaWxhYmxlKG9iamVjdCkgewogICAgICAgICAgICByZXR1cm4gISFvYmplY3QubWV0YS5lZGl0VXJsOwogICAgICAgICAgfQogICAgICAgIH1dCiAgICAgIH1dOwogICAgICB2YXIgZmlsdGVyVHlwZXNNYXAgPSBuZXcgTWFwKHJlbGF0aW9uc2hpcHMubWFwKGZ1bmN0aW9uIChyZWxhdGlvbnNoaXApIHsKICAgICAgICByZXR1cm4gW3JlbGF0aW9uc2hpcC50eXBlLCB7CiAgICAgICAgICB2YWx1ZTogcmVsYXRpb25zaGlwLnR5cGUsCiAgICAgICAgICBuYW1lOiByZWxhdGlvbnNoaXAudHlwZSwKICAgICAgICAgIHZpZXc6IHJlbGF0aW9uc2hpcC50eXBlCiAgICAgICAgfV07CiAgICAgIH0pKTsKICAgICAgdmFyIHNlYXJjaCA9IHsKICAgICAgICBmaWx0ZXJzOiBbewogICAgICAgICAgdHlwZTogJ2ZpZWxkX3ZhbHVlX3NlbGVjdGlvbicsCiAgICAgICAgICBmaWVsZDogJ3JlbGF0aW9uc2hpcCcsCiAgICAgICAgICBuYW1lOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuc2VhcmNoLmZpbHRlcnMucmVsYXRpb25zaGlwLm5hbWUnLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0RpcmVjdCByZWxhdGlvbnNoaXAnCiAgICAgICAgICB9KSwKICAgICAgICAgIG11bHRpU2VsZWN0OiAnb3InLAogICAgICAgICAgb3B0aW9uczogW3sKICAgICAgICAgICAgdmFsdWU6ICdwYXJlbnQnLAogICAgICAgICAgICBuYW1lOiAncGFyZW50JywKICAgICAgICAgICAgdmlldzogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLnJlbGF0aW9uc2hpcHMuc2VhcmNoLmZpbHRlcnMucmVsYXRpb25zaGlwLnBhcmVudEFzVmFsdWUudmlldycsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQYXJlbnQnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHZhbHVlOiAnY2hpbGQnLAogICAgICAgICAgICBuYW1lOiAnY2hpbGQnLAogICAgICAgICAgICB2aWV3OiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUucmVsYXRpb25zaGlwcy5zZWFyY2guZmlsdGVycy5yZWxhdGlvbnNoaXAuY2hpbGRBc1ZhbHVlLnZpZXcnLAogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2hpbGQnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9XQogICAgICAgIH0sIHsKICAgICAgICAgIHR5cGU6ICdmaWVsZF92YWx1ZV9zZWxlY3Rpb24nLAogICAgICAgICAgZmllbGQ6ICd0eXBlJywKICAgICAgICAgIG5hbWU6IGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiAna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUucmVsYXRpb25zaGlwcy5zZWFyY2guZmlsdGVycy50eXBlLm5hbWUnLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1R5cGUnCiAgICAgICAgICB9KSwKICAgICAgICAgIG11bHRpU2VsZWN0OiAnb3InLAogICAgICAgICAgb3B0aW9uczogX3RvQ29uc3VtYWJsZUFycmF5KGZpbHRlclR5cGVzTWFwLnZhbHVlcygpKQogICAgICAgIH1dCiAgICAgIH07CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIGludGwuZm9ybWF0TWVzc2FnZSh7CiAgICAgICAgaWQ6ICdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5yZWxhdGlvbnNoaXBzLnJlbGF0aW9uc2hpcHNUaXRsZScsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdIZXJlIGFyZSB0aGUgc2F2ZWQgb2JqZWN0cyByZWxhdGVkIHRvIHt0aXRsZX0uICcgKyAnRGVsZXRpbmcgdGhpcyB7dHlwZX0gYWZmZWN0cyBpdHMgcGFyZW50IG9iamVjdHMsIGJ1dCBub3QgaXRzIGNoaWxkcmVuLicKICAgICAgfSwgewogICAgICAgIHR5cGU6IHNhdmVkT2JqZWN0LnR5cGUsCiAgICAgICAgdGl0bGU6IHNhdmVkT2JqZWN0Lm1ldGEudGl0bGUgfHwgKDAsIF9saWIuZ2V0RGVmYXVsdFRpdGxlKShzYXZlZE9iamVjdCkKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJbk1lbW9yeVRhYmxlLCB7CiAgICAgICAgaXRlbXM6IHJlbGF0aW9uc2hpcHMsCiAgICAgICAgY29sdW1uczogY29sdW1ucywKICAgICAgICBwYWdpbmF0aW9uOiB0cnVlLAogICAgICAgIHNlYXJjaDogc2VhcmNoCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBjbG9zZSA9IF90aGlzJHByb3BzMy5jbG9zZSwKICAgICAgICAgIHNhdmVkT2JqZWN0ID0gX3RoaXMkcHJvcHMzLnNhdmVkT2JqZWN0OwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZseW91dCwgewogICAgICAgIG9uQ2xvc2U6IGNsb3NlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbHlvdXRIZWFkZXIsIHsKICAgICAgICBoYXNCb3JkZXI6IHRydWUKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgyIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgICAgICBwb3NpdGlvbjogInRvcCIsCiAgICAgICAgY29udGVudDogKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RMYWJlbCkoc2F2ZWRPYmplY3QudHlwZSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICAiYXJpYS1sYWJlbCI6ICgwLCBfbGliLmdldFNhdmVkT2JqZWN0TGFiZWwpKHNhdmVkT2JqZWN0LnR5cGUpLAogICAgICAgIHNpemU6ICJtIiwKICAgICAgICB0eXBlOiBzYXZlZE9iamVjdC5tZXRhLmljb24gfHwgJ2FwcHMnCiAgICAgIH0pKSwgIlx4QTBceEEwIiwgc2F2ZWRPYmplY3QubWV0YS50aXRsZSB8fCAoMCwgX2xpYi5nZXREZWZhdWx0VGl0bGUpKHNhdmVkT2JqZWN0KSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZseW91dEJvZHksIG51bGwsIHRoaXMucmVuZGVyUmVsYXRpb25zaGlwcygpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUmVsYXRpb25zaGlwc1VJOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKX2RlZmluZVByb3BlcnR5KFJlbGF0aW9uc2hpcHNVSSwgInByb3BUeXBlcyIsIHsKICBnZXRSZWxhdGlvbnNoaXBzOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIHNhdmVkT2JqZWN0OiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LmlzUmVxdWlyZWQsCiAgY2xvc2U6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgZ29JbnNwZWN0T2JqZWN0OiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIGNhbkdvSW5BcHA6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQKfSk7Cgp2YXIgUmVsYXRpb25zaGlwcyA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKFJlbGF0aW9uc2hpcHNVSSk7CmV4cG9ydHMuUmVsYXRpb25zaGlwcyA9IFJlbGF0aW9uc2hpcHM7"},null]}