{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/tile_map/public/base_maps_visualization.js","dependencies":[{"path":"src/legacy/core_plugins/tile_map/public/base_maps_visualization.js","mtime":1572296411320},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkJhc2VNYXBzVmlzdWFsaXphdGlvblByb3ZpZGVyID0gQmFzZU1hcHNWaXN1YWxpemF0aW9uUHJvdmlkZXI7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2tpYmFuYV9tYXAgPSByZXF1aXJlKCJ1aS92aXMvbWFwL2tpYmFuYV9tYXAiKTsKCnZhciBSeCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJ4anMiKSk7Cgp2YXIgX29wZXJhdG9ycyA9IHJlcXVpcmUoInJ4anMvb3BlcmF0b3JzIik7CgpyZXF1aXJlKCJ1aS92aXMvbWFwL3NlcnZpY2Vfc2V0dGluZ3MiKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIFdNU19NSU5aT09NID0gMDsKdmFyIFdNU19NQVhaT09NID0gMjI7IC8vaW5jcmVhc2UgdGhpcyB0byAyMi4gQmV0dGVyIGZvciBXTVMKCmZ1bmN0aW9uIEJhc2VNYXBzVmlzdWFsaXphdGlvblByb3ZpZGVyKHNlcnZpY2VTZXR0aW5ncykgewogIC8qKgogICAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGEgdmlzdWFsaXphdGlvbiBjb25zaXN0aW5nIG9mIGEgbWFwIHdpdGggYSBzaW5nbGUgYmFzZWxheWVyLgogICAqIEBjbGFzcyBCYXNlTWFwc1Zpc3VhbGl6YXRpb24KICAgKiBAY29uc3RydWN0b3IKICAgKi8KICByZXR1cm4gKAogICAgLyojX19QVVJFX18qLwogICAgZnVuY3Rpb24gKCkgewogICAgICBmdW5jdGlvbiBCYXNlTWFwc1Zpc3VhbGl6YXRpb24oZWxlbWVudCwgdmlzKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VNYXBzVmlzdWFsaXphdGlvbik7CgogICAgICAgIHRoaXMudmlzID0gdmlzOwogICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGVsZW1lbnQ7CiAgICAgICAgdGhpcy5fa2liYW5hTWFwID0gbnVsbDsKICAgICAgICB0aGlzLl9jaGFydERhdGEgPSBudWxsOyAvL3JlZmVyZW5jZSB0byBkYXRhIGN1cnJlbnRseSBvbiB0aGUgbWFwLgoKICAgICAgICB0aGlzLl9iYXNlTGF5ZXJEaXJ0eSA9IHRydWU7CiAgICAgICAgdGhpcy5fbWFwSXNMb2FkZWQgPSB0aGlzLl9tYWtlS2liYW5hTWFwKCk7CiAgICAgIH0KCiAgICAgIF9jcmVhdGVDbGFzcyhCYXNlTWFwc1Zpc3VhbGl6YXRpb24sIFt7CiAgICAgICAga2V5OiAiaXNMb2FkZWQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc0xvYWRlZCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl9tYXBJc0xvYWRlZDsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJkZXN0cm95IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgICAgIGlmICh0aGlzLl9raWJhbmFNYXApIHsKICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLmRlc3Ryb3koKTsKCiAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcCA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8qKgogICAgICAgICAqIEltcGxlbWVudGF0aW9uIG9mIFZpc3VhbGl6YXRpb24jcmVuZGVyLgogICAgICAgICAqIENoaWxkLWNsYXNzZXMgY2FuIGV4dGVuZCB0aGlzIG1ldGhvZCBpZiB0aGUgcmVuZGVyLWNvbXBsZXRlIGZ1bmN0aW9uIHJlcXVpcmVzIG1vcmUgdGltZSB1bnRpbCByZW5kZXJpbmcgaGFzIGNvbXBsZXRlZC4KICAgICAgICAgKiBAcGFyYW0gZXNSZXNwb25zZQogICAgICAgICAqIEBwYXJhbSBzdGF0dXMKICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAgICAgICAqLwoKICAgICAgfSwgewogICAgICAgIGtleTogInJlbmRlciIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfcmVuZGVyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVzUmVzcG9uc2UsIHZpc1BhcmFtcywgc3RhdHVzKSB7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fa2liYW5hTWFwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hcElzTG9hZGVkOwoKICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMucmVzaXplKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAucmVzaXplKCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoIShzdGF0dXMucGFyYW1zIHx8IHN0YXR1cy5hZ2dzKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcmFtcyA9IHZpc1BhcmFtczsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlUGFyYW1zKCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9oYXNFU1Jlc3BvbnNlQ2hhbmdlZChlc1Jlc3BvbnNlKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZURhdGEoZXNSZXNwb25zZSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMudWlTdGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnVzZVVpU3RhdGVGcm9tVmlzdWFsaXphdGlvbih0aGlzLnZpcyk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3doZW5CYXNlTGF5ZXJJc0xvYWRlZCgpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgZnVuY3Rpb24gcmVuZGVyKF94LCBfeDIsIF94MykgewogICAgICAgICAgICByZXR1cm4gX3JlbmRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiByZW5kZXI7CiAgICAgICAgfSgpCiAgICAgICAgLyoqCiAgICAgICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIGtpYmFuYS1tYXAgd2l0aCBhIHNpbmdsZSBiYXNlbGF5ZXIgYW5kIGFzc2lnbnMgaXQgdG8gdGhlIHRoaXMuX2tpYmFuYU1hcCBwcm9wZXJ0eS4KICAgICAgICAgKiBDbGllbnRzIGNhbiBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBjdXN0b21pemUgdGhlIGluaXRpYWxpemF0aW9uLgogICAgICAgICAqIEBwcml2YXRlCiAgICAgICAgICovCgogICAgICB9LCB7CiAgICAgICAga2V5OiAiX21ha2VLaWJhbmFNYXAiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX21ha2VLaWJhbmFNYXAyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgICAgIHZhciBvcHRpb25zLCB1aVN0YXRlLCB6b29tRnJvbVVpU3RhdGUsIGNlbnRlckZyb21VSVN0YXRlOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgICAgICAgICAgICAgICB1aVN0YXRlID0gdGhpcy52aXMuZ2V0VWlTdGF0ZSgpOwogICAgICAgICAgICAgICAgICAgIHpvb21Gcm9tVWlTdGF0ZSA9IHBhcnNlSW50KHVpU3RhdGUuZ2V0KCdtYXBab29tJykpOwogICAgICAgICAgICAgICAgICAgIGNlbnRlckZyb21VSVN0YXRlID0gdWlTdGF0ZS5nZXQoJ21hcENlbnRlcicpOwogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuem9vbSA9ICFpc05hTih6b29tRnJvbVVpU3RhdGUpID8gem9vbUZyb21VaVN0YXRlIDogdGhpcy52aXMucGFyYW1zLm1hcFpvb207CiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jZW50ZXIgPSBjZW50ZXJGcm9tVUlTdGF0ZSA/IGNlbnRlckZyb21VSVN0YXRlIDogdGhpcy52aXMucGFyYW1zLm1hcENlbnRlcjsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAgPSBuZXcgX2tpYmFuYV9tYXAuS2liYW5hTWFwKHRoaXMuX2NvbnRhaW5lciwgb3B0aW9ucyk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRNaW5ab29tKFdNU19NSU5aT09NKTsgLy91c2UgYSBkZWZhdWx0CgoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0TWF4Wm9vbShXTVNfTUFYWk9PTSk7IC8vdXNlIGEgZGVmYXVsdAoKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLmFkZExlZ2VuZENvbnRyb2woKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLmFkZEZpdENvbnRyb2woKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnBlcnNpc3RVaVN0YXRlRm9yVmlzdWFsaXphdGlvbih0aGlzLnZpcyk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5vbignYmFzZUxheWVyOmxvYWRlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9iYXNlTGF5ZXJEaXJ0eSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAub24oJ2Jhc2VMYXllcjpsb2FkaW5nJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2Jhc2VMYXllckRpcnR5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlQmFzZUxheWVyKCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIGZ1bmN0aW9uIF9tYWtlS2liYW5hTWFwKCkgewogICAgICAgICAgICByZXR1cm4gX21ha2VLaWJhbmFNYXAyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF9tYWtlS2liYW5hTWFwOwogICAgICAgIH0oKQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX3Rtc0NvbmZpZ3VyZWQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfdG1zQ29uZmlndXJlZCgpIHsKICAgICAgICAgIHZhciBfdGhpcyRfZ2V0TWFwc1BhcmFtcyA9IHRoaXMuX2dldE1hcHNQYXJhbXMoKSwKICAgICAgICAgICAgICB3bXMgPSBfdGhpcyRfZ2V0TWFwc1BhcmFtcy53bXM7CgogICAgICAgICAgdmFyIGhhc1Rtc0Jhc2VMYXllciA9ICEhd21zLnNlbGVjdGVkVG1zTGF5ZXI7CiAgICAgICAgICByZXR1cm4gaGFzVG1zQmFzZUxheWVyOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIl93bXNDb25maWd1cmVkIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3dtc0NvbmZpZ3VyZWQoKSB7CiAgICAgICAgICB2YXIgX3RoaXMkX2dldE1hcHNQYXJhbXMyID0gdGhpcy5fZ2V0TWFwc1BhcmFtcygpLAogICAgICAgICAgICAgIHdtcyA9IF90aGlzJF9nZXRNYXBzUGFyYW1zMi53bXM7CgogICAgICAgICAgdmFyIGhhc1dtc0Jhc2VMYXllciA9ICEhd21zLmVuYWJsZWQ7CiAgICAgICAgICByZXR1cm4gaGFzV21zQmFzZUxheWVyOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIl91cGRhdGVCYXNlTGF5ZXIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3VwZGF0ZUJhc2VMYXllcjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgICB2YXIgZW1zVGlsZUxheWVySWQsIG1hcFBhcmFtcywgdG1zU2VydmljZXMsIHVzZXJDb25maWd1cmVkVG1zTGF5ZXIsIGluaXRCYXNlbWFwTGF5ZXIsIHNlbGVjdGVkVG1zTGF5ZXI7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgZW1zVGlsZUxheWVySWQgPSBfY2hyb21lLmRlZmF1bHQuZ2V0SW5qZWN0ZWQoJ2Vtc1RpbGVMYXllcklkJywgdHJ1ZSk7CgogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9raWJhbmFNYXApIHsKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIG1hcFBhcmFtcyA9IHRoaXMuX2dldE1hcHNQYXJhbXMoKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Rtc0NvbmZpZ3VyZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSA1OwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZVNldHRpbmdzLmdldFRNU1NlcnZpY2VzKCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgdG1zU2VydmljZXMgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgICAgICB1c2VyQ29uZmlndXJlZFRtc0xheWVyID0gdG1zU2VydmljZXNbMF07CiAgICAgICAgICAgICAgICAgICAgaW5pdEJhc2VtYXBMYXllciA9IHVzZXJDb25maWd1cmVkVG1zTGF5ZXIgPyB1c2VyQ29uZmlndXJlZFRtc0xheWVyIDogdG1zU2VydmljZXMuZmluZChmdW5jdGlvbiAocykgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHMuaWQgPT09IGVtc1RpbGVMYXllcklkLmJyaWdodDsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRCYXNlbWFwTGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFRtc0xheWVyKGluaXRCYXNlbWFwTGF5ZXIpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxNDsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oNSk7CgogICAgICAgICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFdhcm5pbmcoX2NvbnRleHQzLnQwLm1lc3NhZ2UpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl93bXNDb25maWd1cmVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFdNU19NSU5aT09NID4gdGhpcy5fa2liYW5hTWFwLmdldE1heFpvb21MZXZlbCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldE1pblpvb20oV01TX01JTlpPT00pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0TWF4Wm9vbShXTVNfTUFYWk9PTSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRCYXNlTGF5ZXIoewogICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VMYXllclR5cGU6ICd3bXMnLAogICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogV01TX01JTlpPT00sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhab29tOiBXTVNfTUFYWk9PTSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbWFwUGFyYW1zLndtcy51cmwKICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBtYXBQYXJhbXMud21zLm9wdGlvbnMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90bXNDb25maWd1cmVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUbXNMYXllciA9IG1hcFBhcmFtcy53bXMuc2VsZWN0ZWRUbXNMYXllcjsKCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFRtc0xheWVyKHNlbGVjdGVkVG1zTGF5ZXIpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHRtc0xvYWRpbmdFcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkV2FybmluZyh0bXNMb2FkaW5nRXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzLCBbWzUsIDE0XV0pOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIGZ1bmN0aW9uIF91cGRhdGVCYXNlTGF5ZXIoKSB7CiAgICAgICAgICAgIHJldHVybiBfdXBkYXRlQmFzZUxheWVyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfdXBkYXRlQmFzZUxheWVyOwogICAgICAgIH0oKQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX3NldFRtc0xheWVyIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF9zZXRUbXNMYXllcjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KHRtc0xheWVyKSB7CiAgICAgICAgICAgIHZhciBpc0Rlc2F0dXJhdGVkLCBpc0RhcmtNb2RlLCBtZXRhLCBzaG93Wm9vbU1lc3NhZ2UsIG9wdGlvbnM7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldE1pblpvb20odG1zTGF5ZXIubWluWm9vbSk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRNYXhab29tKHRtc0xheWVyLm1heFpvb20pOwoKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fa2liYW5hTWFwLmdldFpvb21MZXZlbCgpID4gdG1zTGF5ZXIubWF4Wm9vbSkgewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldFpvb21MZXZlbCh0bXNMYXllci5tYXhab29tKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlzRGVzYXR1cmF0ZWQgPSB0aGlzLl9nZXRNYXBzUGFyYW1zKCkuaXNEZXNhdHVyYXRlZDsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpc0Rlc2F0dXJhdGVkICE9PSAnYm9vbGVhbicpIHsKICAgICAgICAgICAgICAgICAgICAgIGlzRGVzYXR1cmF0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaXNEYXJrTW9kZSA9IF9jaHJvbWUuZGVmYXVsdC5nZXRVaVNldHRpbmdzQ2xpZW50KCkuZ2V0KCd0aGVtZTpkYXJrTW9kZScpOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZVNldHRpbmdzLmdldEF0dHJpYnV0ZXNGb3JUTVNMYXllcih0bXNMYXllciwgaXNEZXNhdHVyYXRlZCwgaXNEYXJrTW9kZSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgICAgIHNob3dab29tTWVzc2FnZSA9IHNlcnZpY2VTZXR0aW5ncy5zaG91bGRTaG93Wm9vbU1lc3NhZ2UodG1zTGF5ZXIpOwogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmVEZWVwKHRtc0xheWVyKTsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5pZDsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5zdWJkb21haW5zOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0QmFzZUxheWVyKHsKICAgICAgICAgICAgICAgICAgICAgIGJhc2VMYXllclR5cGU6ICd0bXMnLAogICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogX29iamVjdFNwcmVhZCh7fSwgb3B0aW9ucywgewogICAgICAgICAgICAgICAgICAgICAgICBzaG93Wm9vbU1lc3NhZ2U6IHNob3dab29tTWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgfSwgbWV0YSkKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgZnVuY3Rpb24gX3NldFRtc0xheWVyKF94NCkgewogICAgICAgICAgICByZXR1cm4gX3NldFRtc0xheWVyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfc2V0VG1zTGF5ZXI7CiAgICAgICAgfSgpCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfdXBkYXRlRGF0YSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfdXBkYXRlRGF0YTIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihfaTE4bi5pMThuLnRyYW5zbGF0ZSgndGlsZU1hcC5iYXNlTWFwc1Zpc3VhbGl6YXRpb24uY2hpbGRTaG91bGRJbXBsZW1lbnRNZXRob2RFcnJvck1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0NoaWxkIHNob3VsZCBpbXBsZW1lbnQgdGhpcyBtZXRob2QgdG8gcmVzcG9uZCB0byBkYXRhLXVwZGF0ZScKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNSk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZURhdGEoKSB7CiAgICAgICAgICAgIHJldHVybiBfdXBkYXRlRGF0YTIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX3VwZGF0ZURhdGE7CiAgICAgICAgfSgpCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfaGFzRVNSZXNwb25zZUNoYW5nZWQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaGFzRVNSZXNwb25zZUNoYW5nZWQoZGF0YSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX2NoYXJ0RGF0YSAhPT0gZGF0YTsKICAgICAgICB9CiAgICAgICAgLyoqCiAgICAgICAgICogY2FsbGVkIG9uIG9wdGlvbnMgY2hhbmdlICh2aXMucGFyYW1zIGNoYW5nZSkKICAgICAgICAgKi8KCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfdXBkYXRlUGFyYW1zIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF91cGRhdGVQYXJhbXMyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICAgICAgdmFyIG1hcFBhcmFtczsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBtYXBQYXJhbXMgPSB0aGlzLl9nZXRNYXBzUGFyYW1zKCk7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVCYXNlTGF5ZXIoKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0TGVnZW5kUG9zaXRpb24obWFwUGFyYW1zLmxlZ2VuZFBvc2l0aW9uKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldFNob3dUb29sdGlwKG1hcFBhcmFtcy5hZGRUb29sdGlwKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnVzZVVpU3RhdGVGcm9tVmlzdWFsaXphdGlvbih0aGlzLnZpcyk7CgogICAgICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcyk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVBhcmFtcygpIHsKICAgICAgICAgICAgcmV0dXJuIF91cGRhdGVQYXJhbXMyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF91cGRhdGVQYXJhbXM7CiAgICAgICAgfSgpCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfZ2V0TWFwc1BhcmFtcyIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRNYXBzUGFyYW1zKCkgewogICAgICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIHRoaXMudmlzLnR5cGUudmlzQ29uZmlnLmRlZmF1bHRzLCB7CiAgICAgICAgICAgIHR5cGU6IHRoaXMudmlzLnR5cGUubmFtZQogICAgICAgICAgfSwgdGhpcy5fcGFyYW1zKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfd2hlbkJhc2VMYXllcklzTG9hZGVkIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3doZW5CYXNlTGF5ZXJJc0xvYWRlZCgpIHsKICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICAgIGlmICghdGhpcy5fdG1zQ29uZmlndXJlZCgpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBtYXhUaW1lRm9yQmFzZUxheWVyID0gMTAwMDA7CiAgICAgICAgICB2YXIgaW50ZXJ2YWwkID0gUnguaW50ZXJ2YWwoMTApLnBpcGUoKDAsIF9vcGVyYXRvcnMuZmlsdGVyKShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiAhX3RoaXMyLl9iYXNlTGF5ZXJEaXJ0eTsKICAgICAgICAgIH0pKTsKICAgICAgICAgIHZhciB0aW1lciQgPSBSeC50aW1lcihtYXhUaW1lRm9yQmFzZUxheWVyKTsKICAgICAgICAgIHJldHVybiBSeC5yYWNlKGludGVydmFsJCwgdGltZXIkKS5waXBlKCgwLCBfb3BlcmF0b3JzLmZpcnN0KSgpKS50b1Byb21pc2UoKTsKICAgICAgICB9CiAgICAgIH1dKTsKCiAgICAgIHJldHVybiBCYXNlTWFwc1Zpc3VhbGl6YXRpb247CiAgICB9KCkKICApOwp9"},null]}