{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/console/public/src/autocomplete/body_completer.js","dependencies":[{"path":"src/legacy/core_plugins/console/public/src/autocomplete/body_completer.js","mtime":1572296409236},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdsb2JhbHNPbmx5QXV0b2NvbXBsZXRlQ29tcG9uZW50cyA9IGdsb2JhbHNPbmx5QXV0b2NvbXBsZXRlQ29tcG9uZW50czsKZXhwb3J0cy5jb21waWxlQm9keURlc2NyaXB0aW9uID0gY29tcGlsZUJvZHlEZXNjcmlwdGlvbjsKCnZhciBfZW5naW5lID0gcmVxdWlyZSgiLi9lbmdpbmUiKTsKCnZhciBfY29tcG9uZW50cyA9IHJlcXVpcmUoIi4vY29tcG9uZW50cyIpOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKLyoKICogTGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZSBvciBtb3JlIGNvbnRyaWJ1dG9yCiAqIGxpY2Vuc2UgYWdyZWVtZW50cy4gU2VlIHRoZSBOT1RJQ0UgZmlsZSBkaXN0cmlidXRlZCB3aXRoCiAqIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiByZWdhcmRpbmcgY29weXJpZ2h0CiAqIG93bmVyc2hpcC4gRWxhc3RpY3NlYXJjaCBCLlYuIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIKICogdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkKICogbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICovCnZhciBfID0gcmVxdWlyZSgnbG9kYXNoJyk7CgpmdW5jdGlvbiBDb21waWxpbmdDb250ZXh0KGVuZHBvaW50SWQsIHBhcmFtZXRyaXplZENvbXBvbmVudEZhY3RvcmllcykgewogIHRoaXMucGFyYW1ldHJpemVkQ29tcG9uZW50RmFjdG9yaWVzID0gcGFyYW1ldHJpemVkQ29tcG9uZW50RmFjdG9yaWVzOwogIHRoaXMuZW5kcG9pbnRJZCA9IGVuZHBvaW50SWQ7Cn0KLyoqCiAqIEFuIG9iamVjdCB0byByZXNvbHZlIHNjb3BlIGxpbmtzIChzeW50YXggZW5kcG9pbnQucGF0aDEucGF0aDIpCiAqIEBwYXJhbSBsaW5rIHRoZSBsaW5rIGVpdGhlciBzdHJpbmcgKGVuZHBvaW50LnBhdGgxLnBhdGgyLCBvciAucGF0aDEucGF0aDIpIG9yIGEgZnVuY3Rpb24gKGNvbnRleHQsZWRpdG9yKQogKiB3aGljaCByZXR1cm5zIGEgZGVzY3JpcHRpb24gdG8gYmUgY29tcGlsZWQKICogQGNvbnN0cnVjdG9yCiAqIEBwYXJhbSBjb21waWxpbmdDb250ZXh0CiAqCiAqCiAqIEZvciB0aGlzIHRvIHdvcmsgd2UgZXhwZWN0IHRoZSBjb250ZXh0IHRvIGluY2x1ZGUgYSBtZXRob2QgY29udGV4dC5lbmRwb2ludENvbXBvbmVudFJlc29sdmVyKGVuZHBvaW50KQogKiB3aGljaCBzaG91bGQgcmV0dXJuIHRoZSB0b3AgbGV2ZWwgY29tcG9uZW50cyBmb3IgdGhlIGdpdmVuIGVuZHBvaW50CiAqLwoKCmZ1bmN0aW9uIHJlc29sdmVQYXRoVG9Db21wb25lbnRzKHRva2VuUGF0aCwgY29udGV4dCwgZWRpdG9yLCBjb21wb25lbnRzKSB7CiAgdmFyIHdhbGtTdGF0ZXMgPSAoMCwgX2VuZ2luZS53YWxrVG9rZW5QYXRoKSh0b2tlblBhdGgsIFtuZXcgX2VuZ2luZS5XYWxraW5nU3RhdGUoJ1JPT1QnLCBjb21wb25lbnRzLCBbXSldLCBjb250ZXh0LCBlZGl0b3IpOwogIHZhciByZXN1bHQgPSBbXS5jb25jYXQuYXBwbHkoW10sIF8ucGx1Y2sod2Fsa1N0YXRlcywgJ2NvbXBvbmVudHMnKSk7CiAgcmV0dXJuIHJlc3VsdDsKfQoKdmFyIFNjb3BlUmVzb2x2ZXIgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfU2hhcmVkQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFNjb3BlUmVzb2x2ZXIsIF9TaGFyZWRDb21wb25lbnQpOwoKICBmdW5jdGlvbiBTY29wZVJlc29sdmVyKGxpbmssIGNvbXBpbGluZ0NvbnRleHQpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2NvcGVSZXNvbHZlcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoU2NvcGVSZXNvbHZlcikuY2FsbCh0aGlzLCAnX19zY29wZV9saW5rJykpOwoKICAgIGlmIChfLmlzU3RyaW5nKGxpbmspICYmIGxpbmtbMF0gPT09ICcuJykgewogICAgICAvLyByZWxhdGl2ZSBsaW5rLCBpbmplY3QgY3VycmVudCBlbmRwb2ludAogICAgICBpZiAobGluayA9PT0gJy4nKSB7CiAgICAgICAgbGluayA9IGNvbXBpbGluZ0NvbnRleHQuZW5kcG9pbnRJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBsaW5rID0gY29tcGlsaW5nQ29udGV4dC5lbmRwb2ludElkICsgbGluazsKICAgICAgfQogICAgfQoKICAgIF90aGlzLmxpbmsgPSBsaW5rOwogICAgX3RoaXMuY29tcGlsaW5nQ29udGV4dCA9IGNvbXBpbGluZ0NvbnRleHQ7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU2NvcGVSZXNvbHZlciwgW3sKICAgIGtleTogInJlc29sdmVMaW5rVG9Db21wb25lbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNvbHZlTGlua1RvQ29tcG9uZW50cyhjb250ZXh0LCBlZGl0b3IpIHsKICAgICAgaWYgKF8uaXNGdW5jdGlvbih0aGlzLmxpbmspKSB7CiAgICAgICAgdmFyIGRlc2MgPSB0aGlzLmxpbmsoY29udGV4dCwgZWRpdG9yKTsKICAgICAgICByZXR1cm4gY29tcGlsZURlc2NyaXB0aW9uKGRlc2MsIHRoaXMuY29tcGlsaW5nQ29udGV4dCk7CiAgICAgIH0KCiAgICAgIGlmICghXy5pc1N0cmluZyh0aGlzLmxpbmspKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnN1cHBvcnRlZCBsaW5rIGZvcm1hdCcsIHRoaXMubGluayk7CiAgICAgIH0KCiAgICAgIHZhciBwYXRoID0gdGhpcy5saW5rLnJlcGxhY2UoL1wuL2csICd7Jykuc3BsaXQoLyhceykvKTsKICAgICAgdmFyIGVuZHBvaW50ID0gcGF0aFswXTsKICAgICAgdmFyIGNvbXBvbmVudHM7CgogICAgICB0cnkgewogICAgICAgIGlmIChlbmRwb2ludCA9PT0gJ0dMT0JBTCcpIHsKICAgICAgICAgIC8vIGdsb2JhbCBydWxlcyBuZWVkIGFuIGV4dHJhIGluZGlyZWN0aW9uCiAgICAgICAgICBpZiAocGF0aC5sZW5ndGggPCAzKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignbWlzc2luZyB0ZXJtIGluIGdsb2JhbCBsaW5rOiAnICsgdGhpcy5saW5rKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgdGVybSA9IHBhdGhbMl07CiAgICAgICAgICBjb21wb25lbnRzID0gY29udGV4dC5nbG9iYWxDb21wb25lbnRSZXNvbHZlcih0ZXJtKTsKICAgICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwYXRoID0gcGF0aC5zbGljZSgxKTsKICAgICAgICAgIGNvbXBvbmVudHMgPSBjb250ZXh0LmVuZHBvaW50Q29tcG9uZW50UmVzb2x2ZXIoZW5kcG9pbnQpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignZmFpbGVkIHRvIHJlc29sdmUgbGluayBbJyArIHRoaXMubGluayArICddOiAnICsgZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXNvbHZlUGF0aFRvQ29tcG9uZW50cyhwYXRoLCBjb250ZXh0LCBlZGl0b3IsIGNvbXBvbmVudHMpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFRlcm1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUZXJtcyhjb250ZXh0LCBlZGl0b3IpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBbXTsKICAgICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLnJlc29sdmVMaW5rVG9Db21wb25lbnRzKGNvbnRleHQsIGVkaXRvcik7CgogICAgICBfLmVhY2goY29tcG9uZW50cywgZnVuY3Rpb24gKGNvbXBvbmVudCkgewogICAgICAgIG9wdGlvbnMucHVzaC5hcHBseShvcHRpb25zLCBjb21wb25lbnQuZ2V0VGVybXMoY29udGV4dCwgZWRpdG9yKSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWF0Y2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hdGNoKHRva2VuLCBjb250ZXh0LCBlZGl0b3IpIHsKICAgICAgdmFyIHJlc3VsdCA9IHsKICAgICAgICBuZXh0OiBbXQogICAgICB9OwogICAgICB2YXIgY29tcG9uZW50cyA9IHRoaXMucmVzb2x2ZUxpbmtUb0NvbXBvbmVudHMoY29udGV4dCwgZWRpdG9yKTsKCiAgICAgIF8uZWFjaChjb21wb25lbnRzLCBmdW5jdGlvbiAoY29tcG9uZW50KSB7CiAgICAgICAgdmFyIGNvbXBvbmVudFJlc3VsdCA9IGNvbXBvbmVudC5tYXRjaCh0b2tlbiwgY29udGV4dCwgZWRpdG9yKTsKCiAgICAgICAgaWYgKGNvbXBvbmVudFJlc3VsdCAmJiBjb21wb25lbnRSZXN1bHQubmV4dCkgewogICAgICAgICAgcmVzdWx0Lm5leHQucHVzaC5hcHBseShyZXN1bHQubmV4dCwgY29tcG9uZW50UmVzdWx0Lm5leHQpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFNjb3BlUmVzb2x2ZXI7Cn0oX2NvbXBvbmVudHMuU2hhcmVkQ29tcG9uZW50KTsKCmZ1bmN0aW9uIGdldFRlbXBsYXRlKGRlc2NyaXB0aW9uKSB7CiAgaWYgKGRlc2NyaXB0aW9uLl9fdGVtcGxhdGUpIHsKICAgIHJldHVybiBkZXNjcmlwdGlvbi5fX3RlbXBsYXRlOwogIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24uX19vbmVfb2YpIHsKICAgIHJldHVybiBnZXRUZW1wbGF0ZShkZXNjcmlwdGlvbi5fX29uZV9vZlswXSk7CiAgfSBlbHNlIGlmIChkZXNjcmlwdGlvbi5fX2FueV9vZikgewogICAgcmV0dXJuIFtdOwogIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24uX19zY29wZV9saW5rKSB7CiAgICAvLyBhc3N1bWUgYW4gb2JqZWN0IGZvciBub3cuCiAgICByZXR1cm4ge307CiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGRlc2NyaXB0aW9uKSkgewogICAgaWYgKGRlc2NyaXB0aW9uLmxlbmd0aCA9PT0gMSkgewogICAgICBpZiAoXy5pc09iamVjdChkZXNjcmlwdGlvblswXSkpIHsKICAgICAgICAvLyBzaG9ydGN1dCB0byBzYXZlIHR5cGluZwogICAgICAgIHZhciBpbm5lclRlbXBsYXRlID0gZ2V0VGVtcGxhdGUoZGVzY3JpcHRpb25bMF0pOwogICAgICAgIHJldHVybiBpbm5lclRlbXBsYXRlICE9IG51bGwgPyBbaW5uZXJUZW1wbGF0ZV0gOiBbXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBbXTsKICB9IGVsc2UgaWYgKF8uaXNPYmplY3QoZGVzY3JpcHRpb24pKSB7CiAgICByZXR1cm4ge307CiAgfSBlbHNlIGlmIChfLmlzU3RyaW5nKGRlc2NyaXB0aW9uKSAmJiAhL15cey4qXH0kLy50ZXN0KGRlc2NyaXB0aW9uKSkgewogICAgcmV0dXJuIGRlc2NyaXB0aW9uOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZGVzY3JpcHRpb247CiAgfQp9CgpmdW5jdGlvbiBnZXRPcHRpb25zKGRlc2NyaXB0aW9uKSB7CiAgdmFyIG9wdGlvbnMgPSB7fTsKICB2YXIgdGVtcGxhdGUgPSBnZXRUZW1wbGF0ZShkZXNjcmlwdGlvbik7CgogIGlmICghXy5pc1VuZGVmaW5lZCh0ZW1wbGF0ZSkpIHsKICAgIG9wdGlvbnMudGVtcGxhdGUgPSB0ZW1wbGF0ZTsKICB9CgogIHJldHVybiBvcHRpb25zOwp9Ci8qKgogKiBAcGFyYW0gZGVzY3JpcHRpb24gYSBqc29uIGRpY3QgZGVzY3JpYmluZyB0aGUgZW5kcG9pbnQKICogQHBhcmFtIGNvbXBpbGluZ0NvbnRleHQKICovCgoKZnVuY3Rpb24gY29tcGlsZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uLCBjb21waWxpbmdDb250ZXh0KSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoZGVzY3JpcHRpb24pKSB7CiAgICByZXR1cm4gW2NvbXBpbGVMaXN0KGRlc2NyaXB0aW9uLCBjb21waWxpbmdDb250ZXh0KV07CiAgfSBlbHNlIGlmIChfLmlzT2JqZWN0KGRlc2NyaXB0aW9uKSkgewogICAgLy8gdGVzdCBmb3Igb2JqZWN0cyBsaXN0IGFzIGFycmF5cyBhcmUgYWxzbyBvYmplY3RzCiAgICBpZiAoZGVzY3JpcHRpb24uX19zY29wZV9saW5rKSB7CiAgICAgIHJldHVybiBbbmV3IFNjb3BlUmVzb2x2ZXIoZGVzY3JpcHRpb24uX19zY29wZV9saW5rLCBjb21waWxpbmdDb250ZXh0KV07CiAgICB9CgogICAgaWYgKGRlc2NyaXB0aW9uLl9fYW55X29mKSB7CiAgICAgIHJldHVybiBbY29tcGlsZUxpc3QoZGVzY3JpcHRpb24uX19hbnlfb2YsIGNvbXBpbGluZ0NvbnRleHQpXTsKICAgIH0KCiAgICBpZiAoZGVzY3JpcHRpb24uX19vbmVfb2YpIHsKICAgICAgcmV0dXJuIF8uZmxhdHRlbihfLm1hcChkZXNjcmlwdGlvbi5fX29uZV9vZiwgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gY29tcGlsZURlc2NyaXB0aW9uKGQsIGNvbXBpbGluZ0NvbnRleHQpOwogICAgICB9KSk7CiAgICB9CgogICAgdmFyIG9iaiA9IGNvbXBpbGVPYmplY3QoZGVzY3JpcHRpb24sIGNvbXBpbGluZ0NvbnRleHQpOwoKICAgIGlmIChkZXNjcmlwdGlvbi5fX2NvbmRpdGlvbikgewogICAgICByZXR1cm4gW2NvbXBpbGVDb25kaXRpb24oZGVzY3JpcHRpb24uX19jb25kaXRpb24sIG9iaiwgY29tcGlsaW5nQ29udGV4dCldOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIFtvYmpdOwogICAgfQogIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhkZXNjcmlwdGlvbikgJiYgL15cey4qXH0kLy50ZXN0KGRlc2NyaXB0aW9uKSkgewogICAgcmV0dXJuIFtjb21waWxlUGFyYW1ldHJpemVkVmFsdWUoZGVzY3JpcHRpb24sIGNvbXBpbGluZ0NvbnRleHQpXTsKICB9IGVsc2UgewogICAgcmV0dXJuIFtuZXcgX2NvbXBvbmVudHMuQ29uc3RhbnRDb21wb25lbnQoZGVzY3JpcHRpb24pXTsKICB9Cn0KCmZ1bmN0aW9uIGNvbXBpbGVQYXJhbWV0cml6ZWRWYWx1ZSh2YWx1ZSwgY29tcGlsaW5nQ29udGV4dCwgdGVtcGxhdGUpIHsKICB2YWx1ZSA9IHZhbHVlLnN1YnN0cigxLCB2YWx1ZS5sZW5ndGggLSAyKS50b0xvd2VyQ2FzZSgpOwogIHZhciBjb21wb25lbnQgPSBjb21waWxpbmdDb250ZXh0LnBhcmFtZXRyaXplZENvbXBvbmVudEZhY3Rvcmllcy5nZXRDb21wb25lbnQodmFsdWUsIHRydWUpOwoKICBpZiAoIWNvbXBvbmVudCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdubyBmYWN0b3J5IGZvdW5kIGZvciBcJycgKyB2YWx1ZSArICdcJycpOwogIH0KCiAgY29tcG9uZW50ID0gY29tcG9uZW50KHZhbHVlLCBudWxsLCB0ZW1wbGF0ZSk7CgogIGlmICghXy5pc1VuZGVmaW5lZCh0ZW1wbGF0ZSkpIHsKICAgIGNvbXBvbmVudCA9ICgwLCBfZW5naW5lLndyYXBDb21wb25lbnRXaXRoRGVmYXVsdHMpKGNvbXBvbmVudCwgewogICAgICB0ZW1wbGF0ZTogdGVtcGxhdGUKICAgIH0pOwogIH0KCiAgcmV0dXJuIGNvbXBvbmVudDsKfQoKZnVuY3Rpb24gY29tcGlsZU9iamVjdChvYmpEZXNjcmlwdGlvbiwgY29tcGlsaW5nQ29udGV4dCkgewogIHZhciBvYmplY3RDID0gbmV3IF9jb21wb25lbnRzLkNvbnN0YW50Q29tcG9uZW50KCd7Jyk7CiAgdmFyIGNvbnN0YW50cyA9IFtdOwogIHZhciBwYXR0ZXJucyA9IFtdOwoKICBfLmVhY2gob2JqRGVzY3JpcHRpb24sIGZ1bmN0aW9uIChkZXNjLCBrZXkpIHsKICAgIGlmIChrZXkuaW5kZXhPZignX18nKSA9PT0gMCkgewogICAgICAvLyBtZXRhIGtleQogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIG9wdGlvbnMgPSBnZXRPcHRpb25zKGRlc2MpOwogICAgdmFyIGNvbXBvbmVudDsKCiAgICBpZiAoL15cey4qXH0kLy50ZXN0KGtleSkpIHsKICAgICAgY29tcG9uZW50ID0gY29tcGlsZVBhcmFtZXRyaXplZFZhbHVlKGtleSwgY29tcGlsaW5nQ29udGV4dCwgb3B0aW9ucy50ZW1wbGF0ZSk7CiAgICAgIHBhdHRlcm5zLnB1c2goY29tcG9uZW50KTsKICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnKicpIHsKICAgICAgY29tcG9uZW50ID0gbmV3IF9jb21wb25lbnRzLlNoYXJlZENvbXBvbmVudChrZXkpOwogICAgICBwYXR0ZXJucy5wdXNoKGNvbXBvbmVudCk7CiAgICB9IGVsc2UgewogICAgICBvcHRpb25zLm5hbWUgPSBrZXk7CiAgICAgIGNvbXBvbmVudCA9IG5ldyBfY29tcG9uZW50cy5Db25zdGFudENvbXBvbmVudChrZXksIG51bGwsIFtvcHRpb25zXSk7CiAgICAgIGNvbnN0YW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICB9CgogICAgXy5tYXAoY29tcGlsZURlc2NyaXB0aW9uKGRlc2MsIGNvbXBpbGluZ0NvbnRleHQpLCBmdW5jdGlvbiAoc3ViQ29tcG9uZW50KSB7CiAgICAgIGNvbXBvbmVudC5hZGRDb21wb25lbnQoc3ViQ29tcG9uZW50KTsKICAgIH0pOwogIH0pOwoKICBvYmplY3RDLmFkZENvbXBvbmVudChuZXcgX2NvbXBvbmVudHMuT2JqZWN0Q29tcG9uZW50KCdpbm5lcicsIGNvbnN0YW50cywgcGF0dGVybnMpKTsKICByZXR1cm4gb2JqZWN0QzsKfQoKZnVuY3Rpb24gY29tcGlsZUxpc3QobGlzdFJ1bGUsIGNvbXBpbGluZ0NvbnRleHQpIHsKICB2YXIgbGlzdEMgPSBuZXcgX2NvbXBvbmVudHMuQ29uc3RhbnRDb21wb25lbnQoJ1snKTsKCiAgXy5lYWNoKGxpc3RSdWxlLCBmdW5jdGlvbiAoZGVzYykgewogICAgXy5lYWNoKGNvbXBpbGVEZXNjcmlwdGlvbihkZXNjLCBjb21waWxpbmdDb250ZXh0KSwgZnVuY3Rpb24gKGNvbXBvbmVudCkgewogICAgICBsaXN0Qy5hZGRDb21wb25lbnQoY29tcG9uZW50KTsKICAgIH0pOwogIH0pOwoKICByZXR1cm4gbGlzdEM7Cn0KLyoqIHRha2VzIGEgY29tcGlsZWQgb2JqZWN0IGFuZCB3cmFwcyBpbiBhIHtAbGluayBDb25kaXRpb25hbFByb3h5IH0qLwoKCmZ1bmN0aW9uIGNvbXBpbGVDb25kaXRpb24oZGVzY3JpcHRpb24sIGNvbXBpbGVkT2JqZWN0KSB7CiAgaWYgKGRlc2NyaXB0aW9uLmxpbmVzX3JlZ2V4KSB7CiAgICByZXR1cm4gbmV3IF9jb21wb25lbnRzLkNvbmRpdGlvbmFsUHJveHkoZnVuY3Rpb24gKGNvbnRleHQsIGVkaXRvcikgewogICAgICB2YXIgbGluZXMgPSBlZGl0b3IuZ2V0U2Vzc2lvbigpLmdldExpbmVzKGNvbnRleHQucmVxdWVzdFN0YXJ0Um93LCBlZGl0b3IuZ2V0Q3Vyc29yUG9zaXRpb24oKS5yb3cpLmpvaW4oJ1xuJyk7CiAgICAgIHJldHVybiBuZXcgUmVnRXhwKGRlc2NyaXB0aW9uLmxpbmVzX3JlZ2V4LCAnbScpLnRlc3QobGluZXMpOwogICAgfSwgY29tcGlsZWRPYmplY3QpOwogIH0gZWxzZSB7CiAgICB0aHJvdyAndW5rbm93biBjb25kaXRpb24gdHlwZSAtIGdvdDogJyArIEpTT04uc3RyaW5naWZ5KGRlc2NyaXB0aW9uKTsKICB9Cn0gLy8gYSBsaXN0IG9mIGNvbXBvbmVudCB0aGF0IG1hdGNoIGFueXRoaW5nIGJ1dCBnaXZlIGF1dG8gY29tcGxldGUgc3VnZ2VzdGlvbnMgYmFzZWQgb24gZ2xvYmFsIEFQSSBlbnRyaWVzLgoKCmZ1bmN0aW9uIGdsb2JhbHNPbmx5QXV0b2NvbXBsZXRlQ29tcG9uZW50cygpIHsKICByZXR1cm4gW25ldyBfY29tcG9uZW50cy5HbG9iYWxPbmx5Q29tcG9uZW50KCdfX2dsb2JhbF9fJyldOwp9Ci8qKgogKiBAcGFyYW0gZW5kcG9pbnRJZCBpZCBvZiB0aGUgZW5kcG9pbnQgYmVpbmcgY29tcGlsZWQuCiAqIEBwYXJhbSBkZXNjcmlwdGlvbiBhIGpzb24gZGljdCBkZXNjcmliaW5nIHRoZSBlbmRwb2ludAogKiBAcGFyYW0gZW5kcG9pbnRDb21wb25lbnRSZXNvbHZlciBhIGZ1bmN0aW9uIChlbmRwb2ludCxjb250ZXh0LGVkaXRvcikgd2hpY2ggc2hvdWxkIHJlc29sdmUgYW4gZW5kcG9pbnQKICogICAgICAgIHRvIGl0J3MgbGlzdCBvZiBjb21waWxlZCBjb21wb25lbnRzLgogKiBAcGFyYW0gcGFyYW1ldHJpemVkQ29tcG9uZW50RmFjdG9yaWVzIGEgZGljdCBvZiB0aGUgZm9sbG93aW5nIHN0cnVjdHVyZQogKiB0aGF0IHdpbGwgYmUgdXNlZCBhcyBhIGZhbGwgYmFjayBmb3IgcGF0dGVybiBrZXlzIChpLmUuOiB7dHlwZX0gLHJlc29sdmVkIHdpdGhvdXQgdGhlICRzKQogKiB7CiAqICAgVFlQRTogZnVuY3Rpb24gKHBhcnQsIHBhcmVudCwgZW5kcG9pbnQpIHsKICogICAgICByZXR1cm4gbmV3IFNoYXJlZENvbXBvbmVudChwYXJ0LCBwYXJlbnQpCiAqICAgfQogKiB9CiAqLwoKCmZ1bmN0aW9uIGNvbXBpbGVCb2R5RGVzY3JpcHRpb24oZW5kcG9pbnRJZCwgZGVzY3JpcHRpb24sIHBhcmFtZXRyaXplZENvbXBvbmVudEZhY3RvcmllcykgewogIHJldHVybiBjb21waWxlRGVzY3JpcHRpb24oZGVzY3JpcHRpb24sIG5ldyBDb21waWxpbmdDb250ZXh0KGVuZHBvaW50SWQsIHBhcmFtZXRyaXplZENvbXBvbmVudEZhY3RvcmllcykpOwp9"},null]}