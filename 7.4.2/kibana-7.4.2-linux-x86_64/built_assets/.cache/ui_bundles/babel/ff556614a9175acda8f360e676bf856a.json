{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/region_map/public/choropleth_layer.js","dependencies":[{"path":"src/legacy/core_plugins/region_map/public/choropleth_layer.js","mtime":1572296411268},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Cgp2YXIgX2pxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgianF1ZXJ5IikpOwoKdmFyIF9sZWFmbGV0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsZWFmbGV0IikpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiZDMiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfa2liYW5hX21hcF9sYXllciA9IHJlcXVpcmUoInVpL3Zpcy9tYXAva2liYW5hX21hcF9sYXllciIpOwoKdmFyIF90cnVuY2F0ZWRfY29sb3JtYXBzID0gcmVxdWlyZSgidWkvdmlzbGliL2NvbXBvbmVudHMvY29sb3IvdHJ1bmNhdGVkX2NvbG9ybWFwcyIpOwoKdmFyIHRvcG9qc29uID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgidG9wb2pzb24tY2xpZW50IikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBjb2xvclV0aWwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJ1aS92aXMvbWFwL2NvbG9yX3V0aWwiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ICE9PSAidW5kZWZpbmVkIiAmJiBSZWZsZWN0LmdldCkgeyBfZ2V0ID0gUmVmbGVjdC5nZXQ7IH0gZWxzZSB7IF9nZXQgPSBmdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IHZhciBiYXNlID0gX3N1cGVyUHJvcEJhc2UodGFyZ2V0LCBwcm9wZXJ0eSk7IGlmICghYmFzZSkgcmV0dXJuOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYmFzZSwgcHJvcGVydHkpOyBpZiAoZGVzYy5nZXQpIHsgcmV0dXJuIGRlc2MuZ2V0LmNhbGwocmVjZWl2ZXIpOyB9IHJldHVybiBkZXNjLnZhbHVlOyB9OyB9IHJldHVybiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyIHx8IHRhcmdldCk7IH0KCmZ1bmN0aW9uIF9zdXBlclByb3BCYXNlKG9iamVjdCwgcHJvcGVydHkpIHsgd2hpbGUgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHsgb2JqZWN0ID0gX2dldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChvYmplY3QgPT09IG51bGwpIGJyZWFrOyB9IHJldHVybiBvYmplY3Q7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCnZhciBFTVBUWV9TVFlMRSA9IHsKICB3ZWlnaHQ6IDEsCiAgb3BhY2l0eTogMC42LAogIGNvbG9yOiAncmdiKDIwMCwyMDAsMjAwKScsCiAgZmlsbE9wYWNpdHk6IDAKfTsKCnZhciBDaG9yb3BsZXRoTGF5ZXIgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfS2liYW5hTWFwTGF5ZXIpIHsKICBfaW5oZXJpdHMoQ2hvcm9wbGV0aExheWVyLCBfS2liYW5hTWFwTGF5ZXIpOwoKICBfY3JlYXRlQ2xhc3MoQ2hvcm9wbGV0aExheWVyLCBudWxsLCBbewogICAga2V5OiAiX2RvSW5uZXJKb2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9Jbm5lckpvaW4oc29ydGVkTWV0cmljcywgc29ydGVkR2VvanNvbkZlYXR1cmVzLCBqb2luRmllbGQpIHsKICAgICAgdmFyIGogPSAwOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzb3J0ZWRHZW9qc29uRmVhdHVyZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcHJvcGVydHkgPSBzb3J0ZWRHZW9qc29uRmVhdHVyZXNbaV0ucHJvcGVydGllc1tqb2luRmllbGRdOwogICAgICAgIHNvcnRlZEdlb2pzb25GZWF0dXJlc1tpXS5fX2tibkpvaW5lZE1ldHJpYyA9IG51bGw7CiAgICAgICAgdmFyIHBvc2l0aW9uID0gc29ydGVkTWV0cmljcy5sZW5ndGggPyBjb21wYXJlTGV4aWNvZ3JhcGhpY2FsbHkocHJvcGVydHksIHNvcnRlZE1ldHJpY3Nbal0udGVybSkgOiAtMTsKCiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAtMSkgey8vanVzdCBuZWVkIHRvIGN5Y2xlIG9uCiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gMCkgewogICAgICAgICAgc29ydGVkR2VvanNvbkZlYXR1cmVzW2ldLl9fa2JuSm9pbmVkTWV0cmljID0gc29ydGVkTWV0cmljc1tqXTsKICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAxKSB7CiAgICAgICAgICAvL25lZWRzIHRvIGNhdGNoIHVwCiAgICAgICAgICB3aGlsZSAoaiA8IHNvcnRlZE1ldHJpY3MubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciBuZXdUZXJtID0gc29ydGVkTWV0cmljc1tqXS50ZXJtOwogICAgICAgICAgICB2YXIgbmV3UG9zaXRpb24gPSBjb21wYXJlTGV4aWNvZ3JhcGhpY2FsbHkobmV3VGVybSwgcHJvcGVydHkpOwoKICAgICAgICAgICAgaWYgKG5ld1Bvc2l0aW9uID09PSAtMSkgey8vbm90IGZhciBlbm91Z2gKICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdQb3NpdGlvbiA9PT0gMCkgewogICAgICAgICAgICAgIHNvcnRlZEdlb2pzb25GZWF0dXJlc1tpXS5fX2tibkpvaW5lZE1ldHJpYyA9IHNvcnRlZE1ldHJpY3Nbal07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3UG9zaXRpb24gPT09IDEpIHsKICAgICAgICAgICAgICAvL3RvbyBmYXIhCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChqID09PSBzb3J0ZWRNZXRyaWNzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAvL2Fsd2F5cyBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBsYXN0IG1ldHJpYwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGorKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH1dKTsKCiAgZnVuY3Rpb24gQ2hvcm9wbGV0aExheWVyKG5hbWUsIGF0dHJpYnV0aW9uLCBmb3JtYXQsIHNob3dBbGxTaGFwZXMsIG1ldGEsIGxheWVyQ29uZmlnLCBzZXJ2aWNlU2V0dGluZ3MpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hvcm9wbGV0aExheWVyKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihDaG9yb3BsZXRoTGF5ZXIpLmNhbGwodGhpcykpOwogICAgX3RoaXMuX3NlcnZpY2VTZXR0aW5ncyA9IHNlcnZpY2VTZXR0aW5nczsKICAgIF90aGlzLl9tZXRyaWNzID0gbnVsbDsKICAgIF90aGlzLl9qb2luRmllbGQgPSBudWxsOwogICAgX3RoaXMuX2NvbG9yUmFtcCA9IF90cnVuY2F0ZWRfY29sb3JtYXBzLnRydW5jYXRlZENvbG9yTWFwc1tPYmplY3Qua2V5cyhfdHJ1bmNhdGVkX2NvbG9ybWFwcy50cnVuY2F0ZWRDb2xvck1hcHMpWzBdXS52YWx1ZTsKICAgIF90aGlzLl9saW5lV2VpZ2h0ID0gMTsKCiAgICBfdGhpcy5fdG9vbHRpcEZvcm1hdHRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICcnOwogICAgfTsKCiAgICBfdGhpcy5fYXR0cmlidXRpb24gPSBhdHRyaWJ1dGlvbjsKICAgIF90aGlzLl9ib3VuZHNPZkRhdGEgPSBudWxsOwogICAgX3RoaXMuX3Nob3dBbGxTaGFwZXMgPSBzaG93QWxsU2hhcGVzOwogICAgX3RoaXMuX2xheWVyTmFtZSA9IG5hbWU7CiAgICBfdGhpcy5fbGF5ZXJDb25maWcgPSBsYXllckNvbmZpZzsKICAgIF90aGlzLl9sZWFmbGV0TGF5ZXIgPSBfbGVhZmxldC5kZWZhdWx0Lmdlb0pzb24obnVsbCwgewogICAgICBvbkVhY2hGZWF0dXJlOiBmdW5jdGlvbiBvbkVhY2hGZWF0dXJlKGZlYXR1cmUsIGxheWVyKSB7CiAgICAgICAgbGF5ZXIub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMuZW1pdCgnc2VsZWN0JywgZmVhdHVyZS5wcm9wZXJ0aWVzW190aGlzLl9qb2luRmllbGRdKTsKICAgICAgICB9KTsKICAgICAgICB2YXIgbG9jYXRpb24gPSBudWxsOwogICAgICAgIGxheWVyLm9uKHsKICAgICAgICAgIG1vdXNlb3ZlcjogZnVuY3Rpb24gbW91c2VvdmVyKCkgewogICAgICAgICAgICB2YXIgdG9vbHRpcENvbnRlbnRzID0gX3RoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIoZmVhdHVyZSk7CgogICAgICAgICAgICBpZiAoIWxvY2F0aW9uKSB7CiAgICAgICAgICAgICAgdmFyIGxlYWZsZXRHZW9qc29uID0gX2xlYWZsZXQuZGVmYXVsdC5nZW9Kc29uKGZlYXR1cmUpOwoKICAgICAgICAgICAgICBsb2NhdGlvbiA9IGxlYWZsZXRHZW9qc29uLmdldEJvdW5kcygpLmdldENlbnRlcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpcy5lbWl0KCdzaG93VG9vbHRpcCcsIHsKICAgICAgICAgICAgICBjb250ZW50OiB0b29sdGlwQ29udGVudHMsCiAgICAgICAgICAgICAgcG9zaXRpb246IGxvY2F0aW9uCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwKICAgICAgICAgIG1vdXNlb3V0OiBmdW5jdGlvbiBtb3VzZW91dCgpIHsKICAgICAgICAgICAgX3RoaXMuZW1pdCgnaGlkZVRvb2x0aXAnKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwKICAgICAgc3R5bGU6IF90aGlzLl9tYWtlRW1wdHlTdHlsZUZ1bmN0aW9uKCkKICAgIH0pOwogICAgX3RoaXMuX2xvYWRlZCA9IGZhbHNlOwogICAgX3RoaXMuX2Vycm9yID0gZmFsc2U7CiAgICBfdGhpcy5faXNKb2luVmFsaWQgPSBmYWxzZTsKICAgIF90aGlzLl93aGVuRGF0YUxvYWRlZCA9IG5ldyBQcm9taXNlKAogICAgLyojX19QVVJFX18qLwogICAgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUocmVzb2x2ZSkgewogICAgICAgIHZhciBkYXRhLCBmZWF0dXJlQ29sbGVjdGlvbiwgZm9ybWF0VHlwZSwgZmVhdHVyZXMsIGVycm9yTWVzc2FnZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9tYWtlSnNvbkFqYXhDYWxsKCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICBmb3JtYXRUeXBlID0gZm9ybWF0OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQgJiYgZm9ybWF0LnR5cGUpIHsKICAgICAgICAgICAgICAgICAgZm9ybWF0VHlwZSA9IGZvcm1hdC50eXBlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZm9ybWF0VHlwZSA9ICdnZW9qc29uJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIShmb3JtYXRUeXBlID09PSAnZ2VvanNvbicpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmZWF0dXJlQ29sbGVjdGlvbiA9IGRhdGE7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgaWYgKCEoZm9ybWF0VHlwZSA9PT0gJ3RvcG9qc29uJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmZWF0dXJlcyA9IF9sb2Rhc2guZGVmYXVsdC5nZXQoZGF0YSwgJ29iamVjdHMuJyArIG1ldGEuZmVhdHVyZV9jb2xsZWN0aW9uX3BhdGgpOwogICAgICAgICAgICAgICAgZmVhdHVyZUNvbGxlY3Rpb24gPSB0b3BvanNvbi5mZWF0dXJlKGRhdGEsIGZlYXR1cmVzKTsgLy9jb252ZXJzaW9uIHRvIGdlb2pzb24KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihfaTE4bi5pMThuLnRyYW5zbGF0ZSgncmVnaW9uTWFwLmNob3JvcGxldGhMYXllci51bnJlY29nbml6ZWRGb3JtYXRFcnJvck1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5yZWNvZ25pemVkIGZvcm1hdCB7Zm9ybWF0VHlwZX0nLAogICAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgICBmb3JtYXRUeXBlOiBmb3JtYXRUeXBlCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIF90aGlzLl9zb3J0ZWRGZWF0dXJlcyA9IGZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzLnNsaWNlKCk7CgogICAgICAgICAgICAgICAgX3RoaXMuX3NvcnRGZWF0dXJlcygpOwoKICAgICAgICAgICAgICAgIGlmIChzaG93QWxsU2hhcGVzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLl9sZWFmbGV0TGF5ZXIuYWRkRGF0YShmZWF0dXJlQ29sbGVjdGlvbik7CiAgICAgICAgICAgICAgICB9IGVsc2Ugey8vd2UgbmVlZCB0byBkZWxheSBhZGRpbmcgdGhlIGRhdGEgdW50aWwgd2UgaGF2ZSBwZXJmb3JtZWQgdGhlIGpvaW4gYW5kIGtub3cgd2hpY2ggZmVhdHVyZXMKICAgICAgICAgICAgICAgICAgLy9zaG91bGQgYmUgZGlzcGxheWVkCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgX3RoaXMuX3NldFN0eWxlKCk7CgogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjM7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpcy5fZXJyb3IgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfY29udGV4dC50MC5zdGF0dXMgPT09IDQwNCkgewogICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgncmVnaW9uTWFwLmNob3JvcGxldGhMYXllci5kb3dubG9hZGluZ1ZlY3RvckRhdGE0MDRFcnJvck1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZXJ2ZXIgcmVzcG9uZGluZyB3aXRoIFwnNDA0XCcgd2hlbiBhdHRlbXB0aW5nIHRvIGZldGNoIHtuYW1lfS4gXApNYWtlIHN1cmUgdGhlIGZpbGUgZXhpc3RzIGF0IHRoYXQgbG9jYXRpb24uJywKICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3JlZ2lvbk1hcC5jaG9yb3BsZXRoTGF5ZXIuZG93bmxvYWRpbmdWZWN0b3JEYXRhRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2Fubm90IGRvd25sb2FkIHtuYW1lfSBmaWxlLiBQbGVhc2UgZW5zdXJlIHRoZSBcCkNPUlMgY29uZmlndXJhdGlvbiBvZiB0aGUgc2VydmVyIHBlcm1pdHMgcmVxdWVzdHMgZnJvbSB0aGUgS2liYW5hIGFwcGxpY2F0aW9uIG9uIHRoaXMgaG9zdC4nLAogICAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YUVycm9yTWVzc2FnZVRpdGxlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgZG93bmxvYWRpbmcgdmVjdG9yIGRhdGEnCiAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgMjNdXSk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKICAgIHJldHVybiBfdGhpczsKICB9IC8vVGhpcyBtZXRob2QgaXMgc3R1YmJlZCBpbiB0aGUgdGVzdHMgdG8gYXZvaWQgbmV0d29yayByZXF1ZXN0IGR1cmluZyB1bml0IHRlc3RzLgoKCiAgX2NyZWF0ZUNsYXNzKENob3JvcGxldGhMYXllciwgW3sKICAgIGtleTogIl9tYWtlSnNvbkFqYXhDYWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbWFrZUpzb25BamF4Q2FsbDIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHRoaXMuX3NlcnZpY2VTZXR0aW5ncy5nZXRKc29uRm9yUmVnaW9uTGF5ZXIodGhpcy5fbGF5ZXJDb25maWcpKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX21ha2VKc29uQWpheENhbGwoKSB7CiAgICAgICAgcmV0dXJuIF9tYWtlSnNvbkFqYXhDYWxsMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX21ha2VKc29uQWpheENhbGw7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJfaW52YWxpZGF0ZUpvaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnZhbGlkYXRlSm9pbigpIHsKICAgICAgdGhpcy5faXNKb2luVmFsaWQgPSBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZG9Jbm5lckpvaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0lubmVySm9pbigpIHsKICAgICAgQ2hvcm9wbGV0aExheWVyLl9kb0lubmVySm9pbih0aGlzLl9tZXRyaWNzLCB0aGlzLl9zb3J0ZWRGZWF0dXJlcywgdGhpcy5fam9pbkZpZWxkKTsKCiAgICAgIHRoaXMuX2lzSm9pblZhbGlkID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc2V0U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRTdHlsZSgpIHsKICAgICAgaWYgKHRoaXMuX2Vycm9yIHx8ICF0aGlzLl9sb2FkZWQgfHwgIXRoaXMuX21ldHJpY3MgfHwgIXRoaXMuX2pvaW5GaWVsZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLl9pc0pvaW5WYWxpZCkgewogICAgICAgIHRoaXMuX2RvSW5uZXJKb2luKCk7CgogICAgICAgIGlmICghdGhpcy5fc2hvd0FsbFNoYXBlcykgewogICAgICAgICAgdmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gewogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgICBmZWF0dXJlczogdGhpcy5fc29ydGVkRmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmUuX19rYm5Kb2luZWRNZXRyaWM7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9OwoKICAgICAgICAgIHRoaXMuX2xlYWZsZXRMYXllci5hZGREYXRhKGZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzdHlsZXIgPSB0aGlzLl9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpOwoKICAgICAgdGhpcy5fbGVhZmxldExheWVyLnNldFN0eWxlKHN0eWxlci5sZWFmbGV0U3R5bGVGdW5jdGlvbik7CgogICAgICBpZiAodGhpcy5fbWV0cmljcyAmJiB0aGlzLl9tZXRyaWNzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX2dldE1pbk1heCA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgICAgbWluID0gX2dldE1pbk1heC5taW4sCiAgICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgubWF4OwoKICAgICAgICB0aGlzLl9sZWdlbmRDb2xvcnMgPSBjb2xvclV0aWwuZ2V0TGVnZW5kQ29sb3JzKHRoaXMuX2NvbG9yUmFtcCk7CiAgICAgICAgdmFyIHF1YW50aXplRG9tYWluID0gbWluICE9PSBtYXggPyBbbWluLCBtYXhdIDogX2QuZGVmYXVsdC5zY2FsZS5xdWFudGl6ZSgpLmRvbWFpbigpOwogICAgICAgIHRoaXMuX2xlZ2VuZFF1YW50aXplciA9IF9kLmRlZmF1bHQuc2NhbGUucXVhbnRpemUoKS5kb21haW4ocXVhbnRpemVEb21haW4pLnJhbmdlKHRoaXMuX2xlZ2VuZENvbG9ycyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2JvdW5kc09mRGF0YSA9IHN0eWxlci5nZXRMZWFmbGV0Qm91bmRzKCk7CiAgICAgIHRoaXMuZW1pdCgnc3R5bGVDaGFuZ2VkJywgewogICAgICAgIG1pc21hdGNoZXM6IHN0eWxlci5nZXRNaXNtYXRjaGVzKCkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VXJsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVcmwoKSB7CiAgICAgIHJldHVybiB0aGlzLl9sYXllck5hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VG9vbHRpcEZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VG9vbHRpcEZvcm1hdHRlcih0b29sdGlwRm9ybWF0dGVyLCBmaWVsZEZvcm1hdHRlciwgZmllbGROYW1lLCBtZXRyaWNMYWJlbCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoZ2VvanNvbkZlYXR1cmUpIHsKICAgICAgICBpZiAoIV90aGlzMi5fbWV0cmljcykgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KCiAgICAgICAgdmFyIG1hdGNoID0gX3RoaXMyLl9tZXRyaWNzLmZpbmQoZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICAgICAgcmV0dXJuIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseShidWNrZXQudGVybSwgZ2VvanNvbkZlYXR1cmUucHJvcGVydGllc1tfdGhpczIuX2pvaW5GaWVsZF0pID09PSAwOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gdG9vbHRpcEZvcm1hdHRlcihtYXRjaCwgZmllbGRGb3JtYXR0ZXIsIGZpZWxkTmFtZSwgbWV0cmljTGFiZWwpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInNldEpvaW5GaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Sm9pbkZpZWxkKGpvaW5maWVsZCkgewogICAgICBpZiAoam9pbmZpZWxkID09PSB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2pvaW5GaWVsZCA9IGpvaW5maWVsZDsKCiAgICAgIHRoaXMuX3NvcnRGZWF0dXJlcygpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZUNob3JvcGxldGhMYXllckZvck5ld0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lQ2hvcm9wbGV0aExheWVyRm9yTmV3RGF0YShuYW1lLCBhdHRyaWJ1dGlvbiwgZm9ybWF0LCBzaG93QWxsRGF0YSwgbWV0YSwgbGF5ZXJDb25maWcsIHNlcnZpY2VTZXR0aW5ncykgewogICAgICB2YXIgY2xvbmVkTGF5ZXIgPSBuZXcgQ2hvcm9wbGV0aExheWVyKG5hbWUsIGF0dHJpYnV0aW9uLCBmb3JtYXQsIHNob3dBbGxEYXRhLCBtZXRhLCBsYXllckNvbmZpZywgc2VydmljZVNldHRpbmdzKTsKICAgICAgY2xvbmVkTGF5ZXIuc2V0Sm9pbkZpZWxkKHRoaXMuX2pvaW5GaWVsZCk7CiAgICAgIGNsb25lZExheWVyLnNldENvbG9yUmFtcCh0aGlzLl9jb2xvclJhbXApOwogICAgICBjbG9uZWRMYXllci5zZXRMaW5lV2VpZ2h0KHRoaXMuX2xpbmVXZWlnaHQpOwogICAgICBjbG9uZWRMYXllci5zZXRUb29sdGlwRm9ybWF0dGVyKHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIpOwoKICAgICAgaWYgKHRoaXMuX21ldHJpY3MpIHsKICAgICAgICBjbG9uZWRMYXllci5zZXRNZXRyaWNzKHRoaXMuX21ldHJpY3MsIHRoaXMuX3ZhbHVlRm9ybWF0dGVyLCB0aGlzLl9tZXRyaWNUaXRsZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjbG9uZWRMYXllcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc29ydEZlYXR1cmVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc29ydEZlYXR1cmVzKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9zb3J0ZWRGZWF0dXJlcyAmJiB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICB0aGlzLl9zb3J0ZWRGZWF0dXJlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICB2YXIgdGVybUEgPSBhLnByb3BlcnRpZXNbX3RoaXMzLl9qb2luRmllbGRdOwogICAgICAgICAgdmFyIHRlcm1CID0gYi5wcm9wZXJ0aWVzW190aGlzMy5fam9pbkZpZWxkXTsKICAgICAgICAgIHJldHVybiBjb21wYXJlTGV4aWNvZ3JhcGhpY2FsbHkodGVybUEsIHRlcm1CKTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy5faW52YWxpZGF0ZUpvaW4oKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIndoZW5EYXRhTG9hZGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB3aGVuRGF0YUxvYWRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3doZW5EYXRhTG9hZGVkOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE1ldHJpY3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1ldHJpY3MobWV0cmljcywgZmllbGRGb3JtYXR0ZXIsIG1ldHJpY1RpdGxlKSB7CiAgICAgIHRoaXMuX21ldHJpY3MgPSBtZXRyaWNzLnNsaWNlKCk7CiAgICAgIHRoaXMuX3ZhbHVlRm9ybWF0dGVyID0gZmllbGRGb3JtYXR0ZXI7CiAgICAgIHRoaXMuX21ldHJpY1RpdGxlID0gbWV0cmljVGl0bGU7CgogICAgICB0aGlzLl9tZXRyaWNzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gY29tcGFyZUxleGljb2dyYXBoaWNhbGx5KGEudGVybSwgYi50ZXJtKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9pbnZhbGlkYXRlSm9pbigpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDb2xvclJhbXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbG9yUmFtcChjb2xvclJhbXApIHsKICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGNvbG9yUmFtcCwgdGhpcy5fY29sb3JSYW1wKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fY29sb3JSYW1wID0gY29sb3JSYW1wOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRMaW5lV2VpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMaW5lV2VpZ2h0KGxpbmVXZWlnaHQpIHsKICAgICAgaWYgKHRoaXMuX2xpbmVXZWlnaHQgPT09IGxpbmVXZWlnaHQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2xpbmVXZWlnaHQgPSBsaW5lV2VpZ2h0OwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjYW5SZXVzZUluc3RhbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlKG5hbWUsIHNob3dBbGxTaGFwZXMpIHsKICAgICAgcmV0dXJuIHRoaXMuX2xheWVyTmFtZSA9PT0gbmFtZSAmJiB0aGlzLl9zaG93QWxsU2hhcGVzID09PSBzaG93QWxsU2hhcGVzOwogICAgfQogIH0sIHsKICAgIGtleTogImNhblJldXNlSW5zdGFuY2VGb3JOZXdNZXRyaWNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlRm9yTmV3TWV0cmljcyhuYW1lLCBzaG93QWxsU2hhcGVzLCBuZXdNZXRyaWNzKSB7CiAgICAgIGlmICh0aGlzLl9sYXllck5hbWUgIT09IG5hbWUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChzaG93QWxsU2hhcGVzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dBbGxTaGFwZXMgPT09IHNob3dBbGxTaGFwZXM7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5fbWV0cmljcykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGN1cnJlbnRLZXlzID0gT2JqZWN0LmtleXModGhpcy5fbWV0cmljcyk7CiAgICAgIHZhciBuZXdLZXlzID0gT2JqZWN0LmtleXMobmV3TWV0cmljcyk7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChjdXJyZW50S2V5cywgbmV3S2V5cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Qm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb3VuZHMoKSB7CiAgICAgIHZhciBib3VuZHMgPSBfZ2V0KF9nZXRQcm90b3R5cGVPZihDaG9yb3BsZXRoTGF5ZXIucHJvdG90eXBlKSwgImdldEJvdW5kcyIsIHRoaXMpLmNhbGwodGhpcyk7CgogICAgICByZXR1cm4gdGhpcy5fYm91bmRzT2ZEYXRhID8gdGhpcy5fYm91bmRzT2ZEYXRhIDogYm91bmRzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGVuZExlZ2VuZENvbnRlbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRMZWdlbmRDb250ZW50cyhqcXVlcnlEaXYpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuX2xlZ2VuZENvbG9ycyB8fCAhdGhpcy5fbGVnZW5kUXVhbnRpemVyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGl0bGVUZXh0ID0gdGhpcy5fbWV0cmljVGl0bGU7CiAgICAgIHZhciAkdGl0bGUgPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGRpdj4nKS5hZGRDbGFzcygndmlzTWFwTGVnZW5kX190aXRsZScpLnRleHQodGl0bGVUZXh0KTsKICAgICAganF1ZXJ5RGl2LmFwcGVuZCgkdGl0bGUpOwoKICAgICAgdGhpcy5fbGVnZW5kQ29sb3JzLmZvckVhY2goZnVuY3Rpb24gKGNvbG9yKSB7CiAgICAgICAgdmFyIGxhYmVsVGV4dCA9IF90aGlzNC5fbGVnZW5kUXVhbnRpemVyLmludmVydEV4dGVudChjb2xvcikubWFwKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQuX3ZhbHVlRm9ybWF0dGVyLmNvbnZlcnQodmFsKTsKICAgICAgICB9KS5qb2luKCcg4oCTwqAnKTsKCiAgICAgICAgdmFyIGxhYmVsID0gKDAsIF9qcXVlcnkuZGVmYXVsdCkoJzxkaXY+Jyk7CiAgICAgICAgdmFyIGljb24gPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGk+JykuY3NzKHsKICAgICAgICAgIGJhY2tncm91bmQ6IGNvbG9yLAogICAgICAgICAgJ2JvcmRlci1jb2xvcic6IG1ha2VDb2xvckRhcmtlcihjb2xvcikKICAgICAgICB9KTsKICAgICAgICB2YXIgdGV4dCA9ICgwLCBfanF1ZXJ5LmRlZmF1bHQpKCc8c3Bhbj4nKS50ZXh0KGxhYmVsVGV4dCk7CiAgICAgICAgbGFiZWwuYXBwZW5kKGljb24pOwogICAgICAgIGxhYmVsLmFwcGVuZCh0ZXh0KTsKICAgICAgICBqcXVlcnlEaXYuYXBwZW5kKGxhYmVsKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlRW1wdHlTdHlsZUZ1bmN0aW9uKCkgewogICAgICB2YXIgZW1wdHlTdHlsZSA9IF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIEVNUFRZX1NUWUxFLCB7CiAgICAgICAgd2VpZ2h0OiB0aGlzLl9saW5lV2VpZ2h0CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZW1wdHlTdHlsZTsKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfbWFrZUNob3JvcGxldGhTdHlsZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgZW1wdHlTdHlsZSA9IHRoaXMuX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24oKTsKCiAgICAgIGlmICh0aGlzLl9tZXRyaWNzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsZWFmbGV0U3R5bGVGdW5jdGlvbjogZnVuY3Rpb24gbGVhZmxldFN0eWxlRnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgfSwKICAgICAgICAgIGdldExlYWZsZXRCb3VuZHM6IGZ1bmN0aW9uIGdldExlYWZsZXRCb3VuZHMoKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBfZ2V0TWluTWF4MiA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgIG1pbiA9IF9nZXRNaW5NYXgyLm1pbiwKICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgyLm1heDsKCiAgICAgIHZhciBib3VuZHNPZkFsbEZlYXR1cmVzID0gbmV3IF9sZWFmbGV0LmRlZmF1bHQuTGF0TG5nQm91bmRzKCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGVhZmxldFN0eWxlRnVuY3Rpb246IGZ1bmN0aW9uIGxlYWZsZXRTdHlsZUZ1bmN0aW9uKGdlb2pzb25GZWF0dXJlKSB7CiAgICAgICAgICB2YXIgbWF0Y2ggPSBnZW9qc29uRmVhdHVyZS5fX2tibkpvaW5lZE1ldHJpYzsKCiAgICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGJvdW5kc09mRmVhdHVyZSA9IF9sZWFmbGV0LmRlZmF1bHQuZ2VvSnNvbihnZW9qc29uRmVhdHVyZSkuZ2V0Qm91bmRzKCk7CgogICAgICAgICAgYm91bmRzT2ZBbGxGZWF0dXJlcy5leHRlbmQoYm91bmRzT2ZGZWF0dXJlKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGZpbGxDb2xvcjogZ2V0Q2hvcm9wbGV0aENvbG9yKG1hdGNoLnZhbHVlLCBtaW4sIG1heCwgX3RoaXM1Ll9jb2xvclJhbXApLAogICAgICAgICAgICB3ZWlnaHQ6IF90aGlzNS5fbGluZVdlaWdodCwKICAgICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgICAgY29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjcKICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogc2hvdWxkIG5vdCBiZSBjYWxsZWQgdW50aWwgZ2V0TGVhZmxldFN0eWxlRnVuY3Rpb24gaGFzIGJlZW4gY2FsbGVkCiAgICAgICAgICogQHJldHVybiB7QXJyYXl9CiAgICAgICAgICovCiAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgIHZhciBtaXNtYXRjaGVzID0gX3RoaXM1Ll9tZXRyaWNzLnNsaWNlKCk7CgogICAgICAgICAgX3RoaXM1Ll9zb3J0ZWRGZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IG1pc21hdGNoZXMuaW5kZXhPZihmZWF0dXJlLl9fa2JuSm9pbmVkTWV0cmljKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgbWlzbWF0Y2hlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gbWlzbWF0Y2hlcy5tYXAoZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgcmV0dXJuIGIudGVybTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0TGVhZmxldEJvdW5kczogZnVuY3Rpb24gZ2V0TGVhZmxldEJvdW5kcygpIHsKICAgICAgICAgIHJldHVybiBib3VuZHNPZkFsbEZlYXR1cmVzLmlzVmFsaWQoKSA/IGJvdW5kc09mQWxsRmVhdHVyZXMgOiBudWxsOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDaG9yb3BsZXRoTGF5ZXI7Cn0oX2tpYmFuYV9tYXBfbGF5ZXIuS2liYW5hTWFwTGF5ZXIpOyAvL2xleGljb2dyYXBoaWMgY29tcGFyZQoKCmV4cG9ydHMuZGVmYXVsdCA9IENob3JvcGxldGhMYXllcjsKCmZ1bmN0aW9uIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseSh0ZXJtQSwgdGVybUIpIHsKICB0ZXJtQSA9IHR5cGVvZiB0ZXJtQSA9PT0gJ3N0cmluZycgPyB0ZXJtQSA6IHRlcm1BLnRvU3RyaW5nKCk7CiAgdGVybUIgPSB0eXBlb2YgdGVybUIgPT09ICdzdHJpbmcnID8gdGVybUIgOiB0ZXJtQi50b1N0cmluZygpOwogIHJldHVybiB0ZXJtQS5sb2NhbGVDb21wYXJlKHRlcm1CKTsKfQoKZnVuY3Rpb24gbWFrZUNvbG9yRGFya2VyKGNvbG9yKSB7CiAgdmFyIGFtb3VudCA9IDEuMzsgLy9tYWdpYyBudW1iZXIsIGNhcnJ5IG92ZXIgZnJvbSBlYXJsaWVyCgogIHJldHVybiBfZC5kZWZhdWx0LmhjbChjb2xvcikuZGFya2VyKGFtb3VudCkudG9TdHJpbmcoKTsKfQoKZnVuY3Rpb24gZ2V0TWluTWF4KGRhdGEpIHsKICB2YXIgbWluID0gZGF0YVswXS52YWx1ZTsKICB2YXIgbWF4ID0gZGF0YVswXS52YWx1ZTsKCiAgZm9yICh2YXIgaSA9IDE7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSAxKSB7CiAgICBtaW4gPSBNYXRoLm1pbihkYXRhW2ldLnZhbHVlLCBtaW4pOwogICAgbWF4ID0gTWF0aC5tYXgoZGF0YVtpXS52YWx1ZSwgbWF4KTsKICB9CgogIHJldHVybiB7CiAgICBtaW46IG1pbiwKICAgIG1heDogbWF4CiAgfTsKfQoKZnVuY3Rpb24gZ2V0Q2hvcm9wbGV0aENvbG9yKHZhbHVlLCBtaW4sIG1heCwgY29sb3JSYW1wKSB7CiAgaWYgKG1pbiA9PT0gbWF4KSB7CiAgICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgY29sb3JSYW1wLmxlbmd0aCAtIDEpOwogIH0KCiAgdmFyIGZyYWN0aW9uID0gKHZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pOwogIHZhciBpbmRleCA9IE1hdGgucm91bmQoY29sb3JSYW1wLmxlbmd0aCAqIGZyYWN0aW9uKSAtIDE7CiAgdmFyIGkgPSBNYXRoLm1heChNYXRoLm1pbihjb2xvclJhbXAubGVuZ3RoIC0gMSwgaW5kZXgpLCAwKTsKICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgaSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cy5kZWZhdWx0Ow=="},null]}