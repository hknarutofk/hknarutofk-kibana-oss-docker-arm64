{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/data/public/filter/filter_manager/filter_manager.js","dependencies":[{"path":"src/legacy/core_plugins/data/public/filter/filter_manager/filter_manager.js","mtime":1572296409404},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkZpbHRlck1hbmFnZXIgPSB2b2lkIDA7Cgp2YXIgX2VzUXVlcnkgPSByZXF1aXJlKCJAa2JuL2VzLXF1ZXJ5Iik7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9yeGpzID0gcmVxdWlyZSgicnhqcyIpOwoKdmFyIF9jb21wYXJlX2ZpbHRlcnMgPSByZXF1aXJlKCIuL2xpYi9jb21wYXJlX2ZpbHRlcnMiKTsKCnZhciBfbWFwX2FuZF9mbGF0dGVuX2ZpbHRlcnMgPSByZXF1aXJlKCIuL2xpYi9tYXBfYW5kX2ZsYXR0ZW5fZmlsdGVycyIpOwoKdmFyIF91bmlxX2ZpbHRlcnMgPSByZXF1aXJlKCIuL2xpYi91bmlxX2ZpbHRlcnMiKTsKCnZhciBfZXh0cmFjdF90aW1lX2ZpbHRlciA9IHJlcXVpcmUoIi4vbGliL2V4dHJhY3RfdGltZV9maWx0ZXIiKTsKCnZhciBfY2hhbmdlX3RpbWVfZmlsdGVyID0gcmVxdWlyZSgiLi9saWIvY2hhbmdlX3RpbWVfZmlsdGVyIik7Cgp2YXIgX29ubHlfZGlzYWJsZWQgPSByZXF1aXJlKCIuL2xpYi9vbmx5X2Rpc2FibGVkIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgRmlsdGVyTWFuYWdlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEZpbHRlck1hbmFnZXIoaW5kZXhQYXR0ZXJucywgdWlTZXR0aW5ncykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZpbHRlck1hbmFnZXIpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaW5kZXhQYXR0ZXJucyIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJmaWx0ZXJzIiwgW10pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAidXBkYXRlZCQiLCBuZXcgX3J4anMuU3ViamVjdCgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImZldGNoJCIsIG5ldyBfcnhqcy5TdWJqZWN0KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAidWlTZXR0aW5ncyIsIHZvaWQgMCk7CgogICAgdGhpcy5pbmRleFBhdHRlcm5zID0gaW5kZXhQYXR0ZXJuczsKICAgIHRoaXMudWlTZXR0aW5ncyA9IHVpU2V0dGluZ3M7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRmlsdGVyTWFuYWdlciwgW3sKICAgIGtleTogIm1lcmdlSW5jb21pbmdGaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtZXJnZUluY29taW5nRmlsdGVycyhwYXJ0aXRpb25lZEZpbHRlcnMpIHsKICAgICAgdmFyIGdsb2JhbEZpbHRlcnMgPSBwYXJ0aXRpb25lZEZpbHRlcnMuZ2xvYmFsRmlsdGVyczsKICAgICAgdmFyIGFwcEZpbHRlcnMgPSBwYXJ0aXRpb25lZEZpbHRlcnMuYXBwRmlsdGVyczsgLy8gZXhpc3RpbmcgZ2xvYmFsRmlsdGVycyBzaG91bGQgYmUgbXV0YXRlZCBieSBhcHBGaWx0ZXJzCgogICAgICBfbG9kYXNoLmRlZmF1bHQuZWFjaChhcHBGaWx0ZXJzLCBmdW5jdGlvbiAoZmlsdGVyLCBpKSB7CiAgICAgICAgdmFyIG1hdGNoID0gX2xvZGFzaC5kZWZhdWx0LmZpbmQoZ2xvYmFsRmlsdGVycywgZnVuY3Rpb24gKGdsb2JhbEZpbHRlcikgewogICAgICAgICAgcmV0dXJuICgwLCBfY29tcGFyZV9maWx0ZXJzLmNvbXBhcmVGaWx0ZXJzKShnbG9iYWxGaWx0ZXIsIGZpbHRlcik7CiAgICAgICAgfSk7IC8vIG5vIG1hdGNoLCBkbyBub3RoaW5nCgoKICAgICAgICBpZiAoIW1hdGNoKSByZXR1cm47IC8vIG1hdGNoaW5nIGZpbHRlciBpbiBnbG9iYWxTdGF0ZSwgdXBkYXRlIGdsb2JhbCBhbmQgcmVtb3ZlIGZyb20gYXBwU3RhdGUKCiAgICAgICAgX2xvZGFzaC5kZWZhdWx0LmFzc2lnbihtYXRjaC5tZXRhLCBmaWx0ZXIubWV0YSk7CgogICAgICAgIGFwcEZpbHRlcnMuc3BsaWNlKGksIDEpOwogICAgICB9KTsKCiAgICAgIHJldHVybiBGaWx0ZXJNYW5hZ2VyLm1lcmdlRmlsdGVycyhhcHBGaWx0ZXJzLCBnbG9iYWxGaWx0ZXJzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVTdGF0ZVVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlU3RhdGVVcGRhdGUobmV3RmlsdGVycykgewogICAgICAvLyBnbG9iYWwgZmlsdGVycyBzaG91bGQgYWx3YXlzIGJlIGZpcnN0CiAgICAgIG5ld0ZpbHRlcnMuc29ydChmdW5jdGlvbiAoX3JlZiwgX3JlZjIpIHsKICAgICAgICB2YXIgYSA9IF9yZWYuJHN0YXRlOwogICAgICAgIHZhciBiID0gX3JlZjIuJHN0YXRlOwogICAgICAgIHJldHVybiBhLnN0b3JlID09PSBfZXNRdWVyeS5GaWx0ZXJTdGF0ZVN0b3JlLkdMT0JBTF9TVEFURSAmJiBiLnN0b3JlICE9PSBfZXNRdWVyeS5GaWx0ZXJTdGF0ZVN0b3JlLkdMT0JBTF9TVEFURSA/IC0xIDogMTsKICAgICAgfSk7CiAgICAgIHZhciBmaWx0ZXJzVXBkYXRlZCA9ICFfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbCh0aGlzLmZpbHRlcnMsIG5ld0ZpbHRlcnMpOwogICAgICB2YXIgdXBkYXRlZE9ubHlEaXNhYmxlZEZpbHRlcnMgPSAoMCwgX29ubHlfZGlzYWJsZWQub25seURpc2FibGVkRmlsdGVyc0NoYW5nZWQpKG5ld0ZpbHRlcnMsIHRoaXMuZmlsdGVycyk7CiAgICAgIHRoaXMuZmlsdGVycyA9IG5ld0ZpbHRlcnM7CgogICAgICBpZiAoZmlsdGVyc1VwZGF0ZWQpIHsKICAgICAgICB0aGlzLnVwZGF0ZWQkLm5leHQoKTsKCiAgICAgICAgaWYgKCF1cGRhdGVkT25seURpc2FibGVkRmlsdGVycykgewogICAgICAgICAgdGhpcy5mZXRjaCQubmV4dCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyogR2V0dGVycyAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRGaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWx0ZXJzKCkgewogICAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LmNsb25lRGVlcCh0aGlzLmZpbHRlcnMpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEFwcEZpbHRlcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFwcEZpbHRlcnMoKSB7CiAgICAgIHZhciBfdGhpcyRnZXRQYXJ0aXRpb25lZEYgPSB0aGlzLmdldFBhcnRpdGlvbmVkRmlsdGVycygpLAogICAgICAgICAgYXBwRmlsdGVycyA9IF90aGlzJGdldFBhcnRpdGlvbmVkRi5hcHBGaWx0ZXJzOwoKICAgICAgcmV0dXJuIGFwcEZpbHRlcnM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0R2xvYmFsRmlsdGVycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R2xvYmFsRmlsdGVycygpIHsKICAgICAgdmFyIF90aGlzJGdldFBhcnRpdGlvbmVkRjIgPSB0aGlzLmdldFBhcnRpdGlvbmVkRmlsdGVycygpLAogICAgICAgICAgZ2xvYmFsRmlsdGVycyA9IF90aGlzJGdldFBhcnRpdGlvbmVkRjIuZ2xvYmFsRmlsdGVyczsKCiAgICAgIHJldHVybiBnbG9iYWxGaWx0ZXJzOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhcnRpdGlvbmVkRmlsdGVycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UGFydGl0aW9uZWRGaWx0ZXJzKCkgewogICAgICByZXR1cm4gRmlsdGVyTWFuYWdlci5wYXJ0aXRpb25GaWx0ZXJzKHRoaXMuZ2V0RmlsdGVycygpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRVcGRhdGVzJCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VXBkYXRlcyQoKSB7CiAgICAgIHJldHVybiB0aGlzLnVwZGF0ZWQkLmFzT2JzZXJ2YWJsZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZldGNoZXMkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGZXRjaGVzJCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gkLmFzT2JzZXJ2YWJsZSgpOwogICAgfQogICAgLyogU2V0dGVycyAqLwoKICB9LCB7CiAgICBrZXk6ICJhZGRGaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfYWRkRmlsdGVycyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZmlsdGVycywgcGluRmlsdGVyU3RhdHVzKSB7CiAgICAgICAgdmFyIF9jdXJyZW50RmlsdGVycyRhcHBGaSwgX2N1cnJlbnRGaWx0ZXJzJGdsb2JhOwoKICAgICAgICB2YXIgc3RvcmUsIG1hcHBlZEZpbHRlcnMsIG5ld1BhcnRpdGlvbmVkRmlsdGVycywgY3VycmVudEZpbHRlcnMsIG5ld0ZpbHRlcnM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGZpbHRlcnMpKSB7CiAgICAgICAgICAgICAgICAgIGZpbHRlcnMgPSBbZmlsdGVyc107CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoZmlsdGVycy5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgaWYgKHBpbkZpbHRlclN0YXR1cyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgIHBpbkZpbHRlclN0YXR1cyA9IHRoaXMudWlTZXR0aW5ncy5nZXQoJ2ZpbHRlcnM6cGlubmVkQnlEZWZhdWx0Jyk7CiAgICAgICAgICAgICAgICB9IC8vIFNldCB0aGUgc3RvcmUgb2YgYWxsIGZpbHRlcnMuIEZvciBub3cuCiAgICAgICAgICAgICAgICAvLyBJbiB0aGUgZnV0dXJlLCBhbGwgZmlsdGVycyBzaG91bGQgY29tZSBpbiB3aXRoIGZpbHRlciBzdGF0ZSBzdG9yZSBhbHJlYWR5IHNldC4KCgogICAgICAgICAgICAgICAgc3RvcmUgPSBwaW5GaWx0ZXJTdGF0dXMgPyBfZXNRdWVyeS5GaWx0ZXJTdGF0ZVN0b3JlLkdMT0JBTF9TVEFURSA6IF9lc1F1ZXJ5LkZpbHRlclN0YXRlU3RvcmUuQVBQX1NUQVRFOwogICAgICAgICAgICAgICAgRmlsdGVyTWFuYWdlci5zZXRGaWx0ZXJzU3RvcmUoZmlsdGVycywgc3RvcmUpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9tYXBfYW5kX2ZsYXR0ZW5fZmlsdGVycy5tYXBBbmRGbGF0dGVuRmlsdGVycykodGhpcy5pbmRleFBhdHRlcm5zLCBmaWx0ZXJzKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgbWFwcGVkRmlsdGVycyA9IF9jb250ZXh0LnNlbnQ7IC8vIFRoaXMgaXMgd2hlcmUgd2UgYWRkIG5ldyBmaWx0ZXJzIHRvIHRoZSBjb3JyZWN0IHBsYWNlIChhcHAgXCBnbG9iYWwpCgogICAgICAgICAgICAgICAgbmV3UGFydGl0aW9uZWRGaWx0ZXJzID0gRmlsdGVyTWFuYWdlci5wYXJ0aXRpb25GaWx0ZXJzKG1hcHBlZEZpbHRlcnMpOwogICAgICAgICAgICAgICAgY3VycmVudEZpbHRlcnMgPSB0aGlzLmdldFBhcnRpdGlvbmVkRmlsdGVycygpOwoKICAgICAgICAgICAgICAgIChfY3VycmVudEZpbHRlcnMkYXBwRmkgPSBjdXJyZW50RmlsdGVycy5hcHBGaWx0ZXJzKS5wdXNoLmFwcGx5KF9jdXJyZW50RmlsdGVycyRhcHBGaSwgX3RvQ29uc3VtYWJsZUFycmF5KG5ld1BhcnRpdGlvbmVkRmlsdGVycy5hcHBGaWx0ZXJzKSk7CgogICAgICAgICAgICAgICAgKF9jdXJyZW50RmlsdGVycyRnbG9iYSA9IGN1cnJlbnRGaWx0ZXJzLmdsb2JhbEZpbHRlcnMpLnB1c2guYXBwbHkoX2N1cnJlbnRGaWx0ZXJzJGdsb2JhLCBfdG9Db25zdW1hYmxlQXJyYXkobmV3UGFydGl0aW9uZWRGaWx0ZXJzLmdsb2JhbEZpbHRlcnMpKTsKCiAgICAgICAgICAgICAgICBuZXdGaWx0ZXJzID0gdGhpcy5tZXJnZUluY29taW5nRmlsdGVycyhjdXJyZW50RmlsdGVycyk7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVN0YXRlVXBkYXRlKG5ld0ZpbHRlcnMpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGFkZEZpbHRlcnMoX3gsIF94MikgewogICAgICAgIHJldHVybiBfYWRkRmlsdGVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYWRkRmlsdGVyczsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInNldEZpbHRlcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9zZXRGaWx0ZXJzID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIobmV3RmlsdGVycykgewogICAgICAgIHZhciBtYXBwZWRGaWx0ZXJzLCBuZXdQYXJ0aXRpb25lZEZpbHRlcnMsIG1lcmdlZEZpbHRlcnM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX21hcF9hbmRfZmxhdHRlbl9maWx0ZXJzLm1hcEFuZEZsYXR0ZW5GaWx0ZXJzKSh0aGlzLmluZGV4UGF0dGVybnMsIG5ld0ZpbHRlcnMpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBtYXBwZWRGaWx0ZXJzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBuZXdQYXJ0aXRpb25lZEZpbHRlcnMgPSBGaWx0ZXJNYW5hZ2VyLnBhcnRpdGlvbkZpbHRlcnMobWFwcGVkRmlsdGVycyk7CiAgICAgICAgICAgICAgICBtZXJnZWRGaWx0ZXJzID0gdGhpcy5tZXJnZUluY29taW5nRmlsdGVycyhuZXdQYXJ0aXRpb25lZEZpbHRlcnMpOwogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTdGF0ZVVwZGF0ZShtZXJnZWRGaWx0ZXJzKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gc2V0RmlsdGVycyhfeDMpIHsKICAgICAgICByZXR1cm4gX3NldEZpbHRlcnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNldEZpbHRlcnM7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJyZW1vdmVGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUZpbHRlcihmaWx0ZXIpIHsKICAgICAgdmFyIGZpbHRlckluZGV4ID0gX2xvZGFzaC5kZWZhdWx0LmZpbmRJbmRleCh0aGlzLmZpbHRlcnMsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGl0ZW0ubWV0YSwgZmlsdGVyLm1ldGEpICYmIF9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGl0ZW0ucXVlcnksIGZpbHRlci5xdWVyeSk7CiAgICAgIH0pOwoKICAgICAgaWYgKGZpbHRlckluZGV4ID49IDApIHsKICAgICAgICB2YXIgbmV3RmlsdGVycyA9IF9sb2Rhc2guZGVmYXVsdC5jbG9uZURlZXAodGhpcy5maWx0ZXJzKTsKCiAgICAgICAgbmV3RmlsdGVycy5zcGxpY2UoZmlsdGVySW5kZXgsIDEpOwogICAgICAgIHRoaXMuaGFuZGxlU3RhdGVVcGRhdGUobmV3RmlsdGVycyk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVBbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZW1vdmVBbGwgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0RmlsdGVycyhbXSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHJlbW92ZUFsbCgpIHsKICAgICAgICByZXR1cm4gX3JlbW92ZUFsbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcmVtb3ZlQWxsOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYWRkRmlsdGVyc0FuZENoYW5nZVRpbWVGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hZGRGaWx0ZXJzQW5kQ2hhbmdlVGltZUZpbHRlciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGZpbHRlcnMpIHsKICAgICAgICB2YXIgdGltZUZpbHRlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfZXh0cmFjdF90aW1lX2ZpbHRlci5leHRyYWN0VGltZUZpbHRlcikodGhpcy5pbmRleFBhdHRlcm5zLCBmaWx0ZXJzKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdGltZUZpbHRlciA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgaWYgKHRpbWVGaWx0ZXIpICgwLCBfY2hhbmdlX3RpbWVfZmlsdGVyLmNoYW5nZVRpbWVGaWx0ZXIpKHRpbWVGaWx0ZXIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHRoaXMuYWRkRmlsdGVycyhmaWx0ZXJzLmZpbHRlcihmdW5jdGlvbiAoZmlsdGVyKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXIgIT09IHRpbWVGaWx0ZXI7CiAgICAgICAgICAgICAgICB9KSkpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBhZGRGaWx0ZXJzQW5kQ2hhbmdlVGltZUZpbHRlcihfeDQpIHsKICAgICAgICByZXR1cm4gX2FkZEZpbHRlcnNBbmRDaGFuZ2VUaW1lRmlsdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhZGRGaWx0ZXJzQW5kQ2hhbmdlVGltZUZpbHRlcjsKICAgIH0oKQogIH1dLCBbewogICAga2V5OiAibWVyZ2VGaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtZXJnZUZpbHRlcnMoYXBwRmlsdGVycywgZ2xvYmFsRmlsdGVycykgewogICAgICByZXR1cm4gKDAsIF91bmlxX2ZpbHRlcnMudW5pcUZpbHRlcnMpKGFwcEZpbHRlcnMucmV2ZXJzZSgpLmNvbmNhdChnbG9iYWxGaWx0ZXJzLnJldmVyc2UoKSkpLnJldmVyc2UoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXJ0aXRpb25GaWx0ZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJ0aXRpb25GaWx0ZXJzKGZpbHRlcnMpIHsKICAgICAgdmFyIF8kcGFydGl0aW9uID0gX2xvZGFzaC5kZWZhdWx0LnBhcnRpdGlvbihmaWx0ZXJzLCBfZXNRdWVyeS5pc0ZpbHRlclBpbm5lZCksCiAgICAgICAgICBfJHBhcnRpdGlvbjIgPSBfc2xpY2VkVG9BcnJheShfJHBhcnRpdGlvbiwgMiksCiAgICAgICAgICBnbG9iYWxGaWx0ZXJzID0gXyRwYXJ0aXRpb24yWzBdLAogICAgICAgICAgYXBwRmlsdGVycyA9IF8kcGFydGl0aW9uMlsxXTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgZ2xvYmFsRmlsdGVyczogZ2xvYmFsRmlsdGVycywKICAgICAgICBhcHBGaWx0ZXJzOiBhcHBGaWx0ZXJzCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RmlsdGVyc1N0b3JlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGaWx0ZXJzU3RvcmUoZmlsdGVycywgc3RvcmUpIHsKICAgICAgX2xvZGFzaC5kZWZhdWx0Lm1hcChmaWx0ZXJzLCBmdW5jdGlvbiAoZmlsdGVyKSB7CiAgICAgICAgLy8gT3ZlcnJpZGUgc3RhdHVzIG9ubHkgZm9yIGZpbHRlcnMgdGhhdCBkaWRuJ3QgaGF2ZSBzdGF0ZSBpbiB0aGUgZmlyc3QgcGxhY2UuCiAgICAgICAgaWYgKGZpbHRlci4kc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZmlsdGVyLiRzdGF0ZSA9IHsKICAgICAgICAgICAgc3RvcmU6IHN0b3JlCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRmlsdGVyTWFuYWdlcjsKfSgpOwoKZXhwb3J0cy5GaWx0ZXJNYW5hZ2VyID0gRmlsdGVyTWFuYWdlcjs="},null]}