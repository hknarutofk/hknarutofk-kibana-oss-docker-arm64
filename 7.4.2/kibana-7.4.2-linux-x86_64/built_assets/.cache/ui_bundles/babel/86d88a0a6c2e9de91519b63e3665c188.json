{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/vis/map/service_settings.js","dependencies":[{"path":"src/legacy/ui/public/vis/map/service_settings.js","mtime":1572296413240},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9tb2R1bGVzID0gcmVxdWlyZSgiLi4vLi4vbW9kdWxlcyIpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfbWFya2Rvd25JdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibWFya2Rvd24taXQiKSk7Cgp2YXIgX29yaWdpbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvcmVfcGx1Z2lucy90aWxlX21hcC9jb21tb24vb3JpZ2luIik7Cgp2YXIgX2Vtc19jbGllbnQgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb3JlX3BsdWdpbnMvdGlsZV9tYXAvY29tbW9uL2Vtc19jbGllbnQiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKcmVxdWlyZSgiYW5ndWxhci1zYW5pdGl6ZSIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIG1hcmtkb3duSXQgPSBuZXcgX21hcmtkb3duSXQuZGVmYXVsdCh7CiAgaHRtbDogZmFsc2UsCiAgbGlua2lmeTogdHJ1ZQp9KTsKdmFyIFRNU19JTl9ZTUxfSUQgPSAnVE1TIGluIGNvbmZpZy9raWJhbmEueW1sJzsKCl9tb2R1bGVzLnVpTW9kdWxlcy5nZXQoJ2tpYmFuYScsIFsnbmdTYW5pdGl6ZSddKS5zZXJ2aWNlKCdzZXJ2aWNlU2V0dGluZ3MnLCBmdW5jdGlvbiAoJHNhbml0aXplLCBtYXBDb25maWcsIHRpbGVtYXBzQ29uZmlnLCBrYm5WZXJzaW9uKSB7CiAgdmFyIGF0dHJpYnV0aW9uRnJvbUNvbmZpZyA9ICRzYW5pdGl6ZShtYXJrZG93bkl0LnJlbmRlcih0aWxlbWFwc0NvbmZpZy5kZXByZWNhdGVkLmNvbmZpZy5vcHRpb25zLmF0dHJpYnV0aW9uIHx8ICcnKSk7CgogIHZhciB0bXNPcHRpb25zRnJvbUNvbmZpZyA9IF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIHRpbGVtYXBzQ29uZmlnLmRlcHJlY2F0ZWQuY29uZmlnLm9wdGlvbnMsIHsKICAgIGF0dHJpYnV0aW9uOiBhdHRyaWJ1dGlvbkZyb21Db25maWcKICB9KTsKCiAgdmFyIFNlcnZpY2VTZXR0aW5ncyA9CiAgLyojX19QVVJFX18qLwogIGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFNlcnZpY2VTZXR0aW5ncygpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNlcnZpY2VTZXR0aW5ncyk7CgogICAgICB0aGlzLl9zaG93Wm9vbU1lc3NhZ2UgPSB0cnVlOwogICAgICB0aGlzLl9lbXNDbGllbnQgPSBuZXcgX2Vtc19jbGllbnQuRU1TQ2xpZW50KHsKICAgICAgICBsYW5ndWFnZTogX2kxOG4uaTE4bi5nZXRMb2NhbGUoKSwKICAgICAgICBrYm5WZXJzaW9uOiBrYm5WZXJzaW9uLAogICAgICAgIG1hbmlmZXN0U2VydmljZVVybDogbWFwQ29uZmlnLm1hbmlmZXN0U2VydmljZVVybCwKICAgICAgICBodG1sU2FuaXRpemVyOiAkc2FuaXRpemUsCiAgICAgICAgbGFuZGluZ1BhZ2VVcmw6IG1hcENvbmZpZy5lbXNMYW5kaW5nUGFnZVVybAogICAgICB9KTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoU2VydmljZVNldHRpbmdzLCBbewogICAgICBrZXk6ICJzaG91bGRTaG93Wm9vbU1lc3NhZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkU2hvd1pvb21NZXNzYWdlKF9yZWYpIHsKICAgICAgICB2YXIgb3JpZ2luID0gX3JlZi5vcmlnaW47CiAgICAgICAgcmV0dXJuIG9yaWdpbiA9PT0gX29yaWdpbi5PUklHSU4uRU1TICYmIHRoaXMuX3Nob3dab29tTWVzc2FnZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkaXNhYmxlWm9vbU1lc3NhZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZGlzYWJsZVpvb21NZXNzYWdlKCkgewogICAgICAgIHRoaXMuX3Nob3dab29tTWVzc2FnZSA9IGZhbHNlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIl9fZGVidWdTdHViTWFuaWZlc3RDYWxscyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfX2RlYnVnU3R1Yk1hbmlmZXN0Q2FsbHMobWFuaWZlc3RSZXRyaWV2YWwpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICB2YXIgb2xkR2V0TWFuaWZlc3QgPSB0aGlzLl9lbXNDbGllbnQuZ2V0TWFuaWZlc3Q7CiAgICAgICAgdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0ID0gbWFuaWZlc3RSZXRyaWV2YWw7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHJlbW92ZVN0dWI6IGZ1bmN0aW9uIHJlbW92ZVN0dWIoKSB7CiAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0OyAvL25vdCBzdHJpY3RseSBuZWNlc3Nhcnkgc2luY2UgdGhpcyBpcyBwcm90b3R5cGUgbWV0aG9kCgogICAgICAgICAgICBpZiAoX3RoaXMuX2Vtc0NsaWVudC5nZXRNYW5pZmVzdCAhPT0gb2xkR2V0TWFuaWZlc3QpIHsKICAgICAgICAgICAgICBfdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0ID0gb2xkR2V0TWFuaWZlc3Q7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldEZpbGVMYXllcnMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfZ2V0RmlsZUxheWVycyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgICAgdmFyIGZpbGVMYXllcnM7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGlmIChtYXBDb25maWcuaW5jbHVkZUVsYXN0aWNNYXBzU2VydmljZSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vtc0NsaWVudC5nZXRGaWxlTGF5ZXJzKCk7CgogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICBmaWxlTGF5ZXJzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgZmlsZUxheWVycy5tYXAoZnVuY3Rpb24gKGZpbGVMYXllcikgewogICAgICAgICAgICAgICAgICAgIC8vYmFja2ZpbGwgdG8gb2xkZXIgc2V0dGluZ3MKICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybWF0ID0gZmlsZUxheWVyLmdldERlZmF1bHRGb3JtYXRUeXBlKCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGEgPSBmaWxlTGF5ZXIuZ2V0RGVmYXVsdEZvcm1hdE1ldGEoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogZmlsZUxheWVyLmdldERpc3BsYXlOYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGZpbGVMYXllci5nZXRPcmlnaW4oKSwKICAgICAgICAgICAgICAgICAgICAgIGlkOiBmaWxlTGF5ZXIuZ2V0SWQoKSwKICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGZpbGVMYXllci5nZXRDcmVhdGVkQXQoKSwKICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uOiBmaWxlTGF5ZXIuZ2V0SFRNTEF0dHJpYnV0aW9uKCksCiAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IGZpbGVMYXllci5nZXRGaWVsZHNJbkxhbmd1YWdlKCksCiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdCwKICAgICAgICAgICAgICAgICAgICAgIC8vbGVnYWN5OiBmb3JtYXQgYW5kIG1ldGEgYXJlIHNwbGl0IHVwCiAgICAgICAgICAgICAgICAgICAgICBtZXRhOiBtZXRhIC8vbGVnYWN5LCBmb3JtYXQgYW5kIG1ldGEgYXJlIHNwbGl0IHVwCgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgICAgfSkpOwoKICAgICAgICBmdW5jdGlvbiBnZXRGaWxlTGF5ZXJzKCkgewogICAgICAgICAgcmV0dXJuIF9nZXRGaWxlTGF5ZXJzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZ2V0RmlsZUxheWVyczsKICAgICAgfSgpCiAgICAgIC8qKgogICAgICAgKiBSZXR1cm5zIGFsbCB0aGUgc2VydmljZXMgcHVibGlzaGVkIGJ5IEVNUyAoaWYgY29uZmlndXJlcykKICAgICAgICogSXQgYWxzbyBpbmNsdWRlcyB0aGUgc2VydmljZSBjb25maWd1cmVkIGluIHRpbGVtYXAgKG92ZXJyaWRlKQogICAgICAgKi8KCiAgICB9LCB7CiAgICAgIGtleTogImdldFRNU1NlcnZpY2VzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldFRNU1NlcnZpY2VzID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgdmFyIGFsbFNlcnZpY2VzLCB0bXNTZXJ2aWNlLCBzZXJ2aWNlc0Zyb21NYW5pZmVzdCwgc3RyaXBwZWRTZXJ2aWNlRnJvbU1hbmlmZXN0OwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgYWxsU2VydmljZXMgPSBbXTsKCiAgICAgICAgICAgICAgICAgIGlmICh0aWxlbWFwc0NvbmZpZy5kZXByZWNhdGVkLmlzT3ZlcnJpZGRlbikgewogICAgICAgICAgICAgICAgICAgIC8vdXNlIHRpbGVtYXAuKiBzZXR0aW5ncyBmcm9tIHltbAogICAgICAgICAgICAgICAgICAgIHRtc1NlcnZpY2UgPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmVEZWVwKHRtc09wdGlvbnNGcm9tQ29uZmlnKTsKICAgICAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlLmlkID0gVE1TX0lOX1lNTF9JRDsKICAgICAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlLm9yaWdpbiA9IF9vcmlnaW4uT1JJR0lOLktJQkFOQV9ZTUw7CiAgICAgICAgICAgICAgICAgICAgYWxsU2VydmljZXMucHVzaCh0bXNTZXJ2aWNlKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKCFtYXBDb25maWcuaW5jbHVkZUVsYXN0aWNNYXBzU2VydmljZSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vtc0NsaWVudC5nZXRUTVNTZXJ2aWNlcygpOwoKICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgc2VydmljZXNGcm9tTWFuaWZlc3QgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoc2VydmljZXNGcm9tTWFuaWZlc3QuZmlsdGVyKGZ1bmN0aW9uICh0bXNTZXJ2aWNlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0SWQoKSA9PT0gbWFwQ29uZmlnLmVtc1RpbGVMYXllcklkLmJyaWdodDsKICAgICAgICAgICAgICAgICAgfSkubWFwKAogICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIodG1zU2VydmljZSkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHNoaW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSB0bXNTZXJ2aWNlLmdldE9yaWdpbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIudDEgPSB0bXNTZXJ2aWNlLmdldElkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0TWluWm9vbSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQyID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0TWF4Wm9vbSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50NCA9IHRtc1NlcnZpY2UuZ2V0SFRNTEF0dHJpYnV0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBfY29udGV4dDIudDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IF9jb250ZXh0Mi50MSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5ab29tOiBfY29udGV4dDIudDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogX2NvbnRleHQyLnQzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uOiBfY29udGV4dDIudDQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHNoaW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0oKSkpOwoKICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgc3RyaXBwZWRTZXJ2aWNlRnJvbU1hbmlmZXN0ID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICAgIGFsbFNlcnZpY2VzID0gYWxsU2VydmljZXMuY29uY2F0KHN0cmlwcGVkU2VydmljZUZyb21NYW5pZmVzdCk7CgogICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGFsbFNlcnZpY2VzKTsKCiAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgICAgfSkpOwoKICAgICAgICBmdW5jdGlvbiBnZXRUTVNTZXJ2aWNlcygpIHsKICAgICAgICAgIHJldHVybiBfZ2V0VE1TU2VydmljZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBnZXRUTVNTZXJ2aWNlczsKICAgICAgfSgpCiAgICAgIC8qKgogICAgICAgKiBBZGQgb3B0aW9uYWwgcXVlcnktcGFyYW1ldGVycyB0byBhbGwgcmVxdWVzdHMKICAgICAgICoKICAgICAgICogQHBhcmFtIGFkZGl0aW9uYWxRdWVyeVBhcmFtcwogICAgICAgKi8KCiAgICB9LCB7CiAgICAgIGtleTogImFkZFF1ZXJ5UGFyYW1zIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFF1ZXJ5UGFyYW1zKGFkZGl0aW9uYWxRdWVyeVBhcmFtcykgewogICAgICAgIHRoaXMuX2Vtc0NsaWVudC5hZGRRdWVyeVBhcmFtcyhhZGRpdGlvbmFsUXVlcnlQYXJhbXMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldEVNU0hvdExpbmsiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfZ2V0RU1TSG90TGluayA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChmaWxlTGF5ZXJDb25maWcpIHsKICAgICAgICAgIHZhciBmaWxlTGF5ZXJzLCBsYXllcjsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vtc0NsaWVudC5nZXRGaWxlTGF5ZXJzKCk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBmaWxlTGF5ZXJzID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICAgIGxheWVyID0gZmlsZUxheWVycy5maW5kKGZ1bmN0aW9uIChmaWxlTGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaGFzSWRCeU5hbWUgPSBmaWxlTGF5ZXIuaGFzSWQoZmlsZUxheWVyQ29uZmlnLm5hbWUpOyAvL2xlZ2FjeQoKICAgICAgICAgICAgICAgICAgICB2YXIgaGFzSWRCeUlkID0gZmlsZUxheWVyLmhhc0lkKGZpbGVMYXllckNvbmZpZy5pZCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhhc0lkQnlOYW1lIHx8IGhhc0lkQnlJZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBsYXllciA/IGxheWVyLmdldEVNU0hvdExpbmsoKSA6IG51bGwpOwoKICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0RU1TSG90TGluayhfeDIpIHsKICAgICAgICAgIHJldHVybiBfZ2V0RU1TSG90TGluay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGdldEVNU0hvdExpbms7CiAgICAgIH0oKQogICAgfSwgewogICAgICBrZXk6ICJfZ2V0QXR0cmlidXRlc0ZvckVNU1RNU0xheWVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoaXNEZXNhdHVyYXRlZCwgaXNEYXJrTW9kZSkgewogICAgICAgICAgdmFyIHRtc1NlcnZpY2VzLCBlbXNUaWxlTGF5ZXJJZCwgc2VydmljZUlkLCB0bXNTZXJ2aWNlOwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZW1zQ2xpZW50LmdldFRNU1NlcnZpY2VzKCk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlcyA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgICBlbXNUaWxlTGF5ZXJJZCA9IG1hcENvbmZpZy5lbXNUaWxlTGF5ZXJJZDsKCiAgICAgICAgICAgICAgICAgIGlmIChpc0RhcmtNb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgc2VydmljZUlkID0gZW1zVGlsZUxheWVySWQuZGFyazsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZXNhdHVyYXRlZCkgewogICAgICAgICAgICAgICAgICAgICAgc2VydmljZUlkID0gZW1zVGlsZUxheWVySWQuZGVzYXR1cmF0ZWQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZCA9IGVtc1RpbGVMYXllcklkLmJyaWdodDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHRtc1NlcnZpY2UgPSB0bXNTZXJ2aWNlcy5maW5kKGZ1bmN0aW9uIChzZXJ2aWNlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0SWQoKSA9PT0gc2VydmljZUlkOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICByZXR1cm4gdG1zU2VydmljZS5nZXRVcmxUZW1wbGF0ZSgpOwoKICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0bXNTZXJ2aWNlLmdldE1pblpvb20oKTsKCiAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICBfY29udGV4dDUudDEgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0TWF4Wm9vbSgpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MiA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICByZXR1cm4gdG1zU2VydmljZS5nZXRIVE1MQXR0cmlidXRpb24oKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgICBfY29udGV4dDUudDMgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQ0ID0gX29yaWdpbi5PUklHSU4uRU1TOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICAgICAgICAgIHVybDogX2NvbnRleHQ1LnQwLAogICAgICAgICAgICAgICAgICAgIG1pblpvb206IF9jb250ZXh0NS50MSwKICAgICAgICAgICAgICAgICAgICBtYXhab29tOiBfY29udGV4dDUudDIsCiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRpb246IF9jb250ZXh0NS50MywKICAgICAgICAgICAgICAgICAgICBvcmlnaW46IF9jb250ZXh0NS50NAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgICAgfSkpOwoKICAgICAgICBmdW5jdGlvbiBfZ2V0QXR0cmlidXRlc0ZvckVNU1RNU0xheWVyKF94MywgX3g0KSB7CiAgICAgICAgICByZXR1cm4gX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBfZ2V0QXR0cmlidXRlc0ZvckVNU1RNU0xheWVyOwogICAgICB9KCkKICAgIH0sIHsKICAgICAga2V5OiAiZ2V0QXR0cmlidXRlc0ZvclRNU0xheWVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEF0dHJpYnV0ZXNGb3JUTVNMYXllciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNih0bXNTZXJ2aWNlQ29uZmlnLCBpc0Rlc2F0dXJhdGVkLCBpc0RhcmtNb2RlKSB7CiAgICAgICAgICB2YXIgY29uZmlnLCBhdHRycywgX2NvbmZpZywgX2F0dHJzOwoKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGlmICghKHRtc1NlcnZpY2VDb25maWcub3JpZ2luID09PSBfb3JpZ2luLk9SSUdJTi5FTVMpKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgdGhpcy5fZ2V0QXR0cmlidXRlc0ZvckVNU1RNU0xheWVyKGlzRGVzYXR1cmF0ZWQsIGlzRGFya01vZGUpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgIGlmICghKHRtc1NlcnZpY2VDb25maWcub3JpZ2luID09PSBfb3JpZ2luLk9SSUdJTi5LSUJBTkFfWU1MKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IHRpbGVtYXBzQ29uZmlnLmRlcHJlY2F0ZWQuY29uZmlnOwogICAgICAgICAgICAgICAgICBhdHRycyA9IF9sb2Rhc2guZGVmYXVsdC5waWNrKGNvbmZpZywgWyd1cmwnLCAnbWluem9vbScsICdtYXh6b29tJywgJ2F0dHJpYnV0aW9uJ10pOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgX29iamVjdFNwcmVhZCh7fSwgYXR0cnMsIHt9LCB7CiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBfb3JpZ2luLk9SSUdJTi5LSUJBTkFfWU1MCiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICBpZiAoISh0bXNTZXJ2aWNlQ29uZmlnLmlkID09PSBUTVNfSU5fWU1MX0lEKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF9jb25maWcgPSB0aWxlbWFwc0NvbmZpZy5kZXByZWNhdGVkLmNvbmZpZzsKICAgICAgICAgICAgICAgICAgX2F0dHJzID0gX2xvZGFzaC5kZWZhdWx0LnBpY2soX2NvbmZpZywgWyd1cmwnLCAnbWluem9vbScsICdtYXh6b29tJywgJ2F0dHJpYnV0aW9uJ10pOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgX29iamVjdFNwcmVhZCh7fSwgX2F0dHJzLCB7fSwgewogICAgICAgICAgICAgICAgICAgIG9yaWdpbjogX29yaWdpbi5PUklHSU4uS0lCQU5BX1lNTAogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcihpc0Rlc2F0dXJhdGVkLCBpc0RhcmtNb2RlKSk7CgogICAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0QXR0cmlidXRlc0ZvclRNU0xheWVyKF94NSwgX3g2LCBfeDcpIHsKICAgICAgICAgIHJldHVybiBfZ2V0QXR0cmlidXRlc0ZvclRNU0xheWVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZ2V0QXR0cmlidXRlc0ZvclRNU0xheWVyOwogICAgICB9KCkKICAgIH0sIHsKICAgICAga2V5OiAiX2dldEZpbGVVcmxGcm9tRU1TIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEZpbGVVcmxGcm9tRU1TMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhmaWxlTGF5ZXJDb25maWcpIHsKICAgICAgICAgIHZhciBmaWxlTGF5ZXJzLCBsYXllcjsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vtc0NsaWVudC5nZXRGaWxlTGF5ZXJzKCk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBmaWxlTGF5ZXJzID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICAgIGxheWVyID0gZmlsZUxheWVycy5maW5kKGZ1bmN0aW9uIChmaWxlTGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaGFzSWRCeU5hbWUgPSBmaWxlTGF5ZXIuaGFzSWQoZmlsZUxheWVyQ29uZmlnLm5hbWUpOyAvL2xlZ2FjeQoKICAgICAgICAgICAgICAgICAgICB2YXIgaGFzSWRCeUlkID0gZmlsZUxheWVyLmhhc0lkKGZpbGVMYXllckNvbmZpZy5pZCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhhc0lkQnlOYW1lIHx8IGhhc0lkQnlJZDsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBpZiAoIWxheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgbGF5ZXIuZ2V0RGVmYXVsdEZvcm1hdFVybCgpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRmlsZSAgIi5jb25jYXQoZmlsZUxheWVyQ29uZmlnLm5hbWUsICIgbm90IHJlY29nbml6ZWQiKSk7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlNywgdGhpcyk7CiAgICAgICAgfSkpOwoKICAgICAgICBmdW5jdGlvbiBfZ2V0RmlsZVVybEZyb21FTVMoX3g4KSB7CiAgICAgICAgICByZXR1cm4gX2dldEZpbGVVcmxGcm9tRU1TMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIF9nZXRGaWxlVXJsRnJvbUVNUzsKICAgICAgfSgpCiAgICB9LCB7CiAgICAgIGtleTogImdldFVybEZvclJlZ2lvbkxheWVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldFVybEZvclJlZ2lvbkxheWVyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KGZpbGVMYXllckNvbmZpZykgewogICAgICAgICAgdmFyIHVybDsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGlmIChmaWxlTGF5ZXJDb25maWcub3JpZ2luID09PSBfb3JpZ2luLk9SSUdJTi5FTVMpIHsKICAgICAgICAgICAgICAgICAgICB1cmwgPSB0aGlzLl9nZXRGaWxlVXJsRnJvbUVNUyhmaWxlTGF5ZXJDb25maWcpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVMYXllckNvbmZpZy5sYXllcklkICYmIGZpbGVMYXllckNvbmZpZy5sYXllcklkLnN0YXJ0c1dpdGgoIiIuY29uY2F0KF9vcmlnaW4uT1JJR0lOLkVNUywgIi4iKSkpIHsKICAgICAgICAgICAgICAgICAgICAvL2ZhbGxiYWNrIGZvciBvbGRlciBzYXZlZCBvYmplY3RzCiAgICAgICAgICAgICAgICAgICAgdXJsID0gdGhpcy5fZ2V0RmlsZVVybEZyb21FTVMoZmlsZUxheWVyQ29uZmlnKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlTGF5ZXJDb25maWcubGF5ZXJJZCAmJiBmaWxlTGF5ZXJDb25maWcubGF5ZXJJZC5zdGFydHNXaXRoKCIiLmNvbmNhdChfb3JpZ2luLk9SSUdJTi5LSUJBTkFfWU1MLCAiLiIpKSkgewogICAgICAgICAgICAgICAgICAgIC8vZmFsbGJhY2sgZm9yIG9sZGVyIHNhdmVkIG9iamVjdHMKICAgICAgICAgICAgICAgICAgICB1cmwgPSBmaWxlTGF5ZXJDb25maWcudXJsOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vZ2VuZXJpYyBmYWxsYmFjawogICAgICAgICAgICAgICAgICAgIHVybCA9IGZpbGVMYXllckNvbmZpZy51cmw7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCB1cmwpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0VXJsRm9yUmVnaW9uTGF5ZXIoX3g5KSB7CiAgICAgICAgICByZXR1cm4gX2dldFVybEZvclJlZ2lvbkxheWVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZ2V0VXJsRm9yUmVnaW9uTGF5ZXI7CiAgICAgIH0oKQogICAgfSwgewogICAgICBrZXk6ICJnZXRKc29uRm9yUmVnaW9uTGF5ZXIiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfZ2V0SnNvbkZvclJlZ2lvbkxheWVyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KGZpbGVMYXllckNvbmZpZykgewogICAgICAgICAgdmFyIHVybCwgcmVzcG9uc2U7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFVybEZvclJlZ2lvbkxheWVyKGZpbGVMYXllckNvbmZpZyk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICB1cmwgPSBfY29udGV4dDkuc2VudDsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICByZXR1cm4gZmV0Y2godXJsKTsKCiAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDkuc2VudCk7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7CiAgICAgICAgfSkpOwoKICAgICAgICBmdW5jdGlvbiBnZXRKc29uRm9yUmVnaW9uTGF5ZXIoX3gxMCkgewogICAgICAgICAgcmV0dXJuIF9nZXRKc29uRm9yUmVnaW9uTGF5ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBnZXRKc29uRm9yUmVnaW9uTGF5ZXI7CiAgICAgIH0oKQogICAgfV0pOwoKICAgIHJldHVybiBTZXJ2aWNlU2V0dGluZ3M7CiAgfSgpOwoKICByZXR1cm4gbmV3IFNlcnZpY2VTZXR0aW5ncygpOwp9KTs="},null]}