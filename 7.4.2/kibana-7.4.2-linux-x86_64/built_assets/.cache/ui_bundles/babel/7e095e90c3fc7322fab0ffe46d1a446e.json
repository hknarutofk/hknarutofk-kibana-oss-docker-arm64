{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/vislib/lib/dispatch.js","dependencies":[{"path":"src/legacy/ui/public/vislib/lib/dispatch.js","mtime":1572296413356},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRpc3BhdGNoID0gdm9pZCAwOwoKdmFyIF9kID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJkMyIpKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2pxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgianF1ZXJ5IikpOwoKdmFyIF9zaW1wbGVfZW1pdHRlciA9IHJlcXVpcmUoIi4uLy4uL3V0aWxzL3NpbXBsZV9lbWl0dGVyIik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCnZhciBjb25maWcgPSBfY2hyb21lLmRlZmF1bHQuZ2V0VWlTZXR0aW5nc0NsaWVudCgpOwovKioKICogSGFuZGxlcyBldmVudCByZXNwb25zZXMKICoKICogQGNsYXNzIERpc3BhdGNoCiAqIEBjb25zdHJ1Y3RvcgogKiBAcGFyYW0gaGFuZGxlciB7T2JqZWN0fSBSZWZlcmVuY2UgdG8gSGFuZGxlciBDbGFzcyBPYmplY3QKICovCgoKdmFyIERpc3BhdGNoID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1NpbXBsZUVtaXR0ZXIpIHsKICBfaW5oZXJpdHMoRGlzcGF0Y2gsIF9TaW1wbGVFbWl0dGVyKTsKCiAgZnVuY3Rpb24gRGlzcGF0Y2goaGFuZGxlcikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEaXNwYXRjaCk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRGlzcGF0Y2gpLmNhbGwodGhpcykpOwogICAgX3RoaXMuaGFuZGxlciA9IGhhbmRsZXI7CiAgICBfdGhpcy5fbGlzdGVuZXJzID0ge307CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGlzcGF0Y2gsIFt7CiAgICBrZXk6ICJfcGllQ2xpY2tSZXNwb25zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3BpZUNsaWNrUmVzcG9uc2UoZGF0YSkgewogICAgICB2YXIgcG9pbnRzID0gW107CiAgICAgIHZhciBkYXRhUG9pbnRlciA9IGRhdGE7CgogICAgICB3aGlsZSAoZGF0YVBvaW50ZXIgJiYgZGF0YVBvaW50ZXIucmF3RGF0YSkgewogICAgICAgIHBvaW50cy5wdXNoKGRhdGFQb2ludGVyLnJhd0RhdGEpOwogICAgICAgIGRhdGFQb2ludGVyID0gZGF0YVBvaW50ZXIucGFyZW50OwogICAgICB9CgogICAgICBpZiAoKDAsIF9sb2Rhc2guZ2V0KShkYXRhLCAncmF3RGF0YS50YWJsZS4kcGFyZW50JykpIHsKICAgICAgICB2YXIgX2dldCA9ICgwLCBfbG9kYXNoLmdldCkoZGF0YSwgJ3Jhd0RhdGEudGFibGUuJHBhcmVudCcpLAogICAgICAgICAgICB0YWJsZSA9IF9nZXQudGFibGUsCiAgICAgICAgICAgIGNvbHVtbiA9IF9nZXQuY29sdW1uLAogICAgICAgICAgICByb3cgPSBfZ2V0LnJvdywKICAgICAgICAgICAga2V5ID0gX2dldC5rZXk7CgogICAgICAgIHBvaW50cy5wdXNoKHsKICAgICAgICAgIHRhYmxlOiB0YWJsZSwKICAgICAgICAgIGNvbHVtbjogY29sdW1uLAogICAgICAgICAgcm93OiByb3csCiAgICAgICAgICB2YWx1ZToga2V5CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb2ludHM7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3Nlcmllc0NsaWNrUmVzcG9uc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXJpZXNDbGlja1Jlc3BvbnNlKGRhdGEpIHsKICAgICAgdmFyIHBvaW50cyA9IFtdOwogICAgICBbJ3hSYXcnLCAneVJhdycsICd6UmF3JywgJ3Nlcmllc1JhdycsICdyYXdEYXRhJywgJ3RhYmxlUmF3J10uZm9yRWFjaChmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgaWYgKGRhdGFbdmFsXSAmJiBkYXRhW3ZhbF0uY29sdW1uICE9PSB1bmRlZmluZWQgJiYgZGF0YVt2YWxdLnJvdyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBwb2ludHMucHVzaChkYXRhW3ZhbF0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBwb2ludHM7CiAgICB9CiAgICAvKioKICAgICAqIFJlc3BvbnNlIHRvIGNsaWNrICBldmVudHMKICAgICAqCiAgICAgKiBAcGFyYW0gZCB7T2JqZWN0fSBEYXRhIHBvaW50CiAgICAgKiBAcmV0dXJucyBldmVudCB3aXRoIGxpc3Qgb2YgZGF0YSBwb2ludHMgcmVsYXRlZCB0byB0aGUgY2xpY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjbGlja0V2ZW50UmVzcG9uc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsaWNrRXZlbnRSZXNwb25zZShkKSB7CiAgICAgIHZhciBwcm9wcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBpc1NsaWNlcyA9IHByb3BzLmlzU2xpY2VzOwoKICAgICAgaWYgKGlzU2xpY2VzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgX2RhdGEgPSBfZC5kZWZhdWx0LmV2ZW50LnRhcmdldC5uZWFyZXN0Vmlld3BvcnRFbGVtZW50ID8gX2QuZGVmYXVsdC5ldmVudC50YXJnZXQubmVhcmVzdFZpZXdwb3J0RWxlbWVudC5fX2RhdGFfXyA6IF9kLmRlZmF1bHQuZXZlbnQudGFyZ2V0Ll9fZGF0YV9fOwoKICAgICAgICBpc1NsaWNlcyA9ICEhKF9kYXRhICYmIF9kYXRhLnNsaWNlcyk7CiAgICAgIH0KCiAgICAgIHZhciBkYXRhID0gZC5pbnB1dCB8fCBkOwogICAgICByZXR1cm4gewogICAgICAgIGU6IF9kLmRlZmF1bHQuZXZlbnQsCiAgICAgICAgZGF0YTogaXNTbGljZXMgPyB0aGlzLl9waWVDbGlja1Jlc3BvbnNlKGRhdGEpIDogdGhpcy5fc2VyaWVzQ2xpY2tSZXNwb25zZShkYXRhKQogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgd2hldGhlciByZW5kZXJpbmcgYSBzZXJpZXMgaXMgY29uZmlndXJlZCBpbiBwZXJjZW50YWdlIG1vZGUKICAgICAqIFVzZWQgdG8gZGlzcGxheSBhIHZhbHVlIHBlcmNlbnRhZ2UgZm9ybWF0dGVkIGluIGl0J3MgcG9wb3ZlcgogICAgICoKICAgICAqIEBwYXJhbSByYXdJZCB7c3RyaW5nfSBUaGUgcmF3SWQgb2Ygc2VyaWVzIHRvIGNoZWNrCiAgICAgKiBAcGFyYW0gc2VyaWVzIHtBcnJheX0gQXJyYXkgb2YgYWxsIHNlcmllcyBkYXRhCiAgICAgKiBAcGFyYW0gdmlzQ29uZmlnIHtWaXNDb25maWd9CiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfaXNTZXJpZXNJblBlcmNlbnRhZ2VNb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNTZXJpZXNJblBlcmNlbnRhZ2VNb2RlKHJhd0lkLCBzZXJpZXMsIHZpc0NvbmZpZykgewogICAgICBpZiAoIXJhd0lkIHx8ICFBcnJheS5pc0FycmF5KHNlcmllcykgfHwgIXZpc0NvbmZpZykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvL2ZpbmQgdGhlIHByaW1hcnkgaWQgYnkgdGhlIHJhd0lkLCB0aGF0IGlkIGlzIHVzZWQgaW4gdGhlIGNvbmZpZydzIHNlcmllc1BhcmFtcwoKCiAgICAgIHZhciBfc2VyaWVzJGZpbmQgPSBzZXJpZXMuZmluZChmdW5jdGlvbiAoc2VyaWVzKSB7CiAgICAgICAgcmV0dXJuIHNlcmllcy5yYXdJZCA9PT0gcmF3SWQ7CiAgICAgIH0pLAogICAgICAgICAgaWQgPSBfc2VyaWVzJGZpbmQuaWQ7CgogICAgICBpZiAoIWlkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vZmluZCB0aGUgbWF0Y2hpbmcgc2VyaWVzUGFyYW1zIG9mIHRoZSBzZXJpZXMsIHRvIGdldCB0aGUgaWQgb2YgdGhlIHZhbHVlQXhpcwoKCiAgICAgIHZhciBzZXJpZXNQYXJhbXMgPSB2aXNDb25maWcuZ2V0KCdzZXJpZXNQYXJhbXMnLCBbXSk7CgogICAgICB2YXIgX3JlZiA9IHNlcmllc1BhcmFtcy5maW5kKGZ1bmN0aW9uIChwYXJhbSkgewogICAgICAgIHJldHVybiBwYXJhbS5kYXRhLmlkID09PSBpZDsKICAgICAgfSkgfHwge30sCiAgICAgICAgICB2YWx1ZUF4aXNJZCA9IF9yZWYudmFsdWVBeGlzOwoKICAgICAgaWYgKCF2YWx1ZUF4aXNJZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIHVzZWRWYWx1ZUF4aXMgPSB2aXNDb25maWcuZ2V0KCd2YWx1ZUF4ZXMnLCBbXSkuZmluZChmdW5jdGlvbiAodmFsdWVBeGlzKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlQXhpcy5pZCA9PT0gdmFsdWVBeGlzSWQ7CiAgICAgIH0pOwogICAgICByZXR1cm4gKDAsIF9sb2Rhc2guZ2V0KSh1c2VkVmFsdWVBeGlzLCAnc2NhbGUubW9kZScpID09PSAncGVyY2VudGFnZSc7CiAgICB9CiAgICAvKioKICAgICAqIFJlc3BvbnNlIHRvIGhvdmVyIGV2ZW50cwogICAgICoKICAgICAqIEBwYXJhbSBkIHtPYmplY3R9IERhdGEgcG9pbnQKICAgICAqIEBwYXJhbSBpIHtOdW1iZXJ9IEluZGV4IG51bWJlciBvZiBkYXRhIHBvaW50CiAgICAgKiBAcmV0dXJucyB7e3ZhbHVlOiAqLCBwb2ludDogKiwgbGFiZWw6ICosIGNvbG9yOiAqLCBwb2ludEluZGV4OiAqLAogICAgICogc2VyaWVzOiAqLCBjb25maWc6ICosIGRhdGE6IChPYmplY3R8KiksCiAgICAgKiBlOiAoZDMuZXZlbnR8KiksIGhhbmRsZXI6IChPYmplY3R8Kil9fSBFdmVudCByZXNwb25zZSBvYmplY3QKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJldmVudFJlc3BvbnNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBldmVudFJlc3BvbnNlKGQsIGkpIHsKICAgICAgdmFyIGRhdHVtID0gZC5faW5wdXQgfHwgZDsKICAgICAgdmFyIGRhdGEgPSBfZC5kZWZhdWx0LmV2ZW50LnRhcmdldC5uZWFyZXN0Vmlld3BvcnRFbGVtZW50ID8gX2QuZGVmYXVsdC5ldmVudC50YXJnZXQubmVhcmVzdFZpZXdwb3J0RWxlbWVudC5fX2RhdGFfXyA6IF9kLmRlZmF1bHQuZXZlbnQudGFyZ2V0Ll9fZGF0YV9fOwogICAgICB2YXIgbGFiZWwgPSBkLmxhYmVsID8gZC5sYWJlbCA6IGQuc2VyaWVzIHx8ICdDb3VudCc7CiAgICAgIHZhciBpc1NlcmllcyA9ICEhKGRhdGEgJiYgZGF0YS5zZXJpZXMpOwogICAgICB2YXIgaXNTbGljZXMgPSAhIShkYXRhICYmIGRhdGEuc2xpY2VzKTsKICAgICAgdmFyIHNlcmllcyA9IGlzU2VyaWVzID8gZGF0YS5zZXJpZXMgOiB1bmRlZmluZWQ7CiAgICAgIHZhciBzbGljZXMgPSBpc1NsaWNlcyA/IGRhdGEuc2xpY2VzIDogdW5kZWZpbmVkOwogICAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcjsKICAgICAgdmFyIGNvbG9yID0gKDAsIF9sb2Rhc2guZ2V0KShoYW5kbGVyLCAnZGF0YS5jb2xvcicpOwogICAgICB2YXIgY29uZmlnID0gaGFuZGxlciAmJiBoYW5kbGVyLnZpc0NvbmZpZzsKCiAgICAgIHZhciBpc1BlcmNlbnRhZ2VNb2RlID0gdGhpcy5faXNTZXJpZXNJblBlcmNlbnRhZ2VNb2RlKGQuc2VyaWVzSWQsIHNlcmllcywgY29uZmlnKTsKCiAgICAgIHZhciBldmVudERhdGEgPSB7CiAgICAgICAgdmFsdWU6IGQueSwKICAgICAgICBwb2ludDogZGF0dW0sCiAgICAgICAgZGF0dW06IGRhdHVtLAogICAgICAgIGxhYmVsOiBsYWJlbCwKICAgICAgICBjb2xvcjogY29sb3IgPyBjb2xvcihsYWJlbCkgOiB1bmRlZmluZWQsCiAgICAgICAgcG9pbnRJbmRleDogaSwKICAgICAgICBzZXJpZXM6IHNlcmllcywKICAgICAgICBzbGljZXM6IHNsaWNlcywKICAgICAgICBjb25maWc6IGNvbmZpZywKICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgIGU6IF9kLmRlZmF1bHQuZXZlbnQsCiAgICAgICAgaGFuZGxlcjogaGFuZGxlciwKICAgICAgICBpc1BlcmNlbnRhZ2VNb2RlOiBpc1BlcmNlbnRhZ2VNb2RlCiAgICAgIH07CiAgICAgIHJldHVybiBldmVudERhdGE7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGFkZHMgZXZlbnRzIGFuZCBsaXN0ZW5lcnMgdG8gYSBEMyBzZWxlY3Rpb24KICAgICAqCiAgICAgKiBAbWV0aG9kIGFkZEV2ZW50CiAgICAgKiBAcGFyYW0gZXZlbnQge1N0cmluZ30KICAgICAqIEBwYXJhbSBjYWxsYmFjayB7RnVuY3Rpb259CiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWRkRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50KGV2ZW50LCBjYWxsYmFjaykgewogICAgICByZXR1cm4gZnVuY3Rpb24gKHNlbGVjdGlvbikgewogICAgICAgIHNlbGVjdGlvbi5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtZW50ID0gX2QuZGVmYXVsdC5zZWxlY3QodGhpcyk7CgogICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICByZXR1cm4gZWxlbWVudC5vbihldmVudCwgY2FsbGJhY2spOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKgogICAgICogQG1ldGhvZCBhZGRIb3ZlckV2ZW50CiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWRkSG92ZXJFdmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkSG92ZXJFdmVudCgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgaXNDbGlja2FibGUgPSB0aGlzLmxpc3RlbmVyQ291bnQoJ2NsaWNrJykgPiAwOwogICAgICB2YXIgYWRkRXZlbnQgPSB0aGlzLmFkZEV2ZW50OwogICAgICB2YXIgJGVsID0gdGhpcy5oYW5kbGVyLmVsOwoKICAgICAgaWYgKCF0aGlzLmhhbmRsZXIuaGlnaGxpZ2h0KSB7CiAgICAgICAgdGhpcy5oYW5kbGVyLmhpZ2hsaWdodCA9IHNlbGYuaGlnaGxpZ2h0OwogICAgICB9CgogICAgICBmdW5jdGlvbiBob3ZlcihkLCBpKSB7CiAgICAgICAgLy8gQWRkIHBvaW50ZXIgaWYgaXRlbSBpcyBjbGlja2FibGUKICAgICAgICBpZiAoaXNDbGlja2FibGUpIHsKICAgICAgICAgIHNlbGYuYWRkTW91c2VQb2ludGVyLmNhbGwodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHNlbGYuaGFuZGxlci5oaWdobGlnaHQuY2FsbCh0aGlzLCAkZWwpOwogICAgICAgIHNlbGYuZW1pdCgnaG92ZXInLCBzZWxmLmV2ZW50UmVzcG9uc2UoZCwgaSkpOwogICAgICB9CgogICAgICByZXR1cm4gYWRkRXZlbnQoJ21vdXNlb3ZlcicsIGhvdmVyKTsKICAgIH0KICAgIC8qKgogICAgICoKICAgICAqIEBtZXRob2QgYWRkTW91c2VvdXRFdmVudAogICAgICogQHJldHVybnMge0Z1bmN0aW9ufQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZE1vdXNlb3V0RXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE1vdXNlb3V0RXZlbnQoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIGFkZEV2ZW50ID0gdGhpcy5hZGRFdmVudDsKICAgICAgdmFyICRlbCA9IHRoaXMuaGFuZGxlci5lbDsKCiAgICAgIGlmICghdGhpcy5oYW5kbGVyLnVuSGlnaGxpZ2h0KSB7CiAgICAgICAgdGhpcy5oYW5kbGVyLnVuSGlnaGxpZ2h0ID0gc2VsZi51bkhpZ2hsaWdodDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbW91c2VvdXQoKSB7CiAgICAgICAgc2VsZi5oYW5kbGVyLnVuSGlnaGxpZ2h0LmNhbGwodGhpcywgJGVsKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGFkZEV2ZW50KCdtb3VzZW91dCcsIG1vdXNlb3V0KTsKICAgIH0KICAgIC8qKgogICAgICoKICAgICAqIEBtZXRob2QgYWRkQ2xpY2tFdmVudAogICAgICogQHJldHVybnMge0Z1bmN0aW9ufQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZENsaWNrRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENsaWNrRXZlbnQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIG9uQ2xpY2sgPSBmdW5jdGlvbiBvbkNsaWNrKGQpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLmVtaXQoJ2NsaWNrJywgX3RoaXMyLmNsaWNrRXZlbnRSZXNwb25zZShkKSk7CiAgICAgIH07CgogICAgICByZXR1cm4gdGhpcy5hZGRFdmVudCgnY2xpY2snLCBvbkNsaWNrKTsKICAgIH0KICAgIC8qKgogICAgICogRGV0ZXJtaW5lIGlmIHdlIHdpbGwgYWxsb3cgYnJ1c2hpbmcKICAgICAqCiAgICAgKiBAbWV0aG9kIGFsbG93QnJ1c2hpbmcKICAgICAqIEByZXR1cm5zIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogImFsbG93QnJ1c2hpbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFsbG93QnJ1c2hpbmcoKSB7CiAgICAgIHZhciB4QXhpcyA9IHRoaXMuaGFuZGxlci5jYXRlZ29yeUF4ZXNbMF07IC8vQWxsb3cgYnJ1c2hpbmcgZm9yIG9yZGVyZWQgYXhpcyAtIGRhdGUgaGlzdG9ncmFtIGFuZCBoaXN0b2dyYW0KCiAgICAgIHJldHVybiBCb29sZWFuKHhBeGlzLm9yZGVyZWQpOwogICAgfQogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgaWYgYnJ1c2hpbmcgaXMgY3VycmVudGx5IGVuYWJsZWQKICAgICAqCiAgICAgKiBAbWV0aG9kIGlzQnJ1c2hhYmxlCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc0JydXNoYWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNCcnVzaGFibGUoKSB7CiAgICAgIHJldHVybiB0aGlzLmFsbG93QnJ1c2hpbmcoKSAmJiB0aGlzLmxpc3RlbmVyQ291bnQoJ2JydXNoJykgPiAwOwogICAgfQogICAgLyoqCiAgICAgKgogICAgICogQHBhcmFtIHN2ZwogICAgICogQHJldHVybnMge0Z1bmN0aW9ufQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZEJydXNoRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEJydXNoRXZlbnQoc3ZnKSB7CiAgICAgIGlmICghdGhpcy5pc0JydXNoYWJsZSgpKSByZXR1cm47CiAgICAgIHZhciB4U2NhbGUgPSB0aGlzLmhhbmRsZXIuY2F0ZWdvcnlBeGVzWzBdLmdldFNjYWxlKCk7CiAgICAgIHRoaXMuY3JlYXRlQnJ1c2goeFNjYWxlLCBzdmcpOwogICAgfQogICAgLyoqCiAgICAgKiBNb3VzZW92ZXIgQmVoYXZpb3IKICAgICAqCiAgICAgKiBAbWV0aG9kIGFkZE1vdXNlUG9pbnRlcgogICAgICogQHJldHVybnMge2QzLlNlbGVjdGlvbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZGRNb3VzZVBvaW50ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE1vdXNlUG9pbnRlcigpIHsKICAgICAgcmV0dXJuIF9kLmRlZmF1bHQuc2VsZWN0KHRoaXMpLnN0eWxlKCdjdXJzb3InLCAncG9pbnRlcicpOwogICAgfQogICAgLyoqCiAgICAgKiBIaWdobGlnaHQgdGhlIGVsZW1lbnQgdGhhdCBpcyB1bmRlciB0aGUgY3Vyc29yCiAgICAgKiBieSByZWR1Y2luZyB0aGUgb3BhY2l0eSBvZiBhbGwgdGhlIGVsZW1lbnRzIG9uIHRoZSBncmFwaC4KICAgICAqIEBwYXJhbSBlbGVtZW50IHtkMy5TZWxlY3Rpb259CiAgICAgKiBAbWV0aG9kIGhpZ2hsaWdodAogICAgICovCgogIH0sIHsKICAgIGtleTogImhpZ2hsaWdodCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGlnaGxpZ2h0KGVsZW1lbnQpIHsKICAgICAgdmFyIGxhYmVsID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtbGFiZWwnKTsKICAgICAgaWYgKCFsYWJlbCkgcmV0dXJuOwogICAgICB2YXIgZGltbWluZyA9IGNvbmZpZy5nZXQoJ3Zpc3VhbGl6YXRpb246ZGltbWluZ09wYWNpdHknKTsKICAgICAgKDAsIF9qcXVlcnkuZGVmYXVsdCkoZWxlbWVudCkucGFyZW50KCkuZmluZCgnW2RhdGEtbGFiZWxdJykuY3NzKCdvcGFjaXR5JywgMSkgLy9PcGFjaXR5IDEgaXMgbmVlZGVkIHRvIGF2b2lkIHRoZSBjc3MgYXBwbGljYXRpb24KICAgICAgLm5vdChmdW5jdGlvbiAoZWxzLCBlbCkgewogICAgICAgIHJldHVybiBTdHJpbmcoKDAsIF9qcXVlcnkuZGVmYXVsdCkoZWwpLmRhdGEoJ2xhYmVsJykpID09PSBsYWJlbDsKICAgICAgfSkuY3NzKCdvcGFjaXR5JywganVzdGlmeU9wYWNpdHkoZGltbWluZykpOwogICAgfQogICAgLyoqCiAgICAgKiBNb3VzZW91dCBCZWhhdmlvcgogICAgICoKICAgICAqIEBwYXJhbSBlbGVtZW50IHtkMy5TZWxlY3Rpb259CiAgICAgKiBAbWV0aG9kIHVuSGlnaGxpZ2h0CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidW5IaWdobGlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVuSGlnaGxpZ2h0KGVsZW1lbnQpIHsKICAgICAgKDAsIF9qcXVlcnkuZGVmYXVsdCkoJ1tkYXRhLWxhYmVsXScsIGVsZW1lbnQucGFyZW50Tm9kZSkuY3NzKCdvcGFjaXR5JywgMSk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgRDMgYnJ1c2ggdG8gU1ZHIGFuZCByZXR1cm5zIHRoZSBicnVzaCBmdW5jdGlvbgogICAgICoKICAgICAqIEBwYXJhbSB4U2NhbGUge0Z1bmN0aW9ufSBEMyB4U2NhbGUgZnVuY3Rpb24KICAgICAqIEBwYXJhbSBzdmcge0hUTUxFbGVtZW50fSBSZWZlcmVuY2UgdG8gU1ZHCiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBhIEQzIGJydXNoIGZ1bmN0aW9uIGFuZCBhIFNWRyB3aXRoIGEgYnJ1c2ggZ3JvdXAgYXR0YWNoZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVCcnVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnJ1c2goeFNjYWxlLCBzdmcpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgdmlzQ29uZmlnID0gc2VsZi5oYW5kbGVyLnZpc0NvbmZpZzsKCiAgICAgIHZhciBfc3ZnJG5vZGUkZ2V0QkJveCA9IHN2Zy5ub2RlKCkuZ2V0QkJveCgpLAogICAgICAgICAgd2lkdGggPSBfc3ZnJG5vZGUkZ2V0QkJveC53aWR0aCwKICAgICAgICAgIGhlaWdodCA9IF9zdmckbm9kZSRnZXRCQm94LmhlaWdodDsKCiAgICAgIHZhciBpc0hvcml6b250YWwgPSBzZWxmLmhhbmRsZXIuY2F0ZWdvcnlBeGVzWzBdLmF4aXNDb25maWcuaXNIb3Jpem9udGFsKCk7IC8vIEJydXNoIHNjYWxlCgogICAgICB2YXIgYnJ1c2ggPSBfZC5kZWZhdWx0LnN2Zy5icnVzaCgpOwoKICAgICAgaWYgKGlzSG9yaXpvbnRhbCkgewogICAgICAgIGJydXNoLngoeFNjYWxlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBicnVzaC55KHhTY2FsZSk7CiAgICAgIH0KCiAgICAgIGJydXNoLm9uKCdicnVzaGVuZCcsIGZ1bmN0aW9uIGJydXNoRW5kKCkgewogICAgICAgIC8vIEFzc3VtZXMgZGF0YSBpcyBzZWxlY3RlZCBhdCB0aGUgY2hhcnQgbGV2ZWwKICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIHRoZSBudW1iZXIgb2YgZGF0YSBvYmplY3RzIHNob3VsZCBhbHdheXMgYmUgMQogICAgICAgIHZhciBkYXRhID0gX2QuZGVmYXVsdC5zZWxlY3QodGhpcykuZGF0YSgpWzBdOwoKICAgICAgICB2YXIgaXNUaW1lU2VyaWVzID0gZGF0YS5vcmRlcmVkICYmIGRhdGEub3JkZXJlZC5kYXRlOyAvLyBBbGxvd3MgZm9yIGJydXNoaW5nIG9uIGQzLnNjYWxlLm9yZGluYWwoKQoKICAgICAgICB2YXIgc2VsZWN0ZWQgPSB4U2NhbGUuZG9tYWluKCkuZmlsdGVyKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICByZXR1cm4gYnJ1c2guZXh0ZW50KClbMF0gPD0geFNjYWxlKGQpICYmIHhTY2FsZShkKSA8PSBicnVzaC5leHRlbnQoKVsxXTsKICAgICAgICB9KTsKICAgICAgICB2YXIgcmFuZ2UgPSBpc1RpbWVTZXJpZXMgPyBicnVzaC5leHRlbnQoKSA6IHNlbGVjdGVkOwogICAgICAgIHJldHVybiBzZWxmLmVtaXQoJ2JydXNoJywgewogICAgICAgICAgcmFuZ2U6IHJhbmdlLAogICAgICAgICAgY29uZmlnOiB2aXNDb25maWcsCiAgICAgICAgICBlOiBfZC5kZWZhdWx0LmV2ZW50LAogICAgICAgICAgZGF0YTogZGF0YQogICAgICAgIH0pOwogICAgICB9KTsgLy8gaWYgYGFkZEJydXNoaW5nYCBpcyB0cnVlLCBhZGQgYnJ1c2ggY2FudmFzCgogICAgICBpZiAoc2VsZi5saXN0ZW5lckNvdW50KCdicnVzaCcpKSB7CiAgICAgICAgdmFyIHJlY3QgPSBzdmcuaW5zZXJ0KCdnJywgJ2cnKS5hdHRyKCdjbGFzcycsICdicnVzaCcpLmNhbGwoYnJ1c2gpLmNhbGwoZnVuY3Rpb24gKGJydXNoRykgewogICAgICAgICAgLy8gaGlqYWNrIHRoZSBicnVzaCBzdGFydCBldmVudCB0byBmaWx0ZXIgb3V0IHJpZ2h0L21pZGRsZSBjbGlja3MKICAgICAgICAgIHZhciBicnVzaEhhbmRsZXIgPSBicnVzaEcub24oJ21vdXNlZG93bi5icnVzaCcpOwogICAgICAgICAgaWYgKCFicnVzaEhhbmRsZXIpIHJldHVybjsgLy8gdG91Y2ggZXZlbnRzIGluIHVzZQoKICAgICAgICAgIGJydXNoRy5vbignbW91c2Vkb3duLmJydXNoJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAodmFsaWRCcnVzaENsaWNrKF9kLmRlZmF1bHQuZXZlbnQpKSBicnVzaEhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pLnNlbGVjdEFsbCgncmVjdCcpOwoKICAgICAgICBpZiAoaXNIb3Jpem9udGFsKSB7CiAgICAgICAgICByZWN0LmF0dHIoJ2hlaWdodCcsIGhlaWdodCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlY3QuYXR0cignd2lkdGgnLCB3aWR0aCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYnJ1c2g7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBEaXNwYXRjaDsKfShfc2ltcGxlX2VtaXR0ZXIuU2ltcGxlRW1pdHRlcik7CgpleHBvcnRzLkRpc3BhdGNoID0gRGlzcGF0Y2g7CgpmdW5jdGlvbiB2YWxpZEJydXNoQ2xpY2soZXZlbnQpIHsKICByZXR1cm4gZXZlbnQuYnV0dG9uID09PSAwOwp9CgpmdW5jdGlvbiBqdXN0aWZ5T3BhY2l0eShvcGFjaXR5KSB7CiAgdmFyIGRlY2ltYWxOdW1iZXIgPSBwYXJzZUZsb2F0KG9wYWNpdHksIDEwKTsKICB2YXIgZmFsbGJhY2tPcGFjaXR5ID0gMC41OwogIHJldHVybiAwIDw9IGRlY2ltYWxOdW1iZXIgJiYgZGVjaW1hbE51bWJlciA8PSAxID8gZGVjaW1hbE51bWJlciA6IGZhbGxiYWNrT3BhY2l0eTsKfQ=="},null]}