{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/vis_type_tagcloud/public/components/tag_cloud.js","dependencies":[{"path":"src/legacy/core_plugins/vis_type_tagcloud/public/components/tag_cloud.js","mtime":1572296411632},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRhZ0Nsb3VkID0gdm9pZCAwOwoKdmFyIF9kID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJkMyIpKTsKCnZhciBfZDNDbG91ZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiZDMtY2xvdWQiKSk7Cgp2YXIgX3NlZWRfY29sb3JzID0gcmVxdWlyZSgidWkvdmlzL2NvbXBvbmVudHMvY29sb3Ivc2VlZF9jb2xvcnMiKTsKCnZhciBfZXZlbnRzID0gcmVxdWlyZSgiZXZlbnRzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCnZhciBPUklFTlRBVElPTlMgPSB7CiAgJ3NpbmdsZSc6IGZ1bmN0aW9uIHNpbmdsZSgpIHsKICAgIHJldHVybiAwOwogIH0sCiAgJ3JpZ2h0IGFuZ2xlZCc6IGZ1bmN0aW9uIHJpZ2h0QW5nbGVkKHRhZykgewogICAgcmV0dXJuIGhhc2hXaXRoaW5SYW5nZSh0YWcudGV4dCwgMikgKiA5MDsKICB9LAogICdtdWx0aXBsZSc6IGZ1bmN0aW9uIG11bHRpcGxlKHRhZykgewogICAgcmV0dXJuIGhhc2hXaXRoaW5SYW5nZSh0YWcudGV4dCwgMTIpICogMTUgLSA5MDsgLy9mYW4gb3V0IDEyICogMTUgZGVncmVlcyBvdmVyIHRvcC1yaWdodCBhbmQgYm90dG9tLXJpZ2h0IHF1YWRyYW50ICg9LTkwIGRlZyBvZmZzZXQpCiAgfQp9Owp2YXIgRDNfU0NBTElOR19GVU5DVElPTlMgPSB7CiAgJ2xpbmVhcic6IGZ1bmN0aW9uIGxpbmVhcigpIHsKICAgIHJldHVybiBfZC5kZWZhdWx0LnNjYWxlLmxpbmVhcigpOwogIH0sCiAgJ2xvZyc6IGZ1bmN0aW9uIGxvZygpIHsKICAgIHJldHVybiBfZC5kZWZhdWx0LnNjYWxlLmxvZygpOwogIH0sCiAgJ3NxdWFyZSByb290JzogZnVuY3Rpb24gc3F1YXJlUm9vdCgpIHsKICAgIHJldHVybiBfZC5kZWZhdWx0LnNjYWxlLnNxcnQoKTsKICB9Cn07Cgp2YXIgVGFnQ2xvdWQgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7CiAgX2luaGVyaXRzKFRhZ0Nsb3VkLCBfRXZlbnRFbWl0dGVyKTsKCiAgZnVuY3Rpb24gVGFnQ2xvdWQoZG9tTm9kZSkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUYWdDbG91ZCk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVGFnQ2xvdWQpLmNhbGwodGhpcykpOyAvL0RPTQoKICAgIF90aGlzLl9lbGVtZW50ID0gZG9tTm9kZTsKICAgIF90aGlzLl9kM1N2Z0NvbnRhaW5lciA9IF9kLmRlZmF1bHQuc2VsZWN0KF90aGlzLl9lbGVtZW50KS5hcHBlbmQoJ3N2ZycpOwogICAgX3RoaXMuX3N2Z0dyb3VwID0gX3RoaXMuX2QzU3ZnQ29udGFpbmVyLmFwcGVuZCgnZycpOwogICAgX3RoaXMuX3NpemUgPSBbMSwgMV07CgogICAgX3RoaXMucmVzaXplKCk7IC8vU0VUVElORyAobm9uLWNvbmZpZ3VyYWJsZSkKCgogICAgX3RoaXMuX2ZvbnRGYW1pbHkgPSAnT3BlbiBTYW5zLCBzYW5zLXNlcmlmJzsKICAgIF90aGlzLl9mb250U3R5bGUgPSAnbm9ybWFsJzsKICAgIF90aGlzLl9mb250V2VpZ2h0ID0gJ25vcm1hbCc7CiAgICBfdGhpcy5fc3BpcmFsID0gJ2FyY2hpbWVkZWFuJzsgLy9sYXlvdXQgc2hhcGUKCiAgICBfdGhpcy5fdGltZUludGVydmFsID0gMTAwMDsgLy90aW1lIGFsbG93ZWQgZm9yIGxheW91dCBhbGdvcml0aG0KCiAgICBfdGhpcy5fcGFkZGluZyA9IDU7IC8vT1BUSU9OUwoKICAgIF90aGlzLl9vcmllbnRhdGlvbiA9ICdzaW5nbGUnOwogICAgX3RoaXMuX21pbkZvbnRTaXplID0gMTA7CiAgICBfdGhpcy5fbWF4Rm9udFNpemUgPSAzNjsKICAgIF90aGlzLl90ZXh0U2NhbGUgPSAnbGluZWFyJzsKICAgIF90aGlzLl9vcHRpb25zQXNTdHJpbmcgPSBudWxsOyAvL0RBVEEKCiAgICBfdGhpcy5fd29yZHMgPSBudWxsOyAvL1VUSUwKCiAgICBfdGhpcy5fc2V0VGltZW91dElkID0gbnVsbDsKICAgIF90aGlzLl9wZW5kaW5nSm9iID0gbnVsbDsKICAgIF90aGlzLl9sYXlvdXRJc1VwZGF0aW5nID0gbnVsbDsKICAgIF90aGlzLl9hbGxJblZpZXdCb3ggPSBmYWxzZTsKICAgIF90aGlzLl9ET01pc1VwZGF0aW5nID0gZmFsc2U7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoVGFnQ2xvdWQsIFt7CiAgICBrZXk6ICJzZXRPcHRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRPcHRpb25zKG9wdGlvbnMpIHsKICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpID09PSB0aGlzLl9vcHRpb25zQXNTdHJpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX29wdGlvbnNBc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpOwogICAgICB0aGlzLl9vcmllbnRhdGlvbiA9IG9wdGlvbnMub3JpZW50YXRpb247CiAgICAgIHRoaXMuX21pbkZvbnRTaXplID0gTWF0aC5taW4ob3B0aW9ucy5taW5Gb250U2l6ZSwgb3B0aW9ucy5tYXhGb250U2l6ZSk7CiAgICAgIHRoaXMuX21heEZvbnRTaXplID0gTWF0aC5tYXgob3B0aW9ucy5taW5Gb250U2l6ZSwgb3B0aW9ucy5tYXhGb250U2l6ZSk7CiAgICAgIHRoaXMuX3RleHRTY2FsZSA9IG9wdGlvbnMuc2NhbGU7CgogICAgICB0aGlzLl9pbnZhbGlkYXRlKGZhbHNlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHsKICAgICAgdmFyIG5ld1dpZHRoID0gdGhpcy5fZWxlbWVudC5vZmZzZXRXaWR0aDsKICAgICAgdmFyIG5ld0hlaWdodCA9IHRoaXMuX2VsZW1lbnQub2Zmc2V0SGVpZ2h0OwoKICAgICAgaWYgKG5ld1dpZHRoID09PSB0aGlzLl9zaXplWzBdICYmIG5ld0hlaWdodCA9PT0gdGhpcy5fc2l6ZVsxXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHdhc0luc2lkZSA9IHRoaXMuX3NpemVbMF0gPj0gdGhpcy5fY2xvdWRXaWR0aCAmJiB0aGlzLl9zaXplWzFdID49IHRoaXMuX2Nsb3VkSGVpZ2h0OwogICAgICB2YXIgd2lsbEJlSW5zaWRlID0gdGhpcy5fY2xvdWRXaWR0aCA8PSBuZXdXaWR0aCAmJiB0aGlzLl9jbG91ZEhlaWdodCA8PSBuZXdIZWlnaHQ7CiAgICAgIHRoaXMuX3NpemVbMF0gPSBuZXdXaWR0aDsKICAgICAgdGhpcy5fc2l6ZVsxXSA9IG5ld0hlaWdodDsKCiAgICAgIGlmICh3YXNJbnNpZGUgJiYgd2lsbEJlSW5zaWRlICYmIHRoaXMuX2FsbEluVmlld0JveCkgewogICAgICAgIHRoaXMuX2ludmFsaWRhdGUodHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5faW52YWxpZGF0ZShmYWxzZSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREYXRhKGRhdGEpIHsKICAgICAgdGhpcy5fd29yZHMgPSBkYXRhOwoKICAgICAgdGhpcy5faW52YWxpZGF0ZShmYWxzZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3NldFRpbWVvdXRJZCk7CiAgICAgIHRoaXMuX2VsZW1lbnQuaW5uZXJIVE1MID0gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U3RhdHVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdGF0dXMoKSB7CiAgICAgIHJldHVybiB0aGlzLl9hbGxJblZpZXdCb3ggPyBUYWdDbG91ZC5TVEFUVVMuQ09NUExFVEUgOiBUYWdDbG91ZC5TVEFUVVMuSU5DT01QTEVURTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfdXBkYXRlQ29udGFpbmVyU2l6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZUNvbnRhaW5lclNpemUoKSB7CiAgICAgIHRoaXMuX2QzU3ZnQ29udGFpbmVyLmF0dHIoJ3dpZHRoJywgdGhpcy5fc2l6ZVswXSk7CgogICAgICB0aGlzLl9kM1N2Z0NvbnRhaW5lci5hdHRyKCdoZWlnaHQnLCB0aGlzLl9zaXplWzFdKTsKCiAgICAgIHRoaXMuX3N2Z0dyb3VwLmF0dHIoJ3dpZHRoJywgdGhpcy5fc2l6ZVswXSk7CgogICAgICB0aGlzLl9zdmdHcm91cC5hdHRyKCdoZWlnaHQnLCB0aGlzLl9zaXplWzFdKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfaXNKb2JSdW5uaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNKb2JSdW5uaW5nKCkgewogICAgICByZXR1cm4gdGhpcy5fc2V0VGltZW91dElkIHx8IHRoaXMuX2xheW91dElzVXBkYXRpbmcgfHwgdGhpcy5fRE9NaXNVcGRhdGluZzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcHJvY2Vzc1BlbmRpbmdKb2IiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9wcm9jZXNzUGVuZGluZ0pvYjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBqb2IsIGNsb3VkQkJveDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ0pvYikgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNKb2JSdW5uaW5nKCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICB0aGlzLl9jb21wbGV0ZWRKb2IgPSBudWxsOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGlja1BlbmRpbmdKb2IoKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgam9iID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIWpvYi53b3Jkcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIWpvYi5yZWZyZXNoTGF5b3V0KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUxheW91dChqb2IpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZURPTShqb2IpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgY2xvdWRCQm94ID0gdGhpcy5fc3ZnR3JvdXBbMF1bMF0uZ2V0QkJveCgpOwogICAgICAgICAgICAgICAgdGhpcy5fY2xvdWRXaWR0aCA9IGNsb3VkQkJveC53aWR0aDsKICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3VkSGVpZ2h0ID0gY2xvdWRCQm94LmhlaWdodDsKICAgICAgICAgICAgICAgIHRoaXMuX2FsbEluVmlld0JveCA9IGNsb3VkQkJveC54ID49IDAgJiYgY2xvdWRCQm94LnkgPj0gMCAmJiBjbG91ZEJCb3gueCArIGNsb3VkQkJveC53aWR0aCA8PSB0aGlzLl9lbGVtZW50Lm9mZnNldFdpZHRoICYmIGNsb3VkQkJveC55ICsgY2xvdWRCQm94LmhlaWdodCA8PSB0aGlzLl9lbGVtZW50Lm9mZnNldEhlaWdodDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgdGhpcy5fZW1wdHlET00oam9iKTsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nSm9iKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NQZW5kaW5nSm9iKCk7IC8vcGljayB1cCBuZXh0IGpvYgoKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbXBsZXRlZEpvYiA9IGpvYjsKICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdyZW5kZXJDb21wbGV0ZScpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIF9wcm9jZXNzUGVuZGluZ0pvYigpIHsKICAgICAgICByZXR1cm4gX3Byb2Nlc3NQZW5kaW5nSm9iMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX3Byb2Nlc3NQZW5kaW5nSm9iOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX3BpY2tQZW5kaW5nSm9iIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcGlja1BlbmRpbmdKb2IyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLl9zZXRUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KAogICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBqb2I7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvYiA9IF90aGlzMi5fcGVuZGluZ0pvYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5fcGVuZGluZ0pvYiA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuX3NldFRpbWVvdXRJZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGpvYik7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgICAgICAgICAgICAgIH0pKSwgMCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0My5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX3BpY2tQZW5kaW5nSm9iKCkgewogICAgICAgIHJldHVybiBfcGlja1BlbmRpbmdKb2IyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcGlja1BlbmRpbmdKb2I7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJfZW1wdHlET00iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9lbXB0eURPTSgpIHsKICAgICAgdGhpcy5fc3ZnR3JvdXAuc2VsZWN0QWxsKCd0ZXh0JykucmVtb3ZlKCk7CgogICAgICB0aGlzLl9jbG91ZFdpZHRoID0gMDsKICAgICAgdGhpcy5fY2xvdWRIZWlnaHQgPSAwOwogICAgICB0aGlzLl9hbGxJblZpZXdCb3ggPSB0cnVlOwogICAgICB0aGlzLl9ET01pc1VwZGF0aW5nID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3VwZGF0ZURPTSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3VwZGF0ZURPTTIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChqb2IpIHsKICAgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgICAgdmFyIGNhblNraXBEb21VcGRhdGUsIGFmZmluZVRyYW5zZm9ybSwgc3ZnVGV4dE5vZGVzLCBzdGFnZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY2FuU2tpcERvbVVwZGF0ZSA9IHRoaXMuX3BlbmRpbmdKb2IgfHwgdGhpcy5fc2V0VGltZW91dElkOwoKICAgICAgICAgICAgICAgIGlmICghY2FuU2tpcERvbVVwZGF0ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuX0RPTWlzVXBkYXRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgdGhpcy5fRE9NaXNVcGRhdGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBhZmZpbmVUcmFuc2Zvcm0gPSBwb3NpdGlvbldvcmQuYmluZChudWxsLCB0aGlzLl9lbGVtZW50Lm9mZnNldFdpZHRoIC8gMiwgdGhpcy5fZWxlbWVudC5vZmZzZXRIZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgIHN2Z1RleHROb2RlcyA9IHRoaXMuX3N2Z0dyb3VwLnNlbGVjdEFsbCgndGV4dCcpOwogICAgICAgICAgICAgICAgc3RhZ2UgPSBzdmdUZXh0Tm9kZXMuZGF0YShqb2Iud29yZHMsIGdldFRleHQpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICB2YXIgZW50ZXJTZWxlY3Rpb24gPSBzdGFnZS5lbnRlcigpOwogICAgICAgICAgICAgICAgICB2YXIgZW50ZXJpbmdUYWdzID0gZW50ZXJTZWxlY3Rpb24uYXBwZW5kKCd0ZXh0Jyk7CiAgICAgICAgICAgICAgICAgIGVudGVyaW5nVGFncy5zdHlsZSgnZm9udC1zaXplJywgZ2V0U2l6ZUluUGl4ZWxzKTsKICAgICAgICAgICAgICAgICAgZW50ZXJpbmdUYWdzLnN0eWxlKCdmb250LXN0eWxlJywgX3RoaXMzLl9mb250U3R5bGUpOwogICAgICAgICAgICAgICAgICBlbnRlcmluZ1RhZ3Muc3R5bGUoJ2ZvbnQtd2VpZ2h0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMuX2ZvbnRXZWlnaHQ7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbnRlcmluZ1RhZ3Muc3R5bGUoJ2ZvbnQtZmFtaWx5JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMuX2ZvbnRGYW1pbHk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbnRlcmluZ1RhZ3Muc3R5bGUoJ2ZpbGwnLCBnZXRGaWxsKTsKICAgICAgICAgICAgICAgICAgZW50ZXJpbmdUYWdzLmF0dHIoJ3RleHQtYW5jaG9yJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnbWlkZGxlJzsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGVudGVyaW5nVGFncy5hdHRyKCd0cmFuc2Zvcm0nLCBhZmZpbmVUcmFuc2Zvcm0pOwogICAgICAgICAgICAgICAgICBlbnRlcmluZ1RhZ3MuYXR0cignZGF0YS10ZXN0LXN1YmonLCBnZXREaXNwbGF5VGV4dCk7CiAgICAgICAgICAgICAgICAgIGVudGVyaW5nVGFncy50ZXh0KGdldERpc3BsYXlUZXh0KTsKICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSBfdGhpczM7CiAgICAgICAgICAgICAgICAgIGVudGVyaW5nVGFncy5vbih7CiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVtaXQoJ3NlbGVjdCcsIGV2ZW50KTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG1vdXNlb3ZlcjogZnVuY3Rpb24gbW91c2VvdmVyKCkgewogICAgICAgICAgICAgICAgICAgICAgX2QuZGVmYXVsdC5zZWxlY3QodGhpcykuc3R5bGUoJ2N1cnNvcicsICdwb2ludGVyJyk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBtb3VzZW91dDogZnVuY3Rpb24gbW91c2VvdXQoKSB7CiAgICAgICAgICAgICAgICAgICAgICBfZC5kZWZhdWx0LnNlbGVjdCh0aGlzKS5zdHlsZSgnY3Vyc29yJywgJ2RlZmF1bHQnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB2YXIgbW92aW5nVGFncyA9IHN0YWdlLnRyYW5zaXRpb24oKTsKICAgICAgICAgICAgICAgICAgbW92aW5nVGFncy5kdXJhdGlvbig2MDApOwogICAgICAgICAgICAgICAgICBtb3ZpbmdUYWdzLnN0eWxlKCdmb250LXNpemUnLCBnZXRTaXplSW5QaXhlbHMpOwogICAgICAgICAgICAgICAgICBtb3ZpbmdUYWdzLnN0eWxlKCdmb250LXN0eWxlJywgX3RoaXMzLl9mb250U3R5bGUpOwogICAgICAgICAgICAgICAgICBtb3ZpbmdUYWdzLnN0eWxlKCdmb250LXdlaWdodCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLl9mb250V2VpZ2h0OwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgbW92aW5nVGFncy5zdHlsZSgnZm9udC1mYW1pbHknLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5fZm9udEZhbWlseTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIG1vdmluZ1RhZ3MuYXR0cigndHJhbnNmb3JtJywgYWZmaW5lVHJhbnNmb3JtKTsKICAgICAgICAgICAgICAgICAgdmFyIGV4aXRpbmdUYWdzID0gc3RhZ2UuZXhpdCgpOwogICAgICAgICAgICAgICAgICB2YXIgZXhpdFRyYW5zaXRpb24gPSBleGl0aW5nVGFncy50cmFuc2l0aW9uKCk7CiAgICAgICAgICAgICAgICAgIGV4aXRUcmFuc2l0aW9uLmR1cmF0aW9uKDIwMCk7CiAgICAgICAgICAgICAgICAgIGV4aXRpbmdUYWdzLnN0eWxlKCdmaWxsLW9wYWNpdHknLCAxZS02KTsKICAgICAgICAgICAgICAgICAgZXhpdGluZ1RhZ3MuYXR0cignZm9udC1zaXplJywgMSk7CiAgICAgICAgICAgICAgICAgIGV4aXRpbmdUYWdzLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICB2YXIgZXhpdHMgPSAwOwogICAgICAgICAgICAgICAgICB2YXIgbW92ZXMgPSAwOwoKICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdmVXaGVuRG9uZSA9IGZ1bmN0aW9uIHJlc29sdmVXaGVuRG9uZSgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXhpdHMgPT09IDAgJiYgbW92ZXMgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fRE9NaXNVcGRhdGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICBleGl0VHJhbnNpdGlvbi5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhpdHMrKzsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGV4aXRUcmFuc2l0aW9uLmVhY2goJ2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBleGl0cy0tOwogICAgICAgICAgICAgICAgICAgIHJlc29sdmVXaGVuRG9uZSgpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgbW92aW5nVGFncy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW92ZXMrKzsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIG1vdmluZ1RhZ3MuZWFjaCgnZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIG1vdmVzLS07CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZVdoZW5Eb25lKCk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBfdXBkYXRlRE9NKF94KSB7CiAgICAgICAgcmV0dXJuIF91cGRhdGVET00yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfdXBkYXRlRE9NOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX21ha2VUZXh0U2l6ZU1hcHBlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX21ha2VUZXh0U2l6ZU1hcHBlcigpIHsKICAgICAgdmFyIG1hcFNpemVUb0ZvbnRTaXplID0gRDNfU0NBTElOR19GVU5DVElPTlNbdGhpcy5fdGV4dFNjYWxlXSgpOwoKICAgICAgdmFyIHJhbmdlID0gdGhpcy5fd29yZHMubGVuZ3RoID09PSAxID8gW3RoaXMuX21heEZvbnRTaXplLCB0aGlzLl9tYXhGb250U2l6ZV0gOiBbdGhpcy5fbWluRm9udFNpemUsIHRoaXMuX21heEZvbnRTaXplXTsKICAgICAgbWFwU2l6ZVRvRm9udFNpemUucmFuZ2UocmFuZ2UpOwoKICAgICAgaWYgKHRoaXMuX3dvcmRzKSB7CiAgICAgICAgbWFwU2l6ZVRvRm9udFNpemUuZG9tYWluKF9kLmRlZmF1bHQuZXh0ZW50KHRoaXMuX3dvcmRzLCBnZXRWYWx1ZSkpOwogICAgICB9CgogICAgICByZXR1cm4gbWFwU2l6ZVRvRm9udFNpemU7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21ha2VOZXdKb2IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlTmV3Sm9iKCkgewogICAgICByZXR1cm4gewogICAgICAgIHJlZnJlc2hMYXlvdXQ6IHRydWUsCiAgICAgICAgc2l6ZTogdGhpcy5fc2l6ZS5zbGljZSgpLAogICAgICAgIHdvcmRzOiB0aGlzLl93b3JkcwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogIl9tYWtlSm9iUHJlc2VydmluZ0xheW91dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX21ha2VKb2JQcmVzZXJ2aW5nTGF5b3V0KCkgewogICAgICByZXR1cm4gewogICAgICAgIHJlZnJlc2hMYXlvdXQ6IGZhbHNlLAogICAgICAgIHNpemU6IHRoaXMuX3NpemUuc2xpY2UoKSwKICAgICAgICB3b3JkczogdGhpcy5fY29tcGxldGVkSm9iLndvcmRzLm1hcChmdW5jdGlvbiAodGFnKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB4OiB0YWcueCwKICAgICAgICAgICAgeTogdGFnLnksCiAgICAgICAgICAgIHJvdGF0ZTogdGFnLnJvdGF0ZSwKICAgICAgICAgICAgc2l6ZTogdGFnLnNpemUsCiAgICAgICAgICAgIHJhd1RleHQ6IHRhZy5yYXdUZXh0IHx8IHRhZy50ZXh0LAogICAgICAgICAgICBkaXNwbGF5VGV4dDogdGFnLmRpc3BsYXlUZXh0LAogICAgICAgICAgICBtZXRhOiB0YWcubWV0YQogICAgICAgICAgfTsKICAgICAgICB9KQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogIl9pbnZhbGlkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW52YWxpZGF0ZShrZWVwTGF5b3V0KSB7CiAgICAgIGlmICghdGhpcy5fd29yZHMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX3VwZGF0ZUNvbnRhaW5lclNpemUoKTsKCiAgICAgIHZhciBjYW5SZXVzZUxheW91dCA9IGtlZXBMYXlvdXQgJiYgIXRoaXMuX2lzSm9iUnVubmluZygpICYmIHRoaXMuX2NvbXBsZXRlZEpvYjsKICAgICAgdGhpcy5fcGVuZGluZ0pvYiA9IGNhblJldXNlTGF5b3V0ID8gdGhpcy5fbWFrZUpvYlByZXNlcnZpbmdMYXlvdXQoKSA6IHRoaXMuX21ha2VOZXdKb2IoKTsKCiAgICAgIHRoaXMuX3Byb2Nlc3NQZW5kaW5nSm9iKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3VwZGF0ZUxheW91dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3VwZGF0ZUxheW91dDIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShqb2IpIHsKICAgICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgICAgdmFyIG1hcFNpemVUb0ZvbnRTaXplLCB0YWdDbG91ZExheW91dEdlbmVyYXRvcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCEoam9iLnNpemVbMF0gPD0gMCB8fCBqb2Iuc2l6ZVsxXSA8PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgbWFwU2l6ZVRvRm9udFNpemUgPSB0aGlzLl9tYWtlVGV4dFNpemVNYXBwZXIoKTsKICAgICAgICAgICAgICAgIHRhZ0Nsb3VkTGF5b3V0R2VuZXJhdG9yID0gKDAsIF9kM0Nsb3VkLmRlZmF1bHQpKCk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5zaXplKGpvYi5zaXplKTsKICAgICAgICAgICAgICAgIHRhZ0Nsb3VkTGF5b3V0R2VuZXJhdG9yLnBhZGRpbmcodGhpcy5fcGFkZGluZyk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5yb3RhdGUoT1JJRU5UQVRJT05TW3RoaXMuX29yaWVudGF0aW9uXSk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5mb250KHRoaXMuX2ZvbnRGYW1pbHkpOwogICAgICAgICAgICAgICAgdGFnQ2xvdWRMYXlvdXRHZW5lcmF0b3IuZm9udFN0eWxlKHRoaXMuX2ZvbnRTdHlsZSk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5mb250V2VpZ2h0KHRoaXMuX2ZvbnRXZWlnaHQpOwogICAgICAgICAgICAgICAgdGFnQ2xvdWRMYXlvdXRHZW5lcmF0b3IuZm9udFNpemUoZnVuY3Rpb24gKHRhZykgewogICAgICAgICAgICAgICAgICByZXR1cm4gbWFwU2l6ZVRvRm9udFNpemUodGFnLnZhbHVlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGFnQ2xvdWRMYXlvdXRHZW5lcmF0b3IucmFuZG9tKHNlZWQpOwogICAgICAgICAgICAgICAgdGFnQ2xvdWRMYXlvdXRHZW5lcmF0b3Iuc3BpcmFsKHRoaXMuX3NwaXJhbCk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci53b3Jkcyhqb2Iud29yZHMpOwogICAgICAgICAgICAgICAgdGFnQ2xvdWRMYXlvdXRHZW5lcmF0b3IudGV4dChnZXREaXNwbGF5VGV4dCk7CiAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci50aW1lSW50ZXJ2YWwodGhpcy5fdGltZUludGVydmFsKTsKICAgICAgICAgICAgICAgIHRoaXMuX2xheW91dElzVXBkYXRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5vbignZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNC5fbGF5b3V0SXNVcGRhdGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0YWdDbG91ZExheW91dEdlbmVyYXRvci5zdGFydCgpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBfdXBkYXRlTGF5b3V0KF94MikgewogICAgICAgIHJldHVybiBfdXBkYXRlTGF5b3V0Mi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX3VwZGF0ZUxheW91dDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGRlYnVnIGluZm8uIEZvciBkZWJ1Z2dpbmcgb25seS4KICAgICAqIEByZXR1cm4geyp9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RGVidWdJbmZvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREZWJ1Z0luZm8oKSB7CiAgICAgIHZhciBkZWJ1ZyA9IHt9OwogICAgICBkZWJ1Zy5wb3NpdGlvbnMgPSB0aGlzLl9jb21wbGV0ZWRKb2IgPyB0aGlzLl9jb21wbGV0ZWRKb2Iud29yZHMubWFwKGZ1bmN0aW9uICh0YWcpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZGlzcGxheVRleHQ6IHRhZy5kaXNwbGF5VGV4dCwKICAgICAgICAgIHJhd1RleHQ6IHRhZy5yYXdUZXh0IHx8IHRhZy50ZXh0LAogICAgICAgICAgeDogdGFnLngsCiAgICAgICAgICB5OiB0YWcueSwKICAgICAgICAgIHJvdGF0ZTogdGFnLnJvdGF0ZQogICAgICAgIH07CiAgICAgIH0pIDogW107CiAgICAgIGRlYnVnLnNpemUgPSB7CiAgICAgICAgd2lkdGg6IHRoaXMuX3NpemVbMF0sCiAgICAgICAgaGVpZ2h0OiB0aGlzLl9zaXplWzFdCiAgICAgIH07CiAgICAgIHJldHVybiBkZWJ1ZzsKICAgIH0KICB9XSk7CgogIHJldHVybiBUYWdDbG91ZDsKfShfZXZlbnRzLkV2ZW50RW1pdHRlcik7CgpleHBvcnRzLlRhZ0Nsb3VkID0gVGFnQ2xvdWQ7ClRhZ0Nsb3VkLlNUQVRVUyA9IHsKICBDT01QTEVURTogMCwKICBJTkNPTVBMRVRFOiAxCn07CgpmdW5jdGlvbiBzZWVkKCkgewogIHJldHVybiAwLjU7IC8vY29uc3RhbnQgc2VlZCAobm90IHJhbmRvbSkgdG8gZW5zdXJlIGNvbnN0YW50IGxheW91dHMgZm9yIGlkZW50aWNhbCBkYXRhCn0KCmZ1bmN0aW9uIGdldFRleHQod29yZCkgewogIHJldHVybiB3b3JkLnJhd1RleHQ7Cn0KCmZ1bmN0aW9uIGdldERpc3BsYXlUZXh0KHdvcmQpIHsKICByZXR1cm4gd29yZC5kaXNwbGF5VGV4dDsKfQoKZnVuY3Rpb24gcG9zaXRpb25Xb3JkKHhUcmFuc2xhdGUsIHlUcmFuc2xhdGUsIHdvcmQpIHsKICBpZiAoaXNOYU4od29yZC54KSB8fCBpc05hTih3b3JkLnkpIHx8IGlzTmFOKHdvcmQucm90YXRlKSkgewogICAgLy9tb3ZlIG9mZi1zY3JlZW4KICAgIHJldHVybiAidHJhbnNsYXRlKCIuY29uY2F0KHhUcmFuc2xhdGUgKiAzLCAiLCAiKS5jb25jYXQoeVRyYW5zbGF0ZSAqIDMsICIpcm90YXRlKDApIik7CiAgfQoKICByZXR1cm4gInRyYW5zbGF0ZSgiLmNvbmNhdCh3b3JkLnggKyB4VHJhbnNsYXRlLCAiLCAiKS5jb25jYXQod29yZC55ICsgeVRyYW5zbGF0ZSwgIilyb3RhdGUoIikuY29uY2F0KHdvcmQucm90YXRlLCAiKSIpOwp9CgpmdW5jdGlvbiBnZXRWYWx1ZSh0YWcpIHsKICByZXR1cm4gdGFnLnZhbHVlOwp9CgpmdW5jdGlvbiBnZXRTaXplSW5QaXhlbHModGFnKSB7CiAgcmV0dXJuICIiLmNvbmNhdCh0YWcuc2l6ZSwgInB4Iik7Cn0KCnZhciBjb2xvclNjYWxlID0gX2QuZGVmYXVsdC5zY2FsZS5vcmRpbmFsKCkucmFuZ2UoX3NlZWRfY29sb3JzLnNlZWRDb2xvcnMpOwoKZnVuY3Rpb24gZ2V0RmlsbCh0YWcpIHsKICByZXR1cm4gY29sb3JTY2FsZSh0YWcudGV4dCk7Cn0KCmZ1bmN0aW9uIGhhc2hXaXRoaW5SYW5nZShzdHIsIG1heCkgewogIHN0ciA9IEpTT04uc3RyaW5naWZ5KHN0cik7CiAgdmFyIGhhc2ggPSAwOwogIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBzdHJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7CiAgICAgIHZhciBjaCA9IF9zdGVwLnZhbHVlOwogICAgICBoYXNoID0gKGhhc2ggKiAzMSArIGNoLmNoYXJDb2RlQXQoMCkpICUgbWF4OwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOwogICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikgewogICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gTWF0aC5hYnMoaGFzaCkgJSBtYXg7Cn0="},null]}