{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/table_list_view/table_list_view.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/table_list_view/table_list_view.js","mtime":1572296410812},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRhYmxlTGlzdFZpZXcgPSBleHBvcnRzLkVNUFRZX0ZJTFRFUiA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9wcm9wVHlwZXMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb3AtdHlwZXMiKSk7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgRU1QVFlfRklMVEVSID0gJyc7CmV4cG9ydHMuRU1QVFlfRklMVEVSID0gRU1QVFlfRklMVEVSOwp2YXIgUEFHRV9TSVpFX09QVElPTlMgPSBbMTAsIDIwLCA1MF07IC8vIHNhdmVkIG9iamVjdCBjbGllbnQgZG9lcyBub3Qgc3VwcG9ydCBzb3J0aW5nIGJ5IHRpdGxlIGJlY2F1c2UgdGl0bGUgaXMgb25seSBtYXBwZWQgYXMgYW5hbHl6ZWQKLy8gdGhlIGxlZ2FjeSBpbXBsZW1lbnRhdGlvbiBnb3QgYXJvdW5kIHRoaXMgYnkgcHVsbGluZyBgbGlzdGluZ0xpbWl0YCBpdGVtcyBhbmQgZG9pbmcgY2xpZW50IHNpZGUgc29ydGluZwovLyBhbmQgbm90IHN1cHBvcnRpbmcgc2VydmVyLXNpZGUgcGFnaW5nLgovLyBUaGlzIGNvbXBvbmVudCBkb2VzIG5vdCB0cnkgdG8gdGFja2xlIHRoZXNlIHByb2JsZW1zICh5ZXQpIGFuZCBpcyBqdXN0IGZlYXR1cmUgbWF0Y2hpbmcgdGhlIGxlZ2FjeSBjb21wb25lbnQKLy8gVE9ETyBzdXBwb3J0IHNlcnZlciBzaWRlIHNvcnRpbmcvcGFnaW5nIG9uY2UgdGl0bGUgYW5kIGRlc2NyaXB0aW9uIGFyZSBzb3J0YWJsZSBvbiB0aGUgc2VydmVyLgoKdmFyIFRhYmxlTGlzdFZpZXdVaSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoVGFibGVMaXN0Vmlld1VpLCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gVGFibGVMaXN0Vmlld1VpKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRhYmxlTGlzdFZpZXdVaSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVGFibGVMaXN0Vmlld1VpKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVib3VuY2VkRmV0Y2giLCBfbG9kYXNoLmRlZmF1bHQuZGVib3VuY2UoCiAgICAvKiNfX1BVUkVfXyovCiAgICBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShmaWx0ZXIpIHsKICAgICAgICB2YXIgcmVzcG9uc2U7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJvcHMuZmluZEl0ZW1zKGZpbHRlcik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdGhpcyBjaGVjayB0byBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgc2VhcmNoIHJlc3VsdHMgY29tZSBiYWNrIGluIGEgZGlmZmVyZW50CiAgICAgICAgICAgICAgICAvLyBvcmRlciB0aGFuIHRoZXkgd2VyZSBzZW50IG91dC4gT25seSBsb2FkIHJlc3VsdHMgZm9yIHRoZSBtb3N0IHJlY2VudCBzZWFyY2guCiAgICAgICAgICAgICAgICAvLyBBbHNvLCBpbiBjYXNlIGZpbHRlciBpcyBlbXB0eSwgaXRlbXMgYXJlIGJlaW5nIHByZS1zb3J0ZWQgYWxwaGFiZXRpY2FsbHkuCiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyID09PSBfdGhpcy5zdGF0ZS5maWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgIGhhc0luaXRpYWxGZXRjaFJldHVybmVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGlzRmV0Y2hpbmdJdGVtczogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgaXRlbXM6ICFmaWx0ZXIgPyBfbG9kYXNoLmRlZmF1bHQuc29ydEJ5KHJlc3BvbnNlLmhpdHMsICd0aXRsZScpIDogcmVzcG9uc2UuaGl0cywKICAgICAgICAgICAgICAgICAgICB0b3RhbEl0ZW1zOiByZXNwb25zZS50b3RhbCwKICAgICAgICAgICAgICAgICAgICBzaG93TGltaXRFcnJvcjogcmVzcG9uc2UudG90YWwgPiBfdGhpcy5wcm9wcy5saXN0aW5nTGltaXQKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSwgMzAwKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmV0Y2hJdGVtcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzRmV0Y2hpbmdJdGVtczogdHJ1ZQogICAgICB9LCBfdGhpcy5kZWJvdW5jZWRGZXRjaC5iaW5kKG51bGwsIF90aGlzLnN0YXRlLmZpbHRlcikpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVsZXRlU2VsZWN0ZWRJdGVtcyIsCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICB2YXIgaXRlbXNCeUlkOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghX3RoaXMuc3RhdGUuaXNEZWxldGluZ0l0ZW1zKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpc0RlbGV0aW5nSXRlbXM6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzOwogICAgICAgICAgICAgIGl0ZW1zQnlJZCA9IF9sb2Rhc2guZGVmYXVsdC5pbmRleEJ5KF90aGlzLnN0YXRlLml0ZW1zLCAnaWQnKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByb3BzLmRlbGV0ZUl0ZW1zKF90aGlzLnN0YXRlLnNlbGVjdGVkSWRzLm1hcChmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtc0J5SWRbaWRdOwogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMyk7CgogICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgICAgICAgICAgaWQ6ICJrYm4udGFibGVfbGlzdF92aWV3Lmxpc3RpbmcudW5hYmxlVG9EZWxldGVEYW5nZXJNZXNzYWdlIiwKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJVbmFibGUgdG8gZGVsZXRlIHtlbnRpdHlOYW1lfShzKSIsCiAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgIGVudGl0eU5hbWU6IF90aGlzLnByb3BzLmVudGl0eU5hbWUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQoX2NvbnRleHQyLnQwKQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICBfdGhpcy5mZXRjaEl0ZW1zKCk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzRGVsZXRpbmdJdGVtczogZmFsc2UsCiAgICAgICAgICAgICAgICBzZWxlY3RlZElkczogW10KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX3RoaXMuY2xvc2VEZWxldGVNb2RhbCgpOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyLCBudWxsLCBbWzMsIDldXSk7CiAgICB9KSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNsb3NlRGVsZXRlTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzaG93RGVsZXRlTW9kYWw6IGZhbHNlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib3BlbkRlbGV0ZU1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2hvd0RlbGV0ZU1vZGFsOiB0cnVlCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIGl0ZW1zOiBbXSwKICAgICAgdG90YWxJdGVtczogMCwKICAgICAgaGFzSW5pdGlhbEZldGNoUmV0dXJuZWQ6IGZhbHNlLAogICAgICBpc0ZldGNoaW5nSXRlbXM6IGZhbHNlLAogICAgICBpc0RlbGV0aW5nSXRlbXM6IGZhbHNlLAogICAgICBzaG93RGVsZXRlTW9kYWw6IGZhbHNlLAogICAgICBzaG93TGltaXRFcnJvcjogZmFsc2UsCiAgICAgIGZpbHRlcjogX3RoaXMucHJvcHMuaW5pdGlhbEZpbHRlciwKICAgICAgc2VsZWN0ZWRJZHM6IFtdLAogICAgICBwYWdlOiAwLAogICAgICBwZXJQYWdlOiAyMAogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhUYWJsZUxpc3RWaWV3VWksIFt7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCgpIHsKICAgICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlOwogICAgICB0aGlzLmRlYm91bmNlZEZldGNoLmNhbmNlbCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5mZXRjaEl0ZW1zKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RmlsdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGaWx0ZXIoZmlsdGVyKSB7CiAgICAgIC8vIElmIHRoZSB1c2VyIGlzIHNlYXJjaGluZywgd2Ugd2FudCB0byBjbGVhciB0aGUgc29ydCBvcmRlciBzbyB0aGF0CiAgICAgIC8vIHJlc3VsdHMgYXJlIG9yZGVyZWQgYnkgRWxhc3RpY3NlYXJjaCdzIHJlbGV2YW5jZS4KICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZmlsdGVyOiBmaWx0ZXIucXVlcnlUZXh0CiAgICAgIH0sIHRoaXMuZmV0Y2hJdGVtcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFzTm9JdGVtcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzTm9JdGVtcygpIHsKICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzRmV0Y2hpbmdJdGVtcyAmJiB0aGlzLnN0YXRlLml0ZW1zLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5zdGF0ZS5maWx0ZXIpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckNvbmZpcm1EZWxldGVNb2RhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ29uZmlybURlbGV0ZU1vZGFsKCkgewogICAgICB2YXIgZGVsZXRlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi50YWJsZV9saXN0X3ZpZXcubGlzdGluZy5kZWxldGVTZWxlY3RlZEl0ZW1zQ29uZmlybU1vZGFsLmNvbmZpcm1CdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUiCiAgICAgIH0pOwoKICAgICAgaWYgKHRoaXMuc3RhdGUuaXNEZWxldGluZ0l0ZW1zKSB7CiAgICAgICAgZGVsZXRlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAia2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLmRlbGV0ZVNlbGVjdGVkSXRlbXNDb25maXJtTW9kYWwuY29uZmlybUJ1dHRvbkxhYmVsRGVsZXRpbmciLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGluZyIKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlPdmVybGF5TWFzaywgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbmZpcm1Nb2RhbCwgewogICAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJrYm4udGFibGVfbGlzdF92aWV3Lmxpc3RpbmcuZGVsZXRlU2VsZWN0ZWRDb25maXJtTW9kYWwudGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUge2l0ZW1Db3VudH0gc2VsZWN0ZWQge2VudGl0eU5hbWV9PyIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgaXRlbUNvdW50OiB0aGlzLnN0YXRlLnNlbGVjdGVkSWRzLmxlbmd0aCwKICAgICAgICAgICAgZW50aXR5TmFtZTogdGhpcy5zdGF0ZS5zZWxlY3RlZElkcy5sZW5ndGggPT09IDEgPyB0aGlzLnByb3BzLmVudGl0eU5hbWUgOiB0aGlzLnByb3BzLmVudGl0eU5hbWVQbHVyYWwKICAgICAgICAgIH0KICAgICAgICB9KSwKICAgICAgICBidXR0b25Db2xvcjogImRhbmdlciIsCiAgICAgICAgb25DYW5jZWw6IHRoaXMuY2xvc2VEZWxldGVNb2RhbCwKICAgICAgICBvbkNvbmZpcm06IHRoaXMuZGVsZXRlU2VsZWN0ZWRJdGVtcywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJrYm4udGFibGVfbGlzdF92aWV3Lmxpc3RpbmcuZGVsZXRlU2VsZWN0ZWRJdGVtc0NvbmZpcm1Nb2RhbC5jYW5jZWxCdXR0b25MYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNhbmNlbCIKICAgICAgICB9KSwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogZGVsZXRlQnV0dG9uLAogICAgICAgIGRlZmF1bHRGb2N1c2VkQnV0dG9uOiAiY2FuY2VsIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi50YWJsZV9saXN0X3ZpZXcubGlzdGluZy5kZWxldGVDb25maXJtTW9kYWxEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJZb3UgY2FuJ3QgcmVjb3ZlciBkZWxldGVkIHtlbnRpdHlOYW1lUGx1cmFsfS4iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgZW50aXR5TmFtZVBsdXJhbDogdGhpcy5wcm9wcy5lbnRpdHlOYW1lUGx1cmFsCiAgICAgICAgfQogICAgICB9KSkpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJMaXN0aW5nTGltaXRXYXJuaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJMaXN0aW5nTGltaXRXYXJuaW5nKCkgewogICAgICBpZiAodGhpcy5zdGF0ZS5zaG93TGltaXRFcnJvcikgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAia2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLmxpc3RpbmdMaW1pdEV4Y2VlZGVkVGl0bGUiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxpc3RpbmcgbGltaXQgZXhjZWVkZWQiCiAgICAgICAgICB9KSwKICAgICAgICAgIGNvbG9yOiAid2FybmluZyIsCiAgICAgICAgICBpY29uVHlwZTogImhlbHAiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi50YWJsZV9saXN0X3ZpZXcubGlzdGluZy5saXN0aW5nTGltaXRFeGNlZWRlZERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGhhdmUge3RvdGFsSXRlbXN9IHtlbnRpdHlOYW1lUGx1cmFsfSwgYnV0IHlvdXIge2xpc3RpbmdMaW1pdFRleHR9IHNldHRpbmcgcHJldmVudHMgdGhlIHRhYmxlIGJlbG93IGZyb20gZGlzcGxheWluZyBtb3JlIHRoYW4ge2xpc3RpbmdMaW1pdFZhbHVlfS4gWW91IGNhbiBjaGFuZ2UgdGhpcyBzZXR0aW5nIHVuZGVyIHthZHZhbmNlZFNldHRpbmdzTGlua30uIiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBlbnRpdHlOYW1lUGx1cmFsOiB0aGlzLnByb3BzLmVudGl0eU5hbWVQbHVyYWwsCiAgICAgICAgICAgIHRvdGFsSXRlbXM6IHRoaXMuc3RhdGUudG90YWxJdGVtcywKICAgICAgICAgICAgbGlzdGluZ0xpbWl0VmFsdWU6IHRoaXMucHJvcHMubGlzdGluZ0xpbWl0LAogICAgICAgICAgICBsaXN0aW5nTGltaXRUZXh0OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzdHJvbmciLCBudWxsLCAibGlzdGluZ0xpbWl0IiksCiAgICAgICAgICAgIGFkdmFuY2VkU2V0dGluZ3NMaW5rOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgICAgIGhyZWY6ICIjL21hbmFnZW1lbnQva2liYW5hL3NldHRpbmdzIgogICAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICAgIGlkOiAia2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLmxpc3RpbmdMaW1pdEV4Y2VlZGVkLmFkdmFuY2VkU2V0dGluZ3NMaW5rVGV4dCIsCiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBZHZhbmNlZCBTZXR0aW5ncyIKICAgICAgICAgICAgfSkpCiAgICAgICAgICB9CiAgICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgICAgc2l6ZTogIm0iCiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyTm9JdGVtc01lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlck5vSXRlbXNNZXNzYWdlKCkgewogICAgICBpZiAodGhpcy5wcm9wcy5ub0l0ZW1zRnJhZ21lbnQpIHsKICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5ub0l0ZW1zRnJhZ21lbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi50YWJsZV9saXN0X3ZpZXcubGlzdGluZy5ub0F2YWlsYWJsZUl0ZW1zTWVzc2FnZSIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5vIHtlbnRpdHlOYW1lUGx1cmFsfSBhdmFpbGFibGUuIiwKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBlbnRpdHlOYW1lUGx1cmFsOiB0aGlzLnByb3BzLmVudGl0eU5hbWVQbHVyYWwKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclRvb2xzTGVmdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyVG9vbHNMZWZ0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLnN0YXRlLnNlbGVjdGVkSWRzOwoKICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBvbkNsaWNrID0gZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICBfdGhpczIub3BlbkRlbGV0ZU1vZGFsKCk7CiAgICAgIH07CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICBpY29uVHlwZTogInRyYXNoIiwKICAgICAgICBvbkNsaWNrOiBvbkNsaWNrLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJkZWxldGVTZWxlY3RlZEl0ZW1zIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAia2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLmRlbGV0ZUJ1dHRvbk1lc3NhZ2UiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRGVsZXRlIHtpdGVtQ291bnR9IHtlbnRpdHlOYW1lfSIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBpdGVtQ291bnQ6IHNlbGVjdGlvbi5sZW5ndGgsCiAgICAgICAgICBlbnRpdHlOYW1lOiBzZWxlY3Rpb24ubGVuZ3RoID09PSAxID8gdGhpcy5wcm9wcy5lbnRpdHlOYW1lIDogdGhpcy5wcm9wcy5lbnRpdHlOYW1lUGx1cmFsCiAgICAgICAgfQogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyVGFibGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRhYmxlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBwYWdpbmF0aW9uID0gewogICAgICAgIHBhZ2VJbmRleDogdGhpcy5zdGF0ZS5wYWdlLAogICAgICAgIHBhZ2VTaXplOiB0aGlzLnN0YXRlLnBlclBhZ2UsCiAgICAgICAgdG90YWxJdGVtQ291bnQ6IHRoaXMuc3RhdGUuaXRlbXMubGVuZ3RoLAogICAgICAgIHBhZ2VTaXplT3B0aW9uczogUEFHRV9TSVpFX09QVElPTlMKICAgICAgfTsKICAgICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMucHJvcHMuZGVsZXRlSXRlbXMgPyB7CiAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2U6IGZ1bmN0aW9uIG9uU2VsZWN0aW9uQ2hhbmdlKHNlbGVjdGlvbikgewogICAgICAgICAgX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgc2VsZWN0ZWRJZHM6IHNlbGVjdGlvbi5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZDsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSA6IG51bGw7CiAgICAgIHZhciBhY3Rpb25zID0gW3sKICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLnRhYmxlLmVkaXRBY3Rpb25OYW1lJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFZGl0JwogICAgICAgIH0pLAogICAgICAgIGRlc2NyaXB0aW9uOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLnRhYmxlLmVkaXRBY3Rpb25EZXNjcmlwdGlvbicsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRWRpdCcKICAgICAgICB9KSwKICAgICAgICBpY29uOiAncGVuY2lsJywKICAgICAgICB0eXBlOiAnaWNvbicsCiAgICAgICAgb25DbGljazogdGhpcy5wcm9wcy5lZGl0SXRlbQogICAgICB9XTsKICAgICAgdmFyIHNlYXJjaCA9IHsKICAgICAgICBvbkNoYW5nZTogdGhpcy5zZXRGaWx0ZXIuYmluZCh0aGlzKSwKICAgICAgICB0b29sc0xlZnQ6IHRoaXMucmVuZGVyVG9vbHNMZWZ0KCksCiAgICAgICAgZGVmYXVsdFF1ZXJ5OiB0aGlzLnN0YXRlLmZpbHRlciwKICAgICAgICBib3g6IHsKICAgICAgICAgIGluY3JlbWVudGFsOiB0cnVlCiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgY29sdW1ucyA9IHRoaXMucHJvcHMudGFibGVDb2x1bW5zLnNsaWNlKCk7CgogICAgICBpZiAodGhpcy5wcm9wcy5lZGl0SXRlbSkgewogICAgICAgIGNvbHVtbnMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLnRhYmxlLmFjdGlvblRpdGxlJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0FjdGlvbnMnCiAgICAgICAgICB9KSwKICAgICAgICAgIHdpZHRoOiAnMTAwcHgnLAogICAgICAgICAgYWN0aW9uczogYWN0aW9ucwogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgbm9JdGVtc01lc3NhZ2UgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAia2JuLnRhYmxlX2xpc3Rfdmlldy5saXN0aW5nLm5vTWF0Y2hlZEl0ZW1zTWVzc2FnZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJObyB7ZW50aXR5TmFtZVBsdXJhbH0gbWF0Y2hlZCB5b3VyIHNlYXJjaC4iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgZW50aXR5TmFtZVBsdXJhbDogdGhpcy5wcm9wcy5lbnRpdHlOYW1lUGx1cmFsCiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSW5NZW1vcnlUYWJsZSwgewogICAgICAgIGl0ZW1JZDogImlkIiwKICAgICAgICBpdGVtczogdGhpcy5zdGF0ZS5pdGVtcywKICAgICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICAgIHBhZ2luYXRpb246IHBhZ2luYXRpb24sCiAgICAgICAgbG9hZGluZzogdGhpcy5zdGF0ZS5pc0ZldGNoaW5nSXRlbXMsCiAgICAgICAgbWVzc2FnZTogbm9JdGVtc01lc3NhZ2UsCiAgICAgICAgc2VsZWN0aW9uOiBzZWxlY3Rpb24sCiAgICAgICAgc2VhcmNoOiBzZWFyY2gsCiAgICAgICAgc29ydGluZzogdHJ1ZSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiaXRlbXNJbk1lbVRhYmxlIgogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJMaXN0aW5nT3JFbXB0eVN0YXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJMaXN0aW5nT3JFbXB0eVN0YXRlKCkgewogICAgICBpZiAodGhpcy5oYXNOb0l0ZW1zKCkpIHsKICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJOb0l0ZW1zTWVzc2FnZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5yZW5kZXJMaXN0aW5nKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyTGlzdGluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyTGlzdGluZygpIHsKICAgICAgdmFyIGNyZWF0ZUJ1dHRvbjsKCiAgICAgIGlmICh0aGlzLnByb3BzLmNyZWF0ZUl0ZW0pIHsKICAgICAgICBjcmVhdGVCdXR0b24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgICAgb25DbGljazogdGhpcy5wcm9wcy5jcmVhdGVJdGVtLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogIm5ld0l0ZW1CdXR0b24iLAogICAgICAgICAgaWNvblR5cGU6ICJwbHVzSW5DaXJjbGUiLAogICAgICAgICAgZmlsbDogdHJ1ZQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogImtibi50YWJsZV9saXN0X3ZpZXcubGlzdGluZy5jcmVhdGVOZXdJdGVtQnV0dG9uTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgbmV3IHtlbnRpdHlOYW1lfSIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgZW50aXR5TmFtZTogdGhpcy5wcm9wcy5lbnRpdHlOYW1lCiAgICAgICAgICB9CiAgICAgICAgfSkpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIHRoaXMuc3RhdGUuc2hvd0RlbGV0ZU1vZGFsICYmIHRoaXMucmVuZGVyQ29uZmlybURlbGV0ZU1vZGFsKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBqdXN0aWZ5Q29udGVudDogInNwYWNlQmV0d2VlbiIsCiAgICAgICAgYWxpZ25JdGVtczogImZsZXhFbmQiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0b3AtbmF2IgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgICAgICBzaXplOiAibCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDEiLCBudWxsLCB0aGlzLnByb3BzLnRhYmxlTGlzdFRpdGxlKSkpLCBjcmVhdGVCdXR0b24pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgc2l6ZTogIm0iCiAgICAgIH0pLCB0aGlzLnJlbmRlckxpc3RpbmdMaW1pdFdhcm5pbmcoKSwgdGhpcy5yZW5kZXJUYWJsZSgpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJQYWdlQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyUGFnZUNvbnRlbnQoKSB7CiAgICAgIGlmICghdGhpcy5zdGF0ZS5oYXNJbml0aWFsRmV0Y2hSZXR1cm5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgewogICAgICAgIGhvcml6b250YWxQb3NpdGlvbjogImNlbnRlciIKICAgICAgfSwgdGhpcy5yZW5kZXJMaXN0aW5nT3JFbXB0eVN0YXRlKCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2UsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiB0aGlzLnByb3BzLmVudGl0eU5hbWUgKyAnTGFuZGluZ1BhZ2UnLAogICAgICAgIGNsYXNzTmFtZTogIml0ZW1MaXN0aW5nX19wYWdlIiwKICAgICAgICByZXN0cmljdFdpZHRoOiB0cnVlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQm9keSwgbnVsbCwgdGhpcy5yZW5kZXJQYWdlQ29udGVudCgpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVGFibGVMaXN0Vmlld1VpOwp9KF9yZWFjdC5kZWZhdWx0LkNvbXBvbmVudCk7CgpUYWJsZUxpc3RWaWV3VWkucHJvcFR5cGVzID0gewogIHRhYmxlQ29sdW1uczogX3Byb3BUeXBlcy5kZWZhdWx0LmFycmF5LmlzUmVxdWlyZWQsCiAgbm9JdGVtc0ZyYWdtZW50OiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LAogIGZpbmRJdGVtczogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBkZWxldGVJdGVtczogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMsCiAgY3JlYXRlSXRlbTogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMsCiAgZWRpdEl0ZW06IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLAogIGxpc3RpbmdMaW1pdDogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlciwKICBpbml0aWFsRmlsdGVyOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLAogIGVudGl0eU5hbWU6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcuaXNSZXF1aXJlZCwKICBlbnRpdHlOYW1lUGx1cmFsOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLmlzUmVxdWlyZWQsCiAgdGFibGVMaXN0VGl0bGU6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcuaXNSZXF1aXJlZAp9OwpUYWJsZUxpc3RWaWV3VWkuZGVmYXVsdFByb3BzID0gewogIGluaXRpYWxGaWx0ZXI6IEVNUFRZX0ZJTFRFUgp9Owp2YXIgVGFibGVMaXN0VmlldyA9ICgwLCBfcmVhY3QyLmluamVjdEkxOG4pKFRhYmxlTGlzdFZpZXdVaSk7CmV4cG9ydHMuVGFibGVMaXN0VmlldyA9IFRhYmxlTGlzdFZpZXc7"},null]}