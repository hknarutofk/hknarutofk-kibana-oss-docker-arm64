{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/tile_map/common/ems_client.js","dependencies":[{"path":"src/legacy/core_plugins/tile_map/common/ems_client.js","mtime":1572296411320},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1572297165884},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1572297178034},{"path":"node_modules/babel-loader/lib/index.js","mtime":1572297165764}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRU1TQ2xpZW50ID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfdG1zX3NlcnZpY2UgPSByZXF1aXJlKCIuL3Rtc19zZXJ2aWNlIik7Cgp2YXIgX2ZpbGVfbGF5ZXIgPSByZXF1aXJlKCIuL2ZpbGVfbGF5ZXIiKTsKCnZhciBfbm9kZUZldGNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJub2RlLWZldGNoIikpOwoKdmFyIF91cmwgPSByZXF1aXJlKCJ1cmwiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgZXh0ZW5kVXJsID0gZnVuY3Rpb24gZXh0ZW5kVXJsKHVybCwgcHJvcHMpIHsKICByZXR1cm4gbW9kaWZ5VXJsTG9jYWwodXJsLCBmdW5jdGlvbiAocGFyc2VkKSB7CiAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0Lm1lcmdlKHBhcnNlZCwgcHJvcHMpOwogIH0pOwp9OwovKioKICogcGx1Z2lucyBjYW5ub3QgaGF2ZSB1cHN0cmVhbSBkZXBlbmRlbmNpZXMgb24gY29yZS8qLWtpYmFuYS4KICogV29yay1hcm91bmQgYnkgY29weS1wYXN0aW5nIG1vZGlmeVVybCByb3V0aW5lIGhlcmUuCiAqIEBwYXJhbSB1cmwKICogQHBhcmFtIGJsb2NrCiAqLwoKCmZ1bmN0aW9uIG1vZGlmeVVybExvY2FsKHVybCwgYmxvY2spIHsKICB2YXIgcGFyc2VkID0gKDAsIF91cmwucGFyc2UpKHVybCwgdHJ1ZSk7IC8vIGNvcHkgb3ZlciB0aGUgbW9zdCBzcGVjaWZpYyB2ZXJzaW9uIG9mIGVhY2gKICAvLyBwcm9wZXJ0eS4gQnkgZGVmYXVsdCwgdGhlIHBhcnNlZCB1cmwgaW5jbHVkZXMKICAvLyBzZXZlcmFsIGNvbmZsaWN0aW5nIHByb3BlcnRpZXMgKGxpa2UgcGF0aCBhbmQKICAvLyBwYXRobmFtZSArIHNlYXJjaCwgb3Igc2VhcmNoIGFuZCBxdWVyeSkgYW5kIGtlZXBpbmcKICAvLyB0cmFjayBvZiB3aGljaCBwcm9wZXJ0eSBpcyBhY3R1YWxseSB1c2VkIHdoZW4gdGhleQogIC8vIGFyZSBmb3JtYXR0ZWQgaXMgaGFyZGVyIHRoYW4gbmVjZXNzYXJ5CgogIHZhciBtZWFuaW5nZnVsUGFydHMgPSB7CiAgICBwcm90b2NvbDogcGFyc2VkLnByb3RvY29sLAogICAgc2xhc2hlczogcGFyc2VkLnNsYXNoZXMsCiAgICBhdXRoOiBwYXJzZWQuYXV0aCwKICAgIGhvc3RuYW1lOiBwYXJzZWQuaG9zdG5hbWUsCiAgICBwb3J0OiBwYXJzZWQucG9ydCwKICAgIHBhdGhuYW1lOiBwYXJzZWQucGF0aG5hbWUsCiAgICBxdWVyeTogcGFyc2VkLnF1ZXJ5IHx8IHt9LAogICAgaGFzaDogcGFyc2VkLmhhc2gKICB9OyAvLyB0aGUgYmxvY2sgbW9kaWZpZXMgdGhlIG1lYW5pbmdmdWxQYXJ0cyBvYmplY3QsIG9yIHJldHVybnMgYSBuZXcgb25lCgogIHZhciBtb2RpZmllZFBhcnRzID0gYmxvY2sobWVhbmluZ2Z1bFBhcnRzKSB8fCBtZWFuaW5nZnVsUGFydHM7IC8vIGZvcm1hdCB0aGUgbW9kaWZpZWQvcmVwbGFjZWQgbWVhbmluZ2Z1bFBhcnRzIGJhY2sgaW50byBhIHVybAoKICByZXR1cm4gKDAsIF91cmwuZm9ybWF0KSh7CiAgICBwcm90b2NvbDogbW9kaWZpZWRQYXJ0cy5wcm90b2NvbCwKICAgIHNsYXNoZXM6IG1vZGlmaWVkUGFydHMuc2xhc2hlcywKICAgIGF1dGg6IG1vZGlmaWVkUGFydHMuYXV0aCwKICAgIGhvc3RuYW1lOiBtb2RpZmllZFBhcnRzLmhvc3RuYW1lLAogICAgcG9ydDogbW9kaWZpZWRQYXJ0cy5wb3J0LAogICAgcGF0aG5hbWU6IG1vZGlmaWVkUGFydHMucGF0aG5hbWUsCiAgICBxdWVyeTogbW9kaWZpZWRQYXJ0cy5xdWVyeSwKICAgIGhhc2g6IG1vZGlmaWVkUGFydHMuaGFzaAogIH0pOwp9Ci8qKgogKiAgVW5lc2NhcGUgYSB1cmwgdGVtcGxhdGUgdGhhdCB3YXMgZXNjYXBlZCBieSBlbmNvZGVVUkkoKSBzbyBsZWFmbGV0CiAqICB3aWxsIGJlIGFibGUgdG8gY29ycmVjdGx5IGxvY2F0ZSB0aGUgdmFyaWFibGVzIGluIHRoZSB0ZW1wbGF0ZQogKiAgQHBhcmFtICB7U3RyaW5nfSB1cmwKICogIEByZXR1cm4ge1N0cmluZ30KICovCgoKdmFyIHVuZXNjYXBlVGVtcGxhdGVWYXJzID0gZnVuY3Rpb24gdW5lc2NhcGVUZW1wbGF0ZVZhcnModXJsKSB7CiAgdmFyIEVOQ09ERURfVEVNUExBVEVfVkFSU19SRSA9IC8lN0IoXHcrPyklN0QvZzsKICByZXR1cm4gdXJsLnJlcGxhY2UoRU5DT0RFRF9URU1QTEFURV9WQVJTX1JFLCBmdW5jdGlvbiAodG90YWwsIHZhck5hbWUpIHsKICAgIHJldHVybiAieyIuY29uY2F0KHZhck5hbWUsICJ9Iik7CiAgfSk7Cn07IC8vdGhpcyBpcyBub3QgdGhlIGRlZmF1bHQgbG9jYWxlIGZyb20gS2liYW5hLCBidXQgdGhlIGRlZmF1bHQgbG9jYWxlIHN1cHBvcnRlZCBieSB0aGUgRWxhc3RpYyBNYXBzIFNlcnZpY2UKCgp2YXIgREVGQVVMVF9MQU5HVUFHRSA9ICdlbic7Cgp2YXIgRU1TQ2xpZW50ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRU1TQ2xpZW50KF9yZWYpIHsKICAgIHZhciBrYm5WZXJzaW9uID0gX3JlZi5rYm5WZXJzaW9uLAogICAgICAgIG1hbmlmZXN0U2VydmljZVVybCA9IF9yZWYubWFuaWZlc3RTZXJ2aWNlVXJsLAogICAgICAgIGh0bWxTYW5pdGl6ZXIgPSBfcmVmLmh0bWxTYW5pdGl6ZXIsCiAgICAgICAgbGFuZ3VhZ2UgPSBfcmVmLmxhbmd1YWdlLAogICAgICAgIGxhbmRpbmdQYWdlVXJsID0gX3JlZi5sYW5kaW5nUGFnZVVybCwKICAgICAgICBmZXRjaEZ1bmN0aW9uID0gX3JlZi5mZXRjaEZ1bmN0aW9uLAogICAgICAgIHByb3h5UGF0aCA9IF9yZWYucHJveHlQYXRoOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFTVNDbGllbnQpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiRU1TX0xPQURfVElNRU9VVCIsIDMyMDAwKTsKCiAgICB0aGlzLl9xdWVyeVBhcmFtcyA9IHsKICAgICAgZWxhc3RpY190aWxlX3NlcnZpY2VfdG9zOiAnYWdyZWUnLAogICAgICBteV9hcHBfbmFtZTogJ2tpYmFuYScsCiAgICAgIG15X2FwcF92ZXJzaW9uOiBrYm5WZXJzaW9uCiAgICB9OwogICAgdGhpcy5fc2FuaXRpemVyID0gaHRtbFNhbml0aXplciA/IGh0bWxTYW5pdGl6ZXIgOiBmdW5jdGlvbiAoeCkgewogICAgICByZXR1cm4geDsKICAgIH07CiAgICB0aGlzLl9tYW5pZmVzdFNlcnZpY2VVcmwgPSBtYW5pZmVzdFNlcnZpY2VVcmw7CiAgICB0aGlzLl9sb2FkRmlsZUxheWVycyA9IG51bGw7CiAgICB0aGlzLl9sb2FkVE1TU2VydmljZXMgPSBudWxsOwogICAgdGhpcy5fZW1zTGFuZGluZ1BhZ2VVcmwgPSB0eXBlb2YgbGFuZGluZ1BhZ2VVcmwgPT09ICdzdHJpbmcnID8gbGFuZGluZ1BhZ2VVcmwgOiAnJzsKICAgIHRoaXMuX2xhbmd1YWdlID0gdHlwZW9mIGxhbmd1YWdlID09PSAnc3RyaW5nJyA/IGxhbmd1YWdlIDogREVGQVVMVF9MQU5HVUFHRTsKICAgIHRoaXMuX2ZldGNoRnVuY3Rpb24gPSB0eXBlb2YgZmV0Y2hGdW5jdGlvbiA9PT0gJ2Z1bmN0aW9uJyA/IGZldGNoRnVuY3Rpb24gOiBfbm9kZUZldGNoLmRlZmF1bHQ7CiAgICB0aGlzLl9wcm94eVBhdGggPSB0eXBlb2YgcHJveHlQYXRoID09PSAnc3RyaW5nJyA/IHByb3h5UGF0aCA6ICcnOwoKICAgIHRoaXMuX2ludmFsaWRhdGVTZXR0aW5ncygpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEVNU0NsaWVudCwgW3sKICAgIGtleTogImdldERlZmF1bHRMb2NhbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlZmF1bHRMb2NhbGUoKSB7CiAgICAgIHJldHVybiBERUZBVUxUX0xBTkdVQUdFOwogICAgfQogIH0sIHsKICAgIGtleTogImdldExvY2FsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9jYWxlKCkgewogICAgICByZXR1cm4gdGhpcy5fbGFuZ3VhZ2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VmFsdWVJbkxhbmd1YWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZUluTGFuZ3VhZ2UoaTE4bk9iamVjdCkgewogICAgICBpZiAoIWkxOG5PYmplY3QpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIHJldHVybiBpMThuT2JqZWN0W3RoaXMuX2xhbmd1YWdlXSA/IGkxOG5PYmplY3RbdGhpcy5fbGFuZ3VhZ2VdIDogaTE4bk9iamVjdFtERUZBVUxUX0xBTkdVQUdFXTsKICAgIH0KICAgIC8qKgogICAgICogdGhpcyBpbnRlcm5hbCBtZXRob2QgaXMgb3ZlcnJpZGRlbiBieSB0aGUgdGVzdHMgdG8gc2ltdWxhdGUgY3VzdG9tIG1hbmlmZXN0LgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE1hbmlmZXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0TWFuaWZlc3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKG1hbmlmZXN0VXJsKSB7CiAgICAgICAgdmFyIHVybCwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgICAgdXJsID0gZXh0ZW5kVXJsKG1hbmlmZXN0VXJsLCB7CiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiB0aGlzLl9xdWVyeVBhcmFtcwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mZXRjaFdpdGhUaW1lb3V0KHVybCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuanNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gbnVsbDsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgaWYgKCFfY29udGV4dC50MSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC50MSA9IG5ldyBFcnJvcignVW5rbm93biBlcnJvcicpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0LnQxIGluc3RhbmNlb2YgRXJyb3IpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gbmV3IEVycm9yKF9jb250ZXh0LnQxLmRhdGEgfHwgInN0YXR1cyAiLmNvbmNhdChfY29udGV4dC50MS5zdGF0dXNUZXh0IHx8IF9jb250ZXh0LnQxLnN0YXR1cykpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIHJldHJpZXZlIG1hbmlmZXN0IGZyb20gIi5jb25jYXQobWFuaWZlc3RVcmwsICI6ICIpLmNvbmNhdChfY29udGV4dC50MS5tZXNzYWdlKSk7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzAsIDE1XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRNYW5pZmVzdChfeCkgewogICAgICAgIHJldHVybiBfZ2V0TWFuaWZlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldE1hbmlmZXN0OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX2ZldGNoV2l0aFRpbWVvdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9mZXRjaFdpdGhUaW1lb3V0KHVybCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCJSZXF1ZXN0IHRvICIuY29uY2F0KHVybCwgIiB0aW1lZCBvdXQiKSkpOwogICAgICAgIH0sIF90aGlzLkVNU19MT0FEX1RJTUVPVVQpOwoKICAgICAgICBfdGhpcy5fZmV0Y2hGdW5jdGlvbih1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIG9wdGlvbmFsIHF1ZXJ5LXBhcmFtZXRlcnMgdG8gYWxsIHJlcXVlc3RzCiAgICAgKgogICAgICogQHBhcmFtIGFkZGl0aW9uYWxRdWVyeVBhcmFtcwogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZFF1ZXJ5UGFyYW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRRdWVyeVBhcmFtcyhhZGRpdGlvbmFsUXVlcnlQYXJhbXMpIHsKICAgICAgZm9yICh2YXIga2V5IGluIGFkZGl0aW9uYWxRdWVyeVBhcmFtcykgewogICAgICAgIGlmIChhZGRpdGlvbmFsUXVlcnlQYXJhbXMuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgaWYgKGFkZGl0aW9uYWxRdWVyeVBhcmFtc1trZXldICE9PSB0aGlzLl9xdWVyeVBhcmFtc1trZXldKSB7CiAgICAgICAgICAgIC8vY2hhbmdlcyBkZXRlY3RlZC4KICAgICAgICAgICAgdGhpcy5fcXVlcnlQYXJhbXMgPSBfbG9kYXNoLmRlZmF1bHQuYXNzaWduKHt9LCB0aGlzLl9xdWVyeVBhcmFtcywgYWRkaXRpb25hbFF1ZXJ5UGFyYW1zKTsKCiAgICAgICAgICAgIHRoaXMuX2ludmFsaWRhdGVTZXR0aW5ncygpOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiX2dldE1hbmlmZXN0V2l0aFBhcmFtcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldE1hbmlmZXN0V2l0aFBhcmFtczIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMih1cmwpIHsKICAgICAgICB2YXIgZXh0ZW5kZWRVcmw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGV4dGVuZGVkVXJsID0gdGhpcy5leHRlbmRVcmxXaXRoUGFyYW1zKHVybCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRNYW5pZmVzdChleHRlbmRlZFVybCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDIuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIF9nZXRNYW5pZmVzdFdpdGhQYXJhbXMoX3gyKSB7CiAgICAgICAgcmV0dXJuIF9nZXRNYW5pZmVzdFdpdGhQYXJhbXMyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfZ2V0TWFuaWZlc3RXaXRoUGFyYW1zOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX2ludmFsaWRhdGVTZXR0aW5ncyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludmFsaWRhdGVTZXR0aW5ncygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9nZXRNYWluQ2F0YWxvZyA9IF9sb2Rhc2guZGVmYXVsdC5vbmNlKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLl9nZXRNYW5pZmVzdFdpdGhQYXJhbXMoX3RoaXMyLl9tYW5pZmVzdFNlcnZpY2VVcmwpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQzLnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkpOwogICAgICB0aGlzLl9nZXREZWZhdWx0VE1TQ2F0YWxvZyA9IF9sb2Rhc2guZGVmYXVsdC5vbmNlKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBjYXRhbG9ndWUsIGZpcnN0U2VydmljZSwgdXJsOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLl9nZXRNYWluQ2F0YWxvZygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBjYXRhbG9ndWUgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGZpcnN0U2VydmljZSA9IGNhdGFsb2d1ZS5zZXJ2aWNlcy5maW5kKGZ1bmN0aW9uIChzZXJ2aWNlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLnR5cGUgPT09ICd0bXMnOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGZpcnN0U2VydmljZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHVybCA9IF90aGlzMi5fcHJveHlQYXRoICsgZmlyc3RTZXJ2aWNlLm1hbmlmZXN0OwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5nZXRNYW5pZmVzdCh1cmwpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ0LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKTsKICAgICAgdGhpcy5fZ2V0RGVmYXVsdEZpbGVDYXRhbG9nID0gX2xvZGFzaC5kZWZhdWx0Lm9uY2UoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIGNhdGFsb2d1ZSwgZmlyc3RTZXJ2aWNlLCB1cmw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuX2dldE1haW5DYXRhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGNhdGFsb2d1ZSA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgZmlyc3RTZXJ2aWNlID0gY2F0YWxvZ3VlLnNlcnZpY2VzLmZpbmQoZnVuY3Rpb24gKHNlcnZpY2UpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UudHlwZSA9PT0gJ2ZpbGUnOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGZpcnN0U2VydmljZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHVybCA9IF90aGlzMi5fcHJveHlQYXRoICsgZmlyc3RTZXJ2aWNlLm1hbmlmZXN0OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5nZXRNYW5pZmVzdCh1cmwpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ1LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKTsgLy9DYWNoZSB0aGUgYWN0dWFsIGluc3RhbmNlcyBvZiBUTVNTZXJ2aWNlIGFzIHRoZXNlIGluIHR1cm4gY2FjaGUgc3ViLW1hbmlmZXN0cyBmb3IgdGhlIHN0eWxlLWZpbGVzCgogICAgICB0aGlzLl9sb2FkVE1TU2VydmljZXMgPSBfbG9kYXNoLmRlZmF1bHQub25jZSgKICAgICAgLyojX19QVVJFX18qLwogICAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgdG1zTWFuaWZlc3Q7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuX2dldERlZmF1bHRUTVNDYXRhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRtc01hbmlmZXN0ID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgdG1zTWFuaWZlc3Quc2VydmljZXMubWFwKGZ1bmN0aW9uIChzZXJ2aWNlQ29uZmlnKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgX3Rtc19zZXJ2aWNlLlRNU1NlcnZpY2Uoc2VydmljZUNvbmZpZywgX3RoaXMyLCBfdGhpczIuX3Byb3h5UGF0aCk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSk7CiAgICAgIHRoaXMuX2xvYWRGaWxlTGF5ZXJzID0gX2xvZGFzaC5kZWZhdWx0Lm9uY2UoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGZpbGVNYW5pZmVzdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5fZ2V0RGVmYXVsdEZpbGVDYXRhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGZpbGVNYW5pZmVzdCA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIGZpbGVNYW5pZmVzdC5sYXllcnMubWFwKGZ1bmN0aW9uIChsYXllckNvbmZpZykgewogICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IF9maWxlX2xheWVyLkZpbGVMYXllcihsYXllckNvbmZpZywgX3RoaXMyLCBfdGhpczIuX3Byb3h5UGF0aCk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWFpbk1hbmlmZXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0TWFpbk1hbmlmZXN0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRNYWluQ2F0YWxvZygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ4LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRNYWluTWFuaWZlc3QoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRNYWluTWFuaWZlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldE1haW5NYW5pZmVzdDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldERlZmF1bHRGaWxlTWFuaWZlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXREZWZhdWx0RmlsZU1hbmlmZXN0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXREZWZhdWx0RmlsZUNhdGFsb2coKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0OS5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEZpbGVNYW5pZmVzdCgpIHsKICAgICAgICByZXR1cm4gX2dldERlZmF1bHRGaWxlTWFuaWZlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldERlZmF1bHRGaWxlTWFuaWZlc3Q7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXREZWZhdWx0VE1TTWFuaWZlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXREZWZhdWx0VE1TTWFuaWZlc3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldERlZmF1bHRUTVNDYXRhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQxMC5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTAsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXREZWZhdWx0VE1TTWFuaWZlc3QoKSB7CiAgICAgICAgcmV0dXJuIF9nZXREZWZhdWx0VE1TTWFuaWZlc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldERlZmF1bHRUTVNNYW5pZmVzdDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldEZpbGVMYXllcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRGaWxlTGF5ZXJzID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkRmlsZUxheWVycygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0MTEuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0RmlsZUxheWVycygpIHsKICAgICAgICByZXR1cm4gX2dldEZpbGVMYXllcnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEZpbGVMYXllcnM7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRUTVNTZXJ2aWNlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldFRNU1NlcnZpY2VzID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkVE1TU2VydmljZXMoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDEyLnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldFRNU1NlcnZpY2VzKCkgewogICAgICAgIHJldHVybiBfZ2V0VE1TU2VydmljZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFRNU1NlcnZpY2VzOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0TGFuZGluZ1BhZ2VVcmwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhbmRpbmdQYWdlVXJsKCkgewogICAgICByZXR1cm4gdGhpcy5fZW1zTGFuZGluZ1BhZ2VVcmw7CiAgICB9CiAgfSwgewogICAga2V5OiAic2FuaXRpemVIdG1sIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYW5pdGl6ZUh0bWwoaHRtbCkgewogICAgICByZXR1cm4gdGhpcy5fc2FuaXRpemVyKGh0bWwpOwogICAgfQogIH0sIHsKICAgIGtleTogImV4dGVuZFVybFdpdGhQYXJhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4dGVuZFVybFdpdGhQYXJhbXModXJsKSB7CiAgICAgIHJldHVybiB1bmVzY2FwZVRlbXBsYXRlVmFycyhleHRlbmRVcmwodXJsLCB7CiAgICAgICAgcXVlcnk6IHRoaXMuX3F1ZXJ5UGFyYW1zCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaW5kRmlsZUxheWVyQnlJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ZpbmRGaWxlTGF5ZXJCeUlkID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKGlkKSB7CiAgICAgICAgdmFyIGZpbGVMYXllcnMsIGk7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsZUxheWVycygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBmaWxlTGF5ZXJzID0gX2NvbnRleHQxMy5zZW50OwogICAgICAgICAgICAgICAgaSA9IDA7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmICghKGkgPCBmaWxlTGF5ZXJzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghZmlsZUxheWVyc1tpXS5oYXNJZChpZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iLCBmaWxlTGF5ZXJzW2ldKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBmaW5kRmlsZUxheWVyQnlJZChfeDMpIHsKICAgICAgICByZXR1cm4gX2ZpbmRGaWxlTGF5ZXJCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaW5kRmlsZUxheWVyQnlJZDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImZpbmRUTVNTZXJ2aWNlQnlJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ZpbmRUTVNTZXJ2aWNlQnlJZCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNChpZCkgewogICAgICAgIHZhciB0bXNTZXJ2aWNlcywgaTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUTVNTZXJ2aWNlcygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlcyA9IF9jb250ZXh0MTQuc2VudDsKICAgICAgICAgICAgICAgIGkgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoIShpIDwgdG1zU2VydmljZXMubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCF0bXNTZXJ2aWNlc1tpXS5oYXNJZChpZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KCJyZXR1cm4iLCB0bXNTZXJ2aWNlc1tpXSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZmluZFRNU1NlcnZpY2VCeUlkKF94NCkgewogICAgICAgIHJldHVybiBfZmluZFRNU1NlcnZpY2VCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaW5kVE1TU2VydmljZUJ5SWQ7CiAgICB9KCkKICB9XSk7CgogIHJldHVybiBFTVNDbGllbnQ7Cn0oKTsKCmV4cG9ydHMuRU1TQ2xpZW50ID0gRU1TQ2xpZW50Ow=="},null]}