(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}}var installedModules={};var installedChunks={0:0};function jsonpScriptSrc(chunkId){return __webpack_require__.p+"tileMap.chunk."+chunkId+".js"}function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.e=function requireEnsure(chunkId){var promises=[];var installedChunkData=installedChunks[chunkId];if(installedChunkData!==0){if(installedChunkData){promises.push(installedChunkData[2])}else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var script=document.createElement("script");var onScriptComplete;script.charset="utf-8";script.timeout=120;if(__webpack_require__.nc){script.setAttribute("nonce",__webpack_require__.nc)}script.src=jsonpScriptSrc(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null;clearTimeout(timeout);var chunk=installedChunks[chunkId];if(chunk!==0){if(chunk){var errorType=event&&(event.type==="load"?"missing":event.type);var realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")";error.name="ChunkLoadError";error.type=errorType;error.request=realSrc;chunk[1](error)}installedChunks[chunkId]=undefined}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete;document.head.appendChild(script)}}return Promise.all(promises)};__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.oe=function(err){console.error(err);throw err};var jsonpArray=window["tileMap_bundle_jsonpfunction"]=window["tileMap_bundle_jsonpfunction"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;return __webpack_require__(__webpack_require__.s=9)})([function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/mapsLegacy/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/visDefaultEditor/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_tileMap_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);var _node_modules_val_loader_dist_cjs_js_key_tileMap_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_tileMap_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/tileMap/public",__webpack_require__,13)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["tileMap"]},function(module,exports,__webpack_require__){__webpack_require__(12);module.exports="ngSanitize"},function(module,exports){
/**
 * @license AngularJS v1.8.0
 * (c) 2010-2020 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window,angular){"use strict";var $sanitizeMinErr=angular.$$minErr("$sanitize");var bind;var extend;var forEach;var isArray;var isDefined;var lowercase;var noop;var nodeContains;var htmlParser;var htmlSanitizeWriter;function $SanitizeProvider(){var hasBeenInstantiated=false;var svgEnabled=false;this.$get=["$$sanitizeUri",function($$sanitizeUri){hasBeenInstantiated=true;if(svgEnabled){extend(validElements,svgElements)}return function(html){var buf=[];htmlParser(html,htmlSanitizeWriter(buf,(function(uri,isImage){return!/^unsafe:/.test($$sanitizeUri(uri,isImage))})));return buf.join("")}}];this.enableSvg=function(enableSvg){if(isDefined(enableSvg)){svgEnabled=enableSvg;return this}else{return svgEnabled}};this.addValidElements=function(elements){if(!hasBeenInstantiated){if(isArray(elements)){elements={htmlElements:elements}}addElementsTo(svgElements,elements.svgElements);addElementsTo(voidElements,elements.htmlVoidElements);addElementsTo(validElements,elements.htmlVoidElements);addElementsTo(validElements,elements.htmlElements)}return this};this.addValidAttrs=function(attrs){if(!hasBeenInstantiated){extend(validAttrs,arrayToMap(attrs,true))}return this};bind=angular.bind;extend=angular.extend;forEach=angular.forEach;isArray=angular.isArray;isDefined=angular.isDefined;lowercase=angular.$$lowercase;noop=angular.noop;htmlParser=htmlParserImpl;htmlSanitizeWriter=htmlSanitizeWriterImpl;nodeContains=window.Node.prototype.contains||function(arg){return!!(this.compareDocumentPosition(arg)&16)};var SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^#-~ |!])/g;var voidElements=stringToMap("area,br,col,hr,img,wbr");var optionalEndTagBlockElements=stringToMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=stringToMap("rp,rt"),optionalEndTagElements=extend({},optionalEndTagInlineElements,optionalEndTagBlockElements);var blockElements=extend({},optionalEndTagBlockElements,stringToMap("address,article,"+"aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,"+"h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul"));var inlineElements=extend({},optionalEndTagInlineElements,stringToMap("a,abbr,acronym,b,"+"bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,"+"samp,small,span,strike,strong,sub,sup,time,tt,u,var"));var svgElements=stringToMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,"+"hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,"+"radialGradient,rect,stop,svg,switch,text,title,tspan");var blockedElements=stringToMap("script,style");var validElements=extend({},voidElements,blockElements,inlineElements,optionalEndTagElements);var uriAttrs=stringToMap("background,cite,href,longdesc,src,xlink:href,xml:base");var htmlAttrs=stringToMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,"+"color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,"+"ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,"+"scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,"+"valign,value,vspace,width");var svgAttrs=stringToMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,"+"baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,"+"cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,"+"font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,"+"height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,"+"marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,"+"max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,"+"path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,"+"requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,"+"stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,"+"stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,"+"stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,"+"underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,"+"width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,"+"xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",true);var validAttrs=extend({},uriAttrs,svgAttrs,htmlAttrs);function stringToMap(str,lowercaseKeys){return arrayToMap(str.split(","),lowercaseKeys)}function arrayToMap(items,lowercaseKeys){var obj={},i;for(i=0;i<items.length;i++){obj[lowercaseKeys?lowercase(items[i]):items[i]]=true}return obj}function addElementsTo(elementsMap,newElements){if(newElements&&newElements.length){extend(elementsMap,arrayToMap(newElements))}}var getInertBodyElement=function(window,document){var inertDocument;if(document&&document.implementation){inertDocument=document.implementation.createHTMLDocument("inert")}else{throw $sanitizeMinErr("noinert","Can't create an inert html document")}var inertBodyElement=(inertDocument.documentElement||inertDocument.getDocumentElement()).querySelector("body");inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>';if(!inertBodyElement.querySelector("svg")){return getInertBodyElement_XHR}else{inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">';if(inertBodyElement.querySelector("svg img")){return getInertBodyElement_DOMParser}else{return getInertBodyElement_InertDocument}}function getInertBodyElement_XHR(html){html="<remove></remove>"+html;try{html=encodeURI(html)}catch(e){return undefined}var xhr=new window.XMLHttpRequest;xhr.responseType="document";xhr.open("GET","data:text/html;charset=utf-8,"+html,false);xhr.send(null);var body=xhr.response.body;body.firstChild.remove();return body}function getInertBodyElement_DOMParser(html){html="<remove></remove>"+html;try{var body=(new window.DOMParser).parseFromString(html,"text/html").body;body.firstChild.remove();return body}catch(e){return undefined}}function getInertBodyElement_InertDocument(html){inertBodyElement.innerHTML=html;if(document.documentMode){stripCustomNsAttrs(inertBodyElement)}return inertBodyElement}}(window,window.document);function htmlParserImpl(html,handler){if(html===null||html===undefined){html=""}else if(typeof html!=="string"){html=""+html}var inertBodyElement=getInertBodyElement(html);if(!inertBodyElement)return"";var mXSSAttempts=5;do{if(mXSSAttempts===0){throw $sanitizeMinErr("uinput","Failed to sanitize html because the input is unstable")}mXSSAttempts--;html=inertBodyElement.innerHTML;inertBodyElement=getInertBodyElement(html)}while(html!==inertBodyElement.innerHTML);var node=inertBodyElement.firstChild;while(node){switch(node.nodeType){case 1:handler.start(node.nodeName.toLowerCase(),attrToMap(node.attributes));break;case 3:handler.chars(node.textContent);break}var nextNode;if(!(nextNode=node.firstChild)){if(node.nodeType===1){handler.end(node.nodeName.toLowerCase())}nextNode=getNonDescendant("nextSibling",node);if(!nextNode){while(nextNode==null){node=getNonDescendant("parentNode",node);if(node===inertBodyElement)break;nextNode=getNonDescendant("nextSibling",node);if(node.nodeType===1){handler.end(node.nodeName.toLowerCase())}}}}node=nextNode}while(node=inertBodyElement.firstChild){inertBodyElement.removeChild(node)}}function attrToMap(attrs){var map={};for(var i=0,ii=attrs.length;i<ii;i++){var attr=attrs[i];map[attr.name]=attr.value}return map}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,(function(value){var hi=value.charCodeAt(0);var low=value.charCodeAt(1);return"&#"+((hi-55296)*1024+(low-56320)+65536)+";"})).replace(NON_ALPHANUMERIC_REGEXP,(function(value){return"&#"+value.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriterImpl(buf,uriValidator){var ignoreCurrentElement=false;var out=bind(buf,buf.push);return{start:function(tag,attrs){tag=lowercase(tag);if(!ignoreCurrentElement&&blockedElements[tag]){ignoreCurrentElement=tag}if(!ignoreCurrentElement&&validElements[tag]===true){out("<");out(tag);forEach(attrs,(function(value,key){var lkey=lowercase(key);var isImage=tag==="img"&&lkey==="src"||lkey==="background";if(validAttrs[lkey]===true&&(uriAttrs[lkey]!==true||uriValidator(value,isImage))){out(" ");out(key);out('="');out(encodeEntities(value));out('"')}}));out(">")}},end:function(tag){tag=lowercase(tag);if(!ignoreCurrentElement&&validElements[tag]===true&&voidElements[tag]!==true){out("</");out(tag);out(">")}if(tag==ignoreCurrentElement){ignoreCurrentElement=false}},chars:function(chars){if(!ignoreCurrentElement){out(encodeEntities(chars))}}}}function stripCustomNsAttrs(node){while(node){if(node.nodeType===window.Node.ELEMENT_NODE){var attrs=node.attributes;for(var i=0,l=attrs.length;i<l;i++){var attrNode=attrs[i];var attrName=attrNode.name.toLowerCase();if(attrName==="xmlns:ns1"||attrName.lastIndexOf("ns1:",0)===0){node.removeAttributeNode(attrNode);i--;l--}}}var nextNode=node.firstChild;if(nextNode){stripCustomNsAttrs(nextNode)}node=getNonDescendant("nextSibling",node)}}function getNonDescendant(propName,node){var nextNode=node[propName];if(nextNode&&nodeContains.call(node,nextNode)){throw $sanitizeMinErr("elclob","Failed to sanitize html because the element is clobbered: {0}",node.outerHTML||node.outerText)}return nextNode}}function sanitizeText(chars){var buf=[];var writer=htmlSanitizeWriter(buf,noop);writer.chars(chars);return buf.join("")}angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider).info({angularVersion:"1.8.0"});angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i;var linkyMinErr=angular.$$minErr("linky");var isDefined=angular.isDefined;var isFunction=angular.isFunction;var isObject=angular.isObject;var isString=angular.isString;return function(text,target,attributes){if(text==null||text==="")return text;if(!isString(text))throw linkyMinErr("notstring","Expected string but received: {0}",text);var attributesFn=isFunction(attributes)?attributes:isObject(attributes)?function getAttributesObject(){return attributes}:function getEmptyAttributesObject(){return{}};var match;var raw=text;var html=[];var url;var i;while(match=raw.match(LINKY_URL_REGEXP)){url=match[0];if(!match[2]&&!match[4]){url=(match[3]?"http://":"mailto:")+url}i=match.index;addText(raw.substr(0,i));addLink(url,match[0].replace(MAILTO_REGEXP,""));raw=raw.substring(i+match[0].length)}addText(raw);return $sanitize(html.join(""));function addText(text){if(!text){return}html.push(sanitizeText(text))}function addLink(url,text){var key,linkAttributes=attributesFn(url);html.push("<a ");for(key in linkAttributes){html.push(key+'="'+linkAttributes[key]+'" ')}if(isDefined(target)&&!("target"in linkAttributes)){html.push('target="',target,'" ')}html.push('href="',url.replace(/"/g,"&quot;"),'">');addText(text);html.push("</a>")}}}])})(window,window.angular)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var angular_sanitize=__webpack_require__(11);var public_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);var tile_map_fn_createTileMapFn=function createTileMapFn(){return{name:"tilemap",type:"render",context:{types:["kibana_datatable"]},help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.function.help",{defaultMessage:"Tilemap visualization"}),args:{visConfig:{types:["string","null"],default:'"{}"'}},fn(context,args){var visConfig=JSON.parse(args.visConfig);var _visConfig$dimensions=visConfig.dimensions,geohash=_visConfig$dimensions.geohash,metric=_visConfig$dimensions.metric,geocentroid=_visConfig$dimensions.geocentroid;var convertedData=Object(public_["convertToGeoJson"])(context,{geohash:geohash,metric:metric,geocentroid:geocentroid});if(geohash&&geohash.accessor){convertedData.meta.geohash=context.columns[geohash.accessor].meta}return{type:"render",as:"visualization",value:{visData:convertedData,visType:"tile_map",visConfig:visConfig,params:{listenOnChange:true}}}}}};var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var visDefaultEditor_public_=__webpack_require__(7);var external_kbnSharedDeps_Lodash_=__webpack_require__(3);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var kibanaUtils_public_=__webpack_require__(5);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var _createGetterSetter=Object(kibanaUtils_public_["createGetterSetter"])("Core"),_createGetterSetter2=_slicedToArray(_createGetterSetter,2),getCoreService=_createGetterSetter2[0],setCoreService=_createGetterSetter2[1];var _createGetterSetter3=Object(kibanaUtils_public_["createGetterSetter"])("vislib data.fieldFormats"),_createGetterSetter4=_slicedToArray(_createGetterSetter3,2),getFormatService=_createGetterSetter4[0],setFormatService=_createGetterSetter4[1];var _createGetterSetter5=Object(kibanaUtils_public_["createGetterSetter"])("Query"),_createGetterSetter6=_slicedToArray(_createGetterSetter5,2),getQueryService=_createGetterSetter6[0],setQueryService=_createGetterSetter6[1];var _createGetterSetter7=Object(kibanaUtils_public_["createGetterSetter"])("Share"),_createGetterSetter8=_slicedToArray(_createGetterSetter7,2),getShareService=_createGetterSetter8[0],setShareService=_createGetterSetter8[1];var _createGetterSetter9=Object(kibanaUtils_public_["createGetterSetter"])("KibanaLegacy"),_createGetterSetter10=_slicedToArray(_createGetterSetter9,2),getKibanaLegacy=_createGetterSetter10[0],setKibanaLegacy=_createGetterSetter10[1];function tooltipFormatter(metricTitle,metricFormat,feature){if(!feature){return""}return[{label:metricTitle,value:metricFormat(feature.properties.value)},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.tooltipFormatter.latitudeLabel",{defaultMessage:"Latitude"}),value:feature.geometry.coordinates[1]},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.tooltipFormatter.longitudeLabel",{defaultMessage:"Longitude"}),value:feature.geometry.coordinates[0]}]}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function scaleBounds(bounds){var scale=.5;var topLeft=bounds.top_left;var bottomRight=bounds.bottom_right;var latDiff=Object(external_kbnSharedDeps_Lodash_["round"])(Math.abs(topLeft.lat-bottomRight.lat),5);var lonDiff=Object(external_kbnSharedDeps_Lodash_["round"])(Math.abs(bottomRight.lon-topLeft.lon),5);if(latDiff===0)latDiff=lonDiff;var latDelta=latDiff*scale;var topLeftLat=Object(external_kbnSharedDeps_Lodash_["round"])(topLeft.lat,5)+latDelta;if(topLeftLat>90)topLeftLat=90;var bottomRightLat=Object(external_kbnSharedDeps_Lodash_["round"])(bottomRight.lat,5)-latDelta;if(bottomRightLat<-90)bottomRightLat=-90;var lonDelta=lonDiff*scale;var topLeftLon=Object(external_kbnSharedDeps_Lodash_["round"])(topLeft.lon,5)-lonDelta;if(topLeftLon<-180)topLeftLon=-180;var bottomRightLon=Object(external_kbnSharedDeps_Lodash_["round"])(bottomRight.lon,5)+lonDelta;if(bottomRightLon>180)bottomRightLon=180;return{top_left:{lat:topLeftLat,lon:topLeftLon},bottom_right:{lat:bottomRightLat,lon:bottomRightLon}}}var tile_map_visualization_createTileMapVisualization=function createTileMapVisualization(dependencies){var _temp;var getZoomPrecision=dependencies.getZoomPrecision,getPrecision=dependencies.getPrecision,BaseMapsVisualization=dependencies.BaseMapsVisualization;return _temp=function(_BaseMapsVisualizatio){_inherits(CoordinateMapsVisualization,_BaseMapsVisualizatio);var _super=_createSuper(CoordinateMapsVisualization);function CoordinateMapsVisualization(element,vis){var _this;_classCallCheck(this,CoordinateMapsVisualization);_this=_super.call(this,element,vis);_defineProperty(_assertThisInitialized(_this),"updateGeohashAgg",(function(){var geohashAgg=_this._getGeoHashAgg();if(!geohashAgg)return;var updateVarsObject={name:"bounds",data:{}};var bounds=_this._kibanaMap.getBounds();var mapCollar=scaleBounds(bounds);if(!Object(public_["geoContains"])(geohashAgg.aggConfigParams.boundingBox,mapCollar)){updateVarsObject.data.boundingBox={top_left:mapCollar.top_left,bottom_right:mapCollar.bottom_right}}else{updateVarsObject.data.boundingBox=geohashAgg.aggConfigParams.boundingBox}var zoomPrecision=getZoomPrecision();updateVarsObject.data.precision=geohashAgg.aggConfigParams.autoPrecision?zoomPrecision[_this.vis.getUiState().get("mapZoom")]:getPrecision(geohashAgg.aggConfigParams.precision);_this.vis.eventsSubject.next(updateVarsObject)}));_this._geohashLayer=null;_this._tooltipFormatter=Object(public_["mapTooltipProvider"])(element,tooltipFormatter);return _this}_createClass(CoordinateMapsVisualization,[{key:"render",value:function(){var _render=_asyncToGenerator(regeneratorRuntime.mark((function _callee(esResponse,visParams){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:getKibanaLegacy().loadFontAwesome();_context.next=3;return _get(_getPrototypeOf(CoordinateMapsVisualization.prototype),"render",this).call(this,esResponse,visParams);case 3:case"end":return _context.stop()}}}),_callee,this)})));function render(_x,_x2){return _render.apply(this,arguments)}return render}()},{key:"_makeKibanaMap",value:function(){var _makeKibanaMap2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _this2=this;var previousPrecision,precisionChange,uiState;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _get(_getPrototypeOf(CoordinateMapsVisualization.prototype),"_makeKibanaMap",this).call(this);case 2:previousPrecision=this._kibanaMap.getGeohashPrecision();precisionChange=false;uiState=this.vis.getUiState();uiState.on("change",(function(prop){if(prop==="mapZoom"||prop==="mapCenter"){_this2.updateGeohashAgg()}}));this._kibanaMap.on("zoomchange",(function(){precisionChange=previousPrecision!==_this2._kibanaMap.getGeohashPrecision();previousPrecision=_this2._kibanaMap.getGeohashPrecision()}));this._kibanaMap.on("zoomend",(function(){var geohashAgg=_this2._getGeoHashAgg();if(!geohashAgg){return}var isAutoPrecision=typeof geohashAgg.aggConfigParams.autoPrecision==="boolean"?geohashAgg.aggConfigParams.autoPrecision:true;if(!isAutoPrecision){return}if(precisionChange){_this2.updateGeohashAgg()}else{_this2._updateData(_this2._geoJsonFeatureCollectionAndMeta)}}));this._kibanaMap.addDrawControl();this._kibanaMap.on("drawCreated:rectangle",(function(event){var geohashAgg=_this2._getGeoHashAgg();_this2.addSpatialFilter(geohashAgg,"geo_bounding_box",event.bounds)}));this._kibanaMap.on("drawCreated:polygon",(function(event){var geohashAgg=_this2._getGeoHashAgg();_this2.addSpatialFilter(geohashAgg,"geo_polygon",{points:event.points})}));case 11:case"end":return _context2.stop()}}}),_callee2,this)})));function _makeKibanaMap(){return _makeKibanaMap2.apply(this,arguments)}return _makeKibanaMap}()},{key:"_updateData",value:function(){var _updateData2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(geojsonFeatureCollectionAndMeta){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this._getMapsParams().mapType!=="Heatmap"&&geojsonFeatureCollectionAndMeta===this._geoJsonFeatureCollectionAndMeta)){_context3.next=2;break}return _context3.abrupt("return");case 2:if(this._geohashLayer){this._kibanaMap.removeLayer(this._geohashLayer);this._geohashLayer=null}if(geojsonFeatureCollectionAndMeta){_context3.next=8;break}this._geoJsonFeatureCollectionAndMeta=null;this._kibanaMap.removeLayer(this._geohashLayer);this._geohashLayer=null;return _context3.abrupt("return");case 8:if(!this._geoJsonFeatureCollectionAndMeta||!geojsonFeatureCollectionAndMeta.featureCollection.features.length){this._geoJsonFeatureCollectionAndMeta=geojsonFeatureCollectionAndMeta;this.updateGeohashAgg()}this._geoJsonFeatureCollectionAndMeta=geojsonFeatureCollectionAndMeta;this._recreateGeohashLayer();case 11:case"end":return _context3.stop()}}}),_callee3,this)})));function _updateData(_x3){return _updateData2.apply(this,arguments)}return _updateData}()},{key:"_recreateGeohashLayer",value:function(){var _recreateGeohashLayer2=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _yield$import,GeohashLayer,geohashOptions;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(2)]).then(__webpack_require__.bind(null,17));case 2:_yield$import=_context4.sent;GeohashLayer=_yield$import.GeohashLayer;if(this._geohashLayer){this._kibanaMap.removeLayer(this._geohashLayer);this._geohashLayer=null}geohashOptions=this._getGeohashOptions();_context4.t0=GeohashLayer;_context4.t1=this._geoJsonFeatureCollectionAndMeta.featureCollection;_context4.t2=this._geoJsonFeatureCollectionAndMeta.meta;_context4.t3=geohashOptions;_context4.t4=this._kibanaMap.getZoomLevel();_context4.t5=this._kibanaMap;_context4.next=14;return Object(public_["lazyLoadMapsLegacyModules"])();case 14:_context4.t6=_context4.sent.L;this._geohashLayer=new _context4.t0(_context4.t1,_context4.t2,_context4.t3,_context4.t4,_context4.t5,_context4.t6);this._kibanaMap.addLayer(this._geohashLayer);case 17:case"end":return _context4.stop()}}}),_callee4,this)})));function _recreateGeohashLayer(){return _recreateGeohashLayer2.apply(this,arguments)}return _recreateGeohashLayer}()},{key:"_updateParams",value:function(){var _updateParams2=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var geohashOptions;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return _get(_getPrototypeOf(CoordinateMapsVisualization.prototype),"_updateParams",this).call(this);case 2:this._kibanaMap.setDesaturateBaseLayer(this._params.isDesaturated);geohashOptions=this._getGeohashOptions();if(!this._geohashLayer||!this._geohashLayer.isReusable(geohashOptions)){if(this._geoJsonFeatureCollectionAndMeta){this._recreateGeohashLayer()}this._updateData(this._geoJsonFeatureCollectionAndMeta)}case 5:case"end":return _context5.stop()}}}),_callee5,this)})));function _updateParams(){return _updateParams2.apply(this,arguments)}return _updateParams}()},{key:"_getGeohashOptions",value:function _getGeohashOptions(){var newParams=this._getMapsParams();var metricDimension=this._params.dimensions.metric;var metricLabel=metricDimension?metricDimension.label:"";var metricFormat=getFormatService().deserialize(metricDimension&&metricDimension.format);return{label:metricLabel,valueFormatter:this._geoJsonFeatureCollectionAndMeta?metricFormat.getConverterFor("text"):null,tooltipFormatter:this._geoJsonFeatureCollectionAndMeta?this._tooltipFormatter.bind(null,metricLabel,metricFormat.getConverterFor("text")):null,mapType:newParams.mapType,isFilteredByCollar:this._isFilteredByCollar(),colorRamp:newParams.colorSchema,heatmap:{heatClusterSize:newParams.heatClusterSize}}}},{key:"addSpatialFilter",value:function addSpatialFilter(agg,filterName,filterData){if(!agg){return}var indexPatternName=agg.indexPatternId;var field=agg.aggConfigParams.field;var filter={meta:{negate:false,index:indexPatternName}};filter[filterName]={ignore_unmapped:true};filter[filterName][field]=filterData;var _getQueryService=getQueryService(),filterManager=_getQueryService.filterManager;filterManager.addFilters([filter]);this.vis.updateState()}},{key:"_getGeoHashAgg",value:function _getGeoHashAgg(){return this._geoJsonFeatureCollectionAndMeta&&this._geoJsonFeatureCollectionAndMeta.meta.geohash}},{key:"_isFilteredByCollar",value:function _isFilteredByCollar(){var DEFAULT=false;var agg=this._getGeoHashAgg();if(agg){return Object(external_kbnSharedDeps_Lodash_["get"])(agg,"aggConfigParams.isFilteredByCollar",DEFAULT)}else{return DEFAULT}}}]);return CoordinateMapsVisualization}(BaseMapsVisualization),_temp};var external_kbnSharedDeps_ElasticEui_=__webpack_require__(6);var charts_public_=__webpack_require__(4);function TileMapOptions(props){var _vis$type$visConfig;var stateParams=props.stateParams,setValue=props.setValue,vis=props.vis;Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(!stateParams.mapType){setValue("mapType",vis.type.editorConfig.collections.mapTypes[0])}}),[setValue,stateParams.mapType,vis.type.editorConfig.collections.mapTypes]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(charts_public_["SelectOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.visParams.mapTypeLabel",{defaultMessage:"Map type"}),options:vis.type.editorConfig.collections.mapTypes,paramName:"mapType",value:stateParams.mapType,setValue:setValue}),stateParams.mapType===public_["MapTypes"].Heatmap?external_kbnSharedDeps_React_default.a.createElement(charts_public_["RangeOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.visParams.clusterSizeLabel",{defaultMessage:"Cluster size"}),max:3,min:1,paramName:"heatClusterSize",step:.1,value:stateParams.heatClusterSize,setValue:setValue}):external_kbnSharedDeps_React_default.a.createElement(charts_public_["SelectOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.visParams.colorSchemaLabel",{defaultMessage:"Color schema"}),options:vis.type.editorConfig.collections.colorSchemas,paramName:"colorSchema",value:stateParams.colorSchema,setValue:setValue}),external_kbnSharedDeps_React_default.a.createElement(charts_public_["BasicOptions"],props),external_kbnSharedDeps_React_default.a.createElement(charts_public_["SwitchOption"],{disabled:!((_vis$type$visConfig=vis.type.visConfig)===null||_vis$type$visConfig===void 0?void 0:_vis$type$visConfig.canDesaturate),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.visParams.desaturateTilesLabel",{defaultMessage:"Desaturate tiles"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.visParams.reduceVibrancyOfTileColorsTip",{defaultMessage:"Reduce the vibrancy of tile colors. This does not work in any version of Internet Explorer."}),paramName:"isDesaturated",value:stateParams.isDesaturated,setValue:setValue})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(public_["WmsOptions"],props))}var supportsCssFilters=function(){var e=document.createElement("img");var rules=["webkitFilter","mozFilter","msFilter","filter"];var test="grayscale(1)";rules.forEach((function(rule){e.style[rule]=test}));document.body.appendChild(e);var styles=window.getComputedStyle(e);var can=external_kbnSharedDeps_Lodash_default()(styles).pick(rules).includes(test);document.body.removeChild(e);return can}();var data_public_=__webpack_require__(8);function get_deprecation_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function get_deprecation_message_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){get_deprecation_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){get_deprecation_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function getDeprecationMessage(vis){var mapsTileMapUrlGenerator;try{mapsTileMapUrlGenerator=getShareService().urlGenerators.getUrlGenerator("MAPS_APP_TILE_MAP_URL_GENERATOR")}catch(error){}var title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.mapTitle",{defaultMessage:"Coordinate Map"});function onClick(_x){return _onClick.apply(this,arguments)}function _onClick(){_onClick=get_deprecation_message_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var _vis$data$indexPatter,_vis$data,_vis$data$aggs,_vis$data2,_vis$data2$aggs;var query,createUrlParams,bucketAggs,_bucketAggs$0$getFiel,geoField,metricAggs,_metricAggs$0$getFiel,url;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();query=getQueryService();createUrlParams={label:vis.title?vis.title:title,mapType:vis.params.mapType,colorSchema:vis.params.colorSchema,indexPatternId:(_vis$data$indexPatter=vis.data.indexPattern)===null||_vis$data$indexPatter===void 0?void 0:_vis$data$indexPatter.id,metricAgg:"count",filters:query.filterManager.getFilters(),query:query.queryString.getQuery(),timeRange:query.timefilter.timefilter.getTime()};bucketAggs=(_vis$data=vis.data)===null||_vis$data===void 0?void 0:(_vis$data$aggs=_vis$data.aggs)===null||_vis$data$aggs===void 0?void 0:_vis$data$aggs.byType("buckets");if((bucketAggs===null||bucketAggs===void 0?void 0:bucketAggs.length)&&bucketAggs[0].type.dslName==="geohash_grid"){createUrlParams.geoFieldName=(_bucketAggs$0$getFiel=bucketAggs[0].getField())===null||_bucketAggs$0$getFiel===void 0?void 0:_bucketAggs$0$getFiel.name}else if(vis.data.indexPattern){geoField=vis.data.indexPattern.fields.find((function(field){return!data_public_["indexPatterns"].isNestedField(field)&&field.aggregatable&&field.type==="geo_point"}));if(geoField){createUrlParams.geoFieldName=geoField.name}}metricAggs=(_vis$data2=vis.data)===null||_vis$data2===void 0?void 0:(_vis$data2$aggs=_vis$data2.aggs)===null||_vis$data2$aggs===void 0?void 0:_vis$data2$aggs.byType("metrics");if(metricAggs===null||metricAggs===void 0?void 0:metricAggs.length){createUrlParams.metricAgg=metricAggs[0].type.dslName;createUrlParams.metricFieldName=(_metricAggs$0$getFiel=metricAggs[0].getField())===null||_metricAggs$0$getFiel===void 0?void 0:_metricAggs$0$getFiel.name}_context.next=9;return mapsTileMapUrlGenerator.createUrl(createUrlParams);case 9:url=_context.sent;getCoreService().application.navigateToUrl(url);case 11:case"end":return _context.stop()}}}),_callee)})));return _onClick.apply(this,arguments)}return external_kbnSharedDeps_React_default.a.createElement(public_["LegacyMapDeprecationMessage"],{isMapsAvailable:!!mapsTileMapUrlGenerator,onClick:onClick,visualizationLabel:title})}function tile_map_type_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function tile_map_type_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){tile_map_type_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){tile_map_type_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function createTileMapTypeDefinition(dependencies){var CoordinateMapsVisualization=tile_map_visualization_createTileMapVisualization(dependencies);var uiSettings=dependencies.uiSettings,getServiceSettings=dependencies.getServiceSettings;return{name:"tile_map",getInfoMessage:getDeprecationMessage,title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.mapTitle",{defaultMessage:"Coordinate Map"}),icon:"visMapCoordinate",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.mapDescription",{defaultMessage:"Plot latitude and longitude coordinates on a map"}),visConfig:{canDesaturate:Boolean(supportsCssFilters),defaults:{colorSchema:"Yellow to Red",mapType:"Scaled Circle Markers",isDesaturated:true,addTooltip:true,heatClusterSize:1.5,legendPosition:"bottomright",mapZoom:2,mapCenter:[0,0],wms:uiSettings.get("visualization:tileMap:WMSdefaults")}},visualization:CoordinateMapsVisualization,responseHandler:public_["convertToGeoJson"],editorConfig:{collections:{colorSchemas:charts_public_["truncatedColorSchemas"],legendPositions:[{value:"bottomleft",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.legendPositions.bottomLeftText",{defaultMessage:"Bottom left"})},{value:"bottomright",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.legendPositions.bottomRightText",{defaultMessage:"Bottom right"})},{value:"topleft",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.legendPositions.topLeftText",{defaultMessage:"Top left"})},{value:"topright",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.legendPositions.topRightText",{defaultMessage:"Top right"})}],mapTypes:[{value:public_["MapTypes"].ScaledCircleMarkers,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.mapTypes.scaledCircleMarkersText",{defaultMessage:"Scaled circle markers"})},{value:public_["MapTypes"].ShadedCircleMarkers,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.mapTypes.shadedCircleMarkersText",{defaultMessage:"Shaded circle markers"})},{value:public_["MapTypes"].ShadedGeohashGrid,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.mapTypes.shadedGeohashGridText",{defaultMessage:"Shaded geohash grid"})},{value:public_["MapTypes"].Heatmap,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.editorConfig.mapTypes.heatmapText",{defaultMessage:"Heatmap"})}],tmsLayers:[]},optionsTemplate:function optionsTemplate(props){return external_kbnSharedDeps_React_default.a.createElement(TileMapOptions,props)},schemas:new visDefaultEditor_public_["Schemas"]([{group:"metrics",name:"metric",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.map.editorConfig.schemas.metricTitle",{defaultMessage:"Value"}),min:1,max:1,aggFilter:["count","avg","sum","min","max","cardinality","top_hits"],defaults:[{schema:"metric",type:"count"}]},{group:"buckets",name:"segment",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("tileMap.vis.map.editorConfig.schemas.geoCoordinatesTitle",{defaultMessage:"Geo coordinates"}),aggFilter:["geohash_grid"],min:1,max:1}])},setup:function(){var _setup=tile_map_type_asyncToGenerator(regeneratorRuntime.mark((function _callee(vis){var tmsLayers,serviceSettings;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getServiceSettings();case 3:serviceSettings=_context.sent;_context.next=6;return serviceSettings.getTMSServices();case 6:tmsLayers=_context.sent;_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](0);return _context.abrupt("return",vis);case 12:vis.type.editorConfig.collections.tmsLayers=tmsLayers;if(!vis.params.wms.selectedTmsLayer&&tmsLayers.length){vis.params.wms.selectedTmsLayer=tmsLayers[0]}return _context.abrupt("return",vis);case 15:case"end":return _context.stop()}}}),_callee,null,[[0,9]])})));function setup(_x){return _setup.apply(this,arguments)}return setup}()}}function plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function plugin_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function plugin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function plugin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function plugin_createClass(Constructor,protoProps,staticProps){if(protoProps)plugin_defineProperties(Constructor.prototype,protoProps);if(staticProps)plugin_defineProperties(Constructor,staticProps);return Constructor}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var plugin_TileMapPlugin=function(){function TileMapPlugin(initializerContext){plugin_classCallCheck(this,TileMapPlugin);plugin_defineProperty(this,"initializerContext",void 0);this.initializerContext=initializerContext}plugin_createClass(TileMapPlugin,[{key:"setup",value:function(){var _setup=plugin_asyncToGenerator(regeneratorRuntime.mark((function _callee(core,_ref){var expressions,visualizations,mapsLegacy,getZoomPrecision,getPrecision,getServiceSettings,visualizationDependencies,config;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:expressions=_ref.expressions,visualizations=_ref.visualizations,mapsLegacy=_ref.mapsLegacy;getZoomPrecision=mapsLegacy.getZoomPrecision,getPrecision=mapsLegacy.getPrecision,getServiceSettings=mapsLegacy.getServiceSettings;visualizationDependencies={getZoomPrecision:getZoomPrecision,getPrecision:getPrecision,BaseMapsVisualization:mapsLegacy.getBaseMapsVis(),uiSettings:core.uiSettings,getServiceSettings:getServiceSettings};expressions.registerFunction((function(){return tile_map_fn_createTileMapFn(visualizationDependencies)}));visualizations.createBaseVisualization(createTileMapTypeDefinition(visualizationDependencies));config=this.initializerContext.config.get();return _context.abrupt("return",{config:config});case 7:case"end":return _context.stop()}}}),_callee,this)})));function setup(_x,_x2){return _setup.apply(this,arguments)}return setup}()},{key:"start",value:function start(core,plugins){setFormatService(plugins.data.fieldFormats);setQueryService(plugins.data.query);setKibanaLegacy(plugins.kibanaLegacy);setShareService(plugins.share);setCoreService(core);return{}}}]);return TileMapPlugin}();function public_plugin(initializerContext){return new plugin_TileMapPlugin(initializerContext)}},function(module,exports){module.exports=__kbnSharedDeps__.Jquery}]);