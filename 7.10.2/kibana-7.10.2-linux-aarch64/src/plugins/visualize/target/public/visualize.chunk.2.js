(window["visualize_bundle_jsonpfunction"]=window["visualize_bundle_jsonpfunction"]||[]).push([[2],{187:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(188);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},188:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},189:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(190);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},190:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},191:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(192);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},192:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},193:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(194);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},194:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  /* 1. Without setting this to 0 you will run into a bug where the filter bar modal is hidden under\na tilemap in an iframe: https://github.com/elastic/kibana/issues/16457 */ }\n  .visEditor > * {\n    flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor .visualization {\n      min-height: 240px; } }\n  .visEditor > .visualize {\n    height: 100%;\n    flex: 1 1 auto;\n    display: flex;\n    z-index: 0;\n    /* 1 */ }\n\n.visEditor__content {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  z-index: 0; }\n  .visEditor__content > * {\n    flex-shrink: 0; }\n",""]);module.exports=exports},195:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return application_renderApp}));var external_kbnSharedDeps_React_=__webpack_require__(19);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(28);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(23);var public_=__webpack_require__(21);var application_app=__webpack_require__(62);var data_public_=__webpack_require__(2);var visualize_listing=__webpack_require__(71);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);var lib=__webpack_require__(84);var visualizations_public_=__webpack_require__(26);var visualize_constants=__webpack_require__(4);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(24);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(25);var get_table_columns_getBadge=function getBadge(item){if(item.stage==="beta"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{className:"visListingTable__betaIcon",label:"B",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.betaTitle",{defaultMessage:"Beta"}),tooltipContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.betaTooltip",{defaultMessage:"This visualization is in beta and is subject to change. The design and code is less mature than official GA "+"features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA "+"features"})})}else if(item.stage==="experimental"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBetaBadge"],{className:"visListingTable__experimentalIcon",label:"E",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.experimentalTitle",{defaultMessage:"Experimental"}),tooltipContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.experimentalTooltip",{defaultMessage:"This visualization might be changed or removed in a future release and is not subject to the support SLA."})})}};var get_table_columns_renderItemTypeIcon=function renderItemTypeIcon(item){var icon;if(item.image){icon=external_kbnSharedDeps_React_default.a.createElement("img",{className:"visListingTable__typeImage","aria-hidden":"true",alt:"",src:item.image})}else{icon=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{className:"visListingTable__typeIcon","aria-hidden":"true",type:item.icon||"empty",size:"m"})}return icon};var get_table_columns_getTableColumns=function getTableColumns(application,history){return[{field:"title",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.titleColumnName",{defaultMessage:"Title"}),sortable:true,render:function render(field,_ref){var editApp=_ref.editApp,editUrl=_ref.editUrl,title=_ref.title,error=_ref.error;return!error?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:function onClick(){if(editApp){application.navigateToApp(editApp,{path:editUrl})}else if(editUrl){history.push(editUrl)}},"data-test-subj":"visListingTitleLink-".concat(title.split(" ").join("-"))},field):field}},{field:"typeTitle",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.typeColumnName",{defaultMessage:"Type"}),sortable:true,render:function render(field,record){return!record.error?external_kbnSharedDeps_React_default.a.createElement("span",null,get_table_columns_renderItemTypeIcon(record),record.typeTitle,get_table_columns_getBadge(record)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{iconType:"alert",color:"warning"},record.error)}},{field:"description",name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:true,render:function render(field,record){return external_kbnSharedDeps_React_default.a.createElement("span",null,record.description)}}]};var get_table_columns_getNoItemsMessage=function getNoItemsMessage(createItem){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"visualizeApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",{id:"visualizeListingHeading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.title",defaultMessage:"Create your first visualization"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.description",defaultMessage:"You can create different visualizations based on your data."})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:createItem,fill:true,iconType:"plusInCircle","data-test-subj":"createVisualizationPromptButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.listing.createNew.createButtonLabel",defaultMessage:"Create new visualization"}))})};var savedObjects_public_=__webpack_require__(29);var kibanaUtils_public_=__webpack_require__(0);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}var appPrefixes={dashboards:{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.dashboard.prefix.breadcrumb",{defaultMessage:"Dashboard"})}};var defaultEditText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.editor.defaultEditBreadcrumbText",{defaultMessage:"Edit"});function getLandingBreadcrumbs(){return[{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.breadcrumb",{defaultMessage:"Visualize"}),href:"#".concat(visualize_constants["b"].LANDING_PAGE_PATH)}]}function getCreateBreadcrumbs(){return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.editor.createBreadcrumb",{defaultMessage:"Create"})}])}function getBreadcrumbsPrefixedWithApp(originatingApp){var originatingAppBreadcrumb=appPrefixes[originatingApp];return[originatingAppBreadcrumb].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:defaultEditText}])}function getEditBreadcrumbs(){var text=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultEditText;return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:text}])}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function get_top_nav_config_toConsumableArray(arr){return get_top_nav_config_arrayWithoutHoles(arr)||get_top_nav_config_iterableToArray(arr)||get_top_nav_config_unsupportedIterableToArray(arr)||get_top_nav_config_nonIterableSpread()}function get_top_nav_config_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function get_top_nav_config_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return get_top_nav_config_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return get_top_nav_config_arrayLikeToArray(o,minLen)}function get_top_nav_config_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function get_top_nav_config_arrayWithoutHoles(arr){if(Array.isArray(arr))return get_top_nav_config_arrayLikeToArray(arr)}function get_top_nav_config_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}var get_top_nav_config_getTopNavConfig=function getTopNavConfig(_ref,_ref2){var hasUnsavedChanges=_ref.hasUnsavedChanges,setHasUnsavedChanges=_ref.setHasUnsavedChanges,openInspector=_ref.openInspector,originatingApp=_ref.originatingApp,setOriginatingApp=_ref.setOriginatingApp,hasUnappliedChanges=_ref.hasUnappliedChanges,visInstance=_ref.visInstance,stateContainer=_ref.stateContainer,visualizationIdFromUrl=_ref.visualizationIdFromUrl,stateTransfer=_ref.stateTransfer,embeddableId=_ref.embeddableId,onAppLeave=_ref.onAppLeave;var application=_ref2.application,chrome=_ref2.chrome,history=_ref2.history,share=_ref2.share,setActiveUrl=_ref2.setActiveUrl,toastNotifications=_ref2.toastNotifications,visualizeCapabilities=_ref2.visualizeCapabilities,I18nContext=_ref2.i18n.Context,dashboard=_ref2.dashboard;var vis=visInstance.vis,embeddableHandler=visInstance.embeddableHandler;var savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;function doSave(_x){return _doSave.apply(this,arguments)}function _doSave(){_doSave=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(saveOptions){var _vis$data$searchSourc;var newlyCreated,id,appPath;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(savedVis){_context4.next=2;break}return _context4.abrupt("return",{});case 2:newlyCreated=!Boolean(savedVis.id)||savedVis.copyOnSave;stateContainer.transitions.setVis({title:savedVis.title});savedVis.searchSourceFields=(_vis$data$searchSourc=vis.data.searchSource)===null||_vis$data$searchSourc===void 0?void 0:_vis$data$searchSourc.getSerializedFields();savedVis.visState=stateContainer.getState().vis;savedVis.uiStateJSON=vis.uiState.toString();setHasUnsavedChanges(false);_context4.prev=8;_context4.next=11;return savedVis.save(saveOptions);case 11:id=_context4.sent;if(id){toastNotifications.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualization.successNotificationText",{defaultMessage:"Saved '{visTitle}'",values:{visTitle:savedVis.title}}),"data-test-subj":"saveVisualizationSuccess"});if(originatingApp&&saveOptions.returnToOrigin){appPath="".concat(visualize_constants["b"].EDIT_PATH,"/").concat(encodeURIComponent(id));history.replace(appPath);setActiveUrl(appPath);if(newlyCreated&&stateTransfer){stateTransfer.navigateToWithEmbeddablePackage(originatingApp,{state:{type:visualizations_public_["VISUALIZE_EMBEDDABLE_TYPE"],input:{savedObjectId:id}}})}else{application.navigateToApp(originatingApp)}}else{if(setOriginatingApp&&originatingApp&&newlyCreated){setOriginatingApp(undefined)}chrome.docTitle.change(savedVis.lastSavedTitle);chrome.setBreadcrumbs(getEditBreadcrumbs(savedVis.lastSavedTitle));if(id!==visualizationIdFromUrl){history.replace(_objectSpread(_objectSpread({},history.location),{},{pathname:"".concat(visualize_constants["b"].EDIT_PATH,"/").concat(id)}))}}}return _context4.abrupt("return",{id:id});case 16:_context4.prev=16;_context4.t0=_context4["catch"](8);console.error(_context4.t0);toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualization.failureNotificationText",{defaultMessage:"Error on saving '{visTitle}'",values:{visTitle:savedVis.title}}),text:_context4.t0.message,"data-test-subj":"saveVisualizationError"});return _context4.abrupt("return",{error:_context4.t0});case 21:case"end":return _context4.stop()}}}),_callee4,null,[[8,16]])})));return _doSave.apply(this,arguments)}var createVisReference=function createVisReference(){if(!originatingApp){return}var state={input:{savedVis:vis.serialize()},embeddableId:embeddableId,type:visualizations_public_["VISUALIZE_EMBEDDABLE_TYPE"]};stateTransfer.navigateToWithEmbeddablePackage(originatingApp,{state:state})};var navigateToOriginatingApp=function navigateToOriginatingApp(){if(originatingApp){application.navigateToApp(originatingApp)}};var topNavMenu=[{id:"inspector",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorButtonLabel",{defaultMessage:"inspect"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorButtonAriaLabel",{defaultMessage:"Open Inspector for visualization"}),testId:"openInspectorButton",disableButton(){return!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()},run:openInspector,tooltip(){if(!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.openInspectorDisabledButtonTooltip",{defaultMessage:"This visualization doesn't support any inspectors."})}}},{id:"share",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.shareVisualizationButtonLabel",{defaultMessage:"share"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.shareVisualizationButtonAriaLabel",{defaultMessage:"Share Visualization"}),testId:"shareTopNavButton",run:function run(anchorElement){if(share&&!embeddableId){share.toggleShareContextMenu({anchorElement:anchorElement,allowEmbed:true,allowShortUrl:visualizeCapabilities.createShortUrl,shareableUrl:Object(kibanaUtils_public_["unhashUrl"])(window.location.href),objectId:savedVis===null||savedVis===void 0?void 0:savedVis.id,objectType:"visualization",sharingData:{title:savedVis===null||savedVis===void 0?void 0:savedVis.title},isDirty:hasUnappliedChanges||hasUnsavedChanges})}},disableButton:!share||!!embeddableId}].concat(get_top_nav_config_toConsumableArray(originatingApp==="dashboards"||originatingApp==="canvas"?[{id:"cancel",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelButtonLabel",{defaultMessage:"Cancel"}),emphasize:false,description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelButtonAriaLabel",{defaultMessage:"Return to the last app without saving changes"}),testId:"visualizeCancelAndReturnButton",tooltip(){if(hasUnappliedChanges||hasUnsavedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.cancelAndReturnButtonTooltip",{defaultMessage:"Discard your changes before finishing"})}},run:function(){var _run=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt("return",navigateToOriginatingApp());case 1:case"end":return _context.stop()}}}),_callee)})));function run(){return _run.apply(this,arguments)}return run}()}]:[]),get_top_nav_config_toConsumableArray(visualizeCapabilities.save&&!embeddableId?[{id:"save",iconType:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?undefined:"save",label:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationAsButtonLabel",{defaultMessage:"save as"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationButtonLabel",{defaultMessage:"save"}),emphasize:savedVis&&!savedVis.id||!originatingApp,description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationButtonAriaLabel",{defaultMessage:"Save Visualization"}),className:(savedVis===null||savedVis===void 0?void 0:savedVis.id)&&originatingApp?"saveAsButton":"",testId:"visualizeSaveButton",disableButton:hasUnappliedChanges,tooltip(){if(hasUnappliedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before saving"})}},run:function run(anchorElement){var onSave=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(_ref3){var newTitle,newCopyOnSave,isTitleDuplicateConfirmed,onTitleDuplicate,newDescription,returnToOrigin,currentTitle,saveOptions,response;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newTitle=_ref3.newTitle,newCopyOnSave=_ref3.newCopyOnSave,isTitleDuplicateConfirmed=_ref3.isTitleDuplicateConfirmed,onTitleDuplicate=_ref3.onTitleDuplicate,newDescription=_ref3.newDescription,returnToOrigin=_ref3.returnToOrigin;if(savedVis){_context2.next=3;break}return _context2.abrupt("return");case 3:currentTitle=savedVis.title;savedVis.title=newTitle;embeddableHandler.updateInput({title:newTitle});savedVis.copyOnSave=newCopyOnSave;savedVis.description=newDescription;saveOptions={confirmOverwrite:false,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate,returnToOrigin:returnToOrigin};_context2.next=11;return doSave(saveOptions);case 11:response=_context2.sent;if(!response.id||response.error){savedVis.title=currentTitle}return _context2.abrupt("return",response);case 14:case"end":return _context2.stop()}}}),_callee2)})));return function onSave(_x2){return _ref4.apply(this,arguments)}}();var saveModal=external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_["SavedObjectSaveModalOrigin"],{documentInfo:savedVis||{title:""},onSave:onSave,getAppNameFromId:stateTransfer.getAppNameFromId,objectType:"visualization",onClose:function onClose(){},originatingApp:originatingApp});var isSaveAsButton=anchorElement.classList.contains("saveAsButton");onAppLeave((function(actions){return actions.default()}));if(originatingApp==="dashboards"&&dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables&&!isSaveAsButton){createVisReference()}else if(savedVis){Object(savedObjects_public_["showSaveModal"])(saveModal,I18nContext)}}}]:[]),get_top_nav_config_toConsumableArray(originatingApp&&(savedVis&&savedVis.id||embeddableId)?[{id:"saveAndReturn",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationButtonLabel",{defaultMessage:"Save and return"}),emphasize:true,iconType:"checkInCircleFilled",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationButtonAriaLabel",{defaultMessage:"Finish editing visualization and return to the last app"}),testId:"visualizesaveAndReturnButton",disableButton:hasUnappliedChanges,tooltip(){if(hasUnappliedChanges){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.topNavMenu.saveAndReturnVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before finishing"})}},run:function(){var _run2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var saveOptions;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:saveOptions={confirmOverwrite:false,returnToOrigin:true};onAppLeave((function(actions){return actions.default()}));if(!(originatingApp==="dashboards"&&dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables&&!savedVis)){_context3.next=4;break}return _context3.abrupt("return",createVisReference());case 4:return _context3.abrupt("return",doSave(saveOptions));case 5:case"end":return _context3.stop()}}}),_callee3)})));function run(){return _run2.apply(this,arguments)}return run}()}]:[]));return topNavMenu};function utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){utils_ownKeys(Object(source),true).forEach((function(key){utils_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function utils_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var utils_addHelpMenuToAppChrome=function addHelpMenuToAppChrome(chrome,docLinks){chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.helpMenu.appName",{defaultMessage:"Visualize"}),links:[{linkType:"documentation",href:"".concat(docLinks.links.visualize.guide)}]})};var utils_addBadgeToAppChrome=function addBadgeToAppChrome(chrome){chrome.setBadge({text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.badge.readOnly.tooltip",{defaultMessage:"Unable to save visualizations"}),iconType:"glasses"})};var getDefaultQuery=function getDefaultQuery(_ref){var data=_ref.data;return data.query.queryString.getDefaultQuery()};var visStateToEditorState=function visStateToEditorState(visInstance,services){var _vis$data$searchSourc,_vis$data$searchSourc2;var vis=visInstance.vis;var savedVisState=services.visualizations.convertFromSerializedVis(vis.serialize());var savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;return{uiState:savedVis&&savedVis.uiStateJSON?JSON.parse(savedVis.uiStateJSON):vis.uiState.toJSON(),query:((_vis$data$searchSourc=vis.data.searchSource)===null||_vis$data$searchSourc===void 0?void 0:_vis$data$searchSourc.getOwnField("query"))||getDefaultQuery(services),filters:((_vis$data$searchSourc2=vis.data.searchSource)===null||_vis$data$searchSourc2===void 0?void 0:_vis$data$searchSourc2.getOwnField("filter"))||[],vis:utils_objectSpread(utils_objectSpread({},savedVisState.visState),{},{title:vis.title}),linked:savedVis&&savedVis.id?!!savedVis.savedSearchId:!!savedVisState.savedSearchId}};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||use_chrome_visibility_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_chrome_visibility_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_chrome_visibility_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_chrome_visibility_arrayLikeToArray(o,minLen)}function use_chrome_visibility_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var use_chrome_visibility_useChromeVisibility=function useChromeVisibility(chrome){var _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=_slicedToArray(_useState,2),isVisible=_useState2[0],setIsVisible=_useState2[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){var subscription=chrome.getIsVisible$().subscribe((function(value){setIsVisible(value)}));return function(){return subscription.unsubscribe()}}),[chrome]);return isVisible};var external_kbnSharedDeps_Lodash_=__webpack_require__(22);function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_editor_updates_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_editor_updates_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_editor_updates_ownKeys(Object(source),true).forEach((function(key){use_editor_updates_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_editor_updates_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_editor_updates_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_editor_updates_slicedToArray(arr,i){return use_editor_updates_arrayWithHoles(arr)||use_editor_updates_iterableToArrayLimit(arr,i)||use_editor_updates_unsupportedIterableToArray(arr,i)||use_editor_updates_nonIterableRest()}function use_editor_updates_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_editor_updates_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_editor_updates_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_editor_updates_arrayLikeToArray(o,minLen)}function use_editor_updates_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function use_editor_updates_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_editor_updates_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var use_editor_updates_useEditorUpdates=function useEditorUpdates(services,eventEmitter,setHasUnsavedChanges,appState,visInstance,visEditorController){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=use_editor_updates_slicedToArray(_useState,2),isEmbeddableRendered=_useState2[0],setIsEmbeddableRendered=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(),_useState4=use_editor_updates_slicedToArray(_useState3,2),currentAppState=_useState4[0],setCurrentAppState=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(appState&&visInstance){var _services$data$query=services.data.query,timefilter=_services$data$query.timefilter.timefilter,filterManager=_services$data$query.filterManager,queryString=_services$data$query.queryString,state$=_services$data$query.state$;var embeddableHandler=visInstance.embeddableHandler,savedSearch=visInstance.savedSearch,vis=visInstance.vis;var savedVis="savedVis"in visInstance?visInstance.savedVis:undefined;var initialState=appState.getState();setCurrentAppState(initialState);var reloadVisualization=function reloadVisualization(){if(visEditorController){visEditorController.render({core:services,data:services.data,uiState:vis.uiState,timeRange:timefilter.getTime(),filters:filterManager.getFilters(),query:queryString.getQuery(),linked:!!vis.data.savedSearchId,savedSearch:savedSearch})}else{embeddableHandler.updateInput({timeRange:timefilter.getTime(),filters:filterManager.getFilters(),query:queryString.getQuery()})}};var subscriptions=state$.subscribe({next:reloadVisualization,error:services.fatalErrors.add});var handleLinkedSearch=function handleLinkedSearch(linked){if(linked&&savedVis&&!savedVis.savedSearchId&&savedSearch){savedVis.savedSearchId=savedSearch.id;vis.data.savedSearchId=savedSearch.id;if(vis.data.searchSource){vis.data.searchSource.setParent(savedSearch.searchSource)}}else if(!linked&&savedVis&&savedVis.savedSearchId){delete savedVis.savedSearchId;delete vis.data.savedSearchId}else if(!linked&&!savedVis){delete vis.data.savedSearchId}};if(initialState.uiState){vis.uiState.setSilent(initialState.uiState)}var updateOnChange=function updateOnChange(){appState.transitions.set("uiState",vis.uiState.getChanges())};vis.uiState.on("change",updateOnChange);var unsubscribeStateUpdates=appState.subscribe((function(state){setCurrentAppState(state);if(savedVis&&savedVis.id&&!services.history.location.pathname.includes(savedVis.id)){return}if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(state.uiState,vis.uiState.getChanges())){vis.uiState.set(state.uiState)}if(savedVis&&!Object(external_kbnSharedDeps_Lodash_["isEqual"])(use_editor_updates_objectSpread(use_editor_updates_objectSpread({},services.visualizations.convertFromSerializedVis(vis.serialize()).visState),{},{title:vis.title}),state.vis)){var _state$vis=state.vis,aggs=_state$vis.aggs,visState=_objectWithoutProperties(_state$vis,["aggs"]);vis.setState(use_editor_updates_objectSpread(use_editor_updates_objectSpread({},visState),{},{data:{aggs:aggs}}));embeddableHandler.reload();eventEmitter.emit("updateEditor")}handleLinkedSearch(state.linked);if(vis.data.searchSource){vis.data.searchSource.setField("query",state.query);vis.data.searchSource.setField("filter",state.filters)}reloadVisualization();setHasUnsavedChanges(true)}));var updateOnEmbeddableRendered=function updateOnEmbeddableRendered(){return setIsEmbeddableRendered(true)};eventEmitter.on("embeddableRendered",updateOnEmbeddableRendered);reloadVisualization();return function(){setIsEmbeddableRendered(false);eventEmitter.off("embeddableRendered",updateOnEmbeddableRendered);subscriptions.unsubscribe();vis.uiState.off("change",updateOnChange);unsubscribeStateUpdates()}}}),[appState,eventEmitter,visInstance,services,setHasUnsavedChanges,visEditorController]);return{isEmbeddableRendered:isEmbeddableRendered,currentAppState:currentAppState}};var query_string=__webpack_require__(80);var visDefaultEditor_public_=__webpack_require__(27);var discover_public_=__webpack_require__(30);function get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function get_visualization_instance_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){get_visualization_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}var createVisualizeEmbeddableAndLinkSavedSearch=function(){var _ref=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee(vis,visualizeServices){var chrome,data,overlays,createVisEmbeddableFromObject,savedObjects,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:chrome=visualizeServices.chrome,data=visualizeServices.data,overlays=visualizeServices.overlays,createVisEmbeddableFromObject=visualizeServices.createVisEmbeddableFromObject,savedObjects=visualizeServices.savedObjects;_context.next=3;return createVisEmbeddableFromObject(vis,{timeRange:data.query.timefilter.timefilter.getTime(),filters:data.query.filterManager.getFilters(),id:""});case 3:embeddableHandler=_context.sent;embeddableHandler.getOutput$().subscribe((function(output){if(output.error){data.search.showError(output.error.original||output.error)}}));if(!vis.data.savedSearchId){_context.next=9;break}_context.next=8;return Object(discover_public_["createSavedSearchesLoader"])({savedObjectsClient:savedObjects.client,indexPatterns:data.indexPatterns,search:data.search,chrome:chrome,overlays:overlays}).get(vis.data.savedSearchId);case 8:savedSearch=_context.sent;case 9:return _context.abrupt("return",{savedSearch:savedSearch,embeddableHandler:embeddableHandler});case 10:case"end":return _context.stop()}}}),_callee)})));return function createVisualizeEmbeddableAndLinkSavedSearch(_x,_x2){return _ref.apply(this,arguments)}}();var getVisualizationInstanceFromInput=function(){var _ref2=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee2(visualizeServices,input){var visualizations,visState,vis,_yield$createVisualiz,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:visualizations=visualizeServices.visualizations;visState=input.savedVis;_context2.next=4;return visualizations.createVis(visState.type,Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(visState));case 4:vis=_context2.sent;if(!vis.type.setup){_context2.next=14;break}_context2.prev=6;_context2.next=9;return vis.type.setup(vis);case 9:vis=_context2.sent;_context2.next=14;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](6);case 14:_context2.next=16;return createVisualizeEmbeddableAndLinkSavedSearch(vis,visualizeServices);case 16:_yield$createVisualiz=_context2.sent;embeddableHandler=_yield$createVisualiz.embeddableHandler;savedSearch=_yield$createVisualiz.savedSearch;return _context2.abrupt("return",{vis:vis,embeddableHandler:embeddableHandler,savedSearch:savedSearch});case 20:case"end":return _context2.stop()}}}),_callee2,null,[[6,12]])})));return function getVisualizationInstanceFromInput(_x3,_x4){return _ref2.apply(this,arguments)}}();var getVisualizationInstance=function(){var _ref3=get_visualization_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee3(visualizeServices,opts){var visualizations,savedVisualizations,savedVis,serializedVis,vis,_yield$createVisualiz2,embeddableHandler,savedSearch;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:visualizations=visualizeServices.visualizations,savedVisualizations=visualizeServices.savedVisualizations;_context3.next=3;return savedVisualizations.get(opts);case 3:savedVis=_context3.sent;if(typeof opts!=="string"){savedVis.searchSourceFields={index:opts===null||opts===void 0?void 0:opts.indexPattern}}serializedVis=visualizations.convertToSerializedVis(savedVis);_context3.next=8;return visualizations.createVis(serializedVis.type,serializedVis);case 8:vis=_context3.sent;if(!vis.type.setup){_context3.next=18;break}_context3.prev=10;_context3.next=13;return vis.type.setup(vis);case 13:vis=_context3.sent;_context3.next=18;break;case 16:_context3.prev=16;_context3.t0=_context3["catch"](10);case 18:_context3.next=20;return createVisualizeEmbeddableAndLinkSavedSearch(vis,visualizeServices);case 20:_yield$createVisualiz2=_context3.sent;embeddableHandler=_yield$createVisualiz2.embeddableHandler;savedSearch=_yield$createVisualiz2.savedSearch;return _context3.abrupt("return",{vis:vis,embeddableHandler:embeddableHandler,savedSearch:savedSearch,savedVis:savedVis});case 24:case"end":return _context3.stop()}}}),_callee3,null,[[10,16]])})));return function getVisualizationInstance(_x5,_x6){return _ref3.apply(this,arguments)}}();function use_saved_vis_instance_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_saved_vis_instance_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_saved_vis_instance_ownKeys(Object(source),true).forEach((function(key){use_saved_vis_instance_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_saved_vis_instance_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_saved_vis_instance_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_saved_vis_instance_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_saved_vis_instance_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_saved_vis_instance_slicedToArray(arr,i){return use_saved_vis_instance_arrayWithHoles(arr)||use_saved_vis_instance_iterableToArrayLimit(arr,i)||use_saved_vis_instance_unsupportedIterableToArray(arr,i)||use_saved_vis_instance_nonIterableRest()}function use_saved_vis_instance_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_saved_vis_instance_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_saved_vis_instance_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_saved_vis_instance_arrayLikeToArray(o,minLen)}function use_saved_vis_instance_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function use_saved_vis_instance_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_saved_vis_instance_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var use_saved_vis_instance_useSavedVisInstance=function useSavedVisInstance(services,eventEmitter,isChromeVisible,visualizationIdFromUrl){var _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=use_saved_vis_instance_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var visEditorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);var visId=Object(external_kbnSharedDeps_React_["useRef"])("");Object(external_kbnSharedDeps_React_["useEffect"])((function(){var _state$savedVisInstan;var navigateToApp=services.application.navigateToApp,chrome=services.chrome,history=services.history,basePath=services.http.basePath,setActiveUrl=services.setActiveUrl,toastNotifications=services.toastNotifications;var getSavedVisInstance=function(){var _ref=use_saved_vis_instance_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var savedVisInstance,searchParams,visTypes,visType,shouldHaveIndex,hasIndex,_savedVisInstance,embeddableHandler,savedVis,vis,visEditorController,Editor,managementRedirectTarget;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(history.location.pathname==="/create")){_context.next=16;break}searchParams=Object(query_string["parse"])(history.location.search);visTypes=services.visualizations.all();visType=visTypes.find((function(_ref2){var name=_ref2.name;return name===searchParams.type}));if(visType){_context.next=7;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.noVisTypeErrorMessage",{defaultMessage:"You must provide a valid visualization type"}));case 7:shouldHaveIndex=visType.requiresSearch&&visType.options.showIndexSelection;hasIndex=searchParams.indexPattern||searchParams.savedSearchId;if(!(shouldHaveIndex&&!hasIndex)){_context.next=11;break}throw new Error(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.noIndexPatternOrSavedSearchIdErrorMessage",{defaultMessage:"You must provide either an indexPattern or a savedSearchId"}));case 11:_context.next=13;return getVisualizationInstance(services,searchParams);case 13:savedVisInstance=_context.sent;_context.next=19;break;case 16:_context.next=18;return getVisualizationInstance(services,visualizationIdFromUrl);case 18:savedVisInstance=_context.sent;case 19:_savedVisInstance=savedVisInstance,embeddableHandler=_savedVisInstance.embeddableHandler,savedVis=_savedVisInstance.savedVis,vis=_savedVisInstance.vis;if(savedVis.id){chrome.setBreadcrumbs(getEditBreadcrumbs(savedVis.title));chrome.docTitle.change(savedVis.title)}else{chrome.setBreadcrumbs(getCreateBreadcrumbs())}if(isChromeVisible){Editor=vis.type.editor||visDefaultEditor_public_["DefaultEditorController"];visEditorController=new Editor(visEditorRef.current,vis,eventEmitter,embeddableHandler)}else if(visEditorRef.current){embeddableHandler.render(visEditorRef.current)}setState({savedVisInstance:savedVisInstance,visEditorController:visEditorController});_context.next=29;break;case 25:_context.prev=25;_context.t0=_context["catch"](0);managementRedirectTarget={app:"management",path:"kibana/objects/savedVisualizations/".concat(visualizationIdFromUrl)};try{Object(kibanaUtils_public_["redirectWhenMissing"])({history:history,navigateToApp:navigateToApp,toastNotifications:toastNotifications,basePath:basePath,mapping:{visualization:visualize_constants["b"].LANDING_PAGE_PATH,search:managementRedirectTarget,"index-pattern":managementRedirectTarget,"index-pattern-field":managementRedirectTarget},onBeforeRedirect(){setActiveUrl(visualize_constants["b"].LANDING_PAGE_PATH)}})(_context.t0)}catch(e){toastNotifications.addWarning({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.createVisualization.failedToLoadErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:e.message});history.replace(visualize_constants["b"].LANDING_PAGE_PATH)}case 29:case"end":return _context.stop()}}}),_callee,null,[[0,25]])})));return function getSavedVisInstance(){return _ref.apply(this,arguments)}}();if(isChromeVisible===undefined){return}if(!visId.current){visId.current=visualizationIdFromUrl||"new";getSavedVisInstance()}else if(visualizationIdFromUrl&&visId.current!==visualizationIdFromUrl&&((_state$savedVisInstan=state.savedVisInstance)===null||_state$savedVisInstan===void 0?void 0:_state$savedVisInstan.savedVis.id)!==visualizationIdFromUrl){visId.current=visualizationIdFromUrl;setState({});getSavedVisInstance()}}),[eventEmitter,isChromeVisible,services,state.savedVisInstance,state.visEditorController,visualizationIdFromUrl]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){return function(){var _state$savedVisInstan2,_state$savedVisInstan3;if(state.visEditorController){state.visEditorController.destroy()}else if((_state$savedVisInstan2=state.savedVisInstance)===null||_state$savedVisInstan2===void 0?void 0:_state$savedVisInstan2.embeddableHandler){state.savedVisInstance.embeddableHandler.destroy()}if((_state$savedVisInstan3=state.savedVisInstance)===null||_state$savedVisInstan3===void 0?void 0:_state$savedVisInstan3.savedVis){state.savedVisInstance.savedVis.destroy()}}}),[state]);return use_saved_vis_instance_objectSpread(use_saved_vis_instance_objectSpread({},state),{},{visEditorRef:visEditorRef})};var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(5);function migrateLegacyQuery(query){if(!Object(external_kbnSharedDeps_Lodash_["has"])(query,"language")){return{query:query,language:"lucene"}}return query}function migrateAppState(appState){if(appState.vis.type!=="table"){return appState}var visAggs=Object(external_kbnSharedDeps_Lodash_["get"])(appState,"vis.aggs");if(visAggs){var splitCount=0;var migratedAggs=visAggs.map((function(agg){if(agg.schema!=="split"){return agg}splitCount++;if(splitCount===1){return agg}agg.schema="bucket";agg.params=Object(external_kbnSharedDeps_Lodash_["omit"])(agg.params,["row"]);return agg}));if(splitCount<=1){return appState}appState.vis.aggs=migratedAggs}return appState}function create_visualize_app_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function create_visualize_app_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){create_visualize_app_state_ownKeys(Object(source),true).forEach((function(key){create_visualize_app_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{create_visualize_app_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function create_visualize_app_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var STATE_STORAGE_KEY="_a";function toObject(state){return Object(external_kbnSharedDeps_Lodash_["omitBy"])(state,(function(value,key){return key.charAt(0)==="$"||key.charAt(0)==="_"||Object(external_kbnSharedDeps_Lodash_["isFunction"])(value)}))}var pureTransitions={set:function set(state){return function(prop,value){return create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{[prop]:value})}},setVis:function setVis(state){return function(vis){return create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{vis:create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state.vis),vis)})}},unlinkSavedSearch:function unlinkSavedSearch(state){return function(_ref){var query=_ref.query,_ref$parentFilters=_ref.parentFilters,parentFilters=_ref$parentFilters===void 0?[]:_ref$parentFilters;return create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{query:query||state.query,filters:Object(external_kbnSharedDeps_Lodash_["union"])(state.filters,parentFilters),linked:false})}},updateVisState:function updateVisState(state){return function(newVisState){return create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{vis:toObject(newVisState)})}},updateSavedQuery:function updateSavedQuery(state){return function(savedQueryId){var updatedState=create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},state),{},{savedQuery:savedQueryId});if(!savedQueryId){delete updatedState.savedQuery}return updatedState}}};function createVisualizeByValueAppState(stateDefaults){var initialState=migrateAppState(create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateDefaults),stateDefaults));var stateContainer=Object(kibanaUtils_public_["createStateContainer"])(initialState,pureTransitions);var stopStateSync=function stopStateSync(){};return{stateContainer:stateContainer,stopStateSync:stopStateSync}}function createDefaultVisualizeAppState(_ref2){var stateDefaults=_ref2.stateDefaults,kbnUrlStateStorage=_ref2.kbnUrlStateStorage;var urlState=kbnUrlStateStorage.get(STATE_STORAGE_KEY);var initialState=migrateAppState(create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateDefaults),urlState));kbnUrlStateStorage.set(STATE_STORAGE_KEY,initialState,{replace:true});var stateContainer=Object(kibanaUtils_public_["createStateContainer"])(initialState,pureTransitions);var _syncState=Object(kibanaUtils_public_["syncState"])({storageKey:STATE_STORAGE_KEY,stateContainer:create_visualize_app_state_objectSpread(create_visualize_app_state_objectSpread({},stateContainer),{},{set:function set(state){if(state){stateContainer.set(state)}}}),stateStorage:kbnUrlStateStorage}),startStateSync=_syncState.start,stopStateSync=_syncState.stop;startStateSync();return{stateContainer:stateContainer,stopStateSync:stopStateSync}}function createVisualizeAppState(_ref3){var stateDefaults=_ref3.stateDefaults,kbnUrlStateStorage=_ref3.kbnUrlStateStorage,byValue=_ref3.byValue;if(byValue){return createVisualizeByValueAppState(stateDefaults)}return createDefaultVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:kbnUrlStateStorage})}function use_visualize_app_state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_visualize_app_state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_visualize_app_state_ownKeys(Object(source),true).forEach((function(key){use_visualize_app_state_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_visualize_app_state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_visualize_app_state_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_visualize_app_state_objectWithoutProperties(source,excluded){if(source==null)return{};var target=use_visualize_app_state_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function use_visualize_app_state_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function use_visualize_app_state_slicedToArray(arr,i){return use_visualize_app_state_arrayWithHoles(arr)||use_visualize_app_state_iterableToArrayLimit(arr,i)||use_visualize_app_state_unsupportedIterableToArray(arr,i)||use_visualize_app_state_nonIterableRest()}function use_visualize_app_state_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_visualize_app_state_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_visualize_app_state_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_visualize_app_state_arrayLikeToArray(o,minLen)}function use_visualize_app_state_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function use_visualize_app_state_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_visualize_app_state_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var use_visualize_app_state_useVisualizeAppState=function useVisualizeAppState(services,eventEmitter,instance){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=use_visualize_app_state_slicedToArray(_useState,2),hasUnappliedChanges=_useState2[0],setHasUnappliedChanges=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(null),_useState4=use_visualize_app_state_slicedToArray(_useState3,2),appState=_useState4[0],setAppState=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(instance){var stateDefaults=visStateToEditorState(instance,services);var byValue=!("savedVis"in instance);var _createVisualizeAppSt=createVisualizeAppState({stateDefaults:stateDefaults,kbnUrlStateStorage:services.kbnUrlStateStorage,byValue:byValue}),stateContainer=_createVisualizeAppSt.stateContainer,stopStateSync=_createVisualizeAppSt.stopStateSync;var onDirtyStateChange=function onDirtyStateChange(_ref){var isDirty=_ref.isDirty;if(!isDirty){stateContainer.transitions.updateVisState(visStateToEditorState(instance,services).vis)}setHasUnappliedChanges(isDirty)};eventEmitter.on("dirtyStateChange",onDirtyStateChange);var _services$data$query=services.data.query,filterManager=_services$data$query.filterManager,queryString=_services$data$query.queryString;filterManager.setAppFilters(Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(stateContainer.getState().filters));queryString.setQuery(migrateLegacyQuery(stateContainer.getState().query));var stopSyncingAppFilters=Object(data_public_["connectToQueryState"])(services.data.query,{set:function set(_ref2){var filters=_ref2.filters,query=_ref2.query;stateContainer.transitions.set("filters",filters);stateContainer.transitions.set("query",query)},get:function get(){return{filters:stateContainer.getState().filters,query:stateContainer.getState().query}},state$:stateContainer.state$.pipe(Object(external_kbnSharedDeps_RxjsOperators_["map"])((function(state){return{filters:state.filters,query:state.query}})))},{filters:data_public_["esFilters"].FilterStateStore.APP_STATE,query:true});if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(stateContainer.getState().vis,stateDefaults.vis)){var _stateContainer$getSt=stateContainer.getState().vis,aggs=_stateContainer$getSt.aggs,visState=use_visualize_app_state_objectWithoutProperties(_stateContainer$getSt,["aggs"]);instance.vis.setState(use_visualize_app_state_objectSpread(use_visualize_app_state_objectSpread({},visState),{},{data:{aggs:aggs}})).then((function(){setAppState(stateContainer)})).catch((function(error){services.toastNotifications.addWarning({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizationLoadingFailedErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:Object(public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(public_["MarkdownSimple"],null,error.message))});services.history.replace("".concat(visualize_constants["b"].LANDING_PAGE_PATH,"?notFound=visualization"))}))}else{setAppState(stateContainer)}return function(){eventEmitter.off("dirtyStateChange",onDirtyStateChange);stopStateSync();stopSyncingAppFilters()}}}),[eventEmitter,instance,services]);return{appState:appState,hasUnappliedChanges:hasUnappliedChanges}};var use_linked_search_updates_useLinkedSearchUpdates=function useLinkedSearchUpdates(services,eventEmitter,appState,visInstance){Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(appState&&visInstance&&visInstance.savedSearch&&visInstance.vis.data.searchSource){var savedSearch=visInstance.savedSearch;var searchSource=visInstance.vis.data.searchSource;var unlinkFromSavedSearch=function unlinkFromSavedSearch(){var searchSourceParent=savedSearch.searchSource;var searchSourceGrandparent=searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getParent();var currentIndex=searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getField("index");searchSource.setField("index",currentIndex);searchSource.setParent(searchSourceGrandparent);appState.transitions.unlinkSavedSearch({query:searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getField("query"),parentFilters:(searchSourceParent===null||searchSourceParent===void 0?void 0:searchSourceParent.getOwnField("filter"))||[]});services.toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.linkedToSearch.unlinkSuccessNotificationText",{defaultMessage:"Unlinked from saved search '{searchTitle}'",values:{searchTitle:savedSearch.title}}))};eventEmitter.on("unlinkFromSavedSearch",unlinkFromSavedSearch);return function(){eventEmitter.off("unlinkFromSavedSearch",unlinkFromSavedSearch)}}}),[appState,eventEmitter,visInstance,services.toastNotifications])};function use_vis_byvalue_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function use_vis_byvalue_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){use_vis_byvalue_ownKeys(Object(source),true).forEach((function(key){use_vis_byvalue_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{use_vis_byvalue_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function use_vis_byvalue_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function use_vis_byvalue_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){use_vis_byvalue_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function use_vis_byvalue_slicedToArray(arr,i){return use_vis_byvalue_arrayWithHoles(arr)||use_vis_byvalue_iterableToArrayLimit(arr,i)||use_vis_byvalue_unsupportedIterableToArray(arr,i)||use_vis_byvalue_nonIterableRest()}function use_vis_byvalue_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function use_vis_byvalue_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return use_vis_byvalue_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return use_vis_byvalue_arrayLikeToArray(o,minLen)}function use_vis_byvalue_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function use_vis_byvalue_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function use_vis_byvalue_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var use_vis_byvalue_useVisByValue=function useVisByValue(services,eventEmitter,isChromeVisible,valueInput,originatingApp){var _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=use_vis_byvalue_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var visEditorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);var loaded=Object(external_kbnSharedDeps_React_["useRef"])(false);Object(external_kbnSharedDeps_React_["useEffect"])((function(){var chrome=services.chrome;var getVisInstance=function(){var _ref=use_vis_byvalue_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var byValueVisInstance,embeddableHandler,vis,Editor,visEditorController;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!valueInput||loaded.current)){_context.next=2;break}return _context.abrupt("return");case 2:_context.next=4;return getVisualizationInstanceFromInput(services,valueInput);case 4:byValueVisInstance=_context.sent;embeddableHandler=byValueVisInstance.embeddableHandler,vis=byValueVisInstance.vis;Editor=vis.type.editor||visDefaultEditor_public_["DefaultEditorController"];visEditorController=new Editor(visEditorRef.current,vis,eventEmitter,embeddableHandler);if(chrome&&originatingApp){chrome.setBreadcrumbs(getBreadcrumbsPrefixedWithApp(originatingApp))}else if(chrome){chrome.setBreadcrumbs(getEditBreadcrumbs())}loaded.current=true;setState({byValueVisInstance:byValueVisInstance,visEditorController:visEditorController});case 11:case"end":return _context.stop()}}}),_callee)})));return function getVisInstance(){return _ref.apply(this,arguments)}}();getVisInstance()}),[eventEmitter,isChromeVisible,services,state.byValueVisInstance,state.visEditorController,valueInput,originatingApp]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){return function(){var _state$byValueVisInst;if(state.visEditorController){state.visEditorController.destroy()}else if((_state$byValueVisInst=state.byValueVisInstance)===null||_state$byValueVisInst===void 0?void 0:_state$byValueVisInst.embeddableHandler){state.byValueVisInstance.embeddableHandler.destroy()}}}),[state]);return use_vis_byvalue_objectSpread(use_vis_byvalue_objectSpread({},state),{},{visEditorRef:visEditorRef})};function visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function visualize_listing_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){visualize_listing_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}var visualize_listing_VisualizeListing=function VisualizeListing(){var _useKibana=Object(public_["useKibana"])(),_useKibana$services=_useKibana.services,application=_useKibana$services.application,chrome=_useKibana$services.chrome,history=_useKibana$services.history,savedVisualizations=_useKibana$services.savedVisualizations,toastNotifications=_useKibana$services.toastNotifications,visualizations=_useKibana$services.visualizations,savedObjects=_useKibana$services.savedObjects,savedObjectsPublic=_useKibana$services.savedObjectsPublic,uiSettings=_useKibana$services.uiSettings,visualizeCapabilities=_useKibana$services.visualizeCapabilities;var _useLocation=Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])(),pathname=_useLocation.pathname;var closeNewVisModal=Object(external_kbnSharedDeps_React_["useRef"])((function(){}));var listingLimit=savedObjectsPublic.settings.getListingLimit();Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(pathname==="/new"){closeNewVisModal.current=visualizations.showNewVisModal({onClose:function onClose(){history.push(visualize_constants["b"].LANDING_PAGE_PATH)}})}else{closeNewVisModal.current()}}),[history,pathname,visualizations]);Object(lib["useMount"])((function(){chrome.setBreadcrumbs([{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizeListingBreadcrumbsTitle",{defaultMessage:"Visualize"})}]);chrome.docTitle.change(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listingPageTitle",{defaultMessage:"Visualize"}))}));Object(lib["useUnmount"])((function(){return closeNewVisModal.current()}));var createNewVis=Object(external_kbnSharedDeps_React_["useCallback"])((function(){closeNewVisModal.current=visualizations.showNewVisModal()}),[visualizations]);var editItem=Object(external_kbnSharedDeps_React_["useCallback"])((function(_ref){var editUrl=_ref.editUrl,editApp=_ref.editApp;if(editApp){application.navigateToApp(editApp,{path:editUrl});return}history.push(editUrl)}),[application,history]);var noItemsFragment=Object(external_kbnSharedDeps_React_["useMemo"])((function(){return get_table_columns_getNoItemsMessage(createNewVis)}),[createNewVis]);var tableColumns=Object(external_kbnSharedDeps_React_["useMemo"])((function(){return get_table_columns_getTableColumns(application,history)}),[application,history]);var fetchItems=Object(external_kbnSharedDeps_React_["useCallback"])((function(filter){var isLabsEnabled=uiSettings.get(visualizations_public_["VISUALIZE_ENABLE_LABS_SETTING"]);return savedVisualizations.findListItems(filter,listingLimit).then((function(_ref2){var total=_ref2.total,hits=_ref2.hits;return{total:total,hits:hits.filter((function(result){var _result$type;return isLabsEnabled||((_result$type=result.type)===null||_result$type===void 0?void 0:_result$type.stage)!=="experimental"}))}}))}),[listingLimit,savedVisualizations,uiSettings]);var deleteItems=Object(external_kbnSharedDeps_React_["useCallback"])(function(){var _ref3=visualize_listing_asyncToGenerator(regeneratorRuntime.mark((function _callee(selectedItems){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all(selectedItems.map((function(item){return savedObjects.client.delete(item.savedObjectType,item.id)}))).catch((function(error){toastNotifications.addError(error,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.visualizeListingDeleteErrorTitle",{defaultMessage:"Error deleting visualization"})})}));case 2:case"end":return _context.stop()}}}),_callee)})));return function(_x){return _ref3.apply(this,arguments)}}(),[savedObjects.client,toastNotifications]);return external_kbnSharedDeps_React_default.a.createElement(public_["TableListView"],{headingId:"visualizeListingHeading",createItem:createNewVis,findItems:fetchItems,deleteItems:visualizeCapabilities.delete?deleteItems:undefined,editItem:visualizeCapabilities.save?editItem:undefined,tableColumns:tableColumns,listingLimit:listingLimit,initialPageSize:savedObjectsPublic.settings.getPerPage(),initialFilter:"",noItemsFragment:noItemsFragment,entityName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.entityName",{defaultMessage:"visualization"}),entityNamePlural:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.entityNamePlural",{defaultMessage:"visualizations"}),tableListTitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.listing.table.listTitle",{defaultMessage:"Visualizations"}),toastNotifications:toastNotifications})};var visualize_editor=__webpack_require__(45);var events=__webpack_require__(61);function visualize_top_nav_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function visualize_top_nav_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){visualize_top_nav_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){visualize_top_nav_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function visualize_top_nav_slicedToArray(arr,i){return visualize_top_nav_arrayWithHoles(arr)||visualize_top_nav_iterableToArrayLimit(arr,i)||visualize_top_nav_unsupportedIterableToArray(arr,i)||visualize_top_nav_nonIterableRest()}function visualize_top_nav_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_top_nav_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_top_nav_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_top_nav_arrayLikeToArray(o,minLen)}function visualize_top_nav_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function visualize_top_nav_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_top_nav_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var visualize_top_nav_TopNav=function TopNav(_ref){var currentAppState=_ref.currentAppState,isChromeVisible=_ref.isChromeVisible,isEmbeddableRendered=_ref.isEmbeddableRendered,hasUnsavedChanges=_ref.hasUnsavedChanges,setHasUnsavedChanges=_ref.setHasUnsavedChanges,hasUnappliedChanges=_ref.hasUnappliedChanges,originatingApp=_ref.originatingApp,setOriginatingApp=_ref.setOriginatingApp,visInstance=_ref.visInstance,stateContainer=_ref.stateContainer,visualizationIdFromUrl=_ref.visualizationIdFromUrl,embeddableId=_ref.embeddableId,onAppLeave=_ref.onAppLeave;var _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;var TopNavMenu=services.navigation.ui.TopNavMenu;var setHeaderActionMenu=services.setHeaderActionMenu,visualizeCapabilities=services.visualizeCapabilities;var embeddableHandler=visInstance.embeddableHandler,vis=visInstance.vis;var _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_top_nav_slicedToArray(_useState,2),inspectorSession=_useState2[0],setInspectorSession=_useState2[1];var openInspector=Object(external_kbnSharedDeps_React_["useCallback"])((function(){var session=embeddableHandler.openInspector();setInspectorSession(session)}),[embeddableHandler]);var handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])((function(_payload,isUpdate){if(isUpdate===false){visInstance.embeddableHandler.reload()}}),[visInstance.embeddableHandler]);var stateTransfer=services.embeddable.getStateTransfer();var config=Object(external_kbnSharedDeps_React_["useMemo"])((function(){if(isEmbeddableRendered){return get_top_nav_config_getTopNavConfig({hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,openInspector:openInspector,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visInstance:visInstance,stateContainer:stateContainer,visualizationIdFromUrl:visualizationIdFromUrl,stateTransfer:stateTransfer,embeddableId:embeddableId,onAppLeave:onAppLeave},services)}}),[isEmbeddableRendered,hasUnsavedChanges,setHasUnsavedChanges,hasUnappliedChanges,openInspector,originatingApp,visInstance,setOriginatingApp,stateContainer,visualizationIdFromUrl,services,embeddableId,stateTransfer,onAppLeave]);var _useState3=Object(external_kbnSharedDeps_React_["useState"])(vis.data.indexPattern?[vis.data.indexPattern]:[]),_useState4=visualize_top_nav_slicedToArray(_useState3,2),indexPatterns=_useState4[0],setIndexPatterns=_useState4[1];var showDatePicker=function showDatePicker(){var hasTimeField=vis.data.indexPattern?!!vis.data.indexPattern.timeFieldName:true;return vis.type.options.showTimePicker&&hasTimeField};var showFilterBar=vis.type.options.showFilterBar;var showQueryInput=vis.type.requiresSearch&&vis.type.options.showQueryBar;Object(external_kbnSharedDeps_React_["useEffect"])((function(){return function(){if(inspectorSession){inspectorSession.close()}}}),[inspectorSession]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){onAppLeave((function(actions){if((originatingApp&&originatingApp==="dashboards"||originatingApp==="canvas")&&(hasUnappliedChanges||hasUnsavedChanges)){return actions.confirm(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.confirmModal.confirmTextDescription",{defaultMessage:"Leave Visualize editor with unsaved changes?"}),external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.confirmModal.title",{defaultMessage:"Unsaved changes"}))}return actions.default()}))}),[onAppLeave,hasUnappliedChanges,hasUnsavedChanges,visualizeCapabilities.save,originatingApp]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){var asyncSetIndexPattern=function(){var _ref2=visualize_top_nav_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var indexes,defaultIndex;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!vis.type.getUsedIndexPattern){_context.next=4;break}_context.next=3;return vis.type.getUsedIndexPattern(vis.params);case 3:indexes=_context.sent;case 4:if(!(!indexes||!indexes.length)){_context.next=9;break}_context.next=7;return services.data.indexPatterns.getDefault();case 7:defaultIndex=_context.sent;if(defaultIndex){indexes=[defaultIndex]}case 9:if(indexes){setIndexPatterns(indexes)}case 10:case"end":return _context.stop()}}}),_callee)})));return function asyncSetIndexPattern(){return _ref2.apply(this,arguments)}}();if(!vis.data.indexPattern){asyncSetIndexPattern()}}),[vis.params,vis.type,services.data.indexPatterns,vis.data.indexPattern]);return isChromeVisible?external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,{appName:visualize_constants["a"],config:config,setMenuMountPoint:setHeaderActionMenu,onQuerySubmit:handleRefresh,savedQueryId:currentAppState.savedQuery,onSavedQueryIdChange:stateContainer.transitions.updateSavedQuery,indexPatterns:indexPatterns,screenTitle:vis.title,showAutoRefreshOnly:!showDatePicker(),showDatePicker:showDatePicker(),showFilterBar:showFilterBar,showQueryInput:showQueryInput,showSaveQuery:services.visualizeCapabilities.saveQuery,showSearchBar:true,useDefaultBehaviors:true}):showFilterBar?external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,{appName:visualize_constants["a"],setMenuMountPoint:setHeaderActionMenu,indexPatterns:indexPatterns,showSearchBar:true,showSaveQuery:false,showDatePicker:false,showQueryInput:false}):null};var VisualizeTopNav=Object(external_kbnSharedDeps_React_["memo"])(visualize_top_nav_TopNav);var experimental_vis_info_InfoComponent=function InfoComponent(){var title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.experimentalVisInfoText",defaultMessage:"This visualization is experimental and is not subject to the support SLA of official GA features. For feedback, please create an issue in {githubLink}.",values:{githubLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{external:true,href:"https://github.com/elastic/kibana/issues/new/choose",target:"_blank"},"GitHub")}}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{className:"hide-for-sharing","data-test-subj":"experimentalVisInfo",size:"s",title:title,iconType:"beaker"})};var ExperimentalVisInfo=Object(external_kbnSharedDeps_React_["memo"])(experimental_vis_info_InfoComponent);var visualize_editor_common_VisualizeEditorCommon=function VisualizeEditorCommon(_ref){var _visInstance$vis,_visInstance$vis$type,_visInstance$vis2,_visInstance$vis2$typ,_visInstance$vis2$typ2;var visInstance=_ref.visInstance,appState=_ref.appState,currentAppState=_ref.currentAppState,isChromeVisible=_ref.isChromeVisible,hasUnsavedChanges=_ref.hasUnsavedChanges,setHasUnsavedChanges=_ref.setHasUnsavedChanges,hasUnappliedChanges=_ref.hasUnappliedChanges,isEmbeddableRendered=_ref.isEmbeddableRendered,onAppLeave=_ref.onAppLeave,originatingApp=_ref.originatingApp,setOriginatingApp=_ref.setOriginatingApp,visualizationIdFromUrl=_ref.visualizationIdFromUrl,embeddableId=_ref.embeddableId,visEditorRef=_ref.visEditorRef;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"app-container visEditor visEditor--".concat(visInstance===null||visInstance===void 0?void 0:visInstance.vis.type.name)},visInstance&&appState&&currentAppState&&external_kbnSharedDeps_React_default.a.createElement(VisualizeTopNav,{currentAppState:currentAppState,hasUnsavedChanges:hasUnsavedChanges,setHasUnsavedChanges:setHasUnsavedChanges,isChromeVisible:isChromeVisible,isEmbeddableRendered:isEmbeddableRendered,hasUnappliedChanges:hasUnappliedChanges,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visInstance:visInstance,stateContainer:appState,visualizationIdFromUrl:visualizationIdFromUrl,embeddableId:embeddableId,onAppLeave:onAppLeave}),(visInstance===null||visInstance===void 0?void 0:(_visInstance$vis=visInstance.vis)===null||_visInstance$vis===void 0?void 0:(_visInstance$vis$type=_visInstance$vis.type)===null||_visInstance$vis$type===void 0?void 0:_visInstance$vis$type.stage)==="experimental"&&external_kbnSharedDeps_React_default.a.createElement(ExperimentalVisInfo,null),visInstance===null||visInstance===void 0?void 0:(_visInstance$vis2=visInstance.vis)===null||_visInstance$vis2===void 0?void 0:(_visInstance$vis2$typ=_visInstance$vis2.type)===null||_visInstance$vis2$typ===void 0?void 0:(_visInstance$vis2$typ2=_visInstance$vis2$typ.getInfoMessage)===null||_visInstance$vis2$typ2===void 0?void 0:_visInstance$vis2$typ2.call(_visInstance$vis2$typ,visInstance.vis),visInstance&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("h1",null,"savedVis"in visInstance&&visInstance.savedVis.id?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.pageHeading",defaultMessage:"{chartName} {chartType} visualization",values:{chartName:visInstance.savedVis.title,chartType:visInstance.vis.type.title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.byValue_pageHeading",defaultMessage:"Visualization of type {chartType} embedded into {originatingApp} app",values:{chartType:visInstance.vis.type.title,originatingApp:originatingApp||"dashboards"}}))),external_kbnSharedDeps_React_default.a.createElement("div",{className:isChromeVisible?"visEditor__content":"visualize",ref:visEditorRef}))};function visualize_editor_slicedToArray(arr,i){return visualize_editor_arrayWithHoles(arr)||visualize_editor_iterableToArrayLimit(arr,i)||visualize_editor_unsupportedIterableToArray(arr,i)||visualize_editor_nonIterableRest()}function visualize_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_editor_arrayLikeToArray(o,minLen)}function visualize_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function visualize_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var visualize_editor_VisualizeEditor=function VisualizeEditor(_ref){var onAppLeave=_ref.onAppLeave;var _useParams=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])(),visualizationIdFromUrl=_useParams.id;var _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_editor_slicedToArray(_useState,2),originatingApp=_useState2[0],setOriginatingApp=_useState2[1];var _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;var _useState3=Object(external_kbnSharedDeps_React_["useState"])(new events["EventEmitter"]),_useState4=visualize_editor_slicedToArray(_useState3,1),eventEmitter=_useState4[0];var _useState5=Object(external_kbnSharedDeps_React_["useState"])(!visualizationIdFromUrl),_useState6=visualize_editor_slicedToArray(_useState5,2),hasUnsavedChanges=_useState6[0],setHasUnsavedChanges=_useState6[1];var isChromeVisible=use_chrome_visibility_useChromeVisibility(services.chrome);var _useSavedVisInstance=use_saved_vis_instance_useSavedVisInstance(services,eventEmitter,isChromeVisible,visualizationIdFromUrl),savedVisInstance=_useSavedVisInstance.savedVisInstance,visEditorRef=_useSavedVisInstance.visEditorRef,visEditorController=_useSavedVisInstance.visEditorController;var _useVisualizeAppState=use_visualize_app_state_useVisualizeAppState(services,eventEmitter,savedVisInstance),appState=_useVisualizeAppState.appState,hasUnappliedChanges=_useVisualizeAppState.hasUnappliedChanges;var _useEditorUpdates=use_editor_updates_useEditorUpdates(services,eventEmitter,setHasUnsavedChanges,appState,savedVisInstance,visEditorController),isEmbeddableRendered=_useEditorUpdates.isEmbeddableRendered,currentAppState=_useEditorUpdates.currentAppState;use_linked_search_updates_useLinkedSearchUpdates(services,eventEmitter,appState,savedVisInstance);Object(external_kbnSharedDeps_React_["useEffect"])((function(){var _ref2=services.embeddable.getStateTransfer(services.scopedHistory).getIncomingEditorState({keysToRemoveAfterFetch:["id","input"]})||{},value=_ref2.originatingApp;setOriginatingApp(value)}),[services]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){return function(){eventEmitter.removeAllListeners()}}),[eventEmitter]);return external_kbnSharedDeps_React_default.a.createElement(visualize_editor_common_VisualizeEditorCommon,{visInstance:savedVisInstance,appState:appState,currentAppState:currentAppState,isChromeVisible:isChromeVisible,hasUnsavedChanges:hasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,isEmbeddableRendered:isEmbeddableRendered,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,visualizationIdFromUrl:visualizationIdFromUrl,setHasUnsavedChanges:setHasUnsavedChanges,visEditorRef:visEditorRef,onAppLeave:onAppLeave})};var bannerId;var visualize_no_match_VisualizeNoMatch=function VisualizeNoMatch(){var _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;Object(external_kbnSharedDeps_React_["useEffect"])((function(){services.restorePreviousUrl();var _services$urlForwardi=services.urlForwarding.navigateToLegacyKibanaUrl(services.history.location.pathname),navigated=_services$urlForwardi.navigated;if(!navigated){var bannerMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visualize.noMatchRoute.bannerTitleText",{defaultMessage:"Page not found"});bannerId=services.overlays.banners.replace(bannerId,Object(public_["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning",iconType:"iInCircle",title:bannerMessage},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visualize.noMatchRoute.bannerText",defaultMessage:"Visualize application doesn't recognize this route: {route}.",values:{route:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:window.location.href},services.history.location.pathname)}})))));setTimeout((function(){services.overlays.banners.remove(bannerId)}),15e3);services.history.replace(visualize_constants["b"].LANDING_PAGE_PATH)}}),[services]);return null};function visualize_byvalue_editor_slicedToArray(arr,i){return visualize_byvalue_editor_arrayWithHoles(arr)||visualize_byvalue_editor_iterableToArrayLimit(arr,i)||visualize_byvalue_editor_unsupportedIterableToArray(arr,i)||visualize_byvalue_editor_nonIterableRest()}function visualize_byvalue_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function visualize_byvalue_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return visualize_byvalue_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return visualize_byvalue_editor_arrayLikeToArray(o,minLen)}function visualize_byvalue_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function visualize_byvalue_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function visualize_byvalue_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var visualize_byvalue_editor_VisualizeByValueEditor=function VisualizeByValueEditor(_ref){var onAppLeave=_ref.onAppLeave;var _useState=Object(external_kbnSharedDeps_React_["useState"])(),_useState2=visualize_byvalue_editor_slicedToArray(_useState,2),originatingApp=_useState2[0],setOriginatingApp=_useState2[1];var _useKibana=Object(public_["useKibana"])(),services=_useKibana.services;var _useState3=Object(external_kbnSharedDeps_React_["useState"])(new events["EventEmitter"]),_useState4=visualize_byvalue_editor_slicedToArray(_useState3,1),eventEmitter=_useState4[0];var _useState5=Object(external_kbnSharedDeps_React_["useState"])(false),_useState6=visualize_byvalue_editor_slicedToArray(_useState5,2),hasUnsavedChanges=_useState6[0],setHasUnsavedChanges=_useState6[1];var _useState7=Object(external_kbnSharedDeps_React_["useState"])(),_useState8=visualize_byvalue_editor_slicedToArray(_useState7,2),embeddableId=_useState8[0],setEmbeddableId=_useState8[1];var _useState9=Object(external_kbnSharedDeps_React_["useState"])(),_useState10=visualize_byvalue_editor_slicedToArray(_useState9,2),valueInput=_useState10[0],setValueInput=_useState10[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){var _ref2=services.embeddable.getStateTransfer(services.scopedHistory).getIncomingEditorState({keysToRemoveAfterFetch:["id","embeddableId","valueInput"]})||{},value=_ref2.originatingApp,embeddableIdValue=_ref2.embeddableId,valueInputValue=_ref2.valueInput;setOriginatingApp(value);setValueInput(valueInputValue);setEmbeddableId(embeddableIdValue);if(!valueInputValue){history.back()}}),[services]);var isChromeVisible=use_chrome_visibility_useChromeVisibility(services.chrome);var _useVisByValue=use_vis_byvalue_useVisByValue(services,eventEmitter,isChromeVisible,valueInput,originatingApp),byValueVisInstance=_useVisByValue.byValueVisInstance,visEditorRef=_useVisByValue.visEditorRef,visEditorController=_useVisByValue.visEditorController;var _useVisualizeAppState=use_visualize_app_state_useVisualizeAppState(services,eventEmitter,byValueVisInstance),appState=_useVisualizeAppState.appState,hasUnappliedChanges=_useVisualizeAppState.hasUnappliedChanges;var _useEditorUpdates=use_editor_updates_useEditorUpdates(services,eventEmitter,setHasUnsavedChanges,appState,byValueVisInstance,visEditorController),isEmbeddableRendered=_useEditorUpdates.isEmbeddableRendered,currentAppState=_useEditorUpdates.currentAppState;use_linked_search_updates_useLinkedSearchUpdates(services,eventEmitter,appState,byValueVisInstance);Object(external_kbnSharedDeps_React_["useEffect"])((function(){return function(){eventEmitter.removeAllListeners()}}),[eventEmitter]);return external_kbnSharedDeps_React_default.a.createElement(visualize_editor_common_VisualizeEditorCommon,{visInstance:byValueVisInstance,appState:appState,currentAppState:currentAppState,isChromeVisible:isChromeVisible,hasUnsavedChanges:hasUnsavedChanges,hasUnappliedChanges:hasUnappliedChanges,isEmbeddableRendered:isEmbeddableRendered,originatingApp:originatingApp,setOriginatingApp:setOriginatingApp,setHasUnsavedChanges:setHasUnsavedChanges,visEditorRef:visEditorRef,embeddableId:embeddableId,onAppLeave:onAppLeave})};var app_VisualizeApp=function VisualizeApp(_ref){var onAppLeave=_ref.onAppLeave;var _useKibana=Object(public_["useKibana"])(),_useKibana$services=_useKibana.services,query=_useKibana$services.data.query,kbnUrlStateStorage=_useKibana$services.kbnUrlStateStorage;var _useLocation=Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])(),pathname=_useLocation.pathname;Object(external_kbnSharedDeps_React_["useEffect"])((function(){var _syncQueryStateWithUr=Object(data_public_["syncQueryStateWithUrl"])(query,kbnUrlStateStorage),stop=_syncQueryStateWithUr.stop;return function(){return stop()}}),[query,kbnUrlStateStorage,pathname]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"".concat(visualize_constants["b"].EDIT_BY_VALUE_PATH)},external_kbnSharedDeps_React_default.a.createElement(visualize_byvalue_editor_VisualizeByValueEditor,{onAppLeave:onAppLeave})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:[visualize_constants["b"].CREATE_PATH,"".concat(visualize_constants["b"].EDIT_PATH,"/:id")]},external_kbnSharedDeps_React_default.a.createElement(visualize_editor_VisualizeEditor,{onAppLeave:onAppLeave})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:[visualize_constants["b"].LANDING_PAGE_PATH,visualize_constants["b"].WIZARD_STEP_1_PAGE_PATH]},external_kbnSharedDeps_React_default.a.createElement(visualize_listing_VisualizeListing,null)),external_kbnSharedDeps_React_default.a.createElement(visualize_no_match_VisualizeNoMatch,null))};var application_renderApp=function renderApp(_ref,services){var element=_ref.element,onAppLeave=_ref.onAppLeave;utils_addHelpMenuToAppChrome(services.chrome,services.docLinks);if(!services.visualizeCapabilities.save){utils_addBadgeToAppChrome(services.chrome)}var app=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Router"],{history:services.history},external_kbnSharedDeps_React_default.a.createElement(public_["KibanaContextProvider"],{services:services},external_kbnSharedDeps_React_default.a.createElement(services.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(app_VisualizeApp,{onAppLeave:onAppLeave}))));external_kbnSharedDeps_ReactDom_default.a.render(app,element);return function(){return external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(element)}}},45:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(187);case"v7light":return __webpack_require__(189);case"v8dark":return __webpack_require__(191);case"v8light":return __webpack_require__(193)}},62:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(63);case"v7light":return __webpack_require__(65);case"v8dark":return __webpack_require__(67);case"v8light":return __webpack_require__(69)}},63:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(64);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},64:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},65:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(66);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},66:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},67:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(68);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},68:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},69:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(70);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},70:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visAppWrapper {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1; }\n",""]);module.exports=exports},71:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(72);case"v7light":return __webpack_require__(74);case"v8dark":return __webpack_require__(76);case"v8light":return __webpack_require__(78)}},72:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(73);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},73:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},74:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(75);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},75:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},76:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(77);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},77:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports},78:function(module,exports,__webpack_require__){var api=__webpack_require__(32);var content=__webpack_require__(79);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},79:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(33);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visListingTable__typeImage,\n.visListingTable__typeIcon {\n  margin-right: 8px;\n  position: relative;\n  top: -1px; }\n\n.visListingTable__typeImage {\n  width: 16px;\n  height: 16px; }\n\n.visListingTable__experimentalIcon {\n  width: 24px;\n  vertical-align: baseline;\n  padding: 0 8px;\n  margin-left: 8px; }\n",""]);module.exports=exports}}]);