(window["visTypeTagcloud_bundle_jsonpfunction"]=window["visTypeTagcloud_bundle_jsonpfunction"]||[]).push([[1],{23:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(24);case"v7light":return __webpack_require__(26);case"v8dark":return __webpack_require__(28);case"v8light":return __webpack_require__(30)}},24:function(module,exports,__webpack_require__){var api=__webpack_require__(18);var content=__webpack_require__(25);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},25:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(19);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".tgcChart__container, .tgcChart__wrapper {\n  flex: 1 1 0;\n  display: flex; }\n\n.tgcChart {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden; }\n\n.tgcChart__label {\n  width: 100%;\n  text-align: center;\n  font-weight: 700; }\n",""]);module.exports=exports},26:function(module,exports,__webpack_require__){var api=__webpack_require__(18);var content=__webpack_require__(27);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},27:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(19);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".tgcChart__container, .tgcChart__wrapper {\n  flex: 1 1 0;\n  display: flex; }\n\n.tgcChart {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden; }\n\n.tgcChart__label {\n  width: 100%;\n  text-align: center;\n  font-weight: 700; }\n",""]);module.exports=exports},28:function(module,exports,__webpack_require__){var api=__webpack_require__(18);var content=__webpack_require__(29);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},29:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(19);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".tgcChart__container, .tgcChart__wrapper {\n  flex: 1 1 0;\n  display: flex; }\n\n.tgcChart {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden; }\n\n.tgcChart__label {\n  width: 100%;\n  text-align: center;\n  font-weight: 700; }\n",""]);module.exports=exports},30:function(module,exports,__webpack_require__){var api=__webpack_require__(18);var content=__webpack_require__(31);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},31:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(19);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".tgcChart__container, .tgcChart__wrapper {\n  flex: 1 1 0;\n  display: flex; }\n\n.tgcChart {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden; }\n\n.tgcChart__label {\n  width: 100%;\n  text-align: center;\n  font-weight: 700; }\n",""]);module.exports=exports},32:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"TagCloudChart",(function(){return tag_cloud_chart_TagCloudChart}));__webpack_require__.d(__webpack_exports__,"default",(function(){return tag_cloud_chart_TagCloudChart}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(6);var external_kbnSharedDeps_Lodash_=__webpack_require__(15);var external_kbnSharedDeps_Rxjs_=__webpack_require__(16);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(17);var external_kbnSharedDeps_ReactDom_=__webpack_require__(5);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(14);var services=__webpack_require__(7);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var label_Label=function(_Component){_inherits(Label,_Component);var _super=_createSuper(Label);function Label(){var _this;_classCallCheck(this,Label);_this=_super.call(this);_this.state={label:"",shouldShowLabel:true};return _this}_createClass(Label,[{key:"render",value:function render(){return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tgcChart__label",style:{display:this.state.shouldShowLabel?"block":"none"}},this.state.label)}}]);return Label}(external_kbnSharedDeps_React_["Component"]);var d3=__webpack_require__(20);var d3_default=__webpack_require__.n(d3);var d3_layout_cloud=__webpack_require__(21);var d3_layout_cloud_default=__webpack_require__.n(d3_layout_cloud);var events=__webpack_require__(22);function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function tag_cloud_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function tag_cloud_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function tag_cloud_createClass(Constructor,protoProps,staticProps){if(protoProps)tag_cloud_defineProperties(Constructor.prototype,protoProps);if(staticProps)tag_cloud_defineProperties(Constructor,staticProps);return Constructor}function tag_cloud_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)tag_cloud_setPrototypeOf(subClass,superClass)}function tag_cloud_setPrototypeOf(o,p){tag_cloud_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return tag_cloud_setPrototypeOf(o,p)}function tag_cloud_createSuper(Derived){var hasNativeReflectConstruct=tag_cloud_isNativeReflectConstruct();return function _createSuperInternal(){var Super=tag_cloud_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=tag_cloud_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return tag_cloud_possibleConstructorReturn(this,result)}}function tag_cloud_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return tag_cloud_assertThisInitialized(self)}function tag_cloud_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function tag_cloud_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function tag_cloud_getPrototypeOf(o){tag_cloud_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return tag_cloud_getPrototypeOf(o)}var ORIENTATIONS={single:function single(){return 0},"right angled":function rightAngled(tag){return hashWithinRange(tag.text,2)*90},multiple:function multiple(tag){return hashWithinRange(tag.text,12)*15-90}};var D3_SCALING_FUNCTIONS={linear:function linear(){return d3_default.a.scale.linear()},log:function log(){return d3_default.a.scale.log()},"square root":function squareRoot(){return d3_default.a.scale.sqrt()}};var tag_cloud_TagCloud=function(_EventEmitter){tag_cloud_inherits(TagCloud,_EventEmitter);var _super=tag_cloud_createSuper(TagCloud);function TagCloud(domNode,colorScale){var _this;tag_cloud_classCallCheck(this,TagCloud);_this=_super.call(this);_this._element=domNode;_this._d3SvgContainer=d3_default.a.select(_this._element).append("svg");_this._svgGroup=_this._d3SvgContainer.append("g");_this._size=[1,1];_this.resize();_this._fontFamily="Inter UI, sans-serif";_this._fontStyle="normal";_this._fontWeight="normal";_this._spiral="archimedean";_this._timeInterval=1e3;_this._padding=5;_this._orientation="single";_this._minFontSize=10;_this._maxFontSize=36;_this._textScale="linear";_this._optionsAsString=null;_this._words=null;_this._colorScale=colorScale;_this._setTimeoutId=null;_this._pendingJob=null;_this._layoutIsUpdating=null;_this._allInViewBox=false;_this._DOMisUpdating=false;return _this}tag_cloud_createClass(TagCloud,[{key:"setOptions",value:function setOptions(options){if(JSON.stringify(options)===this._optionsAsString){return}this._optionsAsString=JSON.stringify(options);this._orientation=options.orientation;this._minFontSize=Math.min(options.minFontSize,options.maxFontSize);this._maxFontSize=Math.max(options.minFontSize,options.maxFontSize);this._textScale=options.scale;this._invalidate(false)}},{key:"resize",value:function resize(){var newWidth=this._element.offsetWidth;var newHeight=this._element.offsetHeight;if(newWidth===this._size[0]&&newHeight===this._size[1]){return}var wasInside=this._size[0]>=this._cloudWidth&&this._size[1]>=this._cloudHeight;var willBeInside=this._cloudWidth<=newWidth&&this._cloudHeight<=newHeight;this._size[0]=newWidth;this._size[1]=newHeight;if(wasInside&&willBeInside&&this._allInViewBox){this._invalidate(true)}else{this._invalidate(false)}}},{key:"setData",value:function setData(data){this._words=data;this._invalidate(false)}},{key:"destroy",value:function destroy(){clearTimeout(this._setTimeoutId);this._element.innerHTML=""}},{key:"getStatus",value:function getStatus(){return this._allInViewBox?TagCloud.STATUS.COMPLETE:TagCloud.STATUS.INCOMPLETE}},{key:"_updateContainerSize",value:function _updateContainerSize(){this._d3SvgContainer.attr("width",this._size[0]);this._d3SvgContainer.attr("height",this._size[1]);this._svgGroup.attr("width",this._size[0]);this._svgGroup.attr("height",this._size[1])}},{key:"_isJobRunning",value:function _isJobRunning(){return this._setTimeoutId||this._layoutIsUpdating||this._DOMisUpdating}},{key:"_processPendingJob",value:function(){var _processPendingJob2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var job,cloudBBox;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(this._pendingJob){_context.next=2;break}return _context.abrupt("return");case 2:if(!this._isJobRunning()){_context.next=4;break}return _context.abrupt("return");case 4:this._completedJob=null;_context.next=7;return this._pickPendingJob();case 7:job=_context.sent;if(!job.words.length){_context.next=20;break}if(!job.refreshLayout){_context.next=12;break}_context.next=12;return this._updateLayout(job);case 12:_context.next=14;return this._updateDOM(job);case 14:cloudBBox=this._svgGroup[0][0].getBBox();this._cloudWidth=cloudBBox.width;this._cloudHeight=cloudBBox.height;this._allInViewBox=cloudBBox.x>=0&&cloudBBox.y>=0&&cloudBBox.x+cloudBBox.width<=this._element.offsetWidth&&cloudBBox.y+cloudBBox.height<=this._element.offsetHeight;_context.next=21;break;case 20:this._emptyDOM(job);case 21:if(this._pendingJob){this._processPendingJob()}else{this._completedJob=job;this.emit("renderComplete")}case 22:case"end":return _context.stop()}}}),_callee,this)})));function _processPendingJob(){return _processPendingJob2.apply(this,arguments)}return _processPendingJob}()},{key:"_pickPendingJob",value:function(){var _pickPendingJob2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _this2=this;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return new Promise((function(resolve){_this2._setTimeoutId=setTimeout(_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var job;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:job=_this2._pendingJob;_this2._pendingJob=null;_this2._setTimeoutId=null;resolve(job);case 4:case"end":return _context2.stop()}}}),_callee2)}))),0)}));case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}}),_callee3)})));function _pickPendingJob(){return _pickPendingJob2.apply(this,arguments)}return _pickPendingJob}()},{key:"_emptyDOM",value:function _emptyDOM(){this._svgGroup.selectAll("text").remove();this._cloudWidth=0;this._cloudHeight=0;this._allInViewBox=true;this._DOMisUpdating=false}},{key:"_updateDOM",value:function(){var _updateDOM2=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(job){var _this3=this;var canSkipDomUpdate,affineTransform,svgTextNodes,stage;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:canSkipDomUpdate=this._pendingJob||this._setTimeoutId;if(!canSkipDomUpdate){_context4.next=4;break}this._DOMisUpdating=false;return _context4.abrupt("return");case 4:this._DOMisUpdating=true;affineTransform=positionWord.bind(null,this._element.offsetWidth/2,this._element.offsetHeight/2);svgTextNodes=this._svgGroup.selectAll("text");stage=svgTextNodes.data(job.words,getText);_context4.next=10;return new Promise((function(resolve){var enterSelection=stage.enter();var enteringTags=enterSelection.append("text");enteringTags.style("font-size",getSizeInPixels);enteringTags.style("font-style",_this3._fontStyle);enteringTags.style("font-weight",(function(){return _this3._fontWeight}));enteringTags.style("font-family",(function(){return _this3._fontFamily}));enteringTags.style("fill",_this3.getFill.bind(_this3));enteringTags.attr("text-anchor",(function(){return"middle"}));enteringTags.attr("transform",affineTransform);enteringTags.attr("data-test-subj",getDisplayText);enteringTags.text(getDisplayText);var self=_this3;enteringTags.on({click:function click(event){self.emit("select",event)},mouseover:function mouseover(){d3_default.a.select(this).style("cursor","pointer")},mouseout:function mouseout(){d3_default.a.select(this).style("cursor","default")}});var movingTags=stage.transition();movingTags.duration(600);movingTags.style("font-size",getSizeInPixels);movingTags.style("font-style",_this3._fontStyle);movingTags.style("font-weight",(function(){return _this3._fontWeight}));movingTags.style("font-family",(function(){return _this3._fontFamily}));movingTags.attr("transform",affineTransform);var exitingTags=stage.exit();var exitTransition=exitingTags.transition();exitTransition.duration(200);exitingTags.style("fill-opacity",1e-6);exitingTags.attr("font-size",1);exitingTags.remove();var exits=0;var moves=0;var resolveWhenDone=function resolveWhenDone(){if(exits===0&&moves===0){_this3._DOMisUpdating=false;resolve(true)}};exitTransition.each((function(){return exits++}));exitTransition.each("end",(function(){exits--;resolveWhenDone()}));movingTags.each((function(){return moves++}));movingTags.each("end",(function(){moves--;resolveWhenDone()}))}));case 10:case"end":return _context4.stop()}}}),_callee4,this)})));function _updateDOM(_x){return _updateDOM2.apply(this,arguments)}return _updateDOM}()},{key:"_makeTextSizeMapper",value:function _makeTextSizeMapper(){var mapSizeToFontSize=D3_SCALING_FUNCTIONS[this._textScale]();var range=this._words.length===1?[this._maxFontSize,this._maxFontSize]:[this._minFontSize,this._maxFontSize];mapSizeToFontSize.range(range);if(this._words){mapSizeToFontSize.domain(d3_default.a.extent(this._words,getValue))}return mapSizeToFontSize}},{key:"_makeNewJob",value:function _makeNewJob(){return{refreshLayout:true,size:this._size.slice(),words:this._words}}},{key:"_makeJobPreservingLayout",value:function _makeJobPreservingLayout(){return{refreshLayout:false,size:this._size.slice(),words:this._completedJob.words.map((function(tag){return{x:tag.x,y:tag.y,rotate:tag.rotate,size:tag.size,rawText:tag.rawText||tag.text,displayText:tag.displayText,meta:tag.meta}}))}}},{key:"_invalidate",value:function _invalidate(keepLayout){if(!this._words){return}this._updateContainerSize();var canReuseLayout=keepLayout&&!this._isJobRunning()&&this._completedJob;this._pendingJob=canReuseLayout?this._makeJobPreservingLayout():this._makeNewJob();this._processPendingJob()}},{key:"_updateLayout",value:function(){var _updateLayout2=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(job){var _this4=this;var mapSizeToFontSize,tagCloudLayoutGenerator;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(job.size[0]<=0||job.size[1]<=0)){_context5.next=2;break}return _context5.abrupt("return");case 2:mapSizeToFontSize=this._makeTextSizeMapper();tagCloudLayoutGenerator=d3_layout_cloud_default()();tagCloudLayoutGenerator.size(job.size);tagCloudLayoutGenerator.padding(this._padding);tagCloudLayoutGenerator.rotate(ORIENTATIONS[this._orientation]);tagCloudLayoutGenerator.font(this._fontFamily);tagCloudLayoutGenerator.fontStyle(this._fontStyle);tagCloudLayoutGenerator.fontWeight(this._fontWeight);tagCloudLayoutGenerator.fontSize((function(tag){return mapSizeToFontSize(tag.value)}));tagCloudLayoutGenerator.random(seed);tagCloudLayoutGenerator.spiral(this._spiral);tagCloudLayoutGenerator.words(job.words);tagCloudLayoutGenerator.text(getDisplayText);tagCloudLayoutGenerator.timeInterval(this._timeInterval);this._layoutIsUpdating=true;_context5.next=19;return new Promise((function(resolve){tagCloudLayoutGenerator.on("end",(function(){_this4._layoutIsUpdating=false;resolve(true)}));tagCloudLayoutGenerator.start()}));case 19:case"end":return _context5.stop()}}}),_callee5,this)})));function _updateLayout(_x2){return _updateLayout2.apply(this,arguments)}return _updateLayout}()},{key:"getDebugInfo",value:function getDebugInfo(){var debug={};debug.positions=this._completedJob?this._completedJob.words.map((function(tag){return{displayText:tag.displayText,rawText:tag.rawText||tag.text,x:tag.x,y:tag.y,rotate:tag.rotate}})):[];debug.size={width:this._size[0],height:this._size[1]};return debug}},{key:"getFill",value:function getFill(tag){return this._colorScale(tag.text)}}]);return TagCloud}(events["EventEmitter"]);tag_cloud_TagCloud.STATUS={COMPLETE:0,INCOMPLETE:1};function seed(){return.5}function getText(word){return word.rawText}function getDisplayText(word){return word.displayText}function positionWord(xTranslate,yTranslate,word){if(isNaN(word.x)||isNaN(word.y)||isNaN(word.rotate)){return"translate(".concat(xTranslate*3,", ").concat(yTranslate*3,")rotate(0)")}return"translate(".concat(word.x+xTranslate,", ").concat(word.y+yTranslate,")rotate(").concat(word.rotate,")")}function getValue(tag){return tag.value}function getSizeInPixels(tag){return"".concat(tag.size,"px")}function hashWithinRange(str,max){str=JSON.stringify(str);var hash=0;var _iterator=_createForOfIteratorHelper(str),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var ch=_step.value;hash=(hash*31+ch.charCodeAt(0))%max}}catch(err){_iterator.e(err)}finally{_iterator.f()}return Math.abs(hash)%max}function feedback_message_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function feedback_message_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function feedback_message_createClass(Constructor,protoProps,staticProps){if(protoProps)feedback_message_defineProperties(Constructor.prototype,protoProps);if(staticProps)feedback_message_defineProperties(Constructor,staticProps);return Constructor}function feedback_message_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)feedback_message_setPrototypeOf(subClass,superClass)}function feedback_message_setPrototypeOf(o,p){feedback_message_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return feedback_message_setPrototypeOf(o,p)}function feedback_message_createSuper(Derived){var hasNativeReflectConstruct=feedback_message_isNativeReflectConstruct();return function _createSuperInternal(){var Super=feedback_message_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=feedback_message_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return feedback_message_possibleConstructorReturn(this,result)}}function feedback_message_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return feedback_message_assertThisInitialized(self)}function feedback_message_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function feedback_message_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function feedback_message_getPrototypeOf(o){feedback_message_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return feedback_message_getPrototypeOf(o)}var feedback_message_FeedbackMessage=function(_Component){feedback_message_inherits(FeedbackMessage,_Component);var _super=feedback_message_createSuper(FeedbackMessage);function FeedbackMessage(){var _this;feedback_message_classCallCheck(this,FeedbackMessage);_this=_super.call(this);_this.state={shouldShowTruncate:false,shouldShowIncomplete:false};return _this}feedback_message_createClass(FeedbackMessage,[{key:"render",value:function render(){if(!this.state.shouldShowTruncate&&!this.state.shouldShowIncomplete){return""}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"alert",color:"warning",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,this.state.shouldShowTruncate&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTagCloud.feedbackMessage.truncatedTagsDescription",defaultMessage:"The number of tags has been truncated to avoid long draw times."})),this.state.shouldShowIncomplete&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTagCloud.feedbackMessage.tooSmallContainerDescription",defaultMessage:"The container is too small to display the entire cloud. Tags might be cropped or omitted."})))})}}]);return FeedbackMessage}(external_kbnSharedDeps_React_["Component"]);function tag_cloud_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function tag_cloud_visualization_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){tag_cloud_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){tag_cloud_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function tag_cloud_visualization_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function tag_cloud_visualization_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function tag_cloud_visualization_createClass(Constructor,protoProps,staticProps){if(protoProps)tag_cloud_visualization_defineProperties(Constructor.prototype,protoProps);if(staticProps)tag_cloud_visualization_defineProperties(Constructor,staticProps);return Constructor}var MAX_TAG_COUNT=200;var tag_cloud_visualization_TagCloudVisualization=function(){function TagCloudVisualization(node,colors,fireEvent){var _this=this;tag_cloud_visualization_classCallCheck(this,TagCloudVisualization);this._containerNode=node;var cloudRelativeContainer=document.createElement("div");cloudRelativeContainer.classList.add("tgcChart");cloudRelativeContainer.setAttribute("style","position: relative");var cloudContainer=document.createElement("div");cloudContainer.classList.add("tgcChart");cloudContainer.setAttribute("data-test-subj","tagCloudVisualization");this._containerNode.classList.add("visChart--vertical");cloudRelativeContainer.appendChild(cloudContainer);this._containerNode.appendChild(cloudRelativeContainer);this._truncated=false;this._tagCloud=new tag_cloud_TagCloud(cloudContainer,d3_default.a.scale.ordinal().range(colors.seedColors));this._tagCloud.on("select",(function(event){if(!_this._visParams.bucket){return}fireEvent({name:"filterBucket",data:{data:[{table:event.meta.data,column:0,row:event.meta.rowIndex}]}})}));this._renderComplete$=external_kbnSharedDeps_Rxjs_["fromEvent"](this._tagCloud,"renderComplete");this._feedbackNode=document.createElement("div");this._containerNode.appendChild(this._feedbackNode);this._feedbackMessage=external_kbnSharedDeps_React_default.a.createRef();Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(feedback_message_FeedbackMessage,{ref:this._feedbackMessage})),this._feedbackNode);this._labelNode=document.createElement("div");this._containerNode.appendChild(this._labelNode);this._label=external_kbnSharedDeps_React_default.a.createRef();Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(label_Label,{ref:this._label}),this._labelNode)}tag_cloud_visualization_createClass(TagCloudVisualization,[{key:"render",value:function(){var _render=tag_cloud_visualization_asyncToGenerator(regeneratorRuntime.mark((function _callee(data,visParams){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this._updateParams(visParams);this._updateData(data);this._resize();_context.next=5;return this._renderComplete$.pipe(Object(external_kbnSharedDeps_RxjsOperators_["take"])(1)).toPromise();case 5:if(!(data&&data.columns.length!==2&&this._feedbackMessage.current)){_context.next=8;break}this._feedbackMessage.current.setState({shouldShowTruncate:false,shouldShowIncomplete:false});return _context.abrupt("return");case 8:if(data&&this._label.current){this._label.current.setState({label:"".concat(data.columns[0].name," - ").concat(data.columns[1].name),shouldShowLabel:visParams.showLabel})}if(this._feedbackMessage.current){this._feedbackMessage.current.setState({shouldShowTruncate:this._truncated,shouldShowIncomplete:this._tagCloud.getStatus()===tag_cloud_TagCloud.STATUS.INCOMPLETE})}case 10:case"end":return _context.stop()}}}),_callee,this)})));function render(_x,_x2){return _render.apply(this,arguments)}return render}()},{key:"destroy",value:function destroy(){this._tagCloud.destroy();Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(this._feedbackNode);Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(this._labelNode)}},{key:"_updateData",value:function _updateData(data){if(!data||!data.rows.length){this._tagCloud.setData([]);return}var bucket=this._visParams.bucket;var metric=this._visParams.metric;var bucketFormatter=bucket?Object(services["a"])().deserialize(bucket.format):null;var tagColumn=bucket?data.columns[bucket.accessor].id:-1;var metricColumn=data.columns[metric.accessor].id;var tags=data.rows.map((function(row,rowIndex){var tag=row[tagColumn]===undefined?"all":row[tagColumn];var metric=row[metricColumn];return{displayText:bucketFormatter?bucketFormatter.convert(tag,"text"):tag,rawText:tag,value:metric,meta:{data:data,rowIndex:rowIndex}}}));if(tags.length>MAX_TAG_COUNT){tags.length=MAX_TAG_COUNT;this._truncated=true}else{this._truncated=false}this._tagCloud.setData(tags)}},{key:"_updateParams",value:function _updateParams(visParams){this._visParams=visParams;this._tagCloud.setOptions(visParams)}},{key:"_resize",value:function _resize(){this._tagCloud.resize()}}]);return TagCloudVisualization}();var tag_cloud=__webpack_require__(23);var tag_cloud_chart_TagCloudChart=function TagCloudChart(_ref){var colors=_ref.colors,visData=_ref.visData,visParams=_ref.visParams,fireEvent=_ref.fireEvent,renderComplete=_ref.renderComplete;var chartDiv=Object(external_kbnSharedDeps_React_["useRef"])(null);var visController=Object(external_kbnSharedDeps_React_["useRef"])(null);Object(external_kbnSharedDeps_React_["useEffect"])((function(){visController.current=new tag_cloud_visualization_TagCloudVisualization(chartDiv.current,colors,fireEvent);return function(){visController.current.destroy();visController.current=null}}),[colors,fireEvent]);Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(visController.current){visController.current.render(visData,visParams).then(renderComplete)}}),[visData,visParams,renderComplete]);var updateChartSize=Object(external_kbnSharedDeps_React_["useMemo"])((function(){return Object(external_kbnSharedDeps_Lodash_["throttle"])((function(){if(visController.current){visController.current.render(visData,visParams).then(renderComplete)}}),300)}),[renderComplete,visData,visParams]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiResizeObserver"],{onResize:updateChartSize},(function(resizeRef){return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tgcChart__wrapper",ref:resizeRef},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tgcChart__container",ref:chartDiv}))}))}}}]);