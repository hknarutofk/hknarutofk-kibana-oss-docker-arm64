(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=7)})([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/securityOss/public",__webpack_require__,9)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["securityOss"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"SecurityOssPluginSetup",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"SecurityOssPluginStart",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(3);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(4);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(6);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var defaultAlertTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.insecureClusterTitle",{defaultMessage:"Your data is not secure"});var default_alert_defaultAlertText=function defaultAlertText(onDismiss){return function(e){var AlertText=function AlertText(){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),persist=_useState2[0],setPersist=_useState2[1];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"insecureClusterDefaultAlertText"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"security.checkup.insecureClusterMessage",defaultMessage:"Don't lose one bit. Secure your data for free with Elastic."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"persistDismissedAlertPreference",checked:persist,onChange:function onChange(changeEvent){return setPersist(changeEvent.target.checked)},label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.dontShowAgain",{defaultMessage:"Don't show again"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",color:"primary",fill:true,href:"https://www.elastic.co/what-is/elastic-stack-security?blade=kibanasecuritymessage",target:"_blank"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.learnMoreButtonText",{defaultMessage:"Learn more"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",onClick:function onClick(){return onDismiss(persist)},"data-test-subj":"defaultDismissAlertButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.dismissButtonText",{defaultMessage:"Dismiss"}))))))};Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(AlertText,null),e);return function(){return Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(e)}}};function insecure_cluster_service_slicedToArray(arr,i){return insecure_cluster_service_arrayWithHoles(arr)||insecure_cluster_service_iterableToArrayLimit(arr,i)||insecure_cluster_service_unsupportedIterableToArray(arr,i)||insecure_cluster_service_nonIterableRest()}function insecure_cluster_service_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function insecure_cluster_service_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return insecure_cluster_service_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return insecure_cluster_service_arrayLikeToArray(o,minLen)}function insecure_cluster_service_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function insecure_cluster_service_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function insecure_cluster_service_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var insecure_cluster_service_InsecureClusterService=function(){function InsecureClusterService(config,storage){_classCallCheck(this,InsecureClusterService);_defineProperty(this,"enabled",void 0);_defineProperty(this,"alertVisibility$",void 0);_defineProperty(this,"storage",void 0);_defineProperty(this,"alertToast",void 0);_defineProperty(this,"alertTitle",void 0);_defineProperty(this,"alertText",void 0);_defineProperty(this,"storageKey",void 0);this.storage=storage;this.enabled=config.showInsecureClusterWarning;this.alertVisibility$=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](this.enabled)}_createClass(InsecureClusterService,[{key:"setup",value:function setup(_ref){var _this=this;var core=_ref.core;var tenant=core.http.basePath.serverBasePath;this.storageKey="insecureClusterWarningVisibility".concat(tenant);this.enabled=this.enabled&&this.getPersistedVisibilityPreference();this.alertVisibility$.next(this.enabled);return{setAlertTitle:function setAlertTitle(alertTitle){if(_this.alertTitle){throw new Error("alert title has already been set")}_this.alertTitle=alertTitle},setAlertText:function setAlertText(alertText){if(_this.alertText){throw new Error("alert text has already been set")}_this.alertText=alertText}}}},{key:"start",value:function start(_ref2){var _this2=this;var core=_ref2.core;var shouldInitialize=this.enabled&&!core.http.anonymousPaths.isAnonymous(window.location.pathname);if(shouldInitialize){this.initializeAlert(core)}return{hideAlert:function hideAlert(persist){return _this2.setAlertVisibility(false,persist)}}}},{key:"initializeAlert",value:function initializeAlert(core){var _this3=this;var displayAlert$=Object(external_kbnSharedDeps_Rxjs_["from"])(core.http.get("/internal/security_oss/display_insecure_cluster_alert").catch((function(e){return{displayAlert:false}})));var oneMinute=6e4;var tenDays=oneMinute*60*24*10;Object(external_kbnSharedDeps_Rxjs_["combineLatest"])([displayAlert$,this.alertVisibility$]).pipe(Object(external_kbnSharedDeps_RxjsOperators_["map"])((function(_ref3){var _ref4=insecure_cluster_service_slicedToArray(_ref3,2),displayAlert=_ref4[0].displayAlert,isAlertVisible=_ref4[1];return displayAlert&&isAlertVisible})),Object(external_kbnSharedDeps_RxjsOperators_["distinctUntilChanged"])()).subscribe((function(showAlert){if(showAlert&&!_this3.alertToast){var _this3$alertTitle,_this3$alertText;_this3.alertToast=core.notifications.toasts.addWarning({title:(_this3$alertTitle=_this3.alertTitle)!==null&&_this3$alertTitle!==void 0?_this3$alertTitle:defaultAlertTitle,text:(_this3$alertText=_this3.alertText)!==null&&_this3$alertText!==void 0?_this3$alertText:default_alert_defaultAlertText((function(persist){return _this3.setAlertVisibility(false,persist)})),iconType:"alert"},{toastLifeTimeMs:tenDays})}else if(!showAlert&&_this3.alertToast){core.notifications.toasts.remove(_this3.alertToast);_this3.alertToast=undefined}}))}},{key:"setAlertVisibility",value:function setAlertVisibility(show,persist){if(!this.enabled){return}this.alertVisibility$.next(show);if(persist){this.setPersistedVisibilityPreference(show)}}},{key:"getPersistedVisibilityPreference",value:function getPersistedVisibilityPreference(){var _this$storage$getItem;var entry=(_this$storage$getItem=this.storage.getItem(this.storageKey))!==null&&_this$storage$getItem!==void 0?_this$storage$getItem:"{}";try{var _JSON$parse=JSON.parse(entry),_JSON$parse$show=_JSON$parse.show,show=_JSON$parse$show===void 0?true:_JSON$parse$show;return show}catch(e){return true}}},{key:"setPersistedVisibilityPreference",value:function setPersistedVisibilityPreference(show){this.storage.setItem(this.storageKey,JSON.stringify({show:show}))}}]);return InsecureClusterService}();function plugin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function plugin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function plugin_createClass(Constructor,protoProps,staticProps){if(protoProps)plugin_defineProperties(Constructor.prototype,protoProps);if(staticProps)plugin_defineProperties(Constructor,staticProps);return Constructor}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var plugin_SecurityOssPlugin=function(){function SecurityOssPlugin(initializerContext){plugin_classCallCheck(this,SecurityOssPlugin);this.initializerContext=initializerContext;plugin_defineProperty(this,"config",void 0);plugin_defineProperty(this,"insecureClusterService",void 0);this.config=this.initializerContext.config.get();this.insecureClusterService=new insecure_cluster_service_InsecureClusterService(this.config,localStorage)}plugin_createClass(SecurityOssPlugin,[{key:"setup",value:function setup(core){return{insecureCluster:this.insecureClusterService.setup({core:core})}}},{key:"start",value:function start(core){return{insecureCluster:this.insecureClusterService.start({core:core})}}}]);return SecurityOssPlugin}();var public_plugin=function plugin(initializerContext){return new plugin_SecurityOssPlugin(initializerContext)}}]);