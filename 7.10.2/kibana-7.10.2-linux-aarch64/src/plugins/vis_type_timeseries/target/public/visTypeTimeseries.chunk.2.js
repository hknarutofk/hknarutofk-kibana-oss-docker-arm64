(window["visTypeTimeseries_bundle_jsonpfunction"]=window["visTypeTimeseries_bundle_jsonpfunction"]||[]).push([[2],{133:function(module,exports,__webpack_require__){var assignValue=__webpack_require__(92),castPath=__webpack_require__(89),isFunction=__webpack_require__(82),isIndex=__webpack_require__(77),isObject=__webpack_require__(48),toKey=__webpack_require__(57);function baseSet(object,path,value,customizer){if(!isObject(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key=="prototype"&&isFunction(nested)){throw new Error("Illegal access of function prototype")}if(index!=lastIndex){var objValue=hasOwnProperty.call(nested,key)?nested[key]:undefined;newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}module.exports=baseSet},271:function(module,exports,__webpack_require__){exports.set=__webpack_require__(272);exports.setWith=__webpack_require__(273)},272:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(133);function set(object,path,value){return object==null?object:baseSet(object,path,value)}module.exports=set},273:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(133);function setWith(object,path,value,customizer){customizer=typeof customizer=="function"?customizer:undefined;return object==null?object:baseSet(object,path,value,customizer)}module.exports=setWith},331:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"VisEditor",(function(){return vis_editor_VisEditor}));__webpack_require__.d(__webpack_exports__,"default",(function(){return vis_editor_VisEditor}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_Rxjs_=__webpack_require__(34);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(35);var external_kbnSharedDeps_Lodash_=__webpack_require__(4);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(10);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(31);var external_kbnSharedDeps_Moment_=__webpack_require__(18);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var public_=__webpack_require__(11);var interval_regexp=__webpack_require__(16);var parseEsInterval=public_["search"].aggs.parseEsInterval;var AUTO_INTERVAL="auto";var unitLookup={s:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.secondsLabel",{defaultMessage:"seconds"}),m:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.minutesLabel",{defaultMessage:"minutes"}),h:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.hoursLabel",{defaultMessage:"hours"}),d:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.daysLabel",{defaultMessage:"days"}),w:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.weeksLabel",{defaultMessage:"weeks"}),M:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.monthsLabel",{defaultMessage:"months"}),y:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.getInterval.yearsLabel",{defaultMessage:"years"})};var get_interval_convertIntervalIntoUnit=function convertIntervalIntoUnit(interval){var hasTranslateUnitString=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var units=Object.keys(unitLookup).reverse();var duration=external_kbnSharedDeps_Moment_default.a.duration(interval,"ms");for(var i=0;i<units.length;i++){var as=duration.as(units[i]);if(Math.abs(as)>1){return{unitValue:Math.round(Math.abs(as)),unitString:hasTranslateUnitString?unitLookup[units[i]]:units[i]}}}};var get_interval_isGteInterval=function isGteInterval(interval){return interval_regexp["a"].test(interval)};var isAutoInterval=function isAutoInterval(interval){return!interval||interval===AUTO_INTERVAL};var validateReInterval=function validateReInterval(intervalValue){var validationResult={};try{parseEsInterval(intervalValue)}catch(_ref){var message=_ref.message;validationResult.errorMessage=message}finally{validationResult.isValid=!validationResult.errorMessage}return validationResult};var get_interval_getInterval=function getInterval(visData,model){var series;if(model&&model.type==="table"){series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"series[0].series",[])}else{series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[])}return series.reduce((function(currentInterval,item){if(item.data.length>1){var seriesInterval=item.data[1][0]-item.data[0][0];if(!currentInterval||seriesInterval<currentInterval)return seriesInterval}return currentInterval}),0)};var panel_types=__webpack_require__(12);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MIN_CHART_HEIGHT=300;var vis_editor_visualization_VisEditorVisualizationUI=function(_Component){_inherits(VisEditorVisualizationUI,_Component);var _super=_createSuper(VisEditorVisualizationUI);function VisEditorVisualizationUI(props){var _this;_classCallCheck(this,VisEditorVisualizationUI);_this=_super.call(this,props);_defineProperty(_assertThisInitialized(_this),"handleMouseDown",(function(){window.addEventListener("mouseup",_this.handleMouseUp);_this.setState({dragging:true})}));_defineProperty(_assertThisInitialized(_this),"handleMouseUp",(function(){window.removeEventListener("mouseup",_this.handleMouseUp);_this.setState({dragging:false})}));_defineProperty(_assertThisInitialized(_this),"handleMouseMove",(function(event){if(_this.state.dragging){_this.setState((function(prevState){return{height:Math.max(MIN_CHART_HEIGHT,prevState.height+event.movementY)}}))}}));_defineProperty(_assertThisInitialized(_this),"onSizeHandleKeyDown",(function(ev){var key=ev.key;if(key===external_kbnSharedDeps_ElasticEui_["keys"].ARROW_UP||key===external_kbnSharedDeps_ElasticEui_["keys"].ARROW_DOWN){ev.preventDefault();_this.setState((function(prevState){var newHeight=prevState.height+(key===external_kbnSharedDeps_ElasticEui_["keys"].ARROW_UP?-15:15);return{height:Math.max(MIN_CHART_HEIGHT,newHeight)}}))}}));_this.state={height:MIN_CHART_HEIGHT,dragging:false,panelInterval:0};_this._visEl=external_kbnSharedDeps_React_default.a.createRef();_this._subscription=null;return _this}_createClass(VisEditorVisualizationUI,[{key:"_loadVisualization",value:function(){var _loadVisualization2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _this2=this;var _this$props,onDataChange,embeddableHandler;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(this._visEl.current){_context.next=2;break}return _context.abrupt("return");case 2:_this$props=this.props,onDataChange=_this$props.onDataChange,embeddableHandler=_this$props.embeddableHandler;this._handler=embeddableHandler;_context.next=6;return this._handler.render(this._visEl.current);case 6:this.props.eventEmitter.emit("embeddableRendered");this._subscription=this._handler.handler.data$.subscribe((function(data){_this2.setPanelInterval(data.value.visData);onDataChange(data.value)}));case 8:case"end":return _context.stop()}}}),_callee,this)})));function _loadVisualization(){return _loadVisualization2.apply(this,arguments)}return _loadVisualization}()},{key:"setPanelInterval",value:function setPanelInterval(visData){var panelInterval=get_interval_getInterval(visData,this.props.model);if(this.state.panelInterval!==panelInterval){this.setState({panelInterval:panelInterval})}}},{key:"hasShowPanelIntervalValue",value:function hasShowPanelIntervalValue(){var type=Object(external_kbnSharedDeps_Lodash_["get"])(this.props,"model.type","");var interval=Object(external_kbnSharedDeps_Lodash_["get"])(this.props,"model.interval",AUTO_INTERVAL);return[panel_types["a"].METRIC,panel_types["a"].TOP_N,panel_types["a"].GAUGE,panel_types["a"].MARKDOWN,panel_types["a"].TABLE].includes(type)&&(isAutoInterval(interval)||get_interval_isGteInterval(interval))}},{key:"getFormattedPanelInterval",value:function getFormattedPanelInterval(){var interval=get_interval_convertIntervalIntoUnit(this.state.panelInterval,false);return interval?"".concat(interval.unitValue).concat(interval.unitString):null}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.removeEventListener("mousemove",this.handleMouseMove);window.removeEventListener("mouseup",this.handleMouseUp);if(this._handler){this._handler.destroy()}if(this._subscription){this._subscription.unsubscribe()}}},{key:"componentDidMount",value:function componentDidMount(){window.addEventListener("mousemove",this.handleMouseMove);this._loadVisualization()}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this._handler){this._handler.updateInput({timeRange:this.props.timeRange,filters:this.props.filters||[],query:this.props.query})}}},{key:"render",value:function render(){var _this$props2=this.props,dirty=_this$props2.dirty,autoApply=_this$props2.autoApply,title=_this$props2.title,description=_this$props2.description,onToggleAutoApply=_this$props2.onToggleAutoApply,onCommit=_this$props2.onCommit;var style={height:this.state.height};if(this.state.dragging){style.userSelect="none"}var panelInterval=this.hasShowPanelIntervalValue()&&this.getFormattedPanelInterval();var applyMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesSuccessfullyAppliedMessage",defaultMessage:"The latest changes have been applied."});if(dirty){applyMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesHaveNotBeenAppliedMessage",defaultMessage:"The changes to this visualization have not been applied."})}if(autoApply){applyMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.changesWillBeAutomaticallyAppliedMessage",defaultMessage:"The changes will be automatically applied."})}var applyButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"tvbEditorVisualization__apply",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{id:"tsvbAutoApplyInput",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.autoApplyLabel",defaultMessage:"Auto apply"}),checked:autoApply,onChange:onToggleAutoApply})),panelInterval&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"default",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.panelInterval",defaultMessage:"Interval: {panelInterval}",values:{panelInterval:panelInterval}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:dirty?"default":"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,applyMessage))),!autoApply&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"play",fill:true,size:"s",onClick:onCommit,disabled:!dirty,"data-test-subj":"applyBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.visEditorVisualization.applyChangesLabel",defaultMessage:"Apply changes"}))));return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("div",{style:style,className:"tvbEditorVisualization","data-shared-items-container":true,"data-title":title,"data-description":description,ref:this._visEl}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},applyButton,external_kbnSharedDeps_React_default.a.createElement("button",{className:"tvbEditorVisualization__draghandle",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onKeyDown:this.onSizeHandleKeyDown,"aria-label":this.props.intl.formatMessage({id:"visTypeTimeseries.colorRules.adjustChartSizeAriaLabel",defaultMessage:"Press up/down to adjust the chart size"})},external_kbnSharedDeps_React_default.a.createElement("i",{className:"fa fa-ellipsis-h"}))))}}]);return VisEditorVisualizationUI}(external_kbnSharedDeps_React_["Component"]);var VisEditorVisualization=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(vis_editor_visualization_VisEditorVisualizationUI);var lib=__webpack_require__(54);var lib_default=__webpack_require__.n(lib);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(32);var handlebars=__webpack_require__(128);var handlebars_default=__webpack_require__.n(handlebars);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var durationBaseOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.millisecondsLabel",{defaultMessage:"Milliseconds"}),value:"ms"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.secondsLabel",{defaultMessage:"Seconds"}),value:"s"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.minutesLabel",{defaultMessage:"Minutes"}),value:"m"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.hoursLabel",{defaultMessage:"Hours"}),value:"h"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.daysLabel",{defaultMessage:"Days"}),value:"d"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.weeksLabel",{defaultMessage:"Weeks"}),value:"w"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.monthsLabel",{defaultMessage:"Months"}),value:"M"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.yearsLabel",{defaultMessage:"Years"}),value:"Y"}];var durationOutputOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.humanize",{defaultMessage:"Human readable"}),value:"humanize"}].concat(durationBaseOptions);var durationInputOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.picosecondsLabel",{defaultMessage:"Picoseconds"}),value:"ps"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.nanosecondsLabel",{defaultMessage:"Nanoseconds"}),value:"ns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.durationOptions.microsecondsLabel",{defaultMessage:"Microseconds"}),value:"us"}].concat(durationBaseOptions);var inputFormats={ps:"picoseconds",ns:"nanoseconds",us:"microseconds",ms:"milliseconds",s:"seconds",m:"minutes",h:"hours",d:"days",w:"weeks",M:"months",Y:"years"};var outputFormats={humanize:"humanize",ms:"asMilliseconds",s:"asSeconds",m:"asMinutes",h:"asHours",d:"asDays",w:"asWeeks",M:"asMonths",Y:"asYears"};var isDuration=function isDuration(format){var splittedFormat=format.split(",");var _splittedFormat=_slicedToArray(splittedFormat,2),input=_splittedFormat[0],output=_splittedFormat[1];return Boolean(inputFormats[input]&&outputFormats[output])&&splittedFormat.length===3};var services=__webpack_require__(0);function tick_formatter_slicedToArray(arr,i){return tick_formatter_arrayWithHoles(arr)||tick_formatter_iterableToArrayLimit(arr,i)||tick_formatter_unsupportedIterableToArray(arr,i)||tick_formatter_nonIterableRest()}function tick_formatter_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tick_formatter_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return tick_formatter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tick_formatter_arrayLikeToArray(o,minLen)}function tick_formatter_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function tick_formatter_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function tick_formatter_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var tick_formatter_createTickFormatter=function createTickFormatter(){var format=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"0,0.[00]";var template=arguments.length>1?arguments[1]:undefined;var getConfig=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var fieldFormats=Object(services["d"])();if(!template)template="{{value}}";var render=handlebars_default.a.compile(template,{knownHelpersOnly:true});var formatter;if(isDuration(format)){var _format$split=format.split(","),_format$split2=tick_formatter_slicedToArray(_format$split,3),from=_format$split2[0],to=_format$split2[1],decimals=_format$split2[2];var DurationFormat=fieldFormats.getType("duration");formatter=new DurationFormat({inputFormat:inputFormats[from],outputFormat:outputFormats[to],outputPrecision:decimals})}else{var FieldFormat=fieldFormats.getType(format);if(FieldFormat){formatter=new FieldFormat(null,getConfig)}else{FieldFormat=fieldFormats.getType("number");formatter=new FieldFormat({pattern:format},getConfig)}}return function(val){var value;if(!Object(external_kbnSharedDeps_Lodash_["isNumber"])(val)){value=val}else{try{value=formatter.convert(val,"text")}catch(e){value=val}}try{return render({value:value})}catch(e){return String(value)}}};var classnames=__webpack_require__(95);var classnames_default=__webpack_require__.n(classnames);var get_timezone=__webpack_require__(13);var external_kbnSharedDeps_Jquery_=__webpack_require__(36);var external_kbnSharedDeps_Jquery_default=__webpack_require__.n(external_kbnSharedDeps_Jquery_);var ACTIVE_CURSOR="ACTIVE_CURSOR";var eventBus=external_kbnSharedDeps_Jquery_default()({});var COLORS={LINE_COLOR:"rgba(105,112,125,0.2)",TEXT_COLOR:"rgba(0,0,0,0.4)",TEXT_COLOR_REVERSED:"rgba(255,255,255,0.5)",VALUE_COLOR:"rgba(0,0,0,0.7)",VALUE_COLOR_REVERSED:"rgba(255,255,255,0.8)"};var GRID_LINE_CONFIG={stroke:"rgba(125,125,125,0.1)"};var X_ACCESSOR_INDEX=0;var STACK_ACCESSORS=[0];var Y_ACCESSOR_INDEXES=[1];var Y0_ACCESSOR_INDEXES=[2];var STACKED_OPTIONS={NONE:"none",PERCENT:"percent",STACKED:"stacked",STACKED_WITHIN_SERIES:"stacked_within_series"};var bomb_icon_bombIcon=function bombIcon(){return external_kbnSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M3.92176768,4.53361616 L3.46466635,5.59664282 L2.65302767,4.14840719 L0.999875397,3.99598886 L2.12641918,2.77654518 L1.76052549,1.15720408 L3.26840652,1.85178207 L4.69542405,1.00339256 L4.500802,2.65210905 L5.74864103,3.7471166 L4.73514583,3.9490388 L5.61669633,5.03766301 C6.0459022,4.69009896 6.67559863,4.75628272 7.02316269,5.18548858 L7.15815921,5.3521954 C7.8837785,5.06498672 8.68754455,4.943927 9.51742529,5.03115098 C12.2637217,5.31979836 14.2560398,7.78010639 13.9673924,10.5264028 C13.6787451,13.2726992 11.218437,15.2650173 8.47214065,14.9763699 C5.72584427,14.6877226 3.73352611,12.2274145 4.02217349,9.48111814 C4.10939747,8.6512374 4.39492411,7.8902053 4.82672133,7.24015658 L4.6917248,7.07344975 C4.34416075,6.64424389 4.41034451,6.01454746 4.83955037,5.6669834 L3.92176768,4.53361616 Z M5.46887076,6.44412936 L6.12580983,7.24015658 C6.03489722,7.30663504 5.87952666,7.491071 5.65969815,7.79346445 C5.30650784,8.32517447 5.08508565,8.93495668 5.01669539,9.5856466 C4.78577748,11.7826837 6.37963201,13.7509301 8.57666912,13.981848 C10.7737062,14.2127659 12.7419526,12.6189114 12.9728706,10.4218743 C13.2037885,8.2248372 11.6099339,6.25659078 9.41289682,6.02567287 C8.7622069,5.95728261 8.11971364,6.04708534 7.52619036,6.28200886 C7.24048061,6.40187373 7.0242157,6.5121707 6.87739563,6.61289978 L6.24601673,5.81480897 L5.46887076,6.44412936 Z M3.34009664,3.61834468 C3.6160708,3.60870745 3.83197954,3.37717367 3.82234231,3.10119951 C3.81270508,2.82522536 3.5811713,2.60931662 3.30519715,2.61895385 C3.02922299,2.62859108 2.81331425,2.86012485 2.82295148,3.13609901 C2.83258871,3.41207317 3.06412249,3.62798191 3.34009664,3.61834468 Z M9.2038399,8.01471666 C8.92921026,7.98585193 8.72997844,7.73982112 8.75884318,7.46519148 C8.78770792,7.19056185 9.03373872,6.99133003 9.30836836,7.02019477 C10.7411945,7.17079087 11.8319627,8.30660625 11.9782919,9.68376241 C11.9842403,9.72621687 11.9855849,9.77015886 11.9808868,9.81485847 C11.9520221,10.0894881 11.7059913,10.2887199 11.4313616,10.2598552 C11.1835304,10.2338071 10.9971003,10.0309074 10.9842889,9.78973323 C10.8859009,8.87197536 10.1588372,8.11509093 9.2038399,8.01471666 Z"}))};var fire_icon_fireIcon=function fireIcon(){return external_kbnSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M10.4285489,13.2131862 C11.3850613,12.5116211 12,11.4062861 12,10.1681623 C12,8.88948911 11.7647926,7.64522527 11.315853,6.48027409 L10.7184365,8.07936372 L9.62838732,6.51595716 C8.65161637,5.11502026 7.41222171,3.90368767 5.9820674,2.94508952 C5.99399825,3.12925457 6,3.31436795 6,3.50022638 C6,5.08794888 5.48443413,6.95085436 4.74437685,7.94154468 C4.26219055,8.5870316 4,9.35779518 4,10.1681623 C4,11.4427639 4.65170744,12.5766371 5.65687647,13.2741368 C5.73557697,13.041105 5.84196228,12.8229717 5.97161458,12.624616 C6.26836682,12.1706132 6.5,11.2280234 6.5,10.4287008 C6.5,9.92871906 6.42479348,9.44813694 6.28619258,9 C7.47628141,9.64169048 8.4897566,10.6210605 9.22434324,11.8251557 C9.23213615,11.8013168 9.2406884,11.7775998 9.25,11.7540048 C9.39656041,11.3826304 9.5,11.0805724 9.5,10.6495848 C9.5,10.6240812 9.49971537,10.5986511 9.49914944,10.5732981 C9.96875289,11.3529062 10.2928315,12.2486386 10.4285489,13.2131862 Z M10.4486865,5.94402249 C10.4642723,5.90230435 10.4813768,5.86079967 10.5,5.81950846 C10.7931208,5.16960326 11,4.64100165 11,3.88677339 C11,3.84214218 10.9994307,3.79763944 10.9982989,3.7532716 C12.2630338,5.59045545 13,7.7961396 13,10.1681623 C13,12.8367126 10.7614237,15 8,15 C5.23857625,15 3,12.8367126 3,10.1681623 C3,9.11340491 3.34972471,8.13758287 3.94322917,7.34307798 C4.53673363,6.54857309 5,4.8990409 5,3.50022638 C5,2.62525836 4.84958695,1.78423964 4.57238517,1 C6.95256283,2.12295834 8.97951321,3.83685594 10.4486865,5.94402249 Z"}))};var ICON_NAMES={ASTERISK:"fa-asterisk",BELL:"fa-bell",BOLT:"fa-bolt",BOMB:"fa-bomb",BUG:"fa-bug",COMMENT:"fa-comment",EXCLAMATION_CIRCLE:"fa-exclamation-circle",EXCLAMATION_TRIANGLE:"fa-exclamation-triangle",FIRE:"fa-fire",FLAG:"fa-flag",HEART:"fa-heart",MAP_MARKER:"fa-map-marker",MAP_PIN:"fa-map-pin",STAR:"fa-star",TAG:"fa-tag"};var ICON_TYPES_MAP={[ICON_NAMES.ASTERISK]:"asterisk",[ICON_NAMES.BELL]:"bell",[ICON_NAMES.BOLT]:"bolt",[ICON_NAMES.BOMB]:bomb_icon_bombIcon,[ICON_NAMES.BUG]:"bug",[ICON_NAMES.COMMENT]:"editorComment",[ICON_NAMES.EXCLAMATION_CIRCLE]:"alert",[ICON_NAMES.EXCLAMATION_TRIANGLE]:"alert",[ICON_NAMES.FIRE]:fire_icon_fireIcon,[ICON_NAMES.FLAG]:"flag",[ICON_NAMES.HEART]:"heart",[ICON_NAMES.MAP_MARKER]:"mapMarker",[ICON_NAMES.MAP_PIN]:"pinFilled",[ICON_NAMES.STAR]:"starFilled",[ICON_NAMES.TAG]:"tag"};var DEFAULT_COLOR="#000";var series_styles_getAreaStyles=function getAreaStyles(_ref){var points=_ref.points,lines=_ref.lines,color=_ref.color;return{areaSeriesStyle:{line:{stroke:color,strokeWidth:Number(lines.lineWidth)||0,visible:Boolean(lines.show&&lines.lineWidth)},area:{fill:color,opacity:lines.fill<=0?0:lines.fill,visible:Boolean(lines.show)},point:{radius:points.radius||.5,stroke:color||DEFAULT_COLOR,strokeWidth:points.lineWidth||5,visible:points.lineWidth>0&&Boolean(points.show)}},curve:lines.steps?external_kbnSharedDeps_ElasticCharts_["CurveType"].CURVE_STEP:external_kbnSharedDeps_ElasticCharts_["CurveType"].LINEAR}};var getBarStyles=function getBarStyles(_ref2,color){var _ref2$show=_ref2.show,show=_ref2$show===void 0?true:_ref2$show,_ref2$lineWidth=_ref2.lineWidth,lineWidth=_ref2$lineWidth===void 0?0:_ref2$lineWidth,_ref2$fill=_ref2.fill,fill=_ref2$fill===void 0?1:_ref2$fill;return{barSeriesStyle:{rectBorder:{stroke:color||DEFAULT_COLOR,strokeWidth:lineWidth,visible:show},rect:{fill:color||DEFAULT_COLOR,opacity:fill}}}};var prop_types=__webpack_require__(259);var prop_types_default=__webpack_require__.n(prop_types);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){charts_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function charts_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var Chart={seriesId:prop_types_default.a.string.isRequired,seriesGroupId:prop_types_default.a.string.isRequired,name:prop_types_default.a.string.isRequired,data:prop_types_default.a.arrayOf(prop_types_default.a.arrayOf(prop_types_default.a.number)).isRequired,hideInLegend:prop_types_default.a.bool.isRequired,color:prop_types_default.a.string.isRequired,stackMode:prop_types_default.a.oneOf(["percentage","wiggle","silhouette"]),stackAccessors:prop_types_default.a.arrayOf(prop_types_default.a.number),xScaleType:prop_types_default.a.string,yScaleType:prop_types_default.a.string,timeZone:prop_types_default.a.string.isRequired,enableHistogramMode:prop_types_default.a.bool.isRequired,useDefaultGroupDomain:prop_types_default.a.bool,sortIndex:prop_types_default.a.number};var BarChart=_objectSpread(_objectSpread({},Chart),{},{bars:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.boolean}).isRequired});var AreaChart=_objectSpread(_objectSpread({},Chart),{},{lines:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.bool,steps:prop_types_default.a.oneOfType([prop_types_default.a.number,prop_types_default.a.bool])}).isRequired,points:prop_types_default.a.shape({lineWidth:prop_types_default.a.number,radius:prop_types_default.a.number,show:prop_types_default.a.bool}).isRequired});var ChartsEntities={BarChart:BarChart,AreaChart:AreaChart};function area_decorator_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function area_decorator_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){area_decorator_ownKeys(Object(source),true).forEach((function(key){area_decorator_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{area_decorator_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function area_decorator_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function AreaSeriesDecorator(_ref){var seriesId=_ref.seriesId,seriesGroupId=_ref.seriesGroupId,name=_ref.name,data=_ref.data,hideInLegend=_ref.hideInLegend,lines=_ref.lines,color=_ref.color,stackAccessors=_ref.stackAccessors,stackMode=_ref.stackMode,points=_ref.points,xScaleType=_ref.xScaleType,yScaleType=_ref.yScaleType,timeZone=_ref.timeZone,enableHistogramMode=_ref.enableHistogramMode,useDefaultGroupDomain=_ref.useDefaultGroupDomain,sortIndex=_ref.sortIndex,y1AccessorFormat=_ref.y1AccessorFormat,y0AccessorFormat=_ref.y0AccessorFormat,tickFormat=_ref.tickFormat;var id=seriesId;var groupId=seriesGroupId;var areaSeriesStyle=series_styles_getAreaStyles({points:points,lines:lines,color:color});var seriesSettings=area_decorator_objectSpread({id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:X_ACCESSOR_INDEX,yAccessors:Y_ACCESSOR_INDEXES,y0Accessors:lines.mode==="band"?Y0_ACCESSOR_INDEXES:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,tickFormat:tickFormat},areaSeriesStyle);if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],seriesSettings)}AreaSeriesDecorator.defaultProps={yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time};function bar_decorator_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function bar_decorator_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){bar_decorator_ownKeys(Object(source),true).forEach((function(key){bar_decorator_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{bar_decorator_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function bar_decorator_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function BarSeriesDecorator(_ref){var seriesId=_ref.seriesId,seriesGroupId=_ref.seriesGroupId,name=_ref.name,data=_ref.data,hideInLegend=_ref.hideInLegend,bars=_ref.bars,color=_ref.color,stackAccessors=_ref.stackAccessors,stackMode=_ref.stackMode,xScaleType=_ref.xScaleType,yScaleType=_ref.yScaleType,timeZone=_ref.timeZone,enableHistogramMode=_ref.enableHistogramMode,useDefaultGroupDomain=_ref.useDefaultGroupDomain,sortIndex=_ref.sortIndex,y1AccessorFormat=_ref.y1AccessorFormat,y0AccessorFormat=_ref.y0AccessorFormat,tickFormat=_ref.tickFormat;var id=seriesId;var groupId=seriesGroupId;var barSeriesStyle=getBarStyles(bars,color);var seriesSettings=bar_decorator_objectSpread({id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:X_ACCESSOR_INDEX,yAccessors:Y_ACCESSOR_INDEXES,y0Accessors:bars.mode==="band"?Y0_ACCESSOR_INDEXES:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,tickFormat:tickFormat},barSeriesStyle);if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],seriesSettings)}BarSeriesDecorator.defaultProps={yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time};var stack_format_getStackAccessors=function getStackAccessors(stack){switch(stack){case STACKED_OPTIONS.STACKED:case STACKED_OPTIONS.STACKED_WITHIN_SERIES:case STACKED_OPTIONS.PERCENT:return STACK_ACCESSORS;default:return undefined}};var node_modules_color=__webpack_require__(129);var color_default=__webpack_require__.n(node_modules_color);function theme_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function theme_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){theme_ownKeys(Object(source),true).forEach((function(key){theme_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{theme_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function theme_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function computeRelativeLuminosity(rgb){return color_default()(rgb).luminosity()}function computeContrast(rgb1,rgb2){return color_default()(rgb1).contrast(color_default()(rgb2))}function getAAARelativeLum(bgColor,fgColor){var ratio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:7;var relLum1=computeRelativeLuminosity(bgColor);var relLum2=computeRelativeLuminosity(fgColor);if(relLum1>relLum2){return(relLum1+.05-ratio*.05)/ratio}else{return Math.min(ratio*(relLum1+.05)-.05,1)}}function getGrayFromRelLum(relLum){if(relLum<=.0031308){return relLum*12.92}else{return(1+.055)*Math.pow(relLum,1/2.4)-.055}}function getGrayRGBfromGray(gray){var g=Math.round(gray*255);return"rgb(".concat(g,",").concat(g,",").concat(g,")")}function getAAAGray(bgColor,fgColor){var ratio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:7;var relLum=getAAARelativeLum(bgColor,fgColor,ratio);var gray=getGrayFromRelLum(relLum);return getGrayRGBfromGray(gray)}function findBestContrastColor(bgColor,lightFgColor,darkFgColor){var ratio=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4.5;var lc=computeContrast(bgColor,lightFgColor);var dc=computeContrast(bgColor,darkFgColor);if(lc>=dc){if(lc>=ratio){return lightFgColor}return getAAAGray(bgColor,lightFgColor,ratio)}if(dc>=ratio){return darkFgColor}return getAAAGray(bgColor,darkFgColor,ratio)}function isValidColor(color){if(typeof color!=="string"){return false}if(color.length===0){return false}try{color_default()(color);return true}catch(_unused){return false}}function getBaseTheme(baseTheme,bgColor){if(!isValidColor(bgColor)){return baseTheme}var bgLuminosity=computeRelativeLuminosity(bgColor);var mainTheme=bgLuminosity<=.179?external_kbnSharedDeps_ElasticCharts_["DARK_THEME"]:external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"];var color=findBestContrastColor(bgColor,external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"].axes.axisTitle.fill,external_kbnSharedDeps_ElasticCharts_["DARK_THEME"].axes.axisTitle.fill);return theme_objectSpread(theme_objectSpread({},mainTheme),{},{axes:theme_objectSpread(theme_objectSpread({},mainTheme.axes),{},{axisTitle:theme_objectSpread(theme_objectSpread({},mainTheme.axes.axisTitle),{},{fill:color}),tickLabel:theme_objectSpread(theme_objectSpread({},mainTheme.axes.tickLabel),{},{fill:color}),axisLine:theme_objectSpread(theme_objectSpread({},mainTheme.axes.axisLine),{},{stroke:color}),tickLine:theme_objectSpread(theme_objectSpread({},mainTheme.axes.tickLine),{},{stroke:color})})})}function getChartClasses(bgColor){if(typeof bgColor!=="string"){return}var bgLuminosity=computeRelativeLuminosity(bgColor);return bgLuminosity<=.179?"tvbVisTimeSeriesDark":"tvbVisTimeSeriesLight"}function timeseries_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function timeseries_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){timeseries_ownKeys(Object(source),true).forEach((function(key){timeseries_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{timeseries_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function timeseries_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function timeseries_slicedToArray(arr,i){return timeseries_arrayWithHoles(arr)||timeseries_iterableToArrayLimit(arr,i)||timeseries_unsupportedIterableToArray(arr,i)||timeseries_nonIterableRest()}function timeseries_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function timeseries_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return timeseries_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return timeseries_arrayLikeToArray(o,minLen)}function timeseries_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function timeseries_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function timeseries_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var generateAnnotationData=function generateAnnotationData(values,formatter){return values.map((function(_ref){var key=_ref.key,docs=_ref.docs;return{dataValue:key,details:docs[0],header:formatter({value:key})}}))};var decorateFormatter=function decorateFormatter(formatter){return function(_ref2){var value=_ref2.value;return formatter(value)}};var timeseries_handleCursorUpdate=function handleCursorUpdate(cursor){eventBus.trigger(ACTIVE_CURSOR,cursor)};var timeseries_TimeSeries=function TimeSeries(_ref3){var backgroundColor=_ref3.backgroundColor,showGrid=_ref3.showGrid,legend=_ref3.legend,legendPosition=_ref3.legendPosition,tooltipMode=_ref3.tooltipMode,xAxisLabel=_ref3.xAxisLabel,series=_ref3.series,yAxis=_ref3.yAxis,onBrush=_ref3.onBrush,xAxisFormatter=_ref3.xAxisFormatter,annotations=_ref3.annotations;var chartRef=Object(external_kbnSharedDeps_React_["useRef"])();Object(external_kbnSharedDeps_React_["useEffect"])((function(){var updateCursor=function updateCursor(_,cursor){if(chartRef.current){chartRef.current.dispatchExternalPointerEvent(cursor)}};eventBus.on(ACTIVE_CURSOR,updateCursor);return function(){eventBus.off(ACTIVE_CURSOR,undefined,updateCursor)}}),[]);var tooltipFormatter=decorateFormatter(xAxisFormatter);var uiSettings=Object(services["g"])();var timeZone=Object(get_timezone["a"])(uiSettings);var hasBarChart=series.some((function(_ref4){var bars=_ref4.bars;return bars===null||bars===void 0?void 0:bars.show}));var classes=classnames_default()("tvbVisTimeSeries",getChartClasses(backgroundColor));var _getChartsSetup=Object(services["a"])(),colors=_getChartsSetup.colors,themeService=_getChartsSetup.theme;var baseTheme=getBaseTheme(themeService.useChartsBaseTheme(),backgroundColor);colors.mappedColors.mapKeys(series.filter((function(_ref5){var color=_ref5.color;return!color})).map((function(_ref6){var label=_ref6.label;return label})));var onBrushEndListener=function onBrushEndListener(_ref7){var x=_ref7.x;if(!x){return}var _x=timeseries_slicedToArray(x,2),min=_x[0],max=_x[1];onBrush(min,max)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],{ref:chartRef,renderer:"canvas",className:classes},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{showLegend:legend,showLegendExtra:true,legendPosition:legendPosition,onBrushEnd:onBrushEndListener,animateData:false,onPointerUpdate:timeseries_handleCursorUpdate,theme:[hasBarChart?{}:{crosshair:{band:{fill:"#F00"}}},{background:{color:backgroundColor}}],baseTheme:baseTheme,tooltip:{snap:true,type:tooltipMode==="show_focused"?external_kbnSharedDeps_ElasticCharts_["TooltipType"].Follow:external_kbnSharedDeps_ElasticCharts_["TooltipType"].VerticalCursor,headerFormatter:tooltipFormatter},externalPointerEvents:{tooltip:{visible:false}}}),annotations.map((function(_ref8){var id=_ref8.id,data=_ref8.data,icon=_ref8.icon,color=_ref8.color;var dataValues=generateAnnotationData(data,tooltipFormatter);var style={line:{stroke:color}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineAnnotation"],{key:id,id:id,domainType:external_kbnSharedDeps_ElasticCharts_["AnnotationDomainTypes"].XDomain,dataValues:dataValues,marker:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:ICON_TYPES_MAP[icon]||"asterisk"}),hideLinesTooltips:true,style:style})})),series.map((function(_ref9,sortIndex){var id=_ref9.id,label=_ref9.label,bars=_ref9.bars,lines=_ref9.lines,data=_ref9.data,hideInLegend=_ref9.hideInLegend,xScaleType=_ref9.xScaleType,yScaleType=_ref9.yScaleType,groupId=_ref9.groupId,color=_ref9.color,stack=_ref9.stack,points=_ref9.points,useDefaultGroupDomain=_ref9.useDefaultGroupDomain,y1AccessorFormat=_ref9.y1AccessorFormat,y0AccessorFormat=_ref9.y0AccessorFormat,tickFormat=_ref9.tickFormat;var stackAccessors=stack_format_getStackAccessors(stack);var isPercentage=stack===STACKED_OPTIONS.PERCENT;var isStacked=stack!==STACKED_OPTIONS.NONE;var key="".concat(id,"-").concat(label);var finalColor=color!==null&&color!==void 0?color:colors.mappedColors.mapping[label];if(bars===null||bars===void 0?void 0:bars.show){return external_kbnSharedDeps_React_default.a.createElement(BarSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:label.toString(),data:data,hideInLegend:hideInLegend,bars:bars,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_kbnSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}if(lines===null||lines===void 0?void 0:lines.show){return external_kbnSharedDeps_React_default.a.createElement(AreaSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:label.toString(),data:data,hideInLegend:hideInLegend,lines:lines,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_kbnSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,points:points,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,useDefaultGroupDomain:useDefaultGroupDomain,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}return null})),yAxis.map((function(_ref10){var id=_ref10.id,groupId=_ref10.groupId,position=_ref10.position,tickFormatter=_ref10.tickFormatter,domain=_ref10.domain,hide=_ref10.hide;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{key:groupId,groupId:groupId,id:id,position:position,domain:domain,hide:hide,gridLine:timeseries_objectSpread(timeseries_objectSpread({},GRID_LINE_CONFIG),{},{visible:showGrid}),tickFormat:tickFormatter})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"bottom",position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,title:xAxisLabel,tickFormat:xAxisFormatter,gridLine:timeseries_objectSpread(timeseries_objectSpread({},GRID_LINE_CONFIG),{},{visible:showGrid})}))};timeseries_TimeSeries.defaultProps={showGrid:true,legend:true,legendPosition:"right"};var kibanaReact_public_=__webpack_require__(33);function replaceVars(str){var args=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var vars=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{var template=handlebars_default.a.compile(str,{strict:true,knownHelpersOnly:true});var string=template(external_kbnSharedDeps_Lodash_default.a.assign({},vars,{args:args}));return string}catch(e){if(e.toString().indexOf("Parse error")!==-1){return str}else if(e.message.indexOf("not defined in")!==-1){var badVar=e.message.split(/"/)[1];e.error={caused_by:{reason:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+badVar+"}}"}}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else{e.error={caused_by:{reason:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}}}return e}}function getAxisLabelString(interval){if(!interval){return""}var convertedValue=get_interval_convertIntervalIntoUnit(interval);if(convertedValue){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.axisLabelOptions.axisLabel",{defaultMessage:"per {unitValue} {unitString}",values:{unitValue:convertedValue.unitValue,unitString:convertedValue.unitString}})}}function getFormat(interval){var rules=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];for(var i=rules.length-1;i>=0;i--){var rule=rules[i];if(!rule[0]||interval>=external_kbnSharedDeps_Moment_default.a.duration(rule[0])){return rule[1]}}}function createXaxisFormatter(interval,rules,dateFormat){return function(val){var _getFormat;return external_kbnSharedDeps_Moment_default()(val).format((_getFormat=getFormat(interval,rules))!==null&&_getFormat!==void 0?_getFormat:dateFormat)}}function vis_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function vis_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){vis_ownKeys(Object(source),true).forEach((function(key){vis_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{vis_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function vis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function vis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function vis_createClass(Constructor,protoProps,staticProps){if(protoProps)vis_defineProperties(Constructor.prototype,protoProps);if(staticProps)vis_defineProperties(Constructor,staticProps);return Constructor}function vis_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)vis_setPrototypeOf(subClass,superClass)}function vis_setPrototypeOf(o,p){vis_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return vis_setPrototypeOf(o,p)}function vis_createSuper(Derived){var hasNativeReflectConstruct=vis_isNativeReflectConstruct();return function _createSuperInternal(){var Super=vis_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=vis_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return vis_possibleConstructorReturn(this,result)}}function vis_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return vis_assertThisInitialized(self)}function vis_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function vis_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function vis_getPrototypeOf(o){vis_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return vis_getPrototypeOf(o)}function vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var vis_TimeseriesVisualization=function(_Component){vis_inherits(TimeseriesVisualization,_Component);var _super=vis_createSuper(TimeseriesVisualization);function TimeseriesVisualization(){var _this;vis_classCallCheck(this,TimeseriesVisualization);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));vis_defineProperty(vis_assertThisInitialized(_this),"xAxisFormatter",(function(interval){return function(val){var _this$props$visData=_this.props.visData,scaledDataFormat=_this$props$visData.scaledDataFormat,dateFormat=_this$props$visData.dateFormat;var formatter=createXaxisFormatter(interval,scaledDataFormat,dateFormat);return formatter(val)}}));vis_defineProperty(vis_assertThisInitialized(_this),"yAxisStackedByPercentFormatter",(function(val){var n=Number(val)*100;return"".concat((Number.isNaN(n)?0:n).toFixed(0),"%")}));vis_defineProperty(vis_assertThisInitialized(_this),"applyDocTo",(function(template){return function(doc){var vars=replaceVars(template,null,doc);if(vars instanceof Error){_this.showToastNotification=vars.error.caused_by;return template}return vars}}));vis_defineProperty(vis_assertThisInitialized(_this),"prepareAnnotations",(function(){var _this$props=_this.props,model=_this$props.model,visData=_this$props.visData;return Object(external_kbnSharedDeps_Lodash_["map"])(model.annotations,(function(_ref){var id=_ref.id,color=_ref.color,icon=_ref.icon,template=_ref.template;var annotationData=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".annotations.").concat(id),[]);var applyDocToTemplate=_this.applyDocTo(template);return{id:id,color:color,icon:icon,data:annotationData.map((function(_ref2){var docs=_ref2.docs,rest=_objectWithoutProperties(_ref2,["docs"]);return vis_objectSpread(vis_objectSpread({},rest),{},{docs:docs.map(applyDocToTemplate)})}))}}))}));return _this}vis_createClass(TimeseriesVisualization,[{key:"componentDidUpdate",value:function componentDidUpdate(){var toastNotifications=Object(services["b"])().notifications.toasts;if(this.showToastNotification&&this.notificationReason!==this.showToastNotification.reason){if(this.notification){toastNotifications.remove(this.notification)}this.notificationReason=this.showToastNotification.reason;this.notification=toastNotifications.addDanger({title:this.showToastNotification.title,text:external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["MarkdownSimple"],null,this.showToastNotification.reason)})}if(!this.showToastNotification&&this.notification){toastNotifications.remove(this.notification);this.notificationReason=null;this.notification=null}}},{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,model=_this$props2.model,visData=_this$props2.visData,onBrush=_this$props2.onBrush;var styles=lib_default()({default:{tvbVis:{borderColor:Object(external_kbnSharedDeps_Lodash_["get"])(model,"background_color")}}});var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);var interval=get_interval_getInterval(visData,model);var yAxisIdGenerator=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])("yaxis");var mainAxisGroupId=yAxisIdGenerator("main_group");var seriesModel=model.series.filter((function(s){return!s.hidden})).map((function(s){return Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(s)}));var mainAxisScaleType=TimeseriesVisualization.getAxisScaleType(model);var mainAxisDomain=TimeseriesVisualization.getYAxisDomain(model);var yAxis=[];var mainDomainAdded=false;var allSeriesHaveSameFormatters=seriesModel.every((function(seriesGroup){return seriesGroup.formatter===seriesModel[0].formatter}));this.showToastNotification=null;seriesModel.forEach((function(seriesGroup){var isStackedWithinSeries=seriesGroup.stacked===STACKED_OPTIONS.STACKED_WITHIN_SERIES;var hasSeparateAxis=Boolean(seriesGroup.separate_axis);var groupId=hasSeparateAxis||isStackedWithinSeries?seriesGroup.id:mainAxisGroupId;var domain=hasSeparateAxis?TimeseriesVisualization.getYAxisDomain(seriesGroup):undefined;var isCustomDomain=groupId!==mainAxisGroupId;var seriesGroupTickFormatter=TimeseriesVisualization.getTickFormatter(seriesGroup,_this2.props.getConfig);var yScaleType=hasSeparateAxis?TimeseriesVisualization.getAxisScaleType(seriesGroup):mainAxisScaleType;if(seriesGroup.stacked===STACKED_OPTIONS.PERCENT){seriesGroup.separate_axis=true;seriesGroup.axisFormatter="percent";seriesGroup.axis_min=seriesGroup.axis_min||0;seriesGroup.axis_max=seriesGroup.axis_max||1;seriesGroup.axis_position=model.axis_position}series.filter((function(r){return Object(external_kbnSharedDeps_Lodash_["startsWith"])(r.id,seriesGroup.id)})).forEach((function(seriesDataRow){seriesDataRow.tickFormat=seriesGroupTickFormatter;seriesDataRow.groupId=groupId;seriesDataRow.yScaleType=yScaleType;seriesDataRow.hideInLegend=Boolean(seriesGroup.hide_in_legend);seriesDataRow.useDefaultGroupDomain=!isCustomDomain}));if(isCustomDomain){TimeseriesVisualization.addYAxis(yAxis,{domain:domain,groupId:groupId,id:yAxisIdGenerator(seriesGroup.id),position:seriesGroup.axis_position,hide:isStackedWithinSeries,tickFormatter:seriesGroup.stacked===STACKED_OPTIONS.PERCENT?_this2.yAxisStackedByPercentFormatter:seriesGroupTickFormatter})}else if(!mainDomainAdded){TimeseriesVisualization.addYAxis(yAxis,{tickFormatter:allSeriesHaveSameFormatters?seriesGroupTickFormatter:function(val){return val},id:yAxisIdGenerator("main"),groupId:mainAxisGroupId,position:model.axis_position,domain:mainAxisDomain});mainDomainAdded=true}}));return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:styles.tvbVis},external_kbnSharedDeps_React_default.a.createElement(timeseries_TimeSeries,{series:series,yAxis:yAxis,onBrush:onBrush,backgroundColor:model.background_color,showGrid:Boolean(model.show_grid),legend:Boolean(model.show_legend),legendPosition:model.legend_position,tooltipMode:model.tooltip_mode,xAxisLabel:getAxisLabelString(interval),xAxisFormatter:this.xAxisFormatter(interval),annotations:this.prepareAnnotations()}))}}]);return TimeseriesVisualization}(external_kbnSharedDeps_React_["Component"]);vis_defineProperty(vis_TimeseriesVisualization,"getYAxisDomain",(function(model){var axisMin=Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_min","").toString();var axisMax=Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_max","").toString();var fit=model.series?model.series.filter((function(_ref3){var hidden=_ref3.hidden;return!hidden})).every((function(_ref4){var fill=_ref4.fill;return fill==="0"})):model.fill==="0";return{min:axisMin.length?Number(axisMin):undefined,max:axisMax.length?Number(axisMax):undefined,fit:fit}}));vis_defineProperty(vis_TimeseriesVisualization,"addYAxis",(function(yAxis,_ref5){var id=_ref5.id,groupId=_ref5.groupId,position=_ref5.position,tickFormatter=_ref5.tickFormatter,domain=_ref5.domain,hide=_ref5.hide;yAxis.push({id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide})}));vis_defineProperty(vis_TimeseriesVisualization,"getAxisScaleType",(function(model){return Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_scale")==="log"?external_kbnSharedDeps_ElasticCharts_["ScaleType"].Log:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear}));vis_defineProperty(vis_TimeseriesVisualization,"getTickFormatter",(function(model,getConfig){return tick_formatter_createTickFormatter(Object(external_kbnSharedDeps_Lodash_["get"])(model,"formatter"),Object(external_kbnSharedDeps_Lodash_["get"])(model,"value_template"),getConfig)}));function getDisplayName(Component){return Component.displayName||Component.name||"Component"}var lookup={count:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.countLabel",{defaultMessage:"Count"}),calculation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.calculationLabel",{defaultMessage:"Calculation"}),std_deviation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.deviationLabel",{defaultMessage:"Std. Deviation"}),variance:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.varianceLabel",{defaultMessage:"Variance"}),sum_of_squares:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.sumOfSqLabel",{defaultMessage:"Sum of Sq."}),avg:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.averageLabel",{defaultMessage:"Average"}),max:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.maxLabel",{defaultMessage:"Max"}),min:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.minLabel",{defaultMessage:"Min"}),sum:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.sumLabel",{defaultMessage:"Sum"}),percentile:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.percentileLabel",{defaultMessage:"Percentile"}),percentile_rank:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.percentileRankLabel",{defaultMessage:"Percentile Rank"}),cardinality:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.cardinalityLabel",{defaultMessage:"Cardinality"}),value_count:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.valueCountLabel",{defaultMessage:"Value Count"}),derivative:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.derivativeLabel",{defaultMessage:"Derivative"}),cumulative_sum:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.cumulativeSumLabel",{defaultMessage:"Cumulative Sum"}),moving_average:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.movingAverageLabel",{defaultMessage:"Moving Average"}),avg_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallAverageLabel",{defaultMessage:"Overall Average"}),min_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallMinLabel",{defaultMessage:"Overall Min"}),max_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallMaxLabel",{defaultMessage:"Overall Max"}),sum_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallSumLabel",{defaultMessage:"Overall Sum"}),variance_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallVarianceLabel",{defaultMessage:"Overall Variance"}),sum_of_squares_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallSumOfSqLabel",{defaultMessage:"Overall Sum of Sq."}),std_deviation_bucket:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.overallStdDeviationLabel",{defaultMessage:"Overall Std. Deviation"}),series_agg:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.seriesAggLabel",{defaultMessage:"Series Agg"}),math:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.mathLabel",{defaultMessage:"Math"}),serial_diff:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.serialDifferenceLabel",{defaultMessage:"Serial Difference"}),filter_ratio:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.filterRatioLabel",{defaultMessage:"Filter Ratio"}),positive_only:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.positiveOnlyLabel",{defaultMessage:"Positive Only"}),static:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.staticValueLabel",{defaultMessage:"Static Value"}),top_hit:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.topHitLabel",{defaultMessage:"Top Hit"}),positive_rate:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggLookup.positiveRateLabel",{defaultMessage:"Positive Rate"})};var pipeline=["calculation","derivative","cumulative_sum","moving_average","avg_bucket","min_bucket","max_bucket","sum_bucket","variance_bucket","sum_of_squares_bucket","std_deviation_bucket","series_agg","math","serial_diff","positive_only"];var byType={_all:lookup,pipeline:pipeline,basic:external_kbnSharedDeps_Lodash_default.a.omit(lookup,pipeline),metrics:external_kbnSharedDeps_Lodash_default.a.pick(lookup,["count","avg","min","max","sum","cardinality","value_count"])};function isBasicAgg(item){return external_kbnSharedDeps_Lodash_default.a.includes(Object.keys(byType.basic),item.type)}var paths=["cumulative_sum","derivative","moving_average","avg_bucket","sum_bucket","min_bucket","max_bucket","std_deviation_bucket","variance_bucket","sum_of_squares_bucket","serial_diff","positive_only"];function calculateLabel(metric,metrics){if(!metric){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.unknownLabel",{defaultMessage:"Unknown"})}if(metric.alias){return metric.alias}if(metric.type==="count"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.countLabel",{defaultMessage:"Count"})}if(metric.type==="calculation"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.bucketScriptsLabel",{defaultMessage:"Bucket Script"})}if(metric.type==="math"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.mathLabel",{defaultMessage:"Math"})}if(metric.type==="series_agg"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.seriesAggLabel",{defaultMessage:"Series Agg ({metricFunction})",values:{metricFunction:metric.function}})}if(metric.type==="filter_ratio"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.filterRatioLabel",{defaultMessage:"Filter Ratio"})}if(metric.type==="positive_rate"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.positiveRateLabel",{defaultMessage:"Positive Rate of {field}",values:{field:metric.field}})}if(metric.type==="static"){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.staticValueLabel",{defaultMessage:"Static Value of {metricValue}",values:{metricValue:metric.value}})}if(Object(external_kbnSharedDeps_Lodash_["includes"])(paths,metric.type)){var targetMetric=metrics.find((function(m){return Object(external_kbnSharedDeps_Lodash_["startsWith"])(metric.field,m.id)}));var targetLabel=calculateLabel(targetMetric,metrics);if(targetMetric&&targetMetric.type==="percentile"){var percentileValueMatch=/\[([0-9\.]+)\]$/;var matches=metric.field.match(percentileValueMatch);if(matches){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfTargetWithAdditionalLabel",{defaultMessage:"{lookupMetricType} of {targetLabel} ({additionalLabel})",values:{lookupMetricType:lookup[metric.type],targetLabel:targetLabel,additionalLabel:matches[1]}})}}return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfTargetLabel",{defaultMessage:"{lookupMetricType} of {targetLabel}",values:{lookupMetricType:lookup[metric.type],targetLabel:targetLabel}})}return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.calculateLabel.lookupMetricTypeOfMetricFieldRankLabel",{defaultMessage:"{lookupMetricType} of {metricField}",values:{lookupMetricType:lookup[metric.type],metricField:metric.field}})}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||vis_with_splits_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return vis_with_splits_arrayLikeToArray(arr)}function vis_with_splits_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function vis_with_splits_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){vis_with_splits_ownKeys(Object(source),true).forEach((function(key){vis_with_splits_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{vis_with_splits_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function vis_with_splits_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function vis_with_splits_slicedToArray(arr,i){return vis_with_splits_arrayWithHoles(arr)||vis_with_splits_iterableToArrayLimit(arr,i)||vis_with_splits_unsupportedIterableToArray(arr,i)||vis_with_splits_nonIterableRest()}function vis_with_splits_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vis_with_splits_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return vis_with_splits_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vis_with_splits_arrayLikeToArray(o,minLen)}function vis_with_splits_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function vis_with_splits_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function vis_with_splits_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function visWithSplits(WrappedComponent){function SplitVisComponent(props){var model=props.model,visData=props.visData;if(!model||!visData||!visData[model.id])return external_kbnSharedDeps_React_default.a.createElement(WrappedComponent,props);if(visData[model.id].series.every((function(s){return s.id.split(":").length===1}))){return external_kbnSharedDeps_React_default.a.createElement(WrappedComponent,props)}var splitsVisData=visData[model.id].series.reduce((function(acc,series){var _series$id$split=series.id.split(":"),_series$id$split2=vis_with_splits_slicedToArray(_series$id$split,2),seriesId=_series$id$split2[0],splitId=_series$id$split2[1];var seriesModel=model.series.find((function(s){return s.id===seriesId}));if(!seriesModel||!splitId)return acc;var metric=Object(external_kbnSharedDeps_Lodash_["last"])(seriesModel.metrics);var label=calculateLabel(metric,seriesModel.metrics);if(!acc[splitId]){acc[splitId]={series:[],label:series.label.toString()}}acc[splitId].series.push(vis_with_splits_objectSpread(vis_with_splits_objectSpread({},series),{},{id:seriesId,color:series.color||seriesModel.color,label:seriesModel.label||label}));return acc}),{});var nonSplitSeries=Object(external_kbnSharedDeps_Lodash_["first"])(visData[model.id].series.filter((function(series){var seriesModel=model.series.find((function(s){return s.id===series.id}));if(!seriesModel)return false;return["everything","filter"].includes(seriesModel.split_mode)})));var indexOfNonSplit=nonSplitSeries?Object(external_kbnSharedDeps_Lodash_["findIndex"])(model.series,(function(s){return s.id===nonSplitSeries.id})):null;var rows=Object.keys(splitsVisData).map((function(key){var splitData=splitsVisData[key];var series=splitData.series,label=splitData.label;var newSeries=indexOfNonSplit!=null&&indexOfNonSplit>0?[].concat(_toConsumableArray(series),[nonSplitSeries]):[nonSplitSeries].concat(_toConsumableArray(series));var newVisData={[model.id]:{id:model.id,series:newSeries||series}};return external_kbnSharedDeps_React_default.a.createElement("div",{key:key,className:"tvbSplitVis__split"},external_kbnSharedDeps_React_default.a.createElement(WrappedComponent,{model:model,visData:newVisData,onBrush:props.onBrush,additionalLabel:label,backgroundColor:props.backgroundColor,getConfig:props.getConfig}))}));return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSplitVis"},rows)}SplitVisComponent.displayName="SplitVisComponent(".concat(getDisplayName(WrappedComponent),")");return SplitVisComponent}var DEFAULT_VALUE=0;var extractValue=function extractValue(data){return data&&data[1]||null};var get_last_value_getLastValue=function getLastValue(data){var defaultValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_VALUE;if(!Object(external_kbnSharedDeps_Lodash_["isArray"])(data)){return data||defaultValue}return extractValue(Object(external_kbnSharedDeps_Lodash_["last"])(data))||defaultValue};var external_kbnSharedDeps_ReactDom_=__webpack_require__(7);function calcDimensions(el,scale){var newWidth=Math.floor(el.clientWidth*scale);var newHeight=Math.floor(el.clientHeight*scale);return[newWidth,newHeight]}function calculate_coordinates_slicedToArray(arr,i){return calculate_coordinates_arrayWithHoles(arr)||calculate_coordinates_iterableToArrayLimit(arr,i)||calculate_coordinates_unsupportedIterableToArray(arr,i)||calculate_coordinates_nonIterableRest()}function calculate_coordinates_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function calculate_coordinates_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return calculate_coordinates_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return calculate_coordinates_arrayLikeToArray(o,minLen)}function calculate_coordinates_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function calculate_coordinates_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function calculate_coordinates_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function calculateCoordinates(innerRef,resizeRef,state){var inner=Object(external_kbnSharedDeps_ReactDom_["findDOMNode"])(innerRef);var resize=Object(external_kbnSharedDeps_ReactDom_["findDOMNode"])(resizeRef);var scale=state.scale;if(resize.clientWidth-resize.clientHeight<0){scale=resize.clientWidth/inner.clientWidth}else{scale=resize.clientHeight/inner.clientHeight}var _calcDimensions=calcDimensions(inner,scale),_calcDimensions2=calculate_coordinates_slicedToArray(_calcDimensions,2),newWidth=_calcDimensions2[0],newHeight=_calcDimensions2[1];if(newWidth>resize.clientWidth){scale=resize.clientWidth/inner.clientWidth}if(newHeight>resize.clientHeight){scale=resize.clientHeight/inner.clientHeight}var _calcDimensions3=calcDimensions(inner,scale);var _calcDimensions4=calculate_coordinates_slicedToArray(_calcDimensions3,2);newWidth=_calcDimensions4[0];newHeight=_calcDimensions4[1];var translateX=(newWidth-inner.clientWidth)/2;var translateY=(newHeight-inner.clientHeight)/2;var top=Math.floor((resize.clientHeight-newHeight)/2);var left=Math.floor((resize.clientWidth-newWidth)/2);return{scale:scale,top:top,left:left,translateY:translateY,translateX:translateX}}function metric_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function metric_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function metric_createClass(Constructor,protoProps,staticProps){if(protoProps)metric_defineProperties(Constructor.prototype,protoProps);if(staticProps)metric_defineProperties(Constructor,staticProps);return Constructor}function metric_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)metric_setPrototypeOf(subClass,superClass)}function metric_setPrototypeOf(o,p){metric_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return metric_setPrototypeOf(o,p)}function metric_createSuper(Derived){var hasNativeReflectConstruct=metric_isNativeReflectConstruct();return function _createSuperInternal(){var Super=metric_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=metric_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return metric_possibleConstructorReturn(this,result)}}function metric_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return metric_assertThisInitialized(self)}function metric_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function metric_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function metric_getPrototypeOf(o){metric_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return metric_getPrototypeOf(o)}var metric_Metric=function(_Component){metric_inherits(Metric,_Component);var _super=metric_createSuper(Metric);function Metric(props){var _this;metric_classCallCheck(this,Metric);_this=_super.call(this,props);_this.state={scale:1,left:0,top:0,translateX:1,translateY:1};_this.handleResize=_this.handleResize.bind(metric_assertThisInitialized(_this));return _this}metric_createClass(Metric,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var _this2=this;var check=function check(){_this2.timeout=setTimeout((function(){var newState=calculateCoordinates(_this2.inner,_this2.resize,_this2.state);if(newState&&_this2.state&&!external_kbnSharedDeps_Lodash_default.a.isEqual(newState,_this2.state)){_this2.handleResize()}check()}),500)};check()}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.timeout)}},{key:"componentDidMount",value:function componentDidMount(){this.handleResize()}},{key:"handleResize",value:function handleResize(){var newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}},{key:"render",value:function render(){var _this3=this;var _this$props=this.props,metric=_this$props.metric,secondary=_this$props.secondary;var _this$state=this.state,scale=_this$state.scale,translateX=_this$state.translateX,translateY=_this$state.translateY;var primaryFormatter=metric&&(metric.tickFormatter||metric.formatter)||function(n){return n};var primaryValue=primaryFormatter(get_last_value_getLastValue(metric&&metric.data||0));var styles=lib_default()({default:{container:{},inner:{top:this.state.top||0,left:this.state.left||0,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")},primary_value:{},secondary_value:{}},reversed:{primary_value:{},secondary_value:{}}},this.props);if(this.props.backgroundColor)styles.container.backgroundColor=this.props.backgroundColor;if(metric&&metric.color)styles.primary_value.color=metric.color;var primaryLabel;if(metric&&metric.label){primaryLabel=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--primary"},metric.label)}var secondarySnippet;if(secondary){var secondaryFormatter=secondary.formatter||function(n){return n};var secondaryValue=secondaryFormatter(get_last_value_getLastValue(secondary.data));if(secondary.color)styles.secondary_value.color=secondary.color;var secondaryLabel;if(secondary.label){secondaryLabel=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--secondary"},secondary.label)}secondarySnippet=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__secondary"},secondaryLabel,external_kbnSharedDeps_React_default.a.createElement("div",{style:styles.secondary_value,className:"tvbVisMetric__value--secondary"},secondaryValue))}var additionalLabel;if(this.props.additionalLabel){additionalLabel=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__label--additional"},this.props.additionalLabel)}var className="tvbVisMetric";if(!styles.container.backgroundColor){className+=" tvbVisMetric--noBackground"}if(this.props.reversed){className+=" tvbVisMetric--reversed"}return external_kbnSharedDeps_React_default.a.createElement("div",{className:className,style:styles.container},external_kbnSharedDeps_React_default.a.createElement("div",{ref:function ref(el){return _this3.resize=el},className:"tvbVisMetric__resize"},external_kbnSharedDeps_React_default.a.createElement("div",{ref:function ref(el){return _this3.inner=el},className:"tvbVisMetric__inner",style:styles.inner},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisMetric__primary"},primaryLabel,external_kbnSharedDeps_React_default.a.createElement("div",{style:styles.primary_value,"data-test-subj":"tsvbMetricValue",className:"tvbVisMetric__value--primary"},primaryValue)),secondarySnippet,additionalLabel)))}}]);return Metric}(external_kbnSharedDeps_React_["Component"]);var set_is_reversed_isDarkTheme=function isDarkTheme(){return Object(services["g"])().get("theme:darkMode")};var set_is_reversed_isColorDark=function isColorDark(c){return color_default()(c).luminosity()<.45};var isThemeDark=function isThemeDark(currentTheme){var themeIsDark=currentTheme||set_is_reversed_isDarkTheme();if(typeof currentTheme==="string"){themeIsDark=set_is_reversed_isColorDark(currentTheme)}return themeIsDark};var isBackgroundDark=function isBackgroundDark(backgroundColor,currentTheme){var themeIsDark=isThemeDark(currentTheme);if(!backgroundColor||backgroundColor==="inherit"){return themeIsDark}return set_is_reversed_isColorDark(backgroundColor)};var isBackgroundInverted=function isBackgroundInverted(backgroundColor,currentTheme){var backgroundIsDark=isBackgroundDark(backgroundColor,currentTheme);var themeIsDark=isThemeDark(currentTheme);return backgroundIsDark!==themeIsDark};function getColors(props){var model=props.model,visData=props.visData;var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter((function(s){return!Object(external_kbnSharedDeps_Lodash_["isUndefined"])(s)}));var color;var background;if(model.background_color_rules){model.background_color_rules.forEach((function(rule){if(rule.operator&&rule.value!=null){var value=series[0]&&get_last_value_getLastValue(series[0].data)||0;if(external_kbnSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){background=rule.background_color;color=rule.color}}}))}return{color:color,background:background}}function MetricVisualization(props){var backgroundColor=props.backgroundColor,model=props.model,visData=props.visData;var colors=getColors(props);var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter((function(row){return row})).map((function(row,i){var seriesDef=model.series.find((function(s){return Object(external_kbnSharedDeps_Lodash_["includes"])(row.id,s.id)}));var newProps={};if(seriesDef){newProps.formatter=tick_formatter_createTickFormatter(seriesDef.formatter,seriesDef.value_template,props.getConfig)}if(i===0&&colors.color)newProps.color=colors.color;return Object(external_kbnSharedDeps_Lodash_["assign"])({},Object(external_kbnSharedDeps_Lodash_["pick"])(row,["label","data"]),newProps)}));var panelBackgroundColor=colors.background||backgroundColor;var style={backgroundColor:panelBackgroundColor};var params={metric:series[0],additionalLabel:props.additionalLabel,reversed:isBackgroundInverted(panelBackgroundColor)};if(series[1]){params.secondary=series[1]}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_kbnSharedDeps_React_default.a.createElement(metric_Metric,params))}var vis_metric=visWithSplits(MetricVisualization);function top_n_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function top_n_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){top_n_ownKeys(Object(source),true).forEach((function(key){top_n_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{top_n_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function top_n_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function top_n_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function top_n_createClass(Constructor,protoProps,staticProps){if(protoProps)top_n_defineProperties(Constructor.prototype,protoProps);if(staticProps)top_n_defineProperties(Constructor,staticProps);return Constructor}function top_n_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)top_n_setPrototypeOf(subClass,superClass)}function top_n_setPrototypeOf(o,p){top_n_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return top_n_setPrototypeOf(o,p)}function top_n_createSuper(Derived){var hasNativeReflectConstruct=top_n_isNativeReflectConstruct();return function _createSuperInternal(){var Super=top_n_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=top_n_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return top_n_possibleConstructorReturn(this,result)}}function top_n_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return top_n_assertThisInitialized(self)}function top_n_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function top_n_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function top_n_getPrototypeOf(o){top_n_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return top_n_getPrototypeOf(o)}function top_n_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var RENDER_MODES={POSITIVE:"positive",NEGATIVE:"negative",MIXED:"mixed"};var top_n_TopN=function(_Component){top_n_inherits(TopN,_Component);var _super=top_n_createSuper(TopN);function TopN(props){var _this;top_n_classCallCheck(this,TopN);_this=_super.call(this,props);_this.tableRef=external_kbnSharedDeps_React_default.a.createRef();_this.state={labelMaxWidth:150};return _this}top_n_createClass(TopN,[{key:"componentDidMount",value:function componentDidMount(){this.setState({labelMaxWidth:this.labelMaxWidth})}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState){if(prevState.labelMaxWidth!==this.labelMaxWidth){this.setState({labelMaxWidth:this.labelMaxWidth})}}},{key:"handleClick",value:function handleClick(item){var _this2=this;return function(){if(_this2.props.onClick){_this2.props.onClick(item)}}}},{key:"renderRow",value:function renderRow(_ref){var _this3=this;var min=_ref.min,max=_ref.max;return function(item){var renderMode=TopN.getRenderMode(min,max);var key="".concat(item.id||item.label);var lastValue=get_last_value_getLastValue(item.data);var formatter=item.tickFormatter||_this3.props.tickFormatter;var isPositiveValue=lastValue>=0;var intervalLength=TopN.calcDomain(renderMode,min,max);var width=100*(Math.abs(lastValue)/intervalLength)||0;var styles=lib_default()({default:{innerBar:top_n_objectSpread({},TopN.calcInnerBarStyles(renderMode,isPositiveValue)),innerBarValue:top_n_objectSpread({},TopN.calcInnerBarDivStyles(item,width,isPositiveValue)),label:{maxWidth:_this3.state.labelMaxWidth}},onClick:{row:{cursor:"pointer"}}},_this3.props);return external_kbnSharedDeps_React_default.a.createElement("tr",{key:key,onClick:_this3.handleClick(top_n_objectSpread({lastValue:lastValue},item)),style:styles.row},external_kbnSharedDeps_React_default.a.createElement("td",{title:item.label,className:"tvbVisTopN__label",style:styles.label},item.label),external_kbnSharedDeps_React_default.a.createElement("td",{width:"100%",className:"tvbVisTopN__bar"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisTopN__innerBar",style:styles.innerBar},external_kbnSharedDeps_React_default.a.createElement("div",{style:styles.innerBarValue}))),external_kbnSharedDeps_React_default.a.createElement("td",{className:"tvbVisTopN__value","data-test-subj":"tsvbTopNValue"},formatter(lastValue)))}}},{key:"render",value:function render(){if(!this.props.series)return null;var intervalSettings=this.props.series.reduce((function(acc,series,index){var value=get_last_value_getLastValue(series.data);return{min:!index||value<acc.min?value:acc.min,max:!index||value>acc.max?value:acc.max}}),{min:undefined,max:undefined});var rows=this.props.series.map(this.renderRow(intervalSettings));var className="tvbVisTopN";if(this.props.reversed){className+=" tvbVisTopN--reversed"}return external_kbnSharedDeps_React_default.a.createElement("div",{className:className},external_kbnSharedDeps_React_default.a.createElement("table",{className:"tvbVisTopN__table","data-test-subj":"tvbVisTopNTable",ref:this.tableRef},external_kbnSharedDeps_React_default.a.createElement("tbody",null,rows)))}},{key:"labelMaxWidth",get:function get(){return this.tableRef.current.offsetWidth*.35}}]);return TopN}(external_kbnSharedDeps_React_["Component"]);top_n_defineProperty(top_n_TopN,"getRenderMode",(function(min,max){if(min>=0){return RENDER_MODES.POSITIVE}else if(max<0){return RENDER_MODES.NEGATIVE}return RENDER_MODES.MIXED}));top_n_defineProperty(top_n_TopN,"calcInnerBarStyles",(function(renderMode,isPositive){if(renderMode===RENDER_MODES.MIXED){return{[isPositive?"marginLeft":"marginRight"]:"50%"}}return{}}));top_n_defineProperty(top_n_TopN,"calcInnerBarDivStyles",(function(item,width,isPositive){return{backgroundColor:item.color,width:width+"%",float:isPositive?"left":"right"}}));top_n_defineProperty(top_n_TopN,"calcDomain",(function(renderMode,min,max){if(renderMode===RENDER_MODES.MIXED){return Math.max(max,Math.abs(min))}else if(renderMode===RENDER_MODES.NEGATIVE){return Math.abs(min)}return max}));top_n_TopN.defaultProps={tickFormatter:function tickFormatter(n){return n},onClick:function onClick(i){return i},direction:"desc"};function top_n_vis_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function top_n_vis_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){top_n_vis_ownKeys(Object(source),true).forEach((function(key){top_n_vis_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{top_n_vis_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function top_n_vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var OPERATORS={gt:external_kbnSharedDeps_Lodash_["gt"],gte:external_kbnSharedDeps_Lodash_["gte"],lt:external_kbnSharedDeps_Lodash_["lt"],lte:external_kbnSharedDeps_Lodash_["lte"]};function sortByDirection(data,direction,fn){if(direction==="desc"){return Object(external_kbnSharedDeps_Lodash_["sortBy"])(data,fn).reverse()}return Object(external_kbnSharedDeps_Lodash_["sortBy"])(data,fn)}function sortSeries(visData,model){var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);return model.series.reduce((function(acc,item){var itemSeries=series.filter((function(s){var id=Object(external_kbnSharedDeps_Lodash_["first"])(s.id.split(/:/));return id===item.id}));var direction=item.terms_direction||"desc";if(item.terms_order_by==="_key")return acc.concat(itemSeries);return acc.concat(sortByDirection(itemSeries,direction,(function(s){return get_last_value_getLastValue(s.data)})))}),[])}function TopNVisualization(props){var backgroundColor=props.backgroundColor,model=props.model,visData=props.visData;var series=sortSeries(visData,model).map((function(item){var id=Object(external_kbnSharedDeps_Lodash_["first"])(item.id.split(/:/));var seriesConfig=model.series.find((function(s){return s.id===id}));if(seriesConfig){var tickFormatter=tick_formatter_createTickFormatter(seriesConfig.formatter,seriesConfig.value_template,props.getConfig);var value=get_last_value_getLastValue(item.data);var color=item.color||seriesConfig.color;if(model.bar_color_rules){model.bar_color_rules.forEach((function(rule){if(rule.operator&&rule.value!=null&&rule.bar_color){if(OPERATORS[rule.operator](value,rule.value)){color=rule.bar_color}}}))}return top_n_vis_objectSpread(top_n_vis_objectSpread({},item),{},{color:color,tickFormatter:tickFormatter})}return item}));var panelBackgroundColor=model.background_color||backgroundColor;var style={backgroundColor:panelBackgroundColor};var params={series:series,reversed:isBackgroundInverted(panelBackgroundColor)};if(model.drilldown_url){params.onClick=function(item){var url=replaceVars(model.drilldown_url,{},{key:item.label});Object(services["b"])().application.navigateToUrl(url)}}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_kbnSharedDeps_React_default.a.createElement(top_n_TopN,params))}var basicAggs=["count","avg","max","min","sum","std_deviation","variance","sum_of_squares","value_count","cardinality"];function isSortable(metric){return basicAggs.includes(metric.type)}var METRIC_TYPES={PERCENTILE:"percentile",PERCENTILE_RANK:"percentile_rank",TOP_HIT:"top_hit",COUNT:"count",DERIVATIVE:"derivative",STD_DEVIATION:"std_deviation",VARIANCE:"variance",SUM_OF_SQUARES:"sum_of_squares",CARDINALITY:"cardinality",VALUE_COUNT:"value_count",AVERAGE:"avg",SUM:"sum"};var EXTENDED_STATS_TYPES=[METRIC_TYPES.STD_DEVIATION,METRIC_TYPES.VARIANCE,METRIC_TYPES.SUM_OF_SQUARES];function table_vis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function table_vis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function table_vis_createClass(Constructor,protoProps,staticProps){if(protoProps)table_vis_defineProperties(Constructor.prototype,protoProps);if(staticProps)table_vis_defineProperties(Constructor,staticProps);return Constructor}function table_vis_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)table_vis_setPrototypeOf(subClass,superClass)}function table_vis_setPrototypeOf(o,p){table_vis_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return table_vis_setPrototypeOf(o,p)}function table_vis_createSuper(Derived){var hasNativeReflectConstruct=table_vis_isNativeReflectConstruct();return function _createSuperInternal(){var Super=table_vis_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=table_vis_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return table_vis_possibleConstructorReturn(this,result)}}function table_vis_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return table_vis_assertThisInitialized(self)}function table_vis_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function table_vis_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function table_vis_getPrototypeOf(o){table_vis_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return table_vis_getPrototypeOf(o)}function table_vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getColor(rules,colorKey,value){var color;if(rules){rules.forEach((function(rule){if(rule.operator&&rule.value!=null){if(external_kbnSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){color=rule[colorKey]}}}))}return color}var vis_TableVis=function(_Component){table_vis_inherits(TableVis,_Component);var _super=table_vis_createSuper(TableVis);function TableVis(props){var _this;table_vis_classCallCheck(this,TableVis);_this=_super.call(this,props);table_vis_defineProperty(table_vis_assertThisInitialized(_this),"renderRow",(function(row){var model=_this.props.model;var rowDisplay=model.pivot_type==="date"?_this.dateFormatter.convert(row.key):row.key;if(model.drilldown_url){var url=replaceVars(model.drilldown_url,{},{key:row.key});rowDisplay=external_kbnSharedDeps_React_default.a.createElement("a",{href:url},rowDisplay)}var columns=row.series.filter((function(item){return item})).map((function(item){var column=_this.visibleSeries.find((function(c){return c.id===item.id}));if(!column)return null;var formatter=tick_formatter_createTickFormatter(column.formatter,column.value_template,_this.props.getConfig);var value=formatter(item.last);var trend;if(column.trend_arrows){var trendIcon=item.slope>0?"sortUp":"sortDown";trend=external_kbnSharedDeps_React_default.a.createElement("span",null,"  ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:trendIcon,color:"subdued"}))}var style={color:getColor(column.color_rules,"text",item.last)};return external_kbnSharedDeps_React_default.a.createElement("td",{key:"".concat(row.key,"-").concat(item.id),"data-test-subj":"tvbTableVis__value",className:"eui-textRight",style:style},external_kbnSharedDeps_React_default.a.createElement("span",null,value),trend)}));return external_kbnSharedDeps_React_default.a.createElement("tr",{key:row.key},external_kbnSharedDeps_React_default.a.createElement("td",null,rowDisplay),columns)}));var fieldFormatsService=Object(services["d"])();var DateFormat=fieldFormatsService.getType(public_["fieldFormats"].FIELD_FORMAT_IDS.DATE);_this.dateFormatter=new DateFormat({},_this.props.getConfig);return _this}table_vis_createClass(TableVis,[{key:"renderHeader",value:function renderHeader(){var _this$props=this.props,model=_this$props.model,uiState=_this$props.uiState,onUiState=_this$props.onUiState;var stateKey="".concat(model.type,".sort");var sort=uiState.get(stateKey,{column:"_default_",order:"asc"});var calculateHeaderLabel=function calculateHeaderLabel(metric,item){var defaultLabel=item.label||calculateLabel(metric,item.metrics);switch(metric.type){case METRIC_TYPES.PERCENTILE:return"".concat(defaultLabel," (").concat(Object(external_kbnSharedDeps_Lodash_["last"])(metric.percentiles).value||0,")");case METRIC_TYPES.PERCENTILE_RANK:return"".concat(defaultLabel," (").concat(Object(external_kbnSharedDeps_Lodash_["last"])(metric.values)||0,")");default:return defaultLabel}};var columns=this.visibleSeries.map((function(item){var metric=Object(external_kbnSharedDeps_Lodash_["last"])(item.metrics);var label=calculateHeaderLabel(metric,item);var handleClick=function handleClick(){if(!isSortable(metric))return;var order;if(sort.column===item.id){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:item.id,order:order})};var sortComponent;if(isSortable(metric)){var _sortIcon;if(sort.column===item.id){_sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{_sortIcon="empty"}sortComponent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:_sortIcon})}var headerContent=external_kbnSharedDeps_React_default.a.createElement("span",null,label," ",sortComponent);if(!isSortable(metric)){headerContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.columnNotSortableTooltip",defaultMessage:"This column is not sortable"})},headerContent)}return external_kbnSharedDeps_React_default.a.createElement("th",{onClick:handleClick,key:item.id,scope:"col"},headerContent)}));var label=model.pivot_label||model.pivot_field||model.pivot_id;var sortIcon;if(sort.column==="_default_"){sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{sortIcon="empty"}var sortComponent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:sortIcon});var handleSortClick=function handleSortClick(){var order;if(sort.column==="_default_"){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:"_default_",order:order})};return external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement("th",{className:"eui-textLeft",scope:"col",onClick:handleSortClick},label," ",sortComponent),columns)}},{key:"render",value:function render(){var _this$props2=this.props,visData=_this$props2.visData,model=_this$props2.model;var header=this.renderHeader();var rows;if(Object(external_kbnSharedDeps_Lodash_["isArray"])(visData.series)&&visData.series.length){rows=visData.series.map(this.renderRow)}else{var message=model.pivot_id?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableMessage",defaultMessage:"No results available."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableWithDescriptionMessage",defaultMessage:"No results available. You must choose a group by field for this visualization."});rows=external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement("td",{colSpan:this.visibleSeries.length+1},message))}return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["RedirectAppLinks"],{application:Object(services["b"])().application,className:"tvbVis","data-test-subj":"tableView"},external_kbnSharedDeps_React_default.a.createElement("table",{className:"table"},external_kbnSharedDeps_React_default.a.createElement("thead",null,header),external_kbnSharedDeps_React_default.a.createElement("tbody",null,rows)))}},{key:"visibleSeries",get:function get(){return Object(external_kbnSharedDeps_Lodash_["get"])(this.props,"model.series",[]).filter((function(series){return!series.hidden}))}}]);return TableVis}(external_kbnSharedDeps_React_["Component"]);vis_TableVis.defaultProps={sort:{}};var get_value_by_getValueBy=function getValueBy(fn,data){if(external_kbnSharedDeps_Lodash_default.a.isNumber(data))return data;if(!Array.isArray(data))return 0;var values=data.map((function(v){return v[1]}));return external_kbnSharedDeps_Lodash_default.a[fn](values)};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function gauge_vis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function gauge_vis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function gauge_vis_createClass(Constructor,protoProps,staticProps){if(protoProps)gauge_vis_defineProperties(Constructor.prototype,protoProps);if(staticProps)gauge_vis_defineProperties(Constructor,staticProps);return Constructor}function gauge_vis_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)gauge_vis_setPrototypeOf(subClass,superClass)}function gauge_vis_setPrototypeOf(o,p){gauge_vis_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return gauge_vis_setPrototypeOf(o,p)}function gauge_vis_createSuper(Derived){var hasNativeReflectConstruct=gauge_vis_isNativeReflectConstruct();return function _createSuperInternal(){var Super=gauge_vis_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=gauge_vis_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return gauge_vis_possibleConstructorReturn(this,result)}}function gauge_vis_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return gauge_vis_assertThisInitialized(self)}function gauge_vis_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function gauge_vis_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function gauge_vis_getPrototypeOf(o){gauge_vis_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return gauge_vis_getPrototypeOf(o)}var gauge_vis_GaugeVis=function(_Component){gauge_vis_inherits(GaugeVis,_Component);var _super=gauge_vis_createSuper(GaugeVis);function GaugeVis(props){var _this;gauge_vis_classCallCheck(this,GaugeVis);_this=_super.call(this,props);_this.state={scale:1,top:0,left:0,translateX:1,translateY:1};_this.handleResize=_this.handleResize.bind(gauge_vis_assertThisInitialized(_this));return _this}gauge_vis_createClass(GaugeVis,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var _this2=this;var check=function check(){_this2.timeout=setTimeout((function(){var newState=calculateCoordinates(_this2.inner,_this2.resize,_this2.state);if(newState&&_this2.state&&!external_kbnSharedDeps_Lodash_default.a.isEqual(newState,_this2.state)){_this2.handleResize()}check()}),500)};check()}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.timeout)}},{key:"componentDidMount",value:function componentDidMount(){this.handleResize()}},{key:"handleResize",value:function handleResize(){var newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}},{key:"render",value:function render(){var _this3=this;var _this$props=this.props,type=_this$props.type,value=_this$props.value,max=_this$props.max,color=_this$props.color;var _this$state=this.state,scale=_this$state.scale,translateX=_this$state.translateX,translateY=_this$state.translateY;var size=2*Math.PI*50;var sliceSize=type==="half"?.6:1;var percent=value<max?value/max:1;var styles=lib_default()({default:{resize:{position:"relative",display:"flex",rowDirection:"column",flex:"1 0 auto",overflow:"hidden"},svg:{position:"absolute",top:this.state.top,left:this.state.left,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")},innerLine:{strokeWidth:this.props.innerLine},gaugeLine:{strokeWidth:this.props.gaugeLine}},half:{svg:{transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")}}},{half:type==="half"});var props={circle:{r:50,cx:60,cy:60,fill:"rgba(0,0,0,0)",stroke:color,strokeWidth:this.props.gaugeLine,strokeDasharray:"".concat(percent*sliceSize*size," ").concat(size),transform:"rotate(-90 60 60)"},circleBackground:{r:50,cx:60,cy:60,fill:"rgba(0,0,0,0)",stroke:COLORS.LINE_COLOR,strokeDasharray:"".concat(sliceSize*size," ").concat(size),strokeWidth:this.props.innerLine}};if(type==="half"){props.circle.transform="rotate(-197.8 60 60)";props.circleBackground.transform="rotate(162 60 60)"}if(this.props.innerColor){props.circleBackground.stroke=this.props.innerColor}var svg;if(type==="half"){svg=external_kbnSharedDeps_React_default.a.createElement("svg",{width:120.72,height:78.72},external_kbnSharedDeps_React_default.a.createElement("circle",_extends({},props.circleBackground,{style:styles.innerLine})),external_kbnSharedDeps_React_default.a.createElement("circle",_extends({},props.circle,{style:styles.gaugeLine})))}else{svg=external_kbnSharedDeps_React_default.a.createElement("svg",{width:120.72,height:120.72},external_kbnSharedDeps_React_default.a.createElement("circle",props.circleBackground),external_kbnSharedDeps_React_default.a.createElement("circle",props.circle))}return external_kbnSharedDeps_React_default.a.createElement("div",{ref:function ref(el){return _this3.resize=el},style:styles.resize},external_kbnSharedDeps_React_default.a.createElement("div",{style:styles.svg,ref:function ref(el){return _this3.inner=el}},svg))}}]);return GaugeVis}(external_kbnSharedDeps_React_["Component"]);gauge_vis_GaugeVis.defaultProps={innerLine:2,gaugeLine:10};function gauge_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function gauge_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function gauge_createClass(Constructor,protoProps,staticProps){if(protoProps)gauge_defineProperties(Constructor.prototype,protoProps);if(staticProps)gauge_defineProperties(Constructor,staticProps);return Constructor}function gauge_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)gauge_setPrototypeOf(subClass,superClass)}function gauge_setPrototypeOf(o,p){gauge_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return gauge_setPrototypeOf(o,p)}function gauge_createSuper(Derived){var hasNativeReflectConstruct=gauge_isNativeReflectConstruct();return function _createSuperInternal(){var Super=gauge_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=gauge_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return gauge_possibleConstructorReturn(this,result)}}function gauge_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return gauge_assertThisInitialized(self)}function gauge_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function gauge_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function gauge_getPrototypeOf(o){gauge_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return gauge_getPrototypeOf(o)}var gauge_Gauge=function(_Component){gauge_inherits(Gauge,_Component);var _super=gauge_createSuper(Gauge);function Gauge(props){var _this;gauge_classCallCheck(this,Gauge);_this=_super.call(this,props);_this.state={scale:1,top:0,left:0,translateX:1,translateY:1};_this.handleResize=_this.handleResize.bind(gauge_assertThisInitialized(_this));return _this}gauge_createClass(Gauge,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var _this2=this;var check=function check(){_this2.timeout=setTimeout((function(){var newState=calculateCoordinates(_this2.inner,_this2.resize,_this2.state);if(newState&&_this2.state&&!external_kbnSharedDeps_Lodash_default.a.isEqual(newState,_this2.state)){_this2.handleResize()}check()}),500)};check()}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.timeout)}},{key:"componentDidMount",value:function componentDidMount(){this.handleResize()}},{key:"handleResize",value:function handleResize(){var newState=calculateCoordinates(this.inner,this.resize,this.state);this.setState(newState)}},{key:"render",value:function render(){var _this3=this;var _this$props=this.props,metric=_this$props.metric,type=_this$props.type;var _this$state=this.state,scale=_this$state.scale,translateX=_this$state.translateX,translateY=_this$state.translateY;var value=metric&&get_last_value_getLastValue(metric.data)||0;var max=metric&&get_value_by_getValueBy("max",metric.data)||1;var formatter=metric&&(metric.tickFormatter||metric.formatter)||this.props.tickFormatter||function(v){return v};var title=metric&&metric.label||"";var styles=lib_default()({default:{inner:{top:this.state.top||0,left:this.state.left||0,transform:"matrix(".concat(scale,", 0, 0, ").concat(scale,", ").concat(translateX,", ").concat(translateY,")")}},valueColor:{value:{color:this.props.valueColor}}},this.props);var gaugeProps={value:value,reversed:isBackgroundDark(this.props.backgroundColor),gaugeLine:this.props.gaugeLine,innerLine:this.props.innerLine,innerColor:this.props.innerColor,max:this.props.max||max,color:metric&&metric.color||"#8ac336",type:type};var metrics;var additionalLabel;if(this.props.additionalLabel){additionalLabel=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__additionalLabel"},this.props.additionalLabel)}if(type==="half"){metrics=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisHalfGauge__metrics",ref:function ref(el){return _this3.inner=el},style:styles.inner},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__label",ref:"title"},title),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__value",style:styles.value,ref:"label"},formatter(value)),additionalLabel)}else{metrics=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisCircleGauge__metrics",ref:function ref(el){return _this3.inner=el},style:styles.inner},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__value",style:styles.value,ref:"label"},formatter(value)),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVisGauge__label",ref:"title"},title),additionalLabel)}var classes=classnames_default()({tvbVisHalfGauge:type==="half",tvbVisCircleGauge:type==="circle","tvbVisGauge--reversed":isBackgroundInverted(this.props.backgroundColor)});return external_kbnSharedDeps_React_default.a.createElement("div",{className:classes},external_kbnSharedDeps_React_default.a.createElement("div",{ref:function ref(el){return _this3.resize=el},className:"tvbVisGauge__resize","data-test-subj":"tvbVisGaugeContainer"},metrics,external_kbnSharedDeps_React_default.a.createElement(gauge_vis_GaugeVis,gaugeProps)))}}]);return Gauge}(external_kbnSharedDeps_React_["Component"]);gauge_Gauge.defaultProps={type:"half",innerLine:2,gaugeLine:10};function vis_getColors(props){var model=props.model,visData=props.visData;var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter((function(s){return!Object(external_kbnSharedDeps_Lodash_["isUndefined"])(s)}));var text;var gauge;if(model.gauge_color_rules){model.gauge_color_rules.forEach((function(rule){if(rule.operator&&rule.value!=null){var value=series[0]&&get_last_value_getLastValue(series[0].data)||0;if(external_kbnSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){gauge=rule.gauge;text=rule.text}}}))}return{text:text,gauge:gauge}}function GaugeVisualization(props){var backgroundColor=props.backgroundColor,model=props.model,visData=props.visData;var colors=vis_getColors(props);var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]).filter((function(row){return row})).map((function(row,i){var seriesDef=model.series.find((function(s){return Object(external_kbnSharedDeps_Lodash_["includes"])(row.id,s.id)}));var newProps={};if(seriesDef){newProps.formatter=tick_formatter_createTickFormatter(seriesDef.formatter,seriesDef.value_template,props.getConfig)}if(i===0&&colors.gauge)newProps.color=colors.gauge;return Object(external_kbnSharedDeps_Lodash_["assign"])({},row,newProps)}));var panelBackgroundColor=model.background_color||backgroundColor;var style={backgroundColor:panelBackgroundColor};var params={metric:series[0],type:model.gauge_style||"half",additionalLabel:props.additionalLabel,backgroundColor:panelBackgroundColor};if(colors.text){params.valueColor=colors.text}if(model.gauge_width)params.gaugeLine=model.gauge_width;if(model.gauge_inner_color)params.innerColor=model.gauge_inner_color;if(model.gauge_inner_width)params.innerLine=model.gauge_inner_width;if(model.gauge_max!=null)params.max=model.gauge_max;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},external_kbnSharedDeps_React_default.a.createElement(gauge_Gauge,params))}var vis_gauge=visWithSplits(GaugeVisualization);var uuid=__webpack_require__(38);var uuid_default=__webpack_require__.n(uuid);var guidPattern=/\[[[a-f\d-\\]{36}\]/g;function ErrorComponent(props){var error=props.error;var additionalInfo;var type=external_kbnSharedDeps_Lodash_default.a.get(error,"error.caused_by.type")||external_kbnSharedDeps_Lodash_default.a.get(error,"error.type");var reason=external_kbnSharedDeps_Lodash_default.a.get(error,"error.caused_by.reason");var title=external_kbnSharedDeps_Lodash_default.a.get(error,"error.caused_by.title");if(!reason){reason=external_kbnSharedDeps_Lodash_default.a.get(error,"message")}if(["runtime_exception","illegal_argument_exception"].includes(type)){reason=external_kbnSharedDeps_Lodash_default.a.get(error,"error.reason").replace(guidPattern,"")}if(type==="script_exception"){var scriptStack=external_kbnSharedDeps_Lodash_default.a.get(error,"error.caused_by.script_stack");reason=external_kbnSharedDeps_Lodash_default.a.get(error,"error.caused_by.caused_by.reason");additionalInfo=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbError__additional"},external_kbnSharedDeps_React_default.a.createElement("div",null,reason),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbError__stack"},scriptStack.join("\n")))}else if(reason){additionalInfo=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbError__additional"},reason)}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"visError"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert",size:"m",color:"danger","aria-hidden":"true"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),title||external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.error.requestForPanelFailedErrorMessage",defaultMessage:"The request for this panel failed"}),additionalInfo))}var elastic_safer_lodash_set=__webpack_require__(271);var convert_series_to_vars_convertSeriesToVars=function convertSeriesToVars(series,model){var dateFormat=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"lll";var getConfig=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var variables={};model.series.forEach((function(seriesModel){series.filter((function(row){return external_kbnSharedDeps_Lodash_default.a.startsWith(row.id,seriesModel.id)})).forEach((function(row){var varName=[external_kbnSharedDeps_Lodash_default.a.snakeCase(row.label),external_kbnSharedDeps_Lodash_default.a.snakeCase(seriesModel.var_name)].filter((function(v){return v})).join(".");var formatter=tick_formatter_createTickFormatter(seriesModel.formatter,seriesModel.value_template,getConfig);var lastValue=get_last_value_getLastValue(row.data);var data={last:{raw:lastValue,formatted:formatter(lastValue)},data:{raw:row.data,formatted:row.data.map((function(point){return[external_kbnSharedDeps_Moment_default()(point[0]).format(dateFormat),formatter(point[1])]}))}};Object(elastic_safer_lodash_set["set"])(variables,varName,data);Object(elastic_safer_lodash_set["set"])(variables,"".concat(external_kbnSharedDeps_Lodash_default.a.snakeCase(row.label),".label"),row.label);if(row.labelFormatted){var momemntObj=external_kbnSharedDeps_Moment_default()(row.labelFormatted);var val;if(momemntObj.isValid()){val=momemntObj.format(dateFormat)}else{val=row.labelFormatted}Object(elastic_safer_lodash_set["set"])(variables,"".concat(external_kbnSharedDeps_Lodash_default.a.snakeCase(row.label),".formatted"),val)}}))}));return variables};function markdown_vis_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function markdown_vis_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){markdown_vis_ownKeys(Object(source),true).forEach((function(key){markdown_vis_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{markdown_vis_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function markdown_vis_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var getMarkdownId=function getMarkdownId(id){return"markdown-".concat(id)};function MarkdownVisualization(props){var backgroundColor=props.backgroundColor,model=props.model,visData=props.visData,dateFormat=props.dateFormat;var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(model.id,".series"),[]);var variables=convert_series_to_vars_convertSeriesToVars(series,model,dateFormat,props.getConfig);var markdownElementId=getMarkdownId(uuid_default.a.v1());var panelBackgroundColor=model.background_color||backgroundColor;var style={backgroundColor:panelBackgroundColor};var markdown;var markdownCss="";if(model.markdown){var markdownSource=replaceVars(model.markdown,{},markdown_vis_objectSpread({_all:variables},variables));if(model.markdown_css){markdownCss=model.markdown_css.replace(new RegExp(getMarkdownId(model.id),"g"),markdownElementId)}var markdownClasses=classnames_default()("kbnMarkdown__body",{"kbnMarkdown__body--reversed":isBackgroundInverted(panelBackgroundColor)});var contentClasses=classnames_default()("tvbMarkdown__content","tvbMarkdown__content--".concat(model.markdown_vertical_align),{"tvbMarkdown__content-isScrolling":model.markdown_scrollbars},markdownClasses);var markdownError=markdownSource instanceof Error?markdownSource:null;markdown=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdown","data-test-subj":"tsvbMarkdown"},markdownError&&external_kbnSharedDeps_React_default.a.createElement(ErrorComponent,{error:markdownError}),external_kbnSharedDeps_React_default.a.createElement("style",{type:"text/css"},markdownCss),external_kbnSharedDeps_React_default.a.createElement("div",{className:contentClasses},external_kbnSharedDeps_React_default.a.createElement("div",{id:markdownElementId},!markdownError&&external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["Markdown"],{markdown:markdownSource,openLinksInNewTab:model.markdown_openLinksInNewTab}))))}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis",style:style},markdown)}function NoDataComponent(){return external_kbnSharedDeps_React_default.a.createElement("div",{className:"visError","data-test-subj":"noTSVBDataMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"visualizeApp",size:"m",color:"subdued","aria-hidden":"true"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.noDataDescription",defaultMessage:"No data to display for the selected metrics"}))))}var types={timeseries:vis_TimeseriesVisualization,metric:vis_metric,top_n:TopNVisualization,table:vis_TableVis,gauge:vis_gauge,markdown:MarkdownVisualization};function Visualization(props){var visData=props.visData,model=props.model;var error=external_kbnSharedDeps_Lodash_default.a.get(visData,"".concat(model.id,".error"));if(error){return external_kbnSharedDeps_React_default.a.createElement("div",{className:props.className},external_kbnSharedDeps_React_default.a.createElement(ErrorComponent,{error:error}))}var path=visData.type==="table"?"series":"".concat(model.id,".series");var noData=external_kbnSharedDeps_Lodash_default.a.get(visData,path,[]).length===0;if(noData){return external_kbnSharedDeps_React_default.a.createElement("div",{className:props.className},external_kbnSharedDeps_React_default.a.createElement(NoDataComponent,null))}var component=types[model.type];if(component){return external_kbnSharedDeps_React_default.a.createElement(component,{dateFormat:props.dateFormat,backgroundColor:props.backgroundColor,model:props.model,onBrush:props.onBrush,onChange:props.onChange,onUiState:props.onUiState,uiState:props.uiState,visData:visData.type===model.type?visData:{},getConfig:props.getConfig})}return external_kbnSharedDeps_React_default.a.createElement("div",{className:props.className})}Visualization.defaultProps={className:"tvbVis"};function vis_picker_extends(){vis_picker_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return vis_picker_extends.apply(this,arguments)}function VisPickerItem(props){var label=props.label,type=props.type,selected=props.selected;var itemClassName="tvbVisPickerItem";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{className:itemClassName,isSelected:selected,onClick:function onClick(){return props.onClick(type)},"data-test-subj":"".concat(type,"TsvbTypeBtn")},label)}var VisPicker=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])((function(props){var handleChange=function handleChange(type){props.onChange({type:type})};var model=props.model,intl=props.intl;var tabs=[{type:panel_types["a"].TIMESERIES,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.timeSeriesLabel",defaultMessage:"Time Series"})},{type:panel_types["a"].METRIC,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.metricLabel",defaultMessage:"Metric"})},{type:panel_types["a"].TOP_N,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.topNLabel",defaultMessage:"Top N"})},{type:panel_types["a"].GAUGE,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.gaugeLabel",defaultMessage:"Gauge"})},{type:panel_types["a"].MARKDOWN,label:"Markdown"},{type:panel_types["a"].TABLE,label:intl.formatMessage({id:"visTypeTimeseries.visPicker.tableLabel",defaultMessage:"Table"})}].map((function(item){return external_kbnSharedDeps_React_default.a.createElement(VisPickerItem,vis_picker_extends({key:item.type,onClick:handleChange,selected:item.type===model.type},item))}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],null,tabs)}));var re_id_series_reIdSeries=function reIdSeries(source){var series=external_kbnSharedDeps_Lodash_default.a.cloneDeep(source);series.id=uuid_default.a.v1();series.metrics.forEach((function(metric){var id=uuid_default.a.v1();var metricId=metric.id;metric.id=id;if(series.terms_order_by===metricId)series.terms_order_by=id;series.metrics.filter((function(r){return r.field===metricId})).forEach((function(r){return r.field=id}));series.metrics.filter((function(r){return r.type==="calculation"&&r.variables.some((function(v){return v.field===metricId}))})).forEach((function(r){r.variables.filter((function(v){return v.field===metricId})).forEach((function(v){v.id=uuid_default.a.v1();v.field=id}))}))}));return series};function color_picker_slicedToArray(arr,i){return color_picker_arrayWithHoles(arr)||color_picker_iterableToArrayLimit(arr,i)||color_picker_unsupportedIterableToArray(arr,i)||color_picker_nonIterableRest()}function color_picker_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function color_picker_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return color_picker_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return color_picker_arrayLikeToArray(o,minLen)}function color_picker_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function color_picker_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function color_picker_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var COMMAS_NUMS_ONLY_RE=/[^0-9,]/g;function ColorPicker(_ref){var name=_ref.name,value=_ref.value,_ref$disableTrash=_ref.disableTrash,disableTrash=_ref$disableTrash===void 0?false:_ref$disableTrash,onChange=_ref.onChange;var initialColorValue=(value===null||value===void 0?void 0:value.includes("rgba"))?value.replace(COMMAS_NUMS_ONLY_RE,""):value;var _useState=Object(external_kbnSharedDeps_React_["useState"])(initialColorValue||""),_useState2=color_picker_slicedToArray(_useState,2),color=_useState2[0],setColor=_useState2[1];var handleColorChange=function handleColorChange(text,_ref2){var rgba=_ref2.rgba,hex=_ref2.hex;setColor(text);var part={};part[name]=hex?"rgba(".concat(rgba.join(","),")"):"";onChange(part)};var handleClear=function handleClear(){setColor("");var part={};part[name]=null;onChange(part)};var label=value?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.colorPicker.notAccessibleWithValueAriaLabel",{defaultMessage:"Color picker ({value}), not accessible",values:{value:value}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.colorPicker.notAccessibleAriaLabel",{defaultMessage:"Color picker, not accessible"});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbColorPicker","data-test-subj":"tvbColorPicker"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiColorPicker"],{onChange:handleColorChange,color:color,secondaryInputDisplay:"top",showAlpha:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiColorPickerSwatch"],{color:color,"aria-label":label})}),!disableTrash&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbColorPicker__clear",onClick:handleClear},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{size:"s",type:"cross",color:"danger",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.colorPicker.clearIconLabel",{defaultMessage:"Clear"})})))}function AddDeleteButtons(props){var testSubj=props.testSubj;var createDelete=function createDelete(){if(props.disableDelete){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:props.deleteTooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"DeleteBtn"),"aria-label":props.deleteTooltip,color:"danger",iconType:"trash",onClick:props.onDelete})))};var createAdd=function createAdd(){if(props.disableAdd){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:props.addTooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"AddBtn"),"aria-label":props.addTooltip,iconType:"plusInCircle",onClick:props.onAdd})))};var createClone=function createClone(){var cloneBtn=null;if(props.onClone&&!props.disableAdd){cloneBtn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:props.cloneTooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"CloneBtn"),"aria-label":props.cloneTooltip,iconType:"copy",onClick:props.onClone})))}return cloneBtn};var createActivatePanel=function createActivatePanel(){var activatePanelBtn=null;if(Object(external_kbnSharedDeps_Lodash_["isBoolean"])(props.isPanelActive)){var tooltip=props.isPanelActive?props.deactivatePanelTooltip:props.activatePanelTooltip;var iconType=props.isPanelActive?"eye":"eyeClosed";activatePanelBtn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:tooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"".concat(testSubj,"ActivatePanelBtn"),"aria-label":tooltip,iconType:iconType,onClick:props.togglePanelActivation})))}return activatePanelBtn};var deleteBtn=createDelete();var addBtn=createAdd();var cloneBtn=createClone();var activatePanelBtn=createActivatePanel();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:props.responsive,justifyContent:"flexEnd"},activatePanelBtn,cloneBtn,addBtn,deleteBtn)}AddDeleteButtons.defaultProps={testSubj:"Add",activeTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),addTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.addButtonDefaultTooltip",{defaultMessage:"Add"}),deleteTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.deleteButtonDefaultTooltip",{defaultMessage:"Delete"}),cloneTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.cloneButtonDefaultTooltip",{defaultMessage:"Clone"}),activatePanelTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.reEnableTooltip",{defaultMessage:"Re-enable"}),deactivatePanelTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.addDeleteButtons.temporarilyDisableTooltip",{defaultMessage:"Temporarily Disable"})};function series_drag_handler_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function series_drag_handler_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function series_drag_handler_createClass(Constructor,protoProps,staticProps){if(protoProps)series_drag_handler_defineProperties(Constructor.prototype,protoProps);if(staticProps)series_drag_handler_defineProperties(Constructor,staticProps);return Constructor}function series_drag_handler_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)series_drag_handler_setPrototypeOf(subClass,superClass)}function series_drag_handler_setPrototypeOf(o,p){series_drag_handler_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return series_drag_handler_setPrototypeOf(o,p)}function series_drag_handler_createSuper(Derived){var hasNativeReflectConstruct=series_drag_handler_isNativeReflectConstruct();return function _createSuperInternal(){var Super=series_drag_handler_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=series_drag_handler_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return series_drag_handler_possibleConstructorReturn(this,result)}}function series_drag_handler_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return series_drag_handler_assertThisInitialized(self)}function series_drag_handler_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function series_drag_handler_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function series_drag_handler_getPrototypeOf(o){series_drag_handler_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return series_drag_handler_getPrototypeOf(o)}function series_drag_handler_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var series_drag_handler_SeriesDragHandler=function(_PureComponent){series_drag_handler_inherits(SeriesDragHandler,_PureComponent);var _super=series_drag_handler_createSuper(SeriesDragHandler);function SeriesDragHandler(){series_drag_handler_classCallCheck(this,SeriesDragHandler);return _super.apply(this,arguments)}series_drag_handler_createClass(SeriesDragHandler,[{key:"render",value:function render(){var _this$props=this.props,dragHandleProps=_this$props.dragHandleProps,hideDragHandler=_this$props.hideDragHandler;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("div",dragHandleProps,!hideDragHandler&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.sort.dragToSortTooltip",{defaultMessage:"Drag to sort"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{className:"tvbSeries__sortHandle","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.sort.dragToSortAriaLabel",{defaultMessage:"Drag to sort"}),type:"grab"}))))}}]);return SeriesDragHandler}(external_kbnSharedDeps_React_["PureComponent"]);series_drag_handler_defineProperty(series_drag_handler_SeriesDragHandler,"defaultProps",{hideDragHandler:true});function AggRow(props){var iconType="eyeClosed";var iconColor="subdued";var lastSibling=Object(external_kbnSharedDeps_Lodash_["last"])(props.siblings);if(lastSibling.id===props.model.id){iconType="eye";iconColor="text"}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"aggRow",gutterSize:"s",alignItems:"flexStart",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{className:"tvbAggRow__visibilityIcon",type:iconType,color:iconColor})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggRow__children"},props.children),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{testSubj:"addMetric",addTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggRow.addMetricButtonTooltip",{defaultMessage:"Add Metric"}),deleteTooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggRow.deleteMetricButtonTooltip",{defaultMessage:"Delete Metric"}),onAdd:props.onAdd,onDelete:props.onDelete,disableDelete:props.disableDelete}))))}var RESTRICTIONS_KEYS;(function(RESTRICTIONS_KEYS){RESTRICTIONS_KEYS["WHITE_LISTED_GROUP_BY_FIELDS"]="whiteListedGroupByFields";RESTRICTIONS_KEYS["WHITE_LISTED_METRICS"]="whiteListedMetrics";RESTRICTIONS_KEYS["WHITE_LISTED_TIMERANGE_MODES"]="whiteListedTimerangeModes"})(RESTRICTIONS_KEYS||(RESTRICTIONS_KEYS={}));var DEFAULT_UI_RESTRICTION={"*":true};var limitOfSeries={[panel_types["a"].GAUGE]:1,[panel_types["a"].METRIC]:2};var check_ui_restrictions_checkUIRestrictions=function checkUIRestrictions(key){var restrictions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:DEFAULT_UI_RESTRICTION;var type=arguments.length>2?arguments[2]:undefined;var isAllEnabled=Object(external_kbnSharedDeps_Lodash_["get"])(restrictions,"".concat(type,".*"),true);return isAllEnabled||Boolean(Object(external_kbnSharedDeps_Lodash_["get"])(restrictions,type,{})[key])};var check_ui_restrictions_isMetricEnabled=function isMetricEnabled(key,restrictions){return check_ui_restrictions_checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.WHITE_LISTED_METRICS)};var check_ui_restrictions_isFieldEnabled=function isFieldEnabled(field,metricType){var restrictions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:DEFAULT_UI_RESTRICTION;if(check_ui_restrictions_isMetricEnabled(metricType,restrictions)){return check_ui_restrictions_checkUIRestrictions(field,restrictions[RESTRICTIONS_KEYS.WHITE_LISTED_METRICS],metricType)}return false};var check_ui_restrictions_isGroupByFieldsEnabled=function isGroupByFieldsEnabled(key,restrictions){return check_ui_restrictions_checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.WHITE_LISTED_GROUP_BY_FIELDS)};var check_ui_restrictions_isTimerangeModeEnabled=function isTimerangeModeEnabled(key,restrictions){return check_ui_restrictions_checkUIRestrictions(key,restrictions,RESTRICTIONS_KEYS.WHITE_LISTED_TIMERANGE_MODES)};function agg_select_extends(){agg_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return agg_select_extends.apply(this,arguments)}function agg_select_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agg_select_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agg_select_ownKeys(Object(source),true).forEach((function(key){agg_select_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agg_select_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agg_select_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function agg_select_objectWithoutProperties(source,excluded){if(source==null)return{};var target=agg_select_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function agg_select_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var metricAggs=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.averageLabel",{defaultMessage:"Average"}),value:"avg"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.cardinalityLabel",{defaultMessage:"Cardinality"}),value:"cardinality"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.countLabel",{defaultMessage:"Count"}),value:"count"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.filterRatioLabel",{defaultMessage:"Filter Ratio"}),value:"filter_ratio"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.positiveRateLabel",{defaultMessage:"Positive Rate"}),value:"positive_rate"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.minLabel",{defaultMessage:"Min"}),value:"min"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.percentileLabel",{defaultMessage:"Percentile"}),value:"percentile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.percentileRankLabel",{defaultMessage:"Percentile Rank"}),value:"percentile_rank"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.staticValueLabel",{defaultMessage:"Static Value"}),value:"static"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.stdDeviationLabel",{defaultMessage:"Std. Deviation"}),value:"std_deviation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.sumLabel",{defaultMessage:"Sum"}),value:"sum"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.sumOfSquaresLabel",{defaultMessage:"Sum of Squares"}),value:"sum_of_squares"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.topHitLabel",{defaultMessage:"Top Hit"}),value:"top_hit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.valueCountLabel",{defaultMessage:"Value Count"}),value:"value_count"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.metricsAggs.varianceLabel",{defaultMessage:"Variance"}),value:"variance"}];var pipelineAggs=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.bucketScriptLabel",{defaultMessage:"Bucket Script"}),value:"calculation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.cumulativeSumLabel",{defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.derivativeLabel",{defaultMessage:"Derivative"}),value:"derivative"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.movingAverageLabel",{defaultMessage:"Moving Average"}),value:"moving_average"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.positiveOnlyLabel",{defaultMessage:"Positive Only"}),value:"positive_only"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.pipelineAggs.serialDifferenceLabel",{defaultMessage:"Serial Difference"}),value:"serial_diff"}];var siblingAggs=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallAverageLabel",{defaultMessage:"Overall Average"}),value:"avg_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallMaxLabel",{defaultMessage:"Overall Max"}),value:"max_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallMinLabel",{defaultMessage:"Overall Min"}),value:"min_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallStdDeviationLabel",{defaultMessage:"Overall Std. Deviation"}),value:"std_deviation_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallSumLabel",{defaultMessage:"Overall Sum"}),value:"sum_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallSumOfSquaresLabel",{defaultMessage:"Overall Sum of Squares"}),value:"sum_of_squares_bucket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.siblingAggs.overallVarianceLabel",{defaultMessage:"Overall Variance"}),value:"variance_bucket"}];var specialAggs=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.specialAggs.seriesAggLabel",{defaultMessage:"Series Agg"}),value:"series_agg"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.specialAggs.mathLabel",{defaultMessage:"Math"}),value:"math"}];var FILTER_RATIO_AGGS=["avg","cardinality","count","positive_rate","max","min","sum","value_count"];var HISTOGRAM_AGGS=["avg","count","sum","value_count"];var allAggOptions=[].concat(metricAggs,pipelineAggs,siblingAggs,specialAggs);function filterByPanelType(panelType){return function(agg){if(panelType==="table")return agg.value!=="series_agg";return true}}function AggSelect(props){var siblings=props.siblings,panelType=props.panelType,value=props.value,onChange=props.onChange,uiRestrictions=props.uiRestrictions,rest=agg_select_objectWithoutProperties(props,["siblings","panelType","value","onChange","uiRestrictions"]);var selectedOptions=allAggOptions.filter((function(option){return value===option.value&&check_ui_restrictions_isMetricEnabled(option.value,uiRestrictions)}));var enablePipelines=siblings.some((function(s){return!!metricAggs.find((function(m){return m.value===s.type}))}));if(siblings.length<=1)enablePipelines=false;var options;if(panelType==="metrics"){options=metricAggs}else if(panelType==="filter_ratio"){options=metricAggs.filter((function(m){return FILTER_RATIO_AGGS.includes("".concat(m.value))}))}else if(panelType==="histogram"){options=metricAggs.filter((function(m){return HISTOGRAM_AGGS.includes("".concat(m.value))}))}else{var disableSiblingAggs=function disableSiblingAggs(agg){return agg_select_objectSpread(agg_select_objectSpread({},agg),{},{disabled:!enablePipelines||!check_ui_restrictions_isMetricEnabled(agg.value,uiRestrictions)})};options=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.metricAggLabel",{defaultMessage:"Metric Aggregations"}),options:metricAggs.map((function(agg){return agg_select_objectSpread(agg_select_objectSpread({},agg),{},{disabled:!check_ui_restrictions_isMetricEnabled(agg.value,uiRestrictions)})}))},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.parentPipelineAggLabel",{defaultMessage:"Parent Pipeline Aggregations"}),options:pipelineAggs.filter(filterByPanelType(panelType)).map(disableSiblingAggs)},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.siblingPipelineAggLabel",{defaultMessage:"Sibling Pipeline Aggregations"}),options:siblingAggs.map(disableSiblingAggs)},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.aggGroups.specialAggLabel",{defaultMessage:"Special Aggregations"}),options:specialAggs.map(disableSiblingAggs)}]}var handleChange=function handleChange(currentlySelectedOptions){if(!currentlySelectedOptions||currentlySelectedOptions.length<=0)return;onChange(currentlySelectedOptions)};return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"aggSelector"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],agg_select_extends({isClearable:false,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.aggSelect.selectAggPlaceholder",{defaultMessage:"Select aggregation"}),options:options,selectedOptions:selectedOptions,onChange:handleChange,singleSelection:{asPlainText:true}},rest)))}function getAncestors(siblings,item){var ancestors=item.id&&[item.id]||[];siblings.forEach((function(sib){if(external_kbnSharedDeps_Lodash_default.a.includes(ancestors,sib.field)){ancestors.push(sib.id)}}));return ancestors}var calculate_siblings_calculateSiblings=function calculateSiblings(siblings,model){var ancestors=getAncestors(siblings,model);return siblings.filter((function(row){return!external_kbnSharedDeps_Lodash_default.a.includes(ancestors,row.id)}))};var percentileNumberTest=/\d+\.\d+/;var toPercentileNumber=function toPercentileNumber(value){return percentileNumberTest.test("".concat(value))?value:"".concat(value,".0")};function metric_select_extends(){metric_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return metric_select_extends.apply(this,arguments)}function metric_select_toConsumableArray(arr){return metric_select_arrayWithoutHoles(arr)||metric_select_iterableToArray(arr)||metric_select_unsupportedIterableToArray(arr)||metric_select_nonIterableSpread()}function metric_select_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function metric_select_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return metric_select_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return metric_select_arrayLikeToArray(o,minLen)}function metric_select_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function metric_select_arrayWithoutHoles(arr){if(Array.isArray(arr))return metric_select_arrayLikeToArray(arr)}function metric_select_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function metric_select_objectWithoutProperties(source,excluded){if(source==null)return{};var target=metric_select_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function metric_select_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function createTypeFilter(restrict,exclude){return function(metric){if(Object(external_kbnSharedDeps_Lodash_["includes"])(exclude,metric.type))return false;switch(restrict){case"basic":return Object(external_kbnSharedDeps_Lodash_["includes"])(basicAggs,metric.type);default:return true}}}function filterRows(includeSiblings){return function(row){if(includeSiblings){return!/^series/.test(row.type)&&!/^percentile/.test(row.type)&&row.type!=="math"}return!/_bucket$/.test(row.type)&&!/^series/.test(row.type)&&!/^percentile/.test(row.type)&&row.type!=="math"}}function MetricSelectUi(props){var additionalOptions=props.additionalOptions,restrict=props.restrict,metric=props.metric,metrics=props.metrics,onChange=props.onChange,value=props.value,exclude=props.exclude,includeSiblings=props.includeSiblings,clearable=props.clearable,intl=props.intl,rest=metric_select_objectWithoutProperties(props,["additionalOptions","restrict","metric","metrics","onChange","value","exclude","includeSiblings","clearable","intl"]);var calculatedMetrics=metrics.filter(createTypeFilter(restrict,exclude));var siblings=calculate_siblings_calculateSiblings(calculatedMetrics,metric);var percentileOptions=siblings.filter((function(row){return/^percentile/.test(row.type)})).reduce((function(acc,row){var label=calculateLabel(row,calculatedMetrics);switch(row.type){case METRIC_TYPES.PERCENTILE_RANK:(row.values||[]).forEach((function(p){var value=toPercentileNumber(p);acc.push({value:"".concat(row.id,"[").concat(value,"]"),label:"".concat(label," (").concat(value,")")})}));case METRIC_TYPES.PERCENTILE:(row.percentiles||[]).forEach((function(p){if(p.value){var _value=toPercentileNumber(p.value);acc.push({value:"".concat(row.id,"[").concat(_value,"]"),label:"".concat(label," (").concat(_value,")")})}}))}return acc}),[]);var options=siblings.filter(filterRows(includeSiblings)).map((function(row){var label=calculateLabel(row,calculatedMetrics);return{value:row.id,label:label}}));var allOptions=[].concat(metric_select_toConsumableArray(options),metric_select_toConsumableArray(additionalOptions),metric_select_toConsumableArray(percentileOptions));var selectedOption=allOptions.find((function(option){return value===option.value}));var selectedOptions=selectedOption?[selectedOption]:[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],metric_select_extends({placeholder:intl.formatMessage({id:"visTypeTimeseries.metricSelect.selectMetricPlaceholder",defaultMessage:"Select metric…"}),options:allOptions,selectedOptions:selectedOptions,onChange:onChange,singleSelection:{asPlainText:true},isClearable:clearable},rest))}MetricSelectUi.defaultProps={additionalOptions:[],exclude:[],metric:{},restrict:"none",includeSiblings:false};var MetricSelect=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(MetricSelectUi);var create_change_handler_createChangeHandler=function createChangeHandler(handleChange,model){return function(part){var doc=external_kbnSharedDeps_Lodash_default.a.assign({},model,part);handleChange(doc)}};var create_select_handler_createSelectHandler=function createSelectHandler(handleChange){return function(name){return function(selectedOptions){return handleChange===null||handleChange===void 0?void 0:handleChange({[name]:external_kbnSharedDeps_Lodash_default.a.get(selectedOptions,"[0].value",null)})}}};function detectIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(msie>0){return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10)}var trident=ua.indexOf("Trident/");if(trident>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");if(edge>0){return parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)}return false}var create_number_handler_createNumberHandler=function createNumberHandler(handleChange){return function(name,defaultValue){return function(e){if(!detectIE()||e.keyCode===13)e.preventDefault();var value=Number(external_kbnSharedDeps_Lodash_default.a.get(e,"target.value",defaultValue));return handleChange===null||handleChange===void 0?void 0:handleChange({[name]:value})}}};var MODEL_TYPES={UNWEIGHTED:"simple",WEIGHTED_EXPONENTIAL:"ewma",WEIGHTED_EXPONENTIAL_DOUBLE:"holt",WEIGHTED_EXPONENTIAL_TRIPLE:"holt_winters",WEIGHTED_LINEAR:"linear"};function moving_average_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function moving_average_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){moving_average_ownKeys(Object(source),true).forEach((function(key){moving_average_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{moving_average_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function moving_average_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULTS={model_type:MODEL_TYPES.UNWEIGHTED,alpha:.3,beta:.1,gamma:.3,period:1,multiplicative:true,window:5};var moving_average_shouldShowHint=function shouldShowHint(_ref){var type=_ref.model_type,window=_ref.window,period=_ref.period;return type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE&&period*2>window};var moving_average_MovingAverageAgg=function MovingAverageAgg(props){var siblings=props.siblings;var model=moving_average_objectSpread(moving_average_objectSpread({},DEFAULTS),props.model);var modelOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.simpleLabel",{defaultMessage:"Simple"}),value:MODEL_TYPES.UNWEIGHTED},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.linearLabel",{defaultMessage:"Linear"}),value:MODEL_TYPES.WEIGHTED_LINEAR},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.exponentiallyWeightedLabel",{defaultMessage:"Exponentially Weighted"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.holtLinearLabel",{defaultMessage:"Holt-Linear"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelOptions.holtWintersLabel",{defaultMessage:"Holt-Winters"}),value:MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE}];var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleNumberChange=create_number_handler_createNumberHandler(handleChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var selectedModelOption=modelOptions.find((function(_ref2){var value=_ref2.value;return model.model_type===value}));var multiplicativeOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicativeOptions.true",{defaultMessage:"True"}),value:true},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicativeOptions.false",{defaultMessage:"False"}),value:false}];var selectedMultiplicative=multiplicativeOptions.find((function(_ref3){var value=_ref3.value;return model.multiplicative===value}));return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.aggregationLabel",{defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.metricLabel",{defaultMessage:"Metric"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("model_type"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.modelLabel",{defaultMessage:"Model"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.model.selectPlaceholder",{defaultMessage:"Select"}),options:modelOptions,selectedOptions:selectedModelOption?[selectedModelOption]:[],onChange:handleSelectChange("model_type"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("windowSize"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.windowSizeLabel",{defaultMessage:"Window Size"}),helpText:moving_average_shouldShowHint(model)&&external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.windowSizeHint",{defaultMessage:"Window must always be at least twice the size of your period"})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"text",onChange:handleNumberChange("window"),value:model.window})))),(model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("alpha"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.alpha",{defaultMessage:"Alpha"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("alpha"),value:model.alpha}))),(model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_DOUBLE||model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("beta"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.beta",{defaultMessage:"Beta"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("beta"),value:model.beta}))),model.model_type===MODEL_TYPES.WEIGHTED_EXPONENTIAL_TRIPLE&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gamma"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.gamma",{defaultMessage:"Gamma"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleNumberChange("gamma"),value:model.gamma}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("period"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.period",{defaultMessage:"Period"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:1,onChange:handleNumberChange("period"),value:model.period}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("multiplicative"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicative",{defaultMessage:"Multiplicative"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.movingAverage.multiplicative.selectPlaceholder",{defaultMessage:"Select"}),options:multiplicativeOptions,selectedOptions:selectedMultiplicative?[selectedMultiplicative]:[],onChange:handleSelectChange("multiplicative"),singleSelection:{asPlainText:true}})))))))};var create_text_handler_createTextHandler=function createTextHandler(handleChange){return function(name,defaultValue){return function(e){if(!detectIE()||e.keyCode===13)e.preventDefault();var value=external_kbnSharedDeps_Lodash_default.a.get(e,"target.value",defaultValue);return handleChange===null||handleChange===void 0?void 0:handleChange({[name]:value})}}};function derivative_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function derivative_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){derivative_ownKeys(Object(source),true).forEach((function(key){derivative_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{derivative_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function derivative_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var derivative_DerivativeAgg=function DerivativeAgg(props){var siblings=props.siblings;var defaults={unit:""};var model=derivative_objectSpread(derivative_objectSpread({},defaults),props.model);var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type"),fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.metricLabel",defaultMessage:"Metric"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("units"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.derivative.unitsLabel",defaultMessage:"Units (1s, 1m, etc)",description:"1s and 1m are required values and must not be translated."}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("unit"),value:model.unit,fullWidth:true})))))};function collection_actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function collection_actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){collection_actions_ownKeys(Object(source),true).forEach((function(key){collection_actions_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{collection_actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function collection_actions_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var collection_actions_newFn=function newFn(){return{id:uuid_default.a.v1()}};function collection_actions_handleChange(props,doc){var _props$onChange;var model=props.model,name=props.name;var collection=model[name]||[];var part={};part[name]=collection.map((function(row){if(row.id===doc.id)return doc;return row}));(_props$onChange=props.onChange)===null||_props$onChange===void 0?void 0:_props$onChange.call(props,collection_actions_objectSpread(collection_actions_objectSpread({},model),part))}function collection_actions_handleDelete(props,doc){var _props$onChange2;var model=props.model,name=props.name;var collection=model[name]||[];var part={};part[name]=collection.filter((function(row){return row.id!==doc.id}));(_props$onChange2=props.onChange)===null||_props$onChange2===void 0?void 0:_props$onChange2.call(props,collection_actions_objectSpread(collection_actions_objectSpread({},model),part))}function collection_actions_handleAdd(props){var _props$onChange3;var fn=arguments.length>1&&arguments[1]!==undefined?arguments[1]:collection_actions_newFn;var model=props.model,name=props.name;var collection=model[name]||[];var part={};part[name]=collection.concat([fn()]);(_props$onChange3=props.onChange)===null||_props$onChange3===void 0?void 0:_props$onChange3.call(props,collection_actions_objectSpread(collection_actions_objectSpread({},model),part))}var collectionActions={handleAdd:collection_actions_handleAdd,handleDelete:collection_actions_handleDelete,handleChange:collection_actions_handleChange};function vars_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function vars_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function vars_createClass(Constructor,protoProps,staticProps){if(protoProps)vars_defineProperties(Constructor.prototype,protoProps);if(staticProps)vars_defineProperties(Constructor,staticProps);return Constructor}function vars_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)vars_setPrototypeOf(subClass,superClass)}function vars_setPrototypeOf(o,p){vars_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return vars_setPrototypeOf(o,p)}function vars_createSuper(Derived){var hasNativeReflectConstruct=vars_isNativeReflectConstruct();return function _createSuperInternal(){var Super=vars_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=vars_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return vars_possibleConstructorReturn(this,result)}}function vars_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return vars_assertThisInitialized(self)}function vars_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function vars_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function vars_getPrototypeOf(o){vars_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return vars_getPrototypeOf(o)}function vars_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function vars_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){vars_ownKeys(Object(source),true).forEach((function(key){vars_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{vars_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function vars_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var vars_newVariable=function newVariable(opts){return vars_objectSpread({id:uuid_default.a.v1(),name:"",field:""},opts)};var vars_CalculationVars=function(_Component){vars_inherits(CalculationVars,_Component);var _super=vars_createSuper(CalculationVars);function CalculationVars(props){var _this;vars_classCallCheck(this,CalculationVars);_this=_super.call(this,props);_this.renderRow=_this.renderRow.bind(vars_assertThisInitialized(_this));return _this}vars_createClass(CalculationVars,[{key:"handleChange",value:function handleChange(item,name){var _this2=this;return function(e){var handleChange=collectionActions.handleChange.bind(null,_this2.props);var part={};part[name]=external_kbnSharedDeps_Lodash_default.a.get(e,"[0].value",external_kbnSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},item,part))}}},{key:"renderRow",value:function renderRow(row,i,items){var handleAdd=collectionActions.handleAdd.bind(null,this.props,vars_newVariable);var handleDelete=collectionActions.handleDelete.bind(null,this.props,row);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:row.id,"data-test-subj":"varRow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{className:"tvbAggs__varName","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.vars.variableNameAriaLabel",{defaultMessage:"Variable name"}),placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.vars.variableNamePlaceholder",{defaultMessage:"Variable name"}),onChange:this.handleChange(row,"name"),value:row.name})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggs__varMetricWrapper"},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:this.handleChange(row,"field"),metrics:this.props.metrics,metric:this.props.model,value:row.field,includeSiblings:this.props.includeSiblings})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false}))))}},{key:"render",value:function render(){var _this$props=this.props,model=_this$props.model,name=_this$props.name;if(!model[name])return external_kbnSharedDeps_React_default.a.createElement("div",null);var rows=model[name].map(this.renderRow);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},rows)}}]);return CalculationVars}(external_kbnSharedDeps_React_["Component"]);vars_CalculationVars.defaultProps={name:"variables",includeSiblings:false};var checkModel=function checkModel(model){return Array.isArray(model.variables)&&model.script!==undefined};function CalculationAgg(props){var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var siblings=props.siblings,model=props.model;var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(!checkModel(model)){handleChange({variables:[vars_newVariable()],script:""})}}),[handleChange,model]);return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("variables")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.variablesLabel",defaultMessage:"Variables"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(vars_CalculationVars,{id:htmlId("variables"),metrics:siblings,onChange:handleChange,name:"variables",model:model})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("painless"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.painlessScriptLabel",defaultMessage:"Painless Script"}),fullWidth:true,helpText:external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.calculation.painlessScriptDescription",defaultMessage:"Variables are keys on the {params} object, i.e. {paramsName}. To access the bucket interval (in milliseconds) use {paramsInterval}.",values:{params:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params"),paramsName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params.<name>"),paramsInterval:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._interval")}}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextArea"],{onChange:handleTextChange("script"),value:model.script,fullWidth:true})))))}function field_select_extends(){field_select_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return field_select_extends.apply(this,arguments)}function field_select_objectWithoutProperties(source,excluded){if(source==null)return{};var target=field_select_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function field_select_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var isFieldTypeEnabled=function isFieldTypeEnabled(fieldRestrictions,fieldType){return fieldRestrictions.length?fieldRestrictions.includes(fieldType):true};function FieldSelectUi(_ref){var type=_ref.type,fields=_ref.fields,indexPattern=_ref.indexPattern,value=_ref.value,onChange=_ref.onChange,disabled=_ref.disabled,restrict=_ref.restrict,placeholder=_ref.placeholder,uiRestrictions=_ref.uiRestrictions,rest=field_select_objectWithoutProperties(_ref,["type","fields","indexPattern","value","onChange","disabled","restrict","placeholder","uiRestrictions"]);if(type==="count"){return null}var selectedOptions=[];var options=Object.values((fields[indexPattern]||[]).reduce((function(acc,field){if(isFieldTypeEnabled(restrict,field.type)&&check_ui_restrictions_isFieldEnabled(field.name,type,uiRestrictions)){var item={label:field.name,value:field.name};if(acc[field.type]){acc[field.type].options.push(item)}else{acc[field.type]={options:[item],label:field.type}}if(value===item.value){selectedOptions.push(item)}}return acc}),{}));if(onChange&&value&&!selectedOptions.length){onChange()}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],field_select_extends({placeholder:placeholder,isDisabled:disabled,options:options,selectedOptions:selectedOptions,onChange:onChange,singleSelection:{asPlainText:true}},rest))}FieldSelectUi.defaultProps={indexPattern:"*",disabled:false,restrict:[],placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.fieldSelect.selectFieldPlaceholder",{defaultMessage:"Select field..."})};var FieldSelect=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(FieldSelectUi);function getSupportedFieldsByMetricType(type){switch(type){case METRIC_TYPES.CARDINALITY:return Object.values(public_["KBN_FIELD_TYPES"]).filter((function(t){return t!==public_["KBN_FIELD_TYPES"].HISTOGRAM}));case METRIC_TYPES.VALUE_COUNT:return Object.values(public_["KBN_FIELD_TYPES"]);case METRIC_TYPES.AVERAGE:case METRIC_TYPES.SUM:return[public_["KBN_FIELD_TYPES"].NUMBER,public_["KBN_FIELD_TYPES"].HISTOGRAM];default:return[public_["KBN_FIELD_TYPES"].NUMBER]}}function StandardAgg(props){var model=props.model,panel=props.panel,series=props.series,fields=props.fields,uiRestrictions=props.uiRestrictions;var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var restrictFields=getSupportedFieldsByMetricType(model.type);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdAgg.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,uiRestrictions:uiRestrictions,onChange:handleSelectChange("type"),fullWidth:true})),model.type!=="count"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdAgg.fieldLabel",defaultMessage:"Field"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:restrictFields,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field"),uiRestrictions:uiRestrictions,fullWidth:true}))):null))}function percentile_ui_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function percentile_ui_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){percentile_ui_ownKeys(Object(source),true).forEach((function(key){percentile_ui_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{percentile_ui_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function percentile_ui_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function percentile_ui_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function percentile_ui_createClass(Constructor,protoProps,staticProps){if(protoProps)percentile_ui_defineProperties(Constructor.prototype,protoProps);if(staticProps)percentile_ui_defineProperties(Constructor,staticProps);return Constructor}function percentile_ui_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)percentile_ui_setPrototypeOf(subClass,superClass)}function percentile_ui_setPrototypeOf(o,p){percentile_ui_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return percentile_ui_setPrototypeOf(o,p)}function percentile_ui_createSuper(Derived){var hasNativeReflectConstruct=percentile_ui_isNativeReflectConstruct();return function _createSuperInternal(){var Super=percentile_ui_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=percentile_ui_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return percentile_ui_possibleConstructorReturn(this,result)}}function percentile_ui_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return percentile_ui_assertThisInitialized(self)}function percentile_ui_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function percentile_ui_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function percentile_ui_getPrototypeOf(o){percentile_ui_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return percentile_ui_getPrototypeOf(o)}function percentile_ui_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var percentile_ui_newPercentile=function newPercentile(opts){return external_kbnSharedDeps_Lodash_default.a.assign({id:uuid_default.a.v1(),mode:"line",shade:.2},opts)};var percentile_ui_PercentilesUi=function(_Component){percentile_ui_inherits(PercentilesUi,_Component);var _super=percentile_ui_createSuper(PercentilesUi);function PercentilesUi(){var _this;percentile_ui_classCallCheck(this,PercentilesUi);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));percentile_ui_defineProperty(percentile_ui_assertThisInitialized(_this),"renderRow",(function(row,i,items){var defaults={value:"",percentile:"",shade:""};var model=percentile_ui_objectSpread(percentile_ui_objectSpread({},defaults),row);var _this$props=_this.props,intl=_this$props.intl,panel=_this$props.panel;var percentileFieldNumber=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{"aria-label":intl.formatMessage({id:"visTypeTimeseries.percentile.percentileAriaLabel",defaultMessage:"Percentile"}),placeholder:0,max:100,min:0,step:1,onChange:_this.handleTextChange(model,"value"),value:model.value===""?"":Number(model.value)}));if(panel.type==="table"){return percentileFieldNumber}var handleAdd=collectionActions.handleAdd.bind(null,_this.props,percentile_ui_newPercentile);var handleDelete=collectionActions.handleDelete.bind(null,_this.props,model);var modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.percentile.modeOptions.lineLabel",defaultMessage:"Line"}),value:"line"},{label:intl.formatMessage({id:"visTypeTimeseries.percentile.modeOptions.bandLabel",defaultMessage:"Band"}),value:"band"}];var optionsStyle={};if(model.mode==="line"){optionsStyle.display="none"}var labelStyle={marginBottom:0};var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);var selectedModeOption=modeOptions.find((function(option){return model.mode===option.value}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:model.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",responsive:false,gutterSize:"s"},percentileFieldNumber,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("mode")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.modeLabel",defaultMessage:"Mode:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("mode"),options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:_this.handleTextChange(model,"mode"),singleSelection:{asPlainText:true}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("fillTo")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.fillToLabel",defaultMessage:"Fill to:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{id:htmlId("fillTo"),min:0,max:100,step:1,onChange:_this.handleTextChange(model,"percentile"),value:Number(model.percentile)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("shade")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.shadeLabel",defaultMessage:"Shade (0 to 1):"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{style:optionsStyle,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{id:htmlId("shade"),style:optionsStyle,step:.1,onChange:_this.handleTextChange(model,"shade"),value:Number(model.shade)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false}))))}));return _this}percentile_ui_createClass(PercentilesUi,[{key:"handleTextChange",value:function handleTextChange(item,name){var _this2=this;return function(e){var handleChange=collectionActions.handleChange.bind(null,_this2.props);var part={};part[name]=external_kbnSharedDeps_Lodash_default.a.get(e,"[0].value",external_kbnSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},item,part))}}},{key:"render",value:function render(){var _this$props2=this.props,model=_this$props2.model,name=_this$props2.name,panel=_this$props2.panel;if(!model[name])return external_kbnSharedDeps_React_default.a.createElement("div",null);var rows;if(panel.type==="table"){rows=this.renderRow(external_kbnSharedDeps_Lodash_default.a.last(model[name]))}else{rows=model[name].map(this.renderRow)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},rows)}}]);return PercentilesUi}(external_kbnSharedDeps_React_["Component"]);percentile_ui_PercentilesUi.defaultProps={name:"percentile"};var Percentiles=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(percentile_ui_PercentilesUi);var RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].NUMBER,public_["KBN_FIELD_TYPES"].HISTOGRAM];var percentile_checkModel=function checkModel(model){return Array.isArray(model.percentiles)};function PercentileAgg(props){var series=props.series,model=props.model,panel=props.panel,fields=props.fields;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(!percentile_checkModel(model)){handleChange({percentiles:[percentile_ui_newPercentile({value:50})]})}}),[handleChange,model]);return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentile.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(Percentiles,{onChange:handleChange,name:"percentiles",model:model,panel:panel}))}function CumulativeSumAgg(props){var model=props.model,siblings=props.siblings;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.cumulativeSum.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.cumulativeSum.metricLabel",defaultMessage:"Metric"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))))}function std_deviation_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function std_deviation_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){std_deviation_ownKeys(Object(source),true).forEach((function(key){std_deviation_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{std_deviation_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function std_deviation_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var std_deviation_RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].NUMBER];var std_deviation_StandardDeviationAggUi=function StandardDeviationAggUi(props){var series=props.series,panel=props.panel,fields=props.fields,intl=props.intl;var defaults={sigma:""};var model=std_deviation_objectSpread(std_deviation_objectSpread({},defaults),props.model);var modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"}];if(panel.type!=="table"){modeOptions.push({label:intl.formatMessage({id:"visTypeTimeseries.stdDeviation.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"})}var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var selectedModeOption=modeOptions.find((function(option){return model.mode===option.value}));return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:std_deviation_RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("sigma"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.sigmaLabel",defaultMessage:"Sigma"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:model.sigma,onChange:handleTextChange("sigma")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("mode"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdDeviation.modeLabel",defaultMessage:"Mode"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:handleSelectChange("mode"),singleSelection:{asPlainText:true}})))))};var StandardDeviationAgg=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(std_deviation_StandardDeviationAggUi);function std_sibling_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function std_sibling_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){std_sibling_ownKeys(Object(source),true).forEach((function(key){std_sibling_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{std_sibling_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function std_sibling_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var std_sibling_StandardSiblingAggUi=function StandardSiblingAggUi(props){var siblings=props.siblings,intl=props.intl;var defaults={sigma:""};var model=std_sibling_objectSpread(std_sibling_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);var stdDev={};if(model.type==="std_deviation_bucket"){stdDev.sigma=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("sigma"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.sigmaLabel",defaultMessage:"Sigma"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:model.sigma,onChange:handleTextChange("sigma")})));var modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.rawLabel",defaultMessage:"Raw"}),value:"raw"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.upperBoundLabel",defaultMessage:"Upper Bound"}),value:"upper"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.lowerBoundLabel",defaultMessage:"Lower Bound"}),value:"lower"},{label:intl.formatMessage({id:"visTypeTimeseries.stdSibling.modeOptions.boundsBandLabel",defaultMessage:"Bounds Band"}),value:"band"}];var selectedModeOption=modeOptions.find((function(option){return model.mode===option.value}));stdDev.mode=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("mode"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.modeLabel",defaultMessage:"Mode"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:modeOptions,selectedOptions:selectedModeOption?[selectedModeOption]:[],onChange:handleSelectChange("mode"),singleSelection:{asPlainText:true}})))}return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,uiRestrictions:props.uiRestrictions,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.stdSibling.metricLabel",defaultMessage:"Metric"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),exclude:["percentile"],metrics:siblings,metric:model,value:model.field}))),stdDev.sigma,stdDev.mode))};var StandardSiblingAgg=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(std_sibling_StandardSiblingAggUi);function SeriesAggUi(props){var panel=props.panel,model=props.model,intl=props.intl;var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var functionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.sumLabel",defaultMessage:"Sum"}),value:"sum"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.maxLabel",defaultMessage:"Max"}),value:"max"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.minLabel",defaultMessage:"Min"}),value:"min"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.avgLabel",defaultMessage:"Avg"}),value:"mean"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallSumLabel",defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMaxLabel",defaultMessage:"Overall Max"}),value:"overall_max"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallMinLabel",defaultMessage:"Overall Min"}),value:"overall_min"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.overallAvgLabel",defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:intl.formatMessage({id:"visTypeTimeseries.seriesAgg.functionOptions.cumulativeSumLabel",defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}];var selectedFunctionOption=functionOptions.find((function(option){return model.function===option.value}));if(panel.type==="table"){return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.seriesAggIsNotCompatibleLabel",defaultMessage:"Series Agg is not compatible with the table visualization."}))))}return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("function"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesAgg.functionLabel",defaultMessage:"Function"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:functionOptions,selectedOptions:selectedFunctionOption?[selectedFunctionOption]:[],onChange:handleSelectChange("function"),singleSelection:{asPlainText:true}})))))}var SeriesAgg=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(SeriesAggUi);function serial_diff_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function serial_diff_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){serial_diff_ownKeys(Object(source),true).forEach((function(key){serial_diff_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{serial_diff_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function serial_diff_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var serial_diff_SerialDiffAgg=function SerialDiffAgg(props){var siblings=props.siblings;var defaults={lag:""};var model=serial_diff_objectSpread(serial_diff_objectSpread({},defaults),props.model);var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleNumberChange=create_number_handler_createNumberHandler(handleChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.metricLabel",defaultMessage:"Metric"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lag"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.serialDiff.lagLabel",defaultMessage:"Lag",description:"'Lag' refers to the parameter name of the serial diff translation https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-pipeline-serialdiff-aggregation.html. This should only be translated if there is a reasaonable word explaining what that parameter does."})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",onChange:handleNumberChange("lag"),value:model.lag,type:"text"})))))};function positive_only_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function positive_only_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){positive_only_ownKeys(Object(source),true).forEach((function(key){positive_only_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{positive_only_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function positive_only_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var positive_only_PositiveOnlyAgg=function PositiveOnlyAgg(props){var siblings=props.siblings;var defaults={unit:""};var model=positive_only_objectSpread(positive_only_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveOnly.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("metric"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveOnly.metricLabel",defaultMessage:"Metric"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{onChange:handleSelectChange("field"),metrics:siblings,metric:model,value:model.field})))))};var CoreStartContext=external_kbnSharedDeps_React_default.a.createContext(null);var CoreStartContextProvider=CoreStartContext.Provider;function query_bar_wrapper_extends(){query_bar_wrapper_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return query_bar_wrapper_extends.apply(this,arguments)}function QueryBarWrapper(props){var coreStartContext=Object(external_kbnSharedDeps_React_["useContext"])(CoreStartContext);return external_kbnSharedDeps_React_default.a.createElement(public_["QueryStringInput"],query_bar_wrapper_extends({},props,coreStartContext))}function filter_ratio_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_ratio_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_ratio_ownKeys(Object(source),true).forEach((function(key){filter_ratio_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_ratio_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_ratio_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var filter_ratio_isFieldHistogram=function isFieldHistogram(fields,indexPattern,field){var indexFields=fields[indexPattern];if(!indexFields)return false;var fieldObject=indexFields.find((function(f){return f.name===field}));if(!fieldObject)return false;return fieldObject.type===public_["KBN_FIELD_TYPES"].HISTOGRAM};var filter_ratio_FilterRatioAgg=function FilterRatioAgg(props){var series=props.series,fields=props.fields,panel=props.panel;var handleChange=Object(external_kbnSharedDeps_React_["useMemo"])((function(){return create_change_handler_createChangeHandler(props.onChange,props.model)}),[props.model,props.onChange]);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleNumeratorQueryChange=Object(external_kbnSharedDeps_React_["useCallback"])((function(query){return handleChange({numerator:query})}),[handleChange]);var handleDenominatorQueryChange=Object(external_kbnSharedDeps_React_["useCallback"])((function(query){return handleChange({denominator:query})}),[handleChange]);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;var defaults={numerator:Object(services["c"])().query.queryString.getDefaultQuery(),denominator:Object(services["c"])().query.queryString.getDefaultQuery(),metric_agg:"count"};var model=filter_ratio_objectSpread(filter_ratio_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("numerator"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.numeratorLabel",defaultMessage:"Numerator"})},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:model.numerator,onChange:handleNumeratorQueryChange,indexPatterns:[indexPattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("denominator"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.denominatorLabel",defaultMessage:"Denominator"})},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:model.denominator,onChange:handleDenominatorQueryChange,indexPatterns:[indexPattern]})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("metric")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.metricAggregationLabel",defaultMessage:"Metric Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("metric"),siblings:props.siblings,panelType:filter_ratio_isFieldHistogram(fields,indexPattern,model.field)?"histogram":"filter_ratio",value:model.metric_agg,onChange:handleSelectChange("metric_agg")})),model.metric_agg!=="count"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("aggField"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.filterRatio.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.metric_agg,restrict:getSupportedFieldsByMetricType(model.metric_agg),indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")}))):null))};function multi_value_row_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function multi_value_row_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){multi_value_row_ownKeys(Object(source),true).forEach((function(key){multi_value_row_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{multi_value_row_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function multi_value_row_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var multi_value_row_MultiValueRow=function MultiValueRow(_ref){var model=_ref.model,onChange=_ref.onChange,_onDelete=_ref.onDelete,onAdd=_ref.onAdd,disableAdd=_ref.disableAdd,disableDelete=_ref.disableDelete;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var onFieldNumberChange=function onFieldNumberChange(event){return onChange(multi_value_row_objectSpread(multi_value_row_objectSpread({},model),{},{value:Object(external_kbnSharedDeps_Lodash_["get"])(event,"target.value")}))};return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow__multiValueRow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("value")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.multivalueRow.valueLabel",defaultMessage:"Value:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:model.value===""?"":Number(model.value),placeholder:"0",onChange:onFieldNumberChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:onAdd,onDelete:function onDelete(){return _onDelete(model)},disableDelete:disableDelete,disableAdd:disableAdd}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null))};multi_value_row_MultiValueRow.defaultProps={model:{id:null,value:""}};function percentile_rank_values_toConsumableArray(arr){return percentile_rank_values_arrayWithoutHoles(arr)||percentile_rank_values_iterableToArray(arr)||percentile_rank_values_unsupportedIterableToArray(arr)||percentile_rank_values_nonIterableSpread()}function percentile_rank_values_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function percentile_rank_values_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return percentile_rank_values_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return percentile_rank_values_arrayLikeToArray(o,minLen)}function percentile_rank_values_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function percentile_rank_values_arrayWithoutHoles(arr){if(Array.isArray(arr))return percentile_rank_values_arrayLikeToArray(arr)}function percentile_rank_values_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}var percentile_rank_values_PercentileRankValues=function PercentileRankValues(props){var model=props.model||[];var onChange=props.onChange,disableAdd=props.disableAdd,disableDelete=props.disableDelete,showOnlyLastRow=props.showOnlyLastRow;var onChangeValue=function onChangeValue(_ref){var value=_ref.value,id=_ref.id;model[id]=value;onChange(model)};var onDeleteValue=function onDeleteValue(_ref2){var id=_ref2.id;return onChange(model.filter((function(item,currentIndex){return id!==currentIndex})))};var onAddValue=function onAddValue(){return onChange([].concat(percentile_rank_values_toConsumableArray(model),[""]))};var renderRow=function renderRow(_ref3){var rowModel=_ref3.rowModel,disableDeleteRow=_ref3.disableDeleteRow,disableAddRow=_ref3.disableAddRow;return external_kbnSharedDeps_React_default.a.createElement(multi_value_row_MultiValueRow,{key:"percentileRankValue__item".concat(rowModel.id),onAdd:onAddValue,onChange:onChangeValue,onDelete:onDeleteValue,disableDelete:disableDeleteRow,disableAdd:disableAddRow,model:rowModel})};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",responsive:false,gutterSize:"xs"},showOnlyLastRow&&renderRow({rowModel:{id:model.length-1,value:Object(external_kbnSharedDeps_Lodash_["last"])(model)||""},disableAddRow:true,disableDeleteRow:true}),!showOnlyLastRow&&model.map((function(value,id,array){return renderRow({rowModel:{id:id,value:value||""},disableAddRow:disableAdd,disableDeleteRow:disableDelete||array.length<2})})))};function percentile_rank_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function percentile_rank_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){percentile_rank_ownKeys(Object(source),true).forEach((function(key){percentile_rank_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{percentile_rank_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function percentile_rank_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var percentile_rank_RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].NUMBER,public_["KBN_FIELD_TYPES"].HISTOGRAM];var percentile_rank_PercentileRankAgg=function PercentileRankAgg(props){var series=props.series,panel=props.panel,fields=props.fields;var defaults={values:[""]};var model=percentile_rank_objectSpread(percentile_rank_objectSpread({},defaults),props.model);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var isTablePanel=panel.type==="table";var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handlePercentileRankValuesChange=function handlePercentileRankValuesChange(values){handleChange(percentile_rank_objectSpread(percentile_rank_objectSpread({},model),{},{values:values}))};return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentileRank.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.percentileRank.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:percentile_rank_RESTRICT_FIELDS,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),model.values&&external_kbnSharedDeps_React_default.a.createElement(percentile_rank_values_PercentileRankValues,{disableAdd:isTablePanel,disableDelete:isTablePanel,showOnlyLastRow:isTablePanel,model:model.values,onChange:handlePercentileRankValuesChange}))};function static_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function static_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){static_ownKeys(Object(source),true).forEach((function(key){static_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{static_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function static_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var static_Static=function Static(props){var handleChange=create_change_handler_createChangeHandler(props.onChange,props.model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);var defaults={numerator:"*",denominator:"*",metric_agg:"count",value:""};var model=static_objectSpread(static_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.static.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("staticValue"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.static.staticValuesLabel",defaultMessage:"Static Value"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("value"),value:model.value===""?"":Number(model.value),step:.1})))))};var math_checkModel=function checkModel(model){return Array.isArray(model.variables)&&model.script!==undefined};function MathAgg(props){var siblings=props.siblings,model=props.model;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(!math_checkModel(model)){handleChange({variables:[vars_newVariable()],script:""})}}),[handleChange,model]);return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("variables")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.variablesLabel",defaultMessage:"Variables"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(vars_CalculationVars,{id:htmlId("variables"),metrics:siblings,onChange:handleChange,name:"variables",model:model,includeSiblings:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:"mathExpressionInput",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionLabel",defaultMessage:"Expression"}),fullWidth:true,helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionDescription",defaultMessage:"This field uses basic math expressions (see {link}) - Variables are keys on the {params} object, i.e. {paramsName} To access all the data use {paramsValues} for an array of the values and {paramsTimestamps} for an array of the timestamps. {paramsTimestamp} is available for the current bucket's timestamp, {paramsIndex} is available for the current bucket's index, and {paramsInterval}s available for the interval in milliseconds.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://github.com/elastic/tinymath/blob/master/docs/functions.md",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.math.expressionDescription.tinyMathLinkText",defaultMessage:"TinyMath"})),params:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params"),paramsName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params.<name>"),paramsValues:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._all.<name>.values"),paramsTimestamps:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._all.<name>.timestamps"),paramsTimestamp:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._timestamp"),paramsIndex:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._index"),paramsInterval:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"params._interval")}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextArea"],{"data-test-subj":"mathExpression",onChange:handleTextChange("script"),fullWidth:true,value:model.script})))))}function top_hit_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function top_hit_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){top_hit_ownKeys(Object(source),true).forEach((function(key){top_hit_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{top_hit_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function top_hit_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var top_hit_isFieldTypeEnabled=function isFieldTypeEnabled(fieldRestrictions,fieldType){return fieldRestrictions.length?fieldRestrictions.includes(fieldType):true};var top_hit_getAggWithOptions=function getAggWithOptions(){var field=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var fieldTypesRestriction=arguments.length>1?arguments[1]:undefined;if(top_hit_isFieldTypeEnabled(fieldTypesRestriction,field.type)){switch(field.type){case public_["KBN_FIELD_TYPES"].NUMBER:return[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.averageLabel",{defaultMessage:"Avg"}),value:"avg"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.maxLabel",{defaultMessage:"Max"}),value:"max"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.minLabel",{defaultMessage:"Min"}),value:"min"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.sumLabel",{defaultMessage:"Sum"}),value:"sum"}];case public_["KBN_FIELD_TYPES"].STRING:return[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggWithOptions.concatenate",{defaultMessage:"Concatenate"}),value:"concat"}]}}return[]};var top_hit_getOrderOptions=function getOrderOptions(){return[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.orderOptions.ascLabel",{defaultMessage:"Asc"}),value:"asc"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.orderOptions.descLabel",{defaultMessage:"Desc"}),value:"desc"}]};var ORDER_DATE_RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].DATE];var top_hit_TopHitAggUi=function TopHitAggUi(props){var fields=props.fields,series=props.series,panel=props.panel;var defaults={size:1,agg_with:"noop",order:"desc"};var model=top_hit_objectSpread(top_hit_objectSpread({},defaults),props.model);var indexPattern=series.override_index_pattern&&series.series_index_pattern||panel.index_pattern;var aggWithOptionsRestrictFields=[panel_types["a"].TABLE,panel_types["a"].METRIC,panel_types["a"].MARKDOWN].includes(panel.type)?[public_["KBN_FIELD_TYPES"].NUMBER,public_["KBN_FIELD_TYPES"].STRING]:[public_["KBN_FIELD_TYPES"].NUMBER];var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var handleTextChange=create_text_handler_createTextHandler(handleChange);var field=fields[indexPattern].find((function(f){return f.name===model.field}));var aggWithOptions=top_hit_getAggWithOptions(field,aggWithOptionsRestrictFields);var orderOptions=top_hit_getOrderOptions();var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var selectedAggWithOption=aggWithOptions.find((function(option){return model.agg_with===option.value}));var selectedOrderOption=orderOptions.find((function(option){return model.order===option.value}));return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:fields,type:model.type,restrict:aggWithOptionsRestrictFields,indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field")})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("size"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.sizeLabel",defaultMessage:"Size"})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",value:model.size,onChange:handleTextChange("size")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("agg_with"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.aggregateWithLabel",defaultMessage:"Aggregate with"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.aggregateWith.selectPlaceholder",{defaultMessage:"Select..."}),options:aggWithOptions,selectedOptions:selectedAggWithOption?[selectedAggWithOption]:[],onChange:handleSelectChange("agg_with"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order_by"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.orderByLabel",defaultMessage:"Order by"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{restrict:ORDER_DATE_RESTRICT_FIELDS,value:model.order_by,onChange:handleSelectChange("order_by"),indexPattern:indexPattern,fields:fields}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topHit.orderLabel",defaultMessage:"Order"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.topHit.order.selectPlaceholder",{defaultMessage:"Select..."}),options:orderOptions,selectedOptions:selectedOrderOption?[selectedOrderOption]:[],onChange:handleSelectChange("order"),singleSelection:{asPlainText:true}})))))};var TopHitAgg=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(top_hit_TopHitAggUi);function positive_rate_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function positive_rate_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){positive_rate_ownKeys(Object(source),true).forEach((function(key){positive_rate_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{positive_rate_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function positive_rate_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var UNIT_OPTIONS=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.auto",{defaultMessage:"auto"}),value:""},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.perMillisecond",{defaultMessage:"per millisecond"}),value:"1ms"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.perSecond",{defaultMessage:"per second"}),value:"1s"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.perMinute",{defaultMessage:"per minute"}),value:"1m"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.perHour",{defaultMessage:"per hour"}),value:"1h"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.units.perDay",{defaultMessage:"per day"}),value:"1d"}];var positive_rate_PositiveRateAgg=function PositiveRateAgg(props){var defaults={unit:""};var model=positive_rate_objectSpread(positive_rate_objectSpread({},defaults),props.model);var handleChange=create_change_handler_createChangeHandler(props.onChange,model);var handleSelectChange=create_select_handler_createSelectHandler(handleChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var indexPattern=props.series.override_index_pattern&&props.series.series_index_pattern||props.panel.index_pattern;var selectedUnitOptions=UNIT_OPTIONS.filter((function(o){return o.value===model.unit}));return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("aggregation")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.aggregationLabel",defaultMessage:"Aggregation"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(AggSelect,{id:htmlId("aggregation"),panelType:props.panel.type,siblings:props.siblings,value:model.type,onChange:handleSelectChange("type"),fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.postiveRate.fieldLabel",defaultMessage:"Field"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:props.fields,type:model.type,restrict:[public_["KBN_FIELD_TYPES"].NUMBER],indexPattern:indexPattern,value:model.field,onChange:handleSelectChange("field"),uiRestrictions:props.uiRestrictions,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("units"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.unitsLabel",defaultMessage:"Scale"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.positiveRate.unitSelectPlaceholder",{defaultMessage:"Select scale..."}),options:UNIT_OPTIONS,onChange:handleSelectChange("unit"),singleSelection:{asPlainText:true},selectedOptions:selectedUnitOptions})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.helpText",defaultMessage:"This aggregation should only be applied to {link}, it is a shortcut for applying max, derivative and positive only to a field.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://en.wikipedia.org/wiki/Monotonic_function",target:"_BLANK"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.positiveRate.helpTextLink",defaultMessage:"monotonically increasing numbers"}))}}))))};var aggToComponent={count:StandardAgg,avg:StandardAgg,max:StandardAgg,min:StandardAgg,sum:StandardAgg,std_deviation:StandardDeviationAgg,sum_of_squares:StandardAgg,variance:StandardAgg,avg_bucket:StandardSiblingAgg,max_bucket:StandardSiblingAgg,min_bucket:StandardSiblingAgg,sum_bucket:StandardSiblingAgg,variance_bucket:StandardSiblingAgg,sum_of_squares_bucket:StandardSiblingAgg,std_deviation_bucket:StandardSiblingAgg,percentile:PercentileAgg,percentile_rank:percentile_rank_PercentileRankAgg,cardinality:StandardAgg,value_count:StandardAgg,calculation:CalculationAgg,cumulative_sum:CumulativeSumAgg,moving_average:moving_average_MovingAverageAgg,derivative:derivative_DerivativeAgg,series_agg:SeriesAgg,serial_diff:serial_diff_SerialDiffAgg,filter_ratio:filter_ratio_FilterRatioAgg,positive_only:positive_only_PositiveOnlyAgg,static:static_Static,math:MathAgg,top_hit:TopHitAgg,positive_rate:positive_rate_PositiveRateAgg};function UnsupportedAgg(props){return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedAgg.aggIsNotSupportedDescription",defaultMessage:"The {modelType} aggregation is no longer supported.",values:{modelType:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,props.model.type)}}))))}function TemporaryUnsupportedAgg(props){return external_kbnSharedDeps_React_default.a.createElement(AggRow,{disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onDelete:props.onDelete,siblings:props.siblings,dragHandleProps:props.dragHandleProps},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedAgg.aggIsTemporaryUnsupportedDescription",defaultMessage:"The {modelType} aggregation is currently unsupported.",values:{modelType:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,props.model.type)}}))))}function agg_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function agg_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){agg_ownKeys(Object(source),true).forEach((function(key){agg_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{agg_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function agg_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function Agg(props){var model=props.model,uiRestrictions=props.uiRestrictions;var Component=aggToComponent[model.type];if(!Component){Component=UnsupportedAgg}else if(!check_ui_restrictions_isMetricEnabled(model.type,uiRestrictions)){Component=TemporaryUnsupportedAgg}var style=agg_objectSpread({cursor:"default"},props.style);return external_kbnSharedDeps_React_default.a.createElement("div",{className:props.className,style:style},external_kbnSharedDeps_React_default.a.createElement(Component,{fields:props.fields,disableDelete:props.disableDelete,model:props.model,onAdd:props.onAdd,onChange:props.onChange,onDelete:props.onDelete,panel:props.panel,series:props.series,siblings:props.siblings,uiRestrictions:props.uiRestrictions,dragHandleProps:props.dragHandleProps}))}var new_metric_agg_fn_newMetricAggFn=function newMetricAggFn(){return{id:uuid_default.a.v1(),type:"count"}};var series_change_handler_seriesChangeHandler=function seriesChangeHandler(props,items){return function(doc){if(items.length===1&&!isBasicAgg(doc)){collection_actions_handleAdd.call(null,props,(function(){var metric=new_metric_agg_fn_newMetricAggFn();metric.type=doc.type;var incompatPipelines=["calculation","series_agg"];if(!external_kbnSharedDeps_Lodash_default.a.includes(incompatPipelines,doc.type))metric.field=doc.id;return metric}))}else{collection_actions_handleChange.call(null,props,doc)}}};function aggs_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function aggs_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function aggs_createClass(Constructor,protoProps,staticProps){if(protoProps)aggs_defineProperties(Constructor.prototype,protoProps);if(staticProps)aggs_defineProperties(Constructor,staticProps);return Constructor}function aggs_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)aggs_setPrototypeOf(subClass,superClass)}function aggs_setPrototypeOf(o,p){aggs_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return aggs_setPrototypeOf(o,p)}function aggs_createSuper(Derived){var hasNativeReflectConstruct=aggs_isNativeReflectConstruct();return function _createSuperInternal(){var Super=aggs_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=aggs_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return aggs_possibleConstructorReturn(this,result)}}function aggs_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return aggs_assertThisInitialized(self)}function aggs_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function aggs_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function aggs_getPrototypeOf(o){aggs_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return aggs_getPrototypeOf(o)}var DROPPABLE_ID="aggs_dnd";var aggs_Aggs=function(_PureComponent){aggs_inherits(Aggs,_PureComponent);var _super=aggs_createSuper(Aggs);function Aggs(){aggs_classCallCheck(this,Aggs);return _super.apply(this,arguments)}aggs_createClass(Aggs,[{key:"render",value:function render(){var _this=this;var _this$props=this.props,panel=_this$props.panel,model=_this$props.model,fields=_this$props.fields,uiRestrictions=_this$props.uiRestrictions;var list=model.metrics;var onChange=series_change_handler_seriesChangeHandler(this.props,list);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:"".concat(DROPPABLE_ID,":").concat(model.id),type:"MICRO",spacing:"s"},list.map((function(row,idx){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDraggable"],{spacing:"s",key:row.id,index:idx,customDragHandle:true,draggableId:"".concat(DROPPABLE_ID,":").concat(model.id,":").concat(row.id)},(function(provided){return external_kbnSharedDeps_React_default.a.createElement(Agg,{key:row.id,disableDelete:list.length<2,fields:fields,model:row,onAdd:function onAdd(){return collection_actions_handleAdd(_this.props,new_metric_agg_fn_newMetricAggFn)},onChange:onChange,onDelete:function onDelete(){return collection_actions_handleDelete(_this.props,row)},panel:panel,series:model,siblings:list,uiRestrictions:uiRestrictions,dragHandleProps:provided.dragHandleProps})}))})))}}]);return Aggs}(external_kbnSharedDeps_React_["PureComponent"]);function data_format_picker_slicedToArray(arr,i){return data_format_picker_arrayWithHoles(arr)||data_format_picker_iterableToArrayLimit(arr,i)||data_format_picker_unsupportedIterableToArray(arr,i)||data_format_picker_nonIterableRest()}function data_format_picker_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function data_format_picker_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return data_format_picker_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return data_format_picker_arrayLikeToArray(o,minLen)}function data_format_picker_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function data_format_picker_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function data_format_picker_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function data_format_picker_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function data_format_picker_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function data_format_picker_createClass(Constructor,protoProps,staticProps){if(protoProps)data_format_picker_defineProperties(Constructor.prototype,protoProps);if(staticProps)data_format_picker_defineProperties(Constructor,staticProps);return Constructor}function data_format_picker_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)data_format_picker_setPrototypeOf(subClass,superClass)}function data_format_picker_setPrototypeOf(o,p){data_format_picker_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return data_format_picker_setPrototypeOf(o,p)}function data_format_picker_createSuper(Derived){var hasNativeReflectConstruct=data_format_picker_isNativeReflectConstruct();return function _createSuperInternal(){var Super=data_format_picker_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=data_format_picker_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return data_format_picker_possibleConstructorReturn(this,result)}}function data_format_picker_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return data_format_picker_assertThisInitialized(self)}function data_format_picker_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function data_format_picker_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function data_format_picker_getPrototypeOf(o){data_format_picker_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return data_format_picker_getPrototypeOf(o)}function data_format_picker_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULT_OUTPUT_PRECISION="2";var data_format_picker_DataFormatPickerUI=function(_Component){data_format_picker_inherits(DataFormatPickerUI,_Component);var _super=data_format_picker_createSuper(DataFormatPickerUI);function DataFormatPickerUI(props){var _this;data_format_picker_classCallCheck(this,DataFormatPickerUI);_this=_super.call(this,props);data_format_picker_defineProperty(data_format_picker_assertThisInitialized(_this),"handleCustomChange",(function(){_this.props.onChange([{value:_this.custom&&_this.custom.value||""}])}));data_format_picker_defineProperty(data_format_picker_assertThisInitialized(_this),"handleChange",(function(selectedOptions){if(selectedOptions.length<1){return}if(selectedOptions[0].value==="custom"){_this.handleCustomChange()}else if(selectedOptions[0].value==="duration"){var _this$state=_this.state,from=_this$state.from,to=_this$state.to,decimals=_this$state.decimals;_this.props.onChange([{value:"".concat(from,",").concat(to,",").concat(decimals)}])}else{_this.props.onChange(selectedOptions)}}));var _from;var _to;var _decimals;if(isDuration(props.value)){var _props$value$split=props.value.split(",");var _props$value$split2=data_format_picker_slicedToArray(_props$value$split,3);_from=_props$value$split2[0];_to=_props$value$split2[1];_decimals=_props$value$split2[2]}_this.state={from:_from||"ms",to:_to||"ms",decimals:_decimals||""};return _this}data_format_picker_createClass(DataFormatPickerUI,[{key:"handleDurationChange",value:function handleDurationChange(name){var _this2=this;return function(selectedOptions){if(selectedOptions.length<1){return}var newValue;if(name==="decimals"){newValue=_this2.decimals.value}else{newValue=selectedOptions[0].value}_this2.setState({[name]:newValue},(function(){var _this2$state=_this2.state,from=_this2$state.from,to=_this2$state.to,decimals=_this2$state.decimals;_this2.props.onChange([{value:"".concat(from,",").concat(to,",").concat(decimals)}])}))}}},{key:"render",value:function render(){var _this3=this;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var value=this.props.value||"";var defaultValue=value;if(!external_kbnSharedDeps_Lodash_default.a.includes(["bytes","number","percent"],value)){defaultValue="custom"}if(isDuration(value)){defaultValue="duration"}var intl=this.props.intl;var options=[{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.bytesLabel",defaultMessage:"Bytes"}),value:"bytes"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.numberLabel",defaultMessage:"Number"}),value:"number"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.percentLabel",defaultMessage:"Percent"}),value:"percent"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.durationLabel",defaultMessage:"Duration"}),value:"duration"},{label:intl.formatMessage({id:"visTypeTimeseries.dataFormatPicker.customLabel",defaultMessage:"Custom"}),value:"custom"}];var selectedOption=options.find((function(option){return defaultValue===option.value}));var custom;if(defaultValue==="duration"){var _value$split=value.split(","),_value$split2=data_format_picker_slicedToArray(_value$split,3),from=_value$split2[0],to=_value$split2[1],decimals=_value$split2[2];var selectedFrom=durationInputOptions.find((function(option){return from===option.value}));var selectedTo=durationOutputOptions.find((function(option){return to===option.value}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("date"),label:this.props.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:options,selectedOptions:selectedOption?[selectedOption]:[],onChange:this.handleChange,singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("from"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.fromLabel",defaultMessage:"From"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:durationInputOptions,selectedOptions:selectedFrom?[selectedFrom]:[],onChange:this.handleDurationChange("from"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("to"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.toLabel",defaultMessage:"To"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:durationOutputOptions,selectedOptions:selectedTo?[selectedTo]:[],onChange:this.handleDurationChange("to"),singleSelection:{asPlainText:true}}))),selectedTo&&selectedTo.value!=="humanize"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("decimal"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.decimalPlacesLabel",defaultMessage:"Decimal places"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{defaultValue:decimals,inputRef:function inputRef(el){return _this3.decimals=el},placeholder:DEFAULT_OUTPUT_PRECISION,onChange:this.handleDurationChange("decimals")}))))}if(defaultValue==="custom"){custom=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.formatStringLabel",defaultMessage:"Format string"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.dataFormatPicker.formatStringHelpText",defaultMessage:"See {numeralJsLink}",values:{numeralJsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"http://numeraljs.com/#format",target:"_BLANK"},"Numeral.js")}}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{defaultValue:value,inputRef:function inputRef(el){return _this3.custom=el},onChange:this.handleCustomChange})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:options,selectedOptions:selectedOption?[selectedOption]:[],onChange:this.handleChange,singleSelection:{asPlainText:true},"data-test-subj":"tsvbDataFormatPicker"}))),custom)}}]);return DataFormatPickerUI}(external_kbnSharedDeps_React_["Component"]);data_format_picker_DataFormatPickerUI.defaultProps={label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.defaultDataFormatterLabel",{defaultMessage:"Data Formatter"})};var DataFormatPicker=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(data_format_picker_DataFormatPickerUI);function YesNo(props){var name=props.name,value=props.value,disabled=props.disabled,dataTestSubj=props["data-test-subj"];var handleChange=function handleChange(value){var name=props.name;return function(){var parts={[name]:value};props.onChange(parts)}};var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var inputName=name+external_kbnSharedDeps_Lodash_default.a.uniqueId();return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadio"],{id:htmlId("yes"),"data-test-subj":"".concat(dataTestSubj,"-yes"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.yesButtonLabel",defaultMessage:"Yes",description:"The 'yes' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:inputName,checked:Boolean(value),value:"yes",onChange:handleChange(1),disabled:disabled})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadio"],{id:htmlId("no"),"data-test-subj":"".concat(dataTestSubj,"-no"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.noButtonLabel",defaultMessage:"No",description:"The 'no' in a yes/no answer choice."}),className:"eui-displayInlineBlock",name:inputName,checked:!Boolean(value),value:"no",onChange:handleChange(0),disabled:disabled}))}YesNo.defaultProps={disabled:false};var FormValidationContext=external_kbnSharedDeps_React_default.a.createContext({});var TIME_RANGE_DATA_MODES={ENTIRE_TIME_RANGE:"entire_time_range",LAST_VALUE:"last_value"};var TIME_RANGE_MODE_KEY="time_range_mode";var VisDataContext=external_kbnSharedDeps_React_default.a.createContext({});function index_pattern_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function index_pattern_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){index_pattern_ownKeys(Object(source),true).forEach((function(key){index_pattern_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{index_pattern_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function index_pattern_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var index_pattern_RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].DATE];var index_pattern_validateIntervalValue=function validateIntervalValue(intervalValue){var isAutoOrGteInterval=get_interval_isGteInterval(intervalValue)||isAutoInterval(intervalValue);if(isAutoOrGteInterval){return{isValid:true}}return validateReInterval(intervalValue)};var index_pattern_htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var index_pattern_isEntireTimeRangeActive=function isEntireTimeRangeActive(model,isTimeSeries){return!isTimeSeries&&model[TIME_RANGE_MODE_KEY]===TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE};var index_pattern_IndexPattern=function IndexPattern(_ref){var fields=_ref.fields,prefix=_ref.prefix,onChange=_ref.onChange,disabled=_ref.disabled,_model=_ref.model;var handleSelectChange=create_select_handler_createSelectHandler(onChange);var handleTextChange=create_text_handler_createTextHandler(onChange);var timeFieldName="".concat(prefix,"time_field");var indexPatternName="".concat(prefix,"index_pattern");var intervalName="".concat(prefix,"interval");var dropBucketName="".concat(prefix,"drop_last_bucket");var updateControlValidity=Object(external_kbnSharedDeps_React_["useContext"])(FormValidationContext);var uiRestrictions=Object(external_kbnSharedDeps_Lodash_["get"])(Object(external_kbnSharedDeps_React_["useContext"])(VisDataContext),"uiRestrictions");var timeRangeOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.lastValue",{defaultMessage:"Last value"}),value:TIME_RANGE_DATA_MODES.LAST_VALUE,disabled:!check_ui_restrictions_isTimerangeModeEnabled(TIME_RANGE_DATA_MODES.LAST_VALUE,uiRestrictions)},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.entireTimeRange",{defaultMessage:"Entire time range"}),value:TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE,disabled:!check_ui_restrictions_isTimerangeModeEnabled(TIME_RANGE_DATA_MODES.ENTIRE_TIME_RANGE,uiRestrictions)}];var defaults={default_index_pattern:"",[indexPatternName]:"*",[intervalName]:AUTO_INTERVAL,[dropBucketName]:1,[TIME_RANGE_MODE_KEY]:timeRangeOptions[0].value};var model=index_pattern_objectSpread(index_pattern_objectSpread({},defaults),_model);var isDefaultIndexPatternUsed=model.default_index_pattern&&!model[indexPatternName];var intervalValidation=index_pattern_validateIntervalValue(model[intervalName]);var selectedTimeRangeOption=timeRangeOptions.find((function(_ref2){var value=_ref2.value;return model[TIME_RANGE_MODE_KEY]===value}));var isTimeSeries=model.type===panel_types["a"].TIMESERIES;updateControlValidity(intervalName,intervalValidation.isValid);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"index-pattern"},!isTimeSeries&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("timeRange"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.label",{defaultMessage:"Data timerange mode"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.selectTimeRange",{defaultMessage:"Select"}),options:timeRangeOptions,selectedOptions:selectedTimeRangeOption?[selectedTimeRangeOption]:[],onChange:handleSelectChange(TIME_RANGE_MODE_KEY),singleSelection:{asPlainText:true},isDisabled:disabled})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",style:{margin:0}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeRange.hint",{defaultMessage:'This setting controls the timespan used for matching documents.\n                "Entire timerange" will match all the documents selected in the timepicker.\n                "Last value" will match only the documents for the specified interval from the end of the timerange.'})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("indexPattern"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPatternLabel",{defaultMessage:"Index pattern"}),helpText:isDefaultIndexPatternUsed&&external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.searchByDefaultIndex",{defaultMessage:"Default index pattern is used. To query all indexes use *"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"metricsIndexPatternInput",disabled:disabled,placeholder:model.default_index_pattern,onChange:handleTextChange(indexPatternName,"*"),value:model[indexPatternName]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("timeField"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.timeFieldLabel",{defaultMessage:"Time field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{"data-test-subj":"metricsIndexPatternFieldsSelect",restrict:index_pattern_RESTRICT_FIELDS,value:model[timeFieldName],disabled:disabled,onChange:handleSelectChange(timeFieldName),indexPattern:model[indexPatternName],fields:fields,placeholder:isDefaultIndexPatternUsed?model.default_timefield:undefined}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:!intervalValidation.isValid,error:intervalValidation.errorMessage,id:index_pattern_htmlId("interval"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.intervalLabel",{defaultMessage:"Interval"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.intervalHelpText",{defaultMessage:"Examples: auto, 1m, 1d, 7d, 1y, >=1m",description:"auto, 1m, 1d, 7d, 1y, >=1m are required values and must not be translated."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"metricsIndexPatternInterval",isInvalid:!intervalValidation.isValid,disabled:disabled||index_pattern_isEntireTimeRangeActive(model,isTimeSeries),onChange:handleTextChange(intervalName,AUTO_INTERVAL),value:model[intervalName],placeholder:AUTO_INTERVAL}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:index_pattern_htmlId("dropLastBucket"),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.indexPattern.dropLastBucketLabel",{defaultMessage:"Drop last bucket?"})},external_kbnSharedDeps_React_default.a.createElement(YesNo,{"data-test-subj":"metricsDropLastBucket",value:model[dropBucketName],name:dropBucketName,onChange:onChange,disabled:disabled||index_pattern_isEntireTimeRangeActive(model,isTimeSeries)})))))};index_pattern_IndexPattern.defaultProps={prefix:"",disabled:false};function getDefaultQueryLanguage(){return Object(services["g"])().get(public_["UI_SETTINGS"].SEARCH_QUERY_LANGUAGE)}var isPercentDisabled=function isPercentDisabled(seriesQuantity){return seriesQuantity<2};function config_extends(){config_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return config_extends.apply(this,arguments)}function config_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function config_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){config_ownKeys(Object(source),true).forEach((function(key){config_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{config_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function config_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TimeseriesConfig=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])((function(props){var handleSelectChange=create_select_handler_createSelectHandler(props.onChange);var handleTextChange=create_text_handler_createTextHandler(props.onChange);var defaults={fill:"",line_width:"",point_size:"",value_template:"{{value}}",offset_time:"",split_color_mode:"kibana",axis_min:"",axis_max:"",stacked:STACKED_OPTIONS.NONE,steps:0};var model=config_objectSpread(config_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var intl=props.intl;var stackedOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.noneLabel",defaultMessage:"None"}),value:STACKED_OPTIONS.NONE},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.stackedLabel",defaultMessage:"Stacked"}),value:STACKED_OPTIONS.STACKED},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.stackedWithinSeriesLabel",defaultMessage:"Stacked within series"}),value:STACKED_OPTIONS.STACKED_WITHIN_SERIES},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.percentLabel",defaultMessage:"Percent"}),value:STACKED_OPTIONS.PERCENT,disabled:isPercentDisabled(props.seriesQuantity[model.id])}];var selectedStackedOption=stackedOptions.find((function(option){return model.stacked===option.value}));var positionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.leftLabel",defaultMessage:"Left"}),value:"left"}];var selectedAxisPosOption=positionOptions.find((function(option){return model.axis_position===option.value}));var chartTypeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.barLabel",defaultMessage:"Bar"}),value:"bar"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.lineLabel",defaultMessage:"Line"}),value:"line"}];var selectedChartTypeOption=chartTypeOptions.find((function(option){return model.chart_type===option.value}));var splitColorOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.defaultPaletteLabel",defaultMessage:"Default palette"}),value:"kibana"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.rainbowLabel",defaultMessage:"Rainbow"}),value:"rainbow"},{label:intl.formatMessage({id:"visTypeTimeseries.timeSeries.gradientLabel",defaultMessage:"Gradient"}),value:"gradient"}];var selectedSplitColorOption=splitColorOptions.find((function(option){return model.split_color_mode===option.value}));var type;if(model.chart_type==="line"){type=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("chartType"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.chartTypeLabel",defaultMessage:"Chart type"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:chartTypeOptions,selectedOptions:selectedChartTypeOption?[selectedChartTypeOption]:[],onChange:handleSelectChange("chart_type"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("stacked"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.stackedLabel",defaultMessage:"Stacked"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:stackedOptions,selectedOptions:selectedStackedOption?[selectedStackedOption]:[],onChange:handleSelectChange("stacked"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fill"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.fillLabel",defaultMessage:"Fill (0 to 1)"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleTextChange("fill"),value:Number(model.fill)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lineWidth"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.lineWidthLabel",defaultMessage:"Line width"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("line_width"),value:Number(model.line_width)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pointSize"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.pointSizeLabel",defaultMessage:"Point size"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("point_size"),value:Number(model.point_size)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartLine.stepsLabel",defaultMessage:"Steps"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.steps,name:"steps",onChange:props.onChange})))}if(model.chart_type==="bar"){type=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("chartType"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.chartTypeLabel",defaultMessage:"Chart type"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:chartTypeOptions,selectedOptions:selectedChartTypeOption?[selectedChartTypeOption]:[],onChange:handleSelectChange("chart_type"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("stacked"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.stackedLabel",defaultMessage:"Stacked"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:stackedOptions,selectedOptions:selectedStackedOption?[selectedStackedOption]:[],onChange:handleSelectChange("stacked"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fill"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.fillLabel",defaultMessage:"Fill (0 to 1)"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{step:.1,onChange:handleTextChange("fill"),value:Number(model.fill)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("lineWidth"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.chartBar.lineWidthLabel",defaultMessage:"Line width"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("line_width"),value:Number(model.line_width)}))))}var disableSeparateYaxis=model.separate_axis?false:true;var seriesIndexPattern=props.model.override_index_pattern&&props.model.series_index_pattern?props.model.series_index_pattern:props.indexPatternForQuery;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.templateLabel",defaultMessage:"Template"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true,"data-test-subj":"tsvb_series_value"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("series_filter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:function onChange(filter){return props.onChange({filter:filter})},indexPatterns:[seriesIndexPattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),type,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("offset"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w, 1d are required values and must not be translated."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"offsetTimeSeries",onChange:handleTextChange("offset_time"),value:model.offset_time}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.hideInLegendLabel",defaultMessage:"Hide in legend"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.hide_in_legend,name:"hide_in_legend",onChange:props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("splitColor"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.splitColorThemeLabel",defaultMessage:"Split color theme"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:splitColorOptions,selectedOptions:selectedSplitColorOption?[selectedSplitColorOption]:[],onChange:handleSelectChange("split_color_mode"),singleSelection:{asPlainText:true}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.separateAxisLabel",defaultMessage:"Separate axis?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.separate_axis,name:"separate_axis",onChange:props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMin"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisMinLabel",defaultMessage:"Axis min"})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"number",disabled:disableSeparateYaxis,onChange:handleTextChange("axis_min"),value:model.axis_min}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMax"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisMaxLabel",defaultMessage:"Axis max"})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",disabled:disableSeparateYaxis,onChange:handleTextChange("axis_max"),value:model.axis_max}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisPos"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.axisPositionLabel",defaultMessage:"Axis position"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,isDisabled:disableSeparateYaxis,options:positionOptions,selectedOptions:selectedAxisPosOption?[selectedAxisPosOption]:[],onChange:handleSelectChange("axis_position"),singleSelection:{asPlainText:true}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.overrideIndexPatternLabel",defaultMessage:"Override Index Pattern?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.override_index_pattern,name:"override_index_pattern",onChange:props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,config_extends({},props,{prefix:"series_",disabled:!model.override_index_pattern,"with-interval":true})))))}));function group_by_select_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function group_by_select_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){group_by_select_ownKeys(Object(source),true).forEach((function(key){group_by_select_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{group_by_select_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function group_by_select_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function GroupBySelectUi(props){var intl=props.intl,uiRestrictions=props.uiRestrictions;var modeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.everythingLabel",defaultMessage:"Everything"}),value:"everything"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.filterLabel",defaultMessage:"Filter"}),value:"filter"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.filtersLabel",defaultMessage:"Filters"}),value:"filters"},{label:intl.formatMessage({id:"visTypeTimeseries.splits.groupBySelect.modeOptions.termsLabel",defaultMessage:"Terms"}),value:"terms"}].map((function(field){return group_by_select_objectSpread(group_by_select_objectSpread({},field),{},{disabled:!check_ui_restrictions_isGroupByFieldsEnabled(field.value,uiRestrictions)})}));var selectedValue=props.value||"everything";var selectedOption=modeOptions.find((function(option){return selectedValue===option.value}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{id:props.id,isClearable:false,options:modeOptions,selectedOptions:[selectedOption],onChange:props.onChange,singleSelection:{asPlainText:true}})}var GroupBySelect=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(GroupBySelectUi);var FIELD_TYPES={BOOLEAN:"boolean",DATE:"date",GEO:"geo_point",NUMBER:"number",STRING:"string"};function terms_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function terms_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){terms_ownKeys(Object(source),true).forEach((function(key){terms_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{terms_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function terms_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var terms_DEFAULTS={terms_direction:"desc",terms_size:10,terms_order_by:"_count"};var terms_SplitByTermsUI=function SplitByTermsUI(_ref){var onChange=_ref.onChange,indexPattern=_ref.indexPattern,intl=_ref.intl,seriesModel=_ref.model,fields=_ref.fields,uiRestrictions=_ref.uiRestrictions,seriesQuantity=_ref.seriesQuantity;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleTextChange=create_text_handler_createTextHandler(onChange);var handleSelectChange=create_select_handler_createSelectHandler(onChange);var model=terms_objectSpread(terms_objectSpread({},terms_DEFAULTS),seriesModel);var metrics=model.metrics;var defaultCount={value:"_count",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.defaultCountLabel",defaultMessage:"Doc Count (default)"})};var terms={value:"_key",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.termsLabel",defaultMessage:"Terms"})};var dirOptions=[{value:"desc",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.descendingLabel",defaultMessage:"Descending"})},{value:"asc",label:intl.formatMessage({id:"visTypeTimeseries.splits.terms.dirOptions.ascendingLabel",defaultMessage:"Ascending"})}];var selectedDirectionOption=dirOptions.find((function(option){return model.terms_direction===option.value}));var selectedField=Object(external_kbnSharedDeps_Lodash_["find"])(fields[indexPattern],(function(_ref2){var name=_ref2.name;return name===model.terms_field}));var selectedFieldType=Object(external_kbnSharedDeps_Lodash_["get"])(selectedField,"type");if(seriesQuantity&&model.stacked===STACKED_OPTIONS.PERCENT&&isPercentDisabled(seriesQuantity[model.id])){onChange({["stacked"]:STACKED_OPTIONS.NONE})}return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.groupByLabel",defaultMessage:"Group by"})},external_kbnSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("by"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.byLabel",defaultMessage:"By",description:"This labels a field selector allowing the user to chose 'by' which field to group."})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{"data-test-subj":"groupByField",indexPattern:indexPattern,onChange:handleSelectChange("terms_field"),value:model.terms_field,fields:fields,uiRestrictions:uiRestrictions,type:"terms"})))),selectedFieldType===FIELD_TYPES.STRING&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("include"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.includeLabel",defaultMessage:"Include"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:model.terms_include,onChange:handleTextChange("terms_include")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("exclude"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.excludeLabel",defaultMessage:"Exclude"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:model.terms_exclude,onChange:handleTextChange("terms_exclude")})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("top"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.topLabel",defaultMessage:"Top"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{placeholder:intl.formatMessage({id:"visTypeTimeseries.splits.terms.sizePlaceholder",defaultMessage:"Size"}),value:Number(model.terms_size),onChange:handleTextChange("terms_size")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("order"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.orderByLabel",defaultMessage:"Order by"})},external_kbnSharedDeps_React_default.a.createElement(MetricSelect,{metrics:metrics,clearable:false,additionalOptions:[defaultCount,terms],onChange:handleSelectChange("terms_order_by"),restrict:"basic",value:model.terms_order_by}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("direction"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.terms.directionLabel",defaultMessage:"Direction"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:dirOptions,selectedOptions:selectedDirectionOption?[selectedDirectionOption]:[],onChange:handleSelectChange("terms_direction"),singleSelection:{asPlainText:true}})))))};var SplitByTerms=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(terms_SplitByTermsUI);function filter_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_ownKeys(Object(source),true).forEach((function(key){filter_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var filter_SplitByFilter=function SplitByFilter(props){var _onChange=props.onChange,uiRestrictions=props.uiRestrictions,indexPattern=props.indexPattern;var defaults={filter:{language:getDefaultQueryLanguage(),query:""}};var model=filter_objectSpread(filter_objectSpread({},defaults),props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleSelectChange=create_select_handler_createSelectHandler(_onChange);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filter.groupByLabel",defaultMessage:"Group by"})},external_kbnSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("query"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filter.queryStringLabel",defaultMessage:"Query string"})},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _onChange({filter:filter})},indexPatterns:[indexPattern]}))))};function filter_items_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_items_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_items_ownKeys(Object(source),true).forEach((function(key){filter_items_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_items_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_items_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function filter_items_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function filter_items_createClass(Constructor,protoProps,staticProps){if(protoProps)filter_items_defineProperties(Constructor.prototype,protoProps);if(staticProps)filter_items_defineProperties(Constructor,staticProps);return Constructor}function filter_items_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)filter_items_setPrototypeOf(subClass,superClass)}function filter_items_setPrototypeOf(o,p){filter_items_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return filter_items_setPrototypeOf(o,p)}function filter_items_createSuper(Derived){var hasNativeReflectConstruct=filter_items_isNativeReflectConstruct();return function _createSuperInternal(){var Super=filter_items_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=filter_items_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return filter_items_possibleConstructorReturn(this,result)}}function filter_items_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return filter_items_assertThisInitialized(self)}function filter_items_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function filter_items_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function filter_items_getPrototypeOf(o){filter_items_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return filter_items_getPrototypeOf(o)}function filter_items_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var filter_items_FilterItemsUi=function(_Component){filter_items_inherits(FilterItemsUi,_Component);var _super=filter_items_createSuper(FilterItemsUi);function FilterItemsUi(props){var _this;filter_items_classCallCheck(this,FilterItemsUi);_this=_super.call(this,props);filter_items_defineProperty(filter_items_assertThisInitialized(_this),"handleQueryChange",(function(model,filter){var part={filter:filter};collectionActions.handleChange(_this.props,external_kbnSharedDeps_Lodash_default.a.assign({},model,part))}));_this.renderRow=_this.renderRow.bind(filter_items_assertThisInitialized(_this));return _this}filter_items_createClass(FilterItemsUi,[{key:"handleChange",value:function handleChange(item,name){var _this2=this;return function(e){var handleChange=collectionActions.handleChange.bind(null,_this2.props);handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},item,{[name]:external_kbnSharedDeps_Lodash_default.a.get(e,"value",external_kbnSharedDeps_Lodash_default.a.get(e,"target.value"))}))}}},{key:"renderRow",value:function renderRow(row,i,items){var _this3=this;var indexPatterns=this.props.indexPatterns;var defaults={filter:"",label:""};var model=filter_items_objectSpread(filter_items_objectSpread({},defaults),row);var handleChange=function handleChange(part){var fn=collectionActions.handleChange.bind(null,_this3.props);fn(external_kbnSharedDeps_Lodash_default.a.assign({},model,part))};var newFilter=function newFilter(){return{color:_this3.props.model.color,id:uuid_default.a.v1(),filter:{language:model.filter.language||getDefaultQueryLanguage(),query:""}}};var handleAdd=collectionActions.handleAdd.bind(null,this.props,newFilter);var handleDelete=collectionActions.handleDelete.bind(null,this.props,model);var intl=this.props.intl;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",className:"tvbAggRow",alignItems:"center",key:model.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:handleChange,name:"color",value:model.color})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(query){return _this3.handleQueryChange(model,query)},indexPatterns:[indexPatterns]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{placeholder:intl.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelPlaceholder",defaultMessage:"Label"}),"aria-label":intl.formatMessage({id:"visTypeTimeseries.splits.filterItems.labelAriaLabel",defaultMessage:"Label"}),onChange:this.handleChange(model,"label"),value:model.label,fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false})))}},{key:"render",value:function render(){var _this$props=this.props,model=_this$props.model,name=_this$props.name;if(!model[name])return external_kbnSharedDeps_React_default.a.createElement("div",null);var rows=model[name].map(this.renderRow);return external_kbnSharedDeps_React_default.a.createElement("div",null,rows)}}]);return FilterItemsUi}(external_kbnSharedDeps_React_["Component"]);var FilterItems=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(filter_items_FilterItemsUi);var filters_SplitByFilters=function SplitByFilters(props){var onChange=props.onChange,model=props.model,uiRestrictions=props.uiRestrictions,indexPattern=props.indexPattern;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleSelectChange=create_select_handler_createSelectHandler(onChange);return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.filters.groupByLabel",defaultMessage:"Group by"})},external_kbnSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions})))),external_kbnSharedDeps_React_default.a.createElement(FilterItems,{name:"split_filters",model:model,onChange:onChange,indexPatterns:indexPattern}))};var everything_SplitByEverything=function SplitByEverything(props){var onChange=props.onChange,model=props.model,uiRestrictions=props.uiRestrictions;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleSelectChange=create_select_handler_createSelectHandler(onChange);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},external_kbnSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))))};var unsupported_split_SplitUnsupported=function SplitUnsupported(props){var onChange=props.onChange,model=props.model,uiRestrictions=props.uiRestrictions;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleSelectChange=create_select_handler_createSelectHandler(onChange);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("group"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.splits.everything.groupByLabel",defaultMessage:"Group by"})},external_kbnSharedDeps_React_default.a.createElement(GroupBySelect,{value:model.split_mode,onChange:handleSelectChange("split_mode"),uiRestrictions:uiRestrictions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{className:"tvbAggRow__unavailable",size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.unsupportedSplit.splitIsUnsupportedDescription",defaultMessage:"Split by {modelType} is unsupported.",values:{modelType:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,model.split_mode)}})))))};function split_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function split_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function split_createClass(Constructor,protoProps,staticProps){if(protoProps)split_defineProperties(Constructor.prototype,protoProps);if(staticProps)split_defineProperties(Constructor,staticProps);return Constructor}function split_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)split_setPrototypeOf(subClass,superClass)}function split_setPrototypeOf(o,p){split_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return split_setPrototypeOf(o,p)}function split_createSuper(Derived){var hasNativeReflectConstruct=split_isNativeReflectConstruct();return function _createSuperInternal(){var Super=split_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=split_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return split_possibleConstructorReturn(this,result)}}function split_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return split_assertThisInitialized(self)}function split_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function split_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function split_getPrototypeOf(o){split_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return split_getPrototypeOf(o)}var SPLIT_MODES={FILTERS:"filters",FILTER:"filter",TERMS:"terms",EVERYTHING:"everything"};var split_Split=function(_Component){split_inherits(Split,_Component);var _super=split_createSuper(Split);function Split(){split_classCallCheck(this,Split);return _super.apply(this,arguments)}split_createClass(Split,[{key:"UNSAFE_componentWillReceiveProps",value:function UNSAFE_componentWillReceiveProps(nextProps){var model=nextProps.model;if(model.split_mode==="filters"&&!model.split_filters){this.props.onChange({split_filters:[{color:model.color,id:uuid_default.a.v1(),filter:{query:"",language:getDefaultQueryLanguage()}}]})}}},{key:"getComponent",value:function getComponent(splitMode,uiRestrictions){if(!check_ui_restrictions_isGroupByFieldsEnabled(splitMode,uiRestrictions)){return unsupported_split_SplitUnsupported}switch(splitMode){case SPLIT_MODES.TERMS:return SplitByTerms;case SPLIT_MODES.FILTER:return filter_SplitByFilter;case SPLIT_MODES.FILTERS:return filters_SplitByFilters;default:return everything_SplitByEverything}}},{key:"render",value:function render(){var _this$props=this.props,model=_this$props.model,panel=_this$props.panel,uiRestrictions=_this$props.uiRestrictions,seriesQuantity=_this$props.seriesQuantity;var indexPattern=model.override_index_pattern&&model.series_index_pattern||panel.index_pattern;var splitMode=Object(external_kbnSharedDeps_Lodash_["get"])(this.props,"model.split_mode",SPLIT_MODES.EVERYTHING);var Component=this.getComponent(splitMode,uiRestrictions);return external_kbnSharedDeps_React_default.a.createElement(Component,{model:model,indexPattern:indexPattern,fields:this.props.fields,onChange:this.props.onChange,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity})}}]);return Split}(external_kbnSharedDeps_React_["Component"]);function series_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function series_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){series_ownKeys(Object(source),true).forEach((function(key){series_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{series_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TimeseriesSeriesUI=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])((function(props){var panel=props.panel,fields=props.fields,onAdd=props.onAdd,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,onChange=props.onChange,visible=props.visible,intl=props.intl,name=props.name,uiRestrictions=props.uiRestrictions,seriesQuantity=props.seriesQuantity;var defaults={label:"",type:panel_types["a"].TIMESERIES};var model=series_objectSpread(series_objectSpread({},defaults),props.model);var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_kbnSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions,seriesQuantity:seriesQuantity})))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(TimeseriesConfig,{fields:props.fields,model:model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery,seriesQuantity:seriesQuantity})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.tab.metricsLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeSeries.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}var colorPicker=external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.timeSeries.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.timeSeries.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.timeSeries.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}));var TimeseriesSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(TimeseriesSeriesUI);function series_config_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function series_config_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){series_config_ownKeys(Object(source),true).forEach((function(key){series_config_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{series_config_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function series_config_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var series_config_SeriesConfig=function SeriesConfig(props){var defaults={offset_time:"",value_template:""};var model=series_config_objectSpread(series_config_objectSpread({},defaults),props.model);var handleSelectChange=create_select_handler_createSelectHandler(props.onChange);var handleTextChange=create_text_handler_createTextHandler(props.onChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var seriesIndexPattern=props.model.override_index_pattern&&props.model.series_index_pattern?props.model.series_index_pattern:props.indexPatternForQuery;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_kbnSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("series_filter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:function onChange(filter){return props.onChange({filter:filter})},indexPatterns:[seriesIndexPattern]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.templateLabel",defaultMessage:"Template"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.templateHelpText",defaultMessage:"eg. {templateExample}",values:{templateExample:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("offsetSeries"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.offsetSeriesTimeLabel",defaultMessage:"Offset series time by (1m, 1h, 1w, 1d)",description:"1m, 1h, 1w and 1d are required values and must not be translated."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"offsetTimeSeries",onChange:handleTextChange("offset_time"),value:model.offset_time})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.overrideIndexPatternLabel",defaultMessage:"Override Index Pattern?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.override_index_pattern,name:"override_index_pattern",onChange:props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{onChange:props.onChange,model:props.model,fields:props.fields,prefix:"series_",disabled:!model.override_index_pattern}))))};function metric_series_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function metric_series_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){metric_series_ownKeys(Object(source),true).forEach((function(key){metric_series_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{metric_series_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function metric_series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function MetricSeriesUi(props){var panel=props.panel,fields=props.fields,name=props.name,onAdd=props.onAdd,onChange=props.onChange,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,visible=props.visible,intl=props.intl,uiRestrictions=props.uiRestrictions;var defaults={label:""};var model=metric_series_objectSpread(metric_series_objectSpread({},defaults),props.model);var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_kbnSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(series_config_SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}var colorPicker;if(props.colorPicker){colorPicker=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color}))}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.metric.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),colorPicker,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.metric.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.metric.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}var MetricSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(MetricSeriesUi);var TopNSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])((function(props){var panel=props.panel,model=props.model,name=props.name,fields=props.fields,onAdd=props.onAdd,onChange=props.onChange,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,visible=props.visible,intl=props.intl,uiRestrictions=props.uiRestrictions;var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_kbnSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(series_config_SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.tab.metricsLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}var colorPicker=external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.topN.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.topN.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.topN.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}));function color_rules_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function color_rules_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){color_rules_ownKeys(Object(source),true).forEach((function(key){color_rules_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{color_rules_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function color_rules_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function color_rules_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function color_rules_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function color_rules_createClass(Constructor,protoProps,staticProps){if(protoProps)color_rules_defineProperties(Constructor.prototype,protoProps);if(staticProps)color_rules_defineProperties(Constructor,staticProps);return Constructor}function color_rules_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)color_rules_setPrototypeOf(subClass,superClass)}function color_rules_setPrototypeOf(o,p){color_rules_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return color_rules_setPrototypeOf(o,p)}function color_rules_createSuper(Derived){var hasNativeReflectConstruct=color_rules_isNativeReflectConstruct();return function _createSuperInternal(){var Super=color_rules_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=color_rules_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return color_rules_possibleConstructorReturn(this,result)}}function color_rules_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return color_rules_assertThisInitialized(self)}function color_rules_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function color_rules_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function color_rules_getPrototypeOf(o){color_rules_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return color_rules_getPrototypeOf(o)}var color_rules_ColorRulesUI=function(_Component){color_rules_inherits(ColorRulesUI,_Component);var _super=color_rules_createSuper(ColorRulesUI);function ColorRulesUI(props){var _this;color_rules_classCallCheck(this,ColorRulesUI);_this=_super.call(this,props);_this.renderRow=_this.renderRow.bind(color_rules_assertThisInitialized(_this));return _this}color_rules_createClass(ColorRulesUI,[{key:"handleChange",value:function handleChange(item,name){var _this2=this;var cast=arguments.length>2&&arguments[2]!==undefined?arguments[2]:String;return function(e){var handleChange=collectionActions.handleChange.bind(null,_this2.props);var part={};part[name]=cast(external_kbnSharedDeps_Lodash_default.a.get(e,"[0].value",external_kbnSharedDeps_Lodash_default.a.get(e,"target.value")));if(part[name]==="undefined")part[name]=undefined;if(cast===Number&&isNaN(part[name]))part[name]=undefined;handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},item,part))}}},{key:"renderRow",value:function renderRow(row,i,items){var _this3=this;var defaults={value:0};var model=color_rules_objectSpread(color_rules_objectSpread({},defaults),row);var handleAdd=function handleAdd(){return collectionActions.handleAdd(_this3.props)};var handleDelete=collectionActions.handleDelete.bind(null,this.props,model);var intl=this.props.intl;var operatorOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.greaterThanLabel",defaultMessage:"> greater than"}),value:"gt"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.greaterThanOrEqualLabel",defaultMessage:">= greater than or equal"}),value:"gte"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.lessThanLabel",defaultMessage:"< less than"}),value:"lt"},{label:intl.formatMessage({id:"visTypeTimeseries.colorRules.lessThanOrEqualLabel",defaultMessage:"<= less than or equal"}),value:"lte"}];var handleColorChange=function handleColorChange(part){var handleChange=collectionActions.handleChange.bind(null,_this3.props);handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},model,part))};var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);var selectedOperatorOption=operatorOptions.find((function(option){return model.operator===option.value}));var labelStyle={marginBottom:0};var secondary;if(!this.props.hideSecondary){secondary=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.setSecondaryColorLabel",defaultMessage:"and {secondaryName} to",values:{secondaryName:this.props.secondaryName},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:handleColorChange,name:this.props.secondaryVarName,value:model[this.props.secondaryVarName]})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,responsive:false,gutterSize:"s",key:model.id,alignItems:"center",className:"tvbColorRules__rule"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.setPrimaryColorLabel",defaultMessage:"Set {primaryName} to",values:{primaryName:this.props.primaryName},description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:handleColorChange,name:this.props.primaryVarName,value:model[this.props.primaryVarName]})),secondary,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{style:labelStyle,htmlFor:htmlId("ifMetricIs")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.colorRules.ifMetricIsLabel",defaultMessage:"if metric is",description:"Part of a larger string: Set {primaryName} to {color} and {secondaryName} to {color} if metric is {greaterOrLessThan} {value}."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{id:htmlId("ifMetricIs"),options:operatorOptions,selectedOptions:selectedOperatorOption?[selectedOperatorOption]:[],onChange:this.handleChange(model,"operator"),singleSelection:{asPlainText:true},"data-test-subj":"colorRuleOperator",fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{"aria-label":intl.formatMessage({id:"visTypeTimeseries.colorRules.valueAriaLabel",defaultMessage:"Value"}),value:model.value,onChange:this.handleChange(model,"value",Number),"data-test-subj":"colorRuleValue",fullWidth:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,disableDelete:items.length<2,responsive:false})))}},{key:"render",value:function render(){var _this$props=this.props,model=_this$props.model,name=_this$props.name;if(!model[name])return external_kbnSharedDeps_React_default.a.createElement("div",null);var rows=model[name].map(this.renderRow);return external_kbnSharedDeps_React_default.a.createElement("div",null,rows)}}]);return ColorRulesUI}(external_kbnSharedDeps_React_["Component"]);color_rules_ColorRulesUI.defaultProps={name:"color_rules",primaryName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.colorRules.defaultPrimaryNameLabel",{defaultMessage:"background"}),primaryVarName:"background_color",secondaryName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.colorRules.defaultSecondaryNameLabel",{defaultMessage:"text"}),secondaryVarName:"color",hideSecondary:false};var ColorRules=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(color_rules_ColorRulesUI);function table_config_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function table_config_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){table_config_ownKeys(Object(source),true).forEach((function(key){table_config_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{table_config_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function table_config_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function config_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function config_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function config_createClass(Constructor,protoProps,staticProps){if(protoProps)config_defineProperties(Constructor.prototype,protoProps);if(staticProps)config_defineProperties(Constructor,staticProps);return Constructor}function config_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)config_setPrototypeOf(subClass,superClass)}function config_setPrototypeOf(o,p){config_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return config_setPrototypeOf(o,p)}function config_createSuper(Derived){var hasNativeReflectConstruct=config_isNativeReflectConstruct();return function _createSuperInternal(){var Super=config_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=config_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return config_possibleConstructorReturn(this,result)}}function config_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return config_assertThisInitialized(self)}function config_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function config_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function config_getPrototypeOf(o){config_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return config_getPrototypeOf(o)}var config_TableSeriesConfigUI=function(_Component){config_inherits(TableSeriesConfigUI,_Component);var _super=config_createSuper(TableSeriesConfigUI);function TableSeriesConfigUI(){config_classCallCheck(this,TableSeriesConfigUI);return _super.apply(this,arguments)}config_createClass(TableSeriesConfigUI,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var model=this.props.model;if(!model.color_rules||model.color_rules&&model.color_rules.length===0){this.props.onChange({color_rules:[{id:uuid_default.a.v1()}]})}}},{key:"render",value:function render(){var _this=this;var defaults={offset_time:"",value_template:""};var model=table_config_objectSpread(table_config_objectSpread({},defaults),this.props.model);var handleSelectChange=create_select_handler_createSelectHandler(this.props.onChange);var handleTextChange=create_text_handler_createTextHandler(this.props.onChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var intl=this.props.intl;var functionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.table.sumLabel",defaultMessage:"Sum"}),value:"sum"},{label:intl.formatMessage({id:"visTypeTimeseries.table.maxLabel",defaultMessage:"Max"}),value:"max"},{label:intl.formatMessage({id:"visTypeTimeseries.table.minLabel",defaultMessage:"Min"}),value:"min"},{label:intl.formatMessage({id:"visTypeTimeseries.table.avgLabel",defaultMessage:"Avg"}),value:"mean"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallSumLabel",defaultMessage:"Overall Sum"}),value:"overall_sum"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallMaxLabel",defaultMessage:"Overall Max"}),value:"overall_max"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallMinLabel",defaultMessage:"Overall Min"}),value:"overall_min"},{label:intl.formatMessage({id:"visTypeTimeseries.table.overallAvgLabel",defaultMessage:"Overall Avg"}),value:"overall_avg"},{label:intl.formatMessage({id:"visTypeTimeseries.table.cumulativeSumLabel",defaultMessage:"Cumulative Sum"}),value:"cumulative_sum"}];var selectedAggFuncOption=functionOptions.find((function(option){return model.aggregate_function===option.value}));return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(DataFormatPicker,{onChange:handleSelectChange("formatter"),value:model.formatter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("template"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.templateLabel",defaultMessage:"Template"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.templateHelpText",defaultMessage:"eg.{templateExample}",values:{templateExample:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{value}}/s")}})),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("value_template"),value:model.value_template,fullWidth:true})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("filterInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.filterLabel",defaultMessage:"Filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter&&model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter&&model.filter.query?model.filter.query:""},onChange:function onChange(filter){return _this.props.onChange({filter:filter})},indexPatterns:[this.props.indexPatternForQuery]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.showTrendArrowsLabel",defaultMessage:"Show trend arrows?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.trend_arrows,name:"trend_arrows",onChange:this.props.onChange}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.fieldLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:this.props.fields,indexPattern:this.props.panel.index_pattern,value:model.aggregate_by,onChange:handleSelectChange("aggregate_by"),fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("aggregateFunctionInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.aggregateFunctionLabel",defaultMessage:"Aggregate function"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:functionOptions,selectedOptions:selectedAggFuncOption?[selectedAggFuncOption]:[],onChange:handleSelectChange("aggregate_function"),singleSelection:{asPlainText:true},fullWidth:true})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.colorRulesLabel",defaultMessage:"Color rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ColorRules,{primaryName:"text",primaryVarName:"text",hideSecondary:true,model:model,onChange:this.props.onChange,name:"color_rules"}))}}]);return TableSeriesConfigUI}(external_kbnSharedDeps_React_["Component"]);var TableSeriesConfig=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(config_TableSeriesConfigUI);function TableSeriesUI(props){var model=props.model,onAdd=props.onAdd,name=props.name,fields=props.fields,panel=props.panel,onChange=props.onChange,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,visible=props.visible,intl=props.intl,uiRestrictions=props.uiRestrictions;var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(TableSeriesConfig,{panel:props.panel,fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.tab.metricsLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.tab.optionsLabel",defaultMessage:"Options"}))),seriesBody)}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.table.toggleSeriesEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,"aria-label":intl.formatMessage({id:"visTypeTimeseries.table.labelAriaLabel",defaultMessage:"Label"}),onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.table.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.table.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.table.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.table.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,togglePanelActivation:props.togglePanelActivation,isPanelActive:!model.hidden,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}var TableSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(TableSeriesUI);function gauge_series_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function gauge_series_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){gauge_series_ownKeys(Object(source),true).forEach((function(key){gauge_series_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{gauge_series_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function gauge_series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function GaugeSeriesUi(props){var panel=props.panel,fields=props.fields,onAdd=props.onAdd,name=props.name,onChange=props.onChange,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,visible=props.visible,intl=props.intl,uiRestrictions=props.uiRestrictions;var defaults={label:""};var model=gauge_series_objectSpread(gauge_series_objectSpread({},defaults),props.model);var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_kbnSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(series_config_SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}var colorPicker=external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:props.onChange,name:"color",value:model.color});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.gauge.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},colorPicker),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:props.disableDelete}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.addSeriesTooltip",defaultMessage:"Add Series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.deleteSeriesTooltip",defaultMessage:"Delete Series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.gauge.editor.cloneSeriesTooltip",defaultMessage:"Clone Series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}var GaugeSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(GaugeSeriesUi);function markdown_series_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function markdown_series_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){markdown_series_ownKeys(Object(source),true).forEach((function(key){markdown_series_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{markdown_series_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function markdown_series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function MarkdownSeriesUi(props){var panel=props.panel,fields=props.fields,onAdd=props.onAdd,onChange=props.onChange,onDelete=props.onDelete,disableDelete=props.disableDelete,disableAdd=props.disableAdd,selectedTab=props.selectedTab,visible=props.visible,intl=props.intl,name=props.name,uiRestrictions=props.uiRestrictions;var defaults={label:"",var_name:""};var model=markdown_series_objectSpread(markdown_series_objectSpread({},defaults),props.model);var handleChange=create_text_handler_createTextHandler(onChange);var caretIcon="arrowDown";if(!visible)caretIcon="arrowRight";var body=null;if(visible){var seriesBody;if(selectedTab==="metrics"){seriesBody=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(aggs_Aggs,{onChange:props.onChange,fields:fields,panel:panel,model:model,name:name,uiRestrictions:uiRestrictions,dragHandleProps:props.dragHandleProps}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAggRow tvbAggRow--split"},external_kbnSharedDeps_React_default.a.createElement(split_Split,{onChange:props.onChange,fields:fields,panel:panel,model:model,uiRestrictions:uiRestrictions})))}else{seriesBody=external_kbnSharedDeps_React_default.a.createElement(series_config_SeriesConfig,{fields:props.fields,model:props.model,onChange:props.onChange,indexPatternForQuery:props.indexPatternForQuery})}body=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbSeries__body"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="metrics",onClick:function onClick(){return props.switchTab("metrics")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.dataTab.metricsButtonLabel",defaultMessage:"Metrics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"seriesOptions",isSelected:selectedTab==="options",onClick:function onClick(){return props.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.optionsButtonLabel",defaultMessage:"Options"}))),seriesBody)}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"".concat(props.className),style:props.style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:caretIcon,color:"text",onClick:props.toggleVisible,"aria-label":intl.formatMessage({id:"visTypeTimeseries.markdown.editor.toggleEditorAriaLabel",defaultMessage:"Toggle series editor"}),"aria-expanded":props.visible})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("label"),placeholder:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.labelPlaceholder",defaultMessage:"Label"}),value:model.label})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{fullWidth:true,onChange:handleChange("var_name"),placeholder:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.variableNamePlaceholder",defaultMessage:"Variable name"}),value:model.var_name})),external_kbnSharedDeps_React_default.a.createElement(series_drag_handler_SeriesDragHandler,{dragHandleProps:props.dragHandleProps,hideDragHandler:true}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{addTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.addSeriesTooltip",defaultMessage:"Add series"}),deleteTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.deleteSeriesTooltip",defaultMessage:"Delete series"}),cloneTooltip:intl.formatMessage({id:"visTypeTimeseries.markdown.editor.cloneSeriesTooltip",defaultMessage:"Clone series"}),onDelete:onDelete,onClone:props.onClone,onAdd:onAdd,disableDelete:disableDelete,disableAdd:disableAdd,responsive:false}))),body)}var MarkdownSeries=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(MarkdownSeriesUi);function series_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function series_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function series_createClass(Constructor,protoProps,staticProps){if(protoProps)series_defineProperties(Constructor.prototype,protoProps);if(staticProps)series_defineProperties(Constructor,staticProps);return Constructor}function series_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)series_setPrototypeOf(subClass,superClass)}function series_setPrototypeOf(o,p){series_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return series_setPrototypeOf(o,p)}function series_createSuper(Derived){var hasNativeReflectConstruct=series_isNativeReflectConstruct();return function _createSuperInternal(){var Super=series_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=series_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return series_possibleConstructorReturn(this,result)}}function series_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return series_assertThisInitialized(self)}function series_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function series_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function series_getPrototypeOf(o){series_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return series_getPrototypeOf(o)}function components_series_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var series_lookup={top_n:TopNSeries,table:TableSeries,metric:MetricSeries,timeseries:TimeseriesSeries,gauge:GaugeSeries,markdown:MarkdownSeries};var series_Series=function(_Component){series_inherits(Series,_Component);var _super=series_createSuper(Series);function Series(){var _this;series_classCallCheck(this,Series);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));components_series_defineProperty(series_assertThisInitialized(_this),"state",{visible:true,selectedTab:"metrics"});components_series_defineProperty(series_assertThisInitialized(_this),"switchTab",(function(selectedTab){_this.setState({selectedTab:selectedTab})}));components_series_defineProperty(series_assertThisInitialized(_this),"handleChange",(function(part){if(_this.props.onChange){var model=_this.props.model;var doc=Object(external_kbnSharedDeps_Lodash_["assign"])({},model,part);_this.props.onChange(doc)}}));components_series_defineProperty(series_assertThisInitialized(_this),"togglePanelActivation",(function(){var model=_this.props.model;_this.handleChange({hidden:!model.hidden})}));components_series_defineProperty(series_assertThisInitialized(_this),"toggleVisible",(function(e){e.preventDefault();_this.setState({visible:!_this.state.visible})}));return _this}series_createClass(Series,[{key:"render",value:function render(){var _this2=this;var panel=this.props.panel;var Component=series_lookup[panel.type];return Boolean(Component)?external_kbnSharedDeps_React_default.a.createElement(VisDataContext.Consumer,null,(function(visData){var series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,"".concat(panel.id,".series"),[]);var counter={};var seriesQuantity=series.reduce((function(acc,value){counter[value.seriesId]=counter[value.seriesId]+1||1;acc[value.seriesId]=counter[value.seriesId];return acc}),{});return external_kbnSharedDeps_React_default.a.createElement(Component,{className:_this2.props.className,disableAdd:_this2.props.disableAdd,uiRestrictions:visData.uiRestrictions,seriesQuantity:seriesQuantity,disableDelete:_this2.props.disableDelete,fields:_this2.props.fields,name:_this2.props.name,onAdd:_this2.props.onAdd,onChange:_this2.handleChange,onClone:_this2.props.onClone,onDelete:_this2.props.onDelete,model:_this2.props.model,panel:_this2.props.panel,selectedTab:_this2.state.selectedTab,style:_this2.props.style,switchTab:_this2.switchTab,toggleVisible:_this2.toggleVisible,togglePanelActivation:_this2.togglePanelActivation,visible:_this2.state.visible,dragHandleProps:_this2.props.dragHandleProps,indexPatternForQuery:panel.index_pattern||panel.default_index_pattern})})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.seriesConfig.missingSeriesComponentDescription",defaultMessage:"Missing Series component for panel type: {panelType}",values:{panelType:panel.type}})}}]);return Series}(external_kbnSharedDeps_React_["Component"]);series_Series.defaultProps={name:"metrics"};var new_series_fn_newSeriesFn=function newSeriesFn(){var obj=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return external_kbnSharedDeps_Lodash_default.a.assign({id:uuid_default.a.v1(),color:"#68BC00",split_mode:"everything",metrics:[new_metric_agg_fn_newMetricAggFn()],separate_axis:0,axis_position:"right",formatter:"number",chart_type:"line",line_width:1,point_size:1,fill:.5,stacked:STACKED_OPTIONS.NONE},obj)};function reorder_slicedToArray(arr,i){return reorder_arrayWithHoles(arr)||reorder_iterableToArrayLimit(arr,i)||reorder_unsupportedIterableToArray(arr,i)||reorder_nonIterableRest()}function reorder_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function reorder_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return reorder_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return reorder_arrayLikeToArray(o,minLen)}function reorder_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function reorder_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function reorder_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var reorder=function reorder(list,startIndex,endIndex){var result=Array.from(list);var _result$splice=result.splice(startIndex,1),_result$splice2=reorder_slicedToArray(_result$splice,1),removed=_result$splice2[0];result.splice(endIndex,0,removed);return result};function series_editor_toConsumableArray(arr){return series_editor_arrayWithoutHoles(arr)||series_editor_iterableToArray(arr)||series_editor_unsupportedIterableToArray(arr)||series_editor_nonIterableSpread()}function series_editor_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function series_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return series_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return series_editor_arrayLikeToArray(o,minLen)}function series_editor_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function series_editor_arrayWithoutHoles(arr){if(Array.isArray(arr))return series_editor_arrayLikeToArray(arr)}function series_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function series_editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function series_editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function series_editor_createClass(Constructor,protoProps,staticProps){if(protoProps)series_editor_defineProperties(Constructor.prototype,protoProps);if(staticProps)series_editor_defineProperties(Constructor,staticProps);return Constructor}function series_editor_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)series_editor_setPrototypeOf(subClass,superClass)}function series_editor_setPrototypeOf(o,p){series_editor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return series_editor_setPrototypeOf(o,p)}function series_editor_createSuper(Derived){var hasNativeReflectConstruct=series_editor_isNativeReflectConstruct();return function _createSuperInternal(){var Super=series_editor_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=series_editor_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return series_editor_possibleConstructorReturn(this,result)}}function series_editor_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return series_editor_assertThisInitialized(self)}function series_editor_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function series_editor_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function series_editor_getPrototypeOf(o){series_editor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return series_editor_getPrototypeOf(o)}function series_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var series_editor_DROPPABLE_ID="series_editor_dnd";var series_editor_SeriesEditor=function(_Component){series_editor_inherits(SeriesEditor,_Component);var _super=series_editor_createSuper(SeriesEditor);function SeriesEditor(){var _this;series_editor_classCallCheck(this,SeriesEditor);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));series_editor_defineProperty(series_editor_assertThisInitialized(_this),"handleClone",(function(series){var newSeries=re_id_series_reIdSeries(series);collection_actions_handleAdd.call(null,_this.props,(function(){return newSeries}))}));series_editor_defineProperty(series_editor_assertThisInitialized(_this),"sortHandler",(function(_ref){var destination=_ref.destination,source=_ref.source;var canSort=destination&&source;if(canSort){var sortFunction=_this.getSortFunction({destination:destination,source:source});sortFunction({destination:destination,source:source})}}));series_editor_defineProperty(series_editor_assertThisInitialized(_this),"getSortFunction",(function(_ref2){var destination=_ref2.destination,source=_ref2.source;return destination.droppableId===source.droppableId&&source.droppableId===series_editor_DROPPABLE_ID?_this.sortSeries:_this.sortAggregations}));series_editor_defineProperty(series_editor_assertThisInitialized(_this),"sortSeries",(function(_ref3){var destination=_ref3.destination,source=_ref3.source;_this.props.onChange({series:reorder(series_editor_toConsumableArray(_this.props.model.series),source.index,destination.index)})}));series_editor_defineProperty(series_editor_assertThisInitialized(_this),"sortAggregations",(function(_ref4){var destination=_ref4.destination,source=_ref4.source;var extractId=function extractId(_ref5){var droppableId=_ref5.droppableId;return droppableId.split(":")[1]};var id=extractId(source);var canSort=id===extractId(destination);if(canSort){var model=series_editor_toConsumableArray(_this.props.model.series);var series=Object(external_kbnSharedDeps_Lodash_["find"])(model,{id:id});series.metrics=reorder(series_editor_toConsumableArray(series.metrics),source.index,destination.index);_this.props.onChange({series:model})}}));return _this}series_editor_createClass(SeriesEditor,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,limit=_this$props.limit,model=_this$props.model,name=_this$props.name,fields=_this$props.fields,colorPicker=_this$props.colorPicker;var list=model[name].filter((function(val,index){return index<(limit||Infinity)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDragDropContext"],{onDragEnd:this.sortHandler},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:series_editor_DROPPABLE_ID,spacing:"l",type:"MACRO"},list.map((function(row,idx){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDraggable"],{spacing:"m",key:row.id,index:idx,customDragHandle:true,draggableId:"".concat(series_editor_DROPPABLE_ID,":").concat(row.id),disableInteractiveElementBlocking:true},(function(provided){return external_kbnSharedDeps_React_default.a.createElement(series_Series,{className:"tvbSeriesEditor",colorPicker:colorPicker,disableAdd:model[name].length>=limit,disableDelete:model[name].length<2,fields:fields,onAdd:function onAdd(){return collection_actions_handleAdd(_this2.props,new_series_fn_newSeriesFn)},onChange:function onChange(doc){return collection_actions_handleChange(_this2.props,doc)},onClone:function onClone(){return _this2.handleClone(row)},onDelete:function onDelete(){return collection_actions_handleDelete(_this2.props,row)},model:row,panel:model,dragHandleProps:provided.dragHandleProps})}))}))))}}]);return SeriesEditor}(external_kbnSharedDeps_React_["Component"]);series_editor_SeriesEditor.defaultProps={name:"series",limit:Infinity,colorPicker:true};var ICONS=[{value:"fa-asterisk",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.asteriskLabel",{defaultMessage:"Asterisk"})},{value:"fa-bell",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bellLabel",{defaultMessage:"Bell"})},{value:"fa-bolt",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.boltLabel",{defaultMessage:"Bolt"})},{value:"fa-comment",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.commentLabel",{defaultMessage:"Comment"})},{value:"fa-map-marker",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.mapMarkerLabel",{defaultMessage:"Map Marker"})},{value:"fa-map-pin",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.mapPinLabel",{defaultMessage:"Map Pin"})},{value:"fa-star",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.starLabel",{defaultMessage:"Star"})},{value:"fa-tag",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.tagLabel",{defaultMessage:"Tag"})},{value:"fa-bomb",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bombLabel",{defaultMessage:"Bomb"})},{value:"fa-bug",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.bugLabel",{defaultMessage:"Bug"})},{value:"fa-exclamation-circle",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.exclamationCircleLabel",{defaultMessage:"Exclamation Circle"})},{value:"fa-exclamation-triangle",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.exclamationTriangleLabel",{defaultMessage:"Exclamation Triangle"})},{value:"fa-fire",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.fireLabel",{defaultMessage:"Fire"})},{value:"fa-flag",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.flagLabel",{defaultMessage:"Flag"})},{value:"fa-heart",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.iconSelect.heartLabel",{defaultMessage:"Heart"})}];function IconView(_ref){var icon=_ref.value,label=_ref.label;return external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:ICON_TYPES_MAP[icon]})," ".concat(label))}function IconSelect(_ref2){var value=_ref2.value,onChange=_ref2.onChange;var selectedIcon=ICONS.find((function(option){return value===option.value}))||ICONS[0];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:ICONS,selectedOptions:[selectedIcon],onChange:onChange,singleSelection:{asPlainText:true},renderOption:IconView})}function annotations_editor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function annotations_editor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){annotations_editor_ownKeys(Object(source),true).forEach((function(key){annotations_editor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{annotations_editor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function annotations_editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function annotations_editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function annotations_editor_createClass(Constructor,protoProps,staticProps){if(protoProps)annotations_editor_defineProperties(Constructor.prototype,protoProps);if(staticProps)annotations_editor_defineProperties(Constructor,staticProps);return Constructor}function annotations_editor_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)annotations_editor_setPrototypeOf(subClass,superClass)}function annotations_editor_setPrototypeOf(o,p){annotations_editor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return annotations_editor_setPrototypeOf(o,p)}function annotations_editor_createSuper(Derived){var hasNativeReflectConstruct=annotations_editor_isNativeReflectConstruct();return function _createSuperInternal(){var Super=annotations_editor_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=annotations_editor_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return annotations_editor_possibleConstructorReturn(this,result)}}function annotations_editor_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return annotations_editor_assertThisInitialized(self)}function annotations_editor_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function annotations_editor_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function annotations_editor_getPrototypeOf(o){annotations_editor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return annotations_editor_getPrototypeOf(o)}function annotations_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function newAnnotation(){return{id:uuid_default.a.v1(),color:"#F00",index_pattern:"*",time_field:"@timestamp",icon:"fa-tag",ignore_global_filters:1,ignore_panel_filters:1}}var annotations_editor_RESTRICT_FIELDS=[public_["KBN_FIELD_TYPES"].DATE];var annotations_editor_AnnotationsEditor=function(_Component){annotations_editor_inherits(AnnotationsEditor,_Component);var _super=annotations_editor_createSuper(AnnotationsEditor);function AnnotationsEditor(props){var _this;annotations_editor_classCallCheck(this,AnnotationsEditor);_this=_super.call(this,props);annotations_editor_defineProperty(annotations_editor_assertThisInitialized(_this),"handleQueryChange",(function(model,filter){var part={query_string:filter};collectionActions.handleChange(_this.props,annotations_editor_objectSpread(annotations_editor_objectSpread({},model),part))}));_this.renderRow=_this.renderRow.bind(annotations_editor_assertThisInitialized(_this));return _this}annotations_editor_createClass(AnnotationsEditor,[{key:"handleChange",value:function handleChange(item,name){var _this2=this;return function(e){var handleChange=collectionActions.handleChange.bind(null,_this2.props);var part={};part[name]=external_kbnSharedDeps_Lodash_default.a.get(e,"[0].value",external_kbnSharedDeps_Lodash_default.a.get(e,"target.value"));handleChange(external_kbnSharedDeps_Lodash_default.a.assign({},item,part))}}},{key:"renderRow",value:function renderRow(row){var _this3=this;var defaults={fields:"",template:"",index_pattern:"*",query_string:{query:"",language:getDefaultQueryLanguage()}};var model=annotations_editor_objectSpread(annotations_editor_objectSpread({},defaults),row);var handleChange=function handleChange(part){var fn=collectionActions.handleChange.bind(null,_this3.props);fn(external_kbnSharedDeps_Lodash_default.a.assign({},model,part))};var togglePanelActivation=function togglePanelActivation(){handleChange({hidden:!model.hidden})};var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])(model.id);var handleAdd=collectionActions.handleAdd.bind(null,this.props,newAnnotation);var handleDelete=collectionActions.handleDelete.bind(null,this.props,model);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAnnotationsEditor",key:model.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{disableTrash:true,onChange:handleChange,name:"color",value:model.color})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"tvbAggRow__children"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("indexPattern"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.indexPatternLabel",defaultMessage:"Index pattern (required)"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"index_pattern"),value:model.index_pattern,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("timeField"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.timeFieldLabel",defaultMessage:"Time field (required)"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{restrict:annotations_editor_RESTRICT_FIELDS,value:model.time_field,onChange:this.handleChange(model,"time_field"),indexPattern:model.index_pattern,fields:this.props.fields,fullWidth:true})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("queryString"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.queryStringLabel",defaultMessage:"Query string"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.query_string.language||getDefaultQueryLanguage(),query:model.query_string.query||""},onChange:function onChange(query){return _this3.handleQueryChange(model,query)},indexPatterns:[model.index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.ignoreGlobalFiltersLabel",defaultMessage:"Ignore global filters?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filters,name:"ignore_global_filters",onChange:handleChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.ignorePanelFiltersLabel",defaultMessage:"Ignore panel filters?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_panel_filters,name:"ignore_panel_filters",onChange:handleChange}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("icon"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.iconLabel",defaultMessage:"Icon (required)"})},external_kbnSharedDeps_React_default.a.createElement(IconSelect,{value:model.icon,onChange:this.handleChange(model,"icon")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("fields"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.fieldsLabel",defaultMessage:"Fields (required - comma separated paths)"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"fields"),value:model.fields,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("rowTemplate"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.rowTemplateLabel",defaultMessage:"Row template (required)"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.rowTemplateHelpText",defaultMessage:"eg.{rowTemplateExample}",values:{rowTemplateExample:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{field}}")}})),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:this.handleChange(model,"template"),value:model.template,fullWidth:true}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AddDeleteButtons,{onAdd:handleAdd,onDelete:handleDelete,togglePanelActivation:togglePanelActivation,isPanelActive:!model.hidden}))))}},{key:"render",value:function render(){var model=this.props.model;var content;if(!model.annotations||!model.annotations.length){var handleAdd=collectionActions.handleAdd.bind(null,this.props,newAnnotation);content=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.howToCreateAnnotationDataSourceDescription",defaultMessage:"Click the button below to create an annotation data source."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:handleAdd},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.addDataSourceButtonLabel",defaultMessage:"Add data source"})))}else{var annotations=model.annotations.map(this.renderRow);content=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.annotationsEditor.dataSourcesLabel",defaultMessage:"Data sources"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),annotations)}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbAnnotationsEditor__container"},content)}}]);return AnnotationsEditor}(external_kbnSharedDeps_React_["Component"]);annotations_editor_AnnotationsEditor.defaultProps={name:"annotations"};function panel_config_timeseries_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function panel_config_timeseries_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){panel_config_timeseries_ownKeys(Object(source),true).forEach((function(key){panel_config_timeseries_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{panel_config_timeseries_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function panel_config_timeseries_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function timeseries_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function timeseries_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function timeseries_createClass(Constructor,protoProps,staticProps){if(protoProps)timeseries_defineProperties(Constructor.prototype,protoProps);if(staticProps)timeseries_defineProperties(Constructor,staticProps);return Constructor}function timeseries_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)timeseries_setPrototypeOf(subClass,superClass)}function timeseries_setPrototypeOf(o,p){timeseries_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return timeseries_setPrototypeOf(o,p)}function timeseries_createSuper(Derived){var hasNativeReflectConstruct=timeseries_isNativeReflectConstruct();return function _createSuperInternal(){var Super=timeseries_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=timeseries_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return timeseries_possibleConstructorReturn(this,result)}}function timeseries_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return timeseries_assertThisInitialized(self)}function timeseries_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function timeseries_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function timeseries_getPrototypeOf(o){timeseries_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return timeseries_getPrototypeOf(o)}var timeseries_TimeseriesPanelConfigUi=function(_Component){timeseries_inherits(TimeseriesPanelConfigUi,_Component);var _super=timeseries_createSuper(TimeseriesPanelConfigUi);function TimeseriesPanelConfigUi(props){var _this;timeseries_classCallCheck(this,TimeseriesPanelConfigUi);_this=_super.call(this,props);_this.state={selectedTab:"data"};return _this}timeseries_createClass(TimeseriesPanelConfigUi,[{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"render",value:function render(){var _this2=this;var defaults={filter:{query:"",language:getDefaultQueryLanguage()},axis_max:"",axis_min:"",legend_position:"right",show_grid:1,tooltip_mode:"show_all"};var model=panel_config_timeseries_objectSpread(panel_config_timeseries_objectSpread({},defaults),this.props.model);var selectedTab=this.state.selectedTab;var handleSelectChange=create_select_handler_createSelectHandler(this.props.onChange);var handleTextChange=create_text_handler_createTextHandler(this.props.onChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var intl=this.props.intl;var positionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.positionOptions.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.positionOptions.leftLabel",defaultMessage:"Left"}),value:"left"}];var tooltipModeOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.tooltipOptions.showAll",defaultMessage:"Show all values"}),value:"show_all"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.tooltipOptions.showFocused",defaultMessage:"Show focused values"}),value:"show_focused"}];var selectedPositionOption=positionOptions.find((function(option){return model.axis_position===option.value}));var scaleOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.scaleOptions.normalLabel",defaultMessage:"Normal"}),value:"normal"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.scaleOptions.logLabel",defaultMessage:"Log"}),value:"log"}];var selectedAxisScaleOption=scaleOptions.find((function(option){return model.axis_scale===option.value}));var legendPositionOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.rightLabel",defaultMessage:"Right"}),value:"right"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.leftLabel",defaultMessage:"Left"}),value:"left"},{label:intl.formatMessage({id:"visTypeTimeseries.timeseries.legendPositionOptions.bottomLabel",defaultMessage:"Bottom"}),value:"bottom"}];var selectedLegendPosOption=legendPositionOptions.find((function(option){return model.legend_position===option.value}));var selectedTooltipMode=tooltipModeOptions.find((function(option){return model.tooltip_mode===option.value}));var view;if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else if(selectedTab==="annotations"){view=external_kbnSharedDeps_React_default.a.createElement(annotations_editor_AnnotationsEditor,{fields:this.props.fields,model:this.props.model,name:"annotations",onChange:this.props.onChange})}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this2.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.styleLabel",defaultMessage:"Style"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMin"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisMinLabel",defaultMessage:"Axis min"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("axis_min"),value:model.axis_min}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisMax"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisMaxLabel",defaultMessage:"Axis max"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("axis_max"),value:model.axis_max}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisPos"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisPositionLabel",defaultMessage:"Axis position"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:positionOptions,selectedOptions:selectedPositionOption?[selectedPositionOption]:[],onChange:handleSelectChange("axis_position"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("axisScale"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.axisScaleLabel",defaultMessage:"Axis scale"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:scaleOptions,selectedOptions:selectedAxisScaleOption?[selectedAxisScaleOption]:[],onChange:handleSelectChange("axis_scale"),singleSelection:{asPlainText:true}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.showLegendLabel",defaultMessage:"Show legend?"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.show_legend,name:"show_legend",onChange:this.props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("legendPos")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.legendPositionLabel",defaultMessage:"Legend position"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("legendPos"),options:legendPositionOptions,selectedOptions:selectedLegendPosOption?[selectedLegendPosOption]:[],onChange:handleSelectChange("legend_position"),singleSelection:{asPlainText:true}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.displayGridLabel",defaultMessage:"Display grid"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.show_grid,name:"show_grid",onChange:this.props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.tooltipMode",defaultMessage:"Tooltip"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,id:htmlId("tooltipMode"),options:tooltipModeOptions,selectedOptions:selectedTooltipMode?[selectedTooltipMode]:[],onChange:handleSelectChange("tooltip_mode"),singleSelection:{asPlainText:true}})))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:function onClick(){return _this2.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this2.switchTab("options")},"data-test-subj":"timeSeriesEditorPanelOptionsBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="annotations",onClick:function onClick(){return _this2.switchTab("annotations")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.timeseries.annotationsTab.annotationsButtonLabel",defaultMessage:"Annotations"}))),view)}}]);return TimeseriesPanelConfigUi}(external_kbnSharedDeps_React_["Component"]);var TimeseriesPanelConfig=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(timeseries_TimeseriesPanelConfigUi);function metric_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function metric_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){metric_ownKeys(Object(source),true).forEach((function(key){metric_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{metric_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function metric_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function panel_config_metric_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function panel_config_metric_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function panel_config_metric_createClass(Constructor,protoProps,staticProps){if(protoProps)panel_config_metric_defineProperties(Constructor.prototype,protoProps);if(staticProps)panel_config_metric_defineProperties(Constructor,staticProps);return Constructor}function panel_config_metric_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)panel_config_metric_setPrototypeOf(subClass,superClass)}function panel_config_metric_setPrototypeOf(o,p){panel_config_metric_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return panel_config_metric_setPrototypeOf(o,p)}function panel_config_metric_createSuper(Derived){var hasNativeReflectConstruct=panel_config_metric_isNativeReflectConstruct();return function _createSuperInternal(){var Super=panel_config_metric_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=panel_config_metric_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return panel_config_metric_possibleConstructorReturn(this,result)}}function panel_config_metric_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return panel_config_metric_assertThisInitialized(self)}function panel_config_metric_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function panel_config_metric_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function panel_config_metric_getPrototypeOf(o){panel_config_metric_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return panel_config_metric_getPrototypeOf(o)}var metric_MetricPanelConfig=function(_Component){panel_config_metric_inherits(MetricPanelConfig,_Component);var _super=panel_config_metric_createSuper(MetricPanelConfig);function MetricPanelConfig(props){var _this;panel_config_metric_classCallCheck(this,MetricPanelConfig);_this=_super.call(this,props);_this.state={selectedTab:"data"};return _this}panel_config_metric_createClass(MetricPanelConfig,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var model=this.props.model;if(!model.background_color_rules||model.background_color_rules&&model.background_color_rules.length===0){this.props.onChange({background_color_rules:[{id:uuid_default.a.v1()}]})}}},{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"render",value:function render(){var _this2=this;var selectedTab=this.state.selectedTab;var defaults={filter:{query:"",language:getDefaultQueryLanguage()}};var model=metric_objectSpread(metric_objectSpread({},defaults),this.props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var view;if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,limit:limitOfSeries[panel_types["a"].METRIC],model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this2.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ColorRules,{model:model,onChange:this.props.onChange,name:"background_color_rules"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:function onClick(){return _this2.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this2.switchTab("options")},"data-test-subj":"metricEditorPanelOptionsBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.metric.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}]);return MetricPanelConfig}(external_kbnSharedDeps_React_["Component"]);function panel_config_top_n_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function panel_config_top_n_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){panel_config_top_n_ownKeys(Object(source),true).forEach((function(key){panel_config_top_n_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{panel_config_top_n_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function panel_config_top_n_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function panel_config_top_n_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function panel_config_top_n_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function panel_config_top_n_createClass(Constructor,protoProps,staticProps){if(protoProps)panel_config_top_n_defineProperties(Constructor.prototype,protoProps);if(staticProps)panel_config_top_n_defineProperties(Constructor,staticProps);return Constructor}function panel_config_top_n_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)panel_config_top_n_setPrototypeOf(subClass,superClass)}function panel_config_top_n_setPrototypeOf(o,p){panel_config_top_n_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return panel_config_top_n_setPrototypeOf(o,p)}function panel_config_top_n_createSuper(Derived){var hasNativeReflectConstruct=panel_config_top_n_isNativeReflectConstruct();return function _createSuperInternal(){var Super=panel_config_top_n_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=panel_config_top_n_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return panel_config_top_n_possibleConstructorReturn(this,result)}}function panel_config_top_n_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return panel_config_top_n_assertThisInitialized(self)}function panel_config_top_n_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function panel_config_top_n_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function panel_config_top_n_getPrototypeOf(o){panel_config_top_n_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return panel_config_top_n_getPrototypeOf(o)}var top_n_TopNPanelConfig=function(_Component){panel_config_top_n_inherits(TopNPanelConfig,_Component);var _super=panel_config_top_n_createSuper(TopNPanelConfig);function TopNPanelConfig(props){var _this;panel_config_top_n_classCallCheck(this,TopNPanelConfig);_this=_super.call(this,props);_this.state={selectedTab:"data"};return _this}panel_config_top_n_createClass(TopNPanelConfig,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var model=this.props.model;var parts={};if(!model.bar_color_rules||model.bar_color_rules&&model.bar_color_rules.length===0){parts.bar_color_rules=[{id:uuid_default.a.v1()}]}this.props.onChange(parts)}},{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"render",value:function render(){var _this2=this;var selectedTab=this.state.selectedTab;var defaults={drilldown_url:"",filter:{query:"",language:getDefaultQueryLanguage()}};var model=panel_config_top_n_objectSpread(panel_config_top_n_objectSpread({},defaults),this.props.model);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var handleTextChange=create_text_handler_createTextHandler(this.props.onChange);var view;if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("itemUrl"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.itemUrlDescription",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{key}}")}}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("drilldown_url"),value:model.drilldown_url})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this2.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.styleLabel",defaultMessage:"Style"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ColorRules,{model:model,primaryVarName:"bar_color",primaryName:"bar",hideSecondary:true,onChange:this.props.onChange,name:"bar_color_rules"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:function onClick(){return _this2.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this2.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.topN.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}]);return TopNPanelConfig}(external_kbnSharedDeps_React_["Component"]);function table_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function table_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){table_ownKeys(Object(source),true).forEach((function(key){table_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{table_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function table_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function table_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function table_createClass(Constructor,protoProps,staticProps){if(protoProps)table_defineProperties(Constructor.prototype,protoProps);if(staticProps)table_defineProperties(Constructor,staticProps);return Constructor}function table_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)table_setPrototypeOf(subClass,superClass)}function table_setPrototypeOf(o,p){table_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return table_setPrototypeOf(o,p)}function table_createSuper(Derived){var hasNativeReflectConstruct=table_isNativeReflectConstruct();return function _createSuperInternal(){var Super=table_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=table_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return table_possibleConstructorReturn(this,result)}}function table_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return table_assertThisInitialized(self)}function table_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function table_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function table_getPrototypeOf(o){table_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return table_getPrototypeOf(o)}function table_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var table_TablePanelConfig=function(_Component){table_inherits(TablePanelConfig,_Component);var _super=table_createSuper(TablePanelConfig);function TablePanelConfig(props){var _this;table_classCallCheck(this,TablePanelConfig);_this=_super.call(this,props);table_defineProperty(table_assertThisInitialized(_this),"handlePivotChange",(function(selectedOption){var _this$props=_this.props,fields=_this$props.fields,model=_this$props.model;var pivotId=Object(external_kbnSharedDeps_Lodash_["get"])(selectedOption,"[0].value",null);var field=fields[model.index_pattern].find((function(field){return field.name===pivotId}));var pivotType=Object(external_kbnSharedDeps_Lodash_["get"])(field,"type",model.pivot_type);_this.props.onChange({pivot_id:pivotId,pivot_type:pivotType})}));_this.state={selectedTab:"data"};return _this}table_createClass(TablePanelConfig,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var model=this.props.model;var parts={};if(!model.bar_color_rules||model.bar_color_rules&&model.bar_color_rules.length===0){parts.bar_color_rules=[{id:uuid_default.a.v1()}]}this.props.onChange(parts)}},{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"render",value:function render(){var _this2=this;var selectedTab=this.state.selectedTab;var defaults={drilldown_url:"",filter:{query:"",language:getDefaultQueryLanguage()},pivot_label:"",pivot_rows:10,pivot_type:""};var model=table_objectSpread(table_objectSpread({},defaults),this.props.model);var handleTextChange=create_text_handler_createTextHandler(this.props.onChange);var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var view;if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.defineFieldDescription",defaultMessage:"For the table visualization you need to define a field to group by using a terms aggregation."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"groupByField"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("field"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.groupByFieldLabel",defaultMessage:"Group by field"})},external_kbnSharedDeps_React_default.a.createElement(FieldSelect,{fields:this.props.fields,value:model.pivot_id,indexPattern:model.index_pattern,onChange:this.handlePivotChange,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pivotLabelInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.columnLabel",defaultMessage:"Column label"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"columnLabelName",onChange:handleTextChange("pivot_label"),value:model.pivot_label,fullWidth:true}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("pivotRowsInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.rowsLabel",defaultMessage:"Rows"})},external_kbnSharedDeps_React_default.a.createElement("input",{className:"tvbAgg__input",type:"number",onChange:handleTextChange("pivot_rows"),value:model.pivot_rows})))))),external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange}))}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("drilldownInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.itemUrlLabel",defaultMessage:"Item url"}),helpText:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.itemUrlHelpText",defaultMessage:"This supports mustache templating. {key} is set to the term.",values:{key:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"{{key}}")}}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleTextChange("drilldown_url"),value:model.drilldown_url})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilterInput"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this2.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("globalFilterOption")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{id:htmlId("globalFilterOption"),value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:function onClick(){return _this2.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.dataTab.columnsButtonLabel",defaultMessage:"Columns"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this2.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}]);return TablePanelConfig}(external_kbnSharedDeps_React_["Component"]);function gauge_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function gauge_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){gauge_ownKeys(Object(source),true).forEach((function(key){gauge_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{gauge_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function gauge_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function panel_config_gauge_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function panel_config_gauge_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function panel_config_gauge_createClass(Constructor,protoProps,staticProps){if(protoProps)panel_config_gauge_defineProperties(Constructor.prototype,protoProps);if(staticProps)panel_config_gauge_defineProperties(Constructor,staticProps);return Constructor}function panel_config_gauge_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)panel_config_gauge_setPrototypeOf(subClass,superClass)}function panel_config_gauge_setPrototypeOf(o,p){panel_config_gauge_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return panel_config_gauge_setPrototypeOf(o,p)}function panel_config_gauge_createSuper(Derived){var hasNativeReflectConstruct=panel_config_gauge_isNativeReflectConstruct();return function _createSuperInternal(){var Super=panel_config_gauge_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=panel_config_gauge_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return panel_config_gauge_possibleConstructorReturn(this,result)}}function panel_config_gauge_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return panel_config_gauge_assertThisInitialized(self)}function panel_config_gauge_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function panel_config_gauge_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function panel_config_gauge_getPrototypeOf(o){panel_config_gauge_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return panel_config_gauge_getPrototypeOf(o)}var gauge_GaugePanelConfigUi=function(_Component){panel_config_gauge_inherits(GaugePanelConfigUi,_Component);var _super=panel_config_gauge_createSuper(GaugePanelConfigUi);function GaugePanelConfigUi(props){var _this;panel_config_gauge_classCallCheck(this,GaugePanelConfigUi);_this=_super.call(this,props);_this.state={selectedTab:"data"};return _this}panel_config_gauge_createClass(GaugePanelConfigUi,[{key:"UNSAFE_componentWillMount",value:function UNSAFE_componentWillMount(){var model=this.props.model;var parts={};if(!model.gauge_color_rules||model.gauge_color_rules&&model.gauge_color_rules.length===0){parts.gauge_color_rules=[{id:uuid_default.a.v1()}]}if(model.gauge_width==null)parts.gauge_width=10;if(model.gauge_inner_width==null)parts.gauge_inner_width=10;if(model.gauge_style==null)parts.gauge_style="half";this.props.onChange(parts)}},{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"render",value:function render(){var _this2=this;var selectedTab=this.state.selectedTab;var intl=this.props.intl;var defaults={gauge_max:"",filter:{query:"",language:getDefaultQueryLanguage()},gauge_style:"circle",gauge_inner_width:"",gauge_width:""};var model=gauge_objectSpread(gauge_objectSpread({},defaults),this.props.model);var handleSelectChange=create_select_handler_createSelectHandler(this.props.onChange);var handleTextChange=create_text_handler_createTextHandler(this.props.onChange);var styleOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.gauge.styleOptions.circleLabel",defaultMessage:"Circle"}),value:"circle"},{label:intl.formatMessage({id:"visTypeTimeseries.gauge.styleOptions.halfCircleLabel",defaultMessage:"Half Circle"}),value:"half"}];var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var selectedGaugeStyleOption=styleOptions.find((function(option){return model.gauge_style===option.value}));var view;if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:true,fields:this.props.fields,limit:limitOfSeries[panel_types["a"].GAUGE],model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language||getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this2.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.styleLabel",defaultMessage:"Style"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeMax"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeMaxLabel",defaultMessage:"Gauge max (empty for auto)"})},external_kbnSharedDeps_React_default.a.createElement("input",{id:htmlId("gaugeMax"),className:"tvbAgg__input",type:"number",onChange:handleTextChange("gauge_max"),value:model.gauge_max}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeStyle"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeStyleLabel",defaultMessage:"Gauge style"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,options:styleOptions,selectedOptions:selectedGaugeStyleOption?[selectedGaugeStyleOption]:[],onChange:handleSelectChange("gauge_style"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("innerLine"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.innerLineWidthLabel",defaultMessage:"Inner line width"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("gauge_inner_width"),value:Number(model.gauge_inner_width)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("gaugeLine"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.gaugeLineWidthLabel",defaultMessage:"Gauge line width"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{onChange:handleTextChange("gauge_width"),value:Number(model.gauge_width)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.innerColorLabel",defaultMessage:"Inner color:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"gauge_inner_color",value:model.gauge_inner_color}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.colorRulesLabel",defaultMessage:"Color rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ColorRules,{primaryName:"gauge color",primaryVarName:"gauge",secondaryName:"text color",secondaryVarName:"text",model:model,onChange:this.props.onChange,name:"gauge_color_rules"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="data",onClick:function onClick(){return _this2.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this2.switchTab("options")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.gauge.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}]);return GaugePanelConfigUi}(external_kbnSharedDeps_React_["Component"]);var GaugePanelConfig=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(gauge_GaugePanelConfigUi);var less=__webpack_require__(274);var mode_markdown=__webpack_require__(275);var github=__webpack_require__(280);function markdown_editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function markdown_editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function markdown_editor_createClass(Constructor,protoProps,staticProps){if(protoProps)markdown_editor_defineProperties(Constructor.prototype,protoProps);if(staticProps)markdown_editor_defineProperties(Constructor,staticProps);return Constructor}function markdown_editor_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)markdown_editor_setPrototypeOf(subClass,superClass)}function markdown_editor_setPrototypeOf(o,p){markdown_editor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return markdown_editor_setPrototypeOf(o,p)}function markdown_editor_createSuper(Derived){var hasNativeReflectConstruct=markdown_editor_isNativeReflectConstruct();return function _createSuperInternal(){var Super=markdown_editor_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=markdown_editor_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return markdown_editor_possibleConstructorReturn(this,result)}}function markdown_editor_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return markdown_editor_assertThisInitialized(self)}function markdown_editor_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function markdown_editor_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function markdown_editor_getPrototypeOf(o){markdown_editor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return markdown_editor_getPrototypeOf(o)}function markdown_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var markdown_editor_MarkdownEditor=function(_Component){markdown_editor_inherits(MarkdownEditor,_Component);var _super=markdown_editor_createSuper(MarkdownEditor);function MarkdownEditor(){var _this;markdown_editor_classCallCheck(this,MarkdownEditor);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));markdown_editor_defineProperty(markdown_editor_assertThisInitialized(_this),"handleChange",(function(value){_this.props.onChange({markdown:value})}));markdown_editor_defineProperty(markdown_editor_assertThisInitialized(_this),"handleOnLoad",(function(ace){_this.ace=ace}));return _this}markdown_editor_createClass(MarkdownEditor,[{key:"handleVarClick",value:function handleVarClick(snippet){var _this2=this;return function(){if(_this2.ace)_this2.ace.insert(snippet)}}},{key:"render",value:function render(){var _this3=this;var _this$props=this.props,visData=_this$props.visData,model=_this$props.model,dateFormat=_this$props.dateFormat;if(!visData){return null}var series=external_kbnSharedDeps_Lodash_default.a.get(visData,"".concat(model.id,".series"),[]);var variables=convert_series_to_vars_convertSeriesToVars(series,model,dateFormat,this.props.getConfig);var rows=[];var rawFormatter=tick_formatter_createTickFormatter("0.[0000]",null,this.props.getConfig);var createPrimitiveRow=function createPrimitiveRow(key){var snippet="{{ ".concat(key," }}");var value=external_kbnSharedDeps_Lodash_default.a.get(variables,key);if(/raw$/.test(key))value=rawFormatter(value);rows.push(external_kbnSharedDeps_React_default.a.createElement("tr",{key:key},external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement("a",{onClick:_this3.handleVarClick(snippet)},snippet)),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement("code",null,"“",value,"”"))))};var createArrayRow=function createArrayRow(key){var snippet="{{# ".concat(key," }}{{/ ").concat(key," }}");var date=external_kbnSharedDeps_Lodash_default.a.get(variables,"".concat(key,"[0][0]"));var value=external_kbnSharedDeps_Lodash_default.a.get(variables,"".concat(key,"[0][1]"));if(/raw$/.test(key))value=rawFormatter(value);rows.push(external_kbnSharedDeps_React_default.a.createElement("tr",{key:key},external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement("a",{onClick:_this3.handleVarClick(snippet)},"{{ ".concat(key," }}"))),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement("code",null,"[ [ “",date,"”, “",value,"” ], ... ]"))))};function walk(obj){var path=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];for(var name in obj){if(Array.isArray(obj[name])){createArrayRow(path.concat(name).join("."))}else if(external_kbnSharedDeps_Lodash_default.a.isObject(obj[name])){walk(obj[name],path.concat(name))}else{createPrimitiveRow(path.concat(name).join("."))}}}walk(variables);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor__editor"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{onLoad:this.handleOnLoad,mode:"markdown",theme:"github",width:"100%",height:"100%",name:"ace-".concat(model.id),setOptions:{wrap:true,fontSize:"14px"},value:model.markdown,onChange:this.handleChange})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbMarkdownEditor__variables"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howToUseVariablesInMarkdownDescription",defaultMessage:"The following variables can be used in the Markdown by using the Handlebar (mustache) syntax. {handlebarLink} on the available expressions.",values:{handlebarLink:external_kbnSharedDeps_React_default.a.createElement("a",{href:"https://handlebarsjs.com/guide/expressions.html",target:"_BLANK",rel:"noreferrer noopener"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howUseVariablesInMarkdownDescription.documentationLinkText",defaultMessage:"Click here for documentation"}))}}))),external_kbnSharedDeps_React_default.a.createElement("table",{className:"table","data-test-subj":"tsvbMarkdownVariablesTable"},external_kbnSharedDeps_React_default.a.createElement("thead",null,external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement("th",{scope:"col"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.nameLabel",defaultMessage:"Name"})),external_kbnSharedDeps_React_default.a.createElement("th",{scope:"col"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.valueLabel",defaultMessage:"Value"})))),external_kbnSharedDeps_React_default.a.createElement("tbody",null,rows)),rows.length===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs",className:"tsvbMarkdownVariablesTable__noVariables","data-test-subj":"tvbMarkdownEditor__noVariables"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.noVariablesAvailableDescription",defaultMessage:"No variables available for the selected data metrics."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdownEditor.howToAccessEntireTreeDescription",defaultMessage:"There is also a special variable named {all} which you can use to access the entire tree. This is useful for creating lists with data from a group by:",values:{all:external_kbnSharedDeps_React_default.a.createElement("code",null,"_all")}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeBlock"],null,"# All servers:\n\n    {{#each _all}}\n    - {{ label }} {{ last.formatted }}\n    {{/each}}")))}}]);return MarkdownEditor}(external_kbnSharedDeps_React_["Component"]);var less_browser=__webpack_require__(281);var less_browser_default=__webpack_require__.n(less_browser);function markdown_extends(){markdown_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return markdown_extends.apply(this,arguments)}function markdown_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function markdown_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){markdown_ownKeys(Object(source),true).forEach((function(key){markdown_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{markdown_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function markdown_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function markdown_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function markdown_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function markdown_createClass(Constructor,protoProps,staticProps){if(protoProps)markdown_defineProperties(Constructor.prototype,protoProps);if(staticProps)markdown_defineProperties(Constructor,staticProps);return Constructor}function markdown_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)markdown_setPrototypeOf(subClass,superClass)}function markdown_setPrototypeOf(o,p){markdown_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return markdown_setPrototypeOf(o,p)}function markdown_createSuper(Derived){var hasNativeReflectConstruct=markdown_isNativeReflectConstruct();return function _createSuperInternal(){var Super=markdown_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=markdown_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return markdown_possibleConstructorReturn(this,result)}}function markdown_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return markdown_assertThisInitialized(self)}function markdown_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function markdown_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function markdown_getPrototypeOf(o){markdown_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return markdown_getPrototypeOf(o)}var lessC=less_browser_default()(window,{env:"production"});var markdown_MarkdownPanelConfigUi=function(_Component){markdown_inherits(MarkdownPanelConfigUi,_Component);var _super=markdown_createSuper(MarkdownPanelConfigUi);function MarkdownPanelConfigUi(props){var _this;markdown_classCallCheck(this,MarkdownPanelConfigUi);_this=_super.call(this,props);_this.state={selectedTab:"markdown"};_this.handleCSSChange=_this.handleCSSChange.bind(markdown_assertThisInitialized(_this));return _this}markdown_createClass(MarkdownPanelConfigUi,[{key:"switchTab",value:function switchTab(selectedTab){this.setState({selectedTab:selectedTab})}},{key:"handleCSSChange",value:function handleCSSChange(value){var _this2=this;var model=this.props.model;var lessSrc="#markdown-".concat(model.id," {\n  ").concat(value,"\n}");lessC.render(lessSrc,{compress:true,javascriptEnabled:false},(function(e,output){var parts={markdown_less:value};if(output){parts.markdown_css=output.css}_this2.props.onChange(parts)}))}},{key:"render",value:function render(){var _this3=this;var defaults={filter:{query:"",language:getDefaultQueryLanguage()}};var model=markdown_objectSpread(markdown_objectSpread({},defaults),this.props.model);var selectedTab=this.state.selectedTab;var handleSelectChange=create_select_handler_createSelectHandler(this.props.onChange);var intl=this.props.intl;var htmlId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();var alignOptions=[{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.topLabel",defaultMessage:"Top"}),value:"top"},{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.middleLabel",defaultMessage:"Middle"}),value:"middle"},{label:intl.formatMessage({id:"visTypeTimeseries.markdown.alignOptions.bottomLabel",defaultMessage:"Bottom"}),value:"bottom"}];var selectedAlignOption=alignOptions.find((function(option){return model.markdown_vertical_align===option.value}));var view;if(selectedTab==="markdown"){view=external_kbnSharedDeps_React_default.a.createElement(VisDataContext.Consumer,null,(function(visData){return external_kbnSharedDeps_React_default.a.createElement(markdown_editor_MarkdownEditor,markdown_extends({visData:visData},_this3.props))}))}else if(selectedTab==="data"){view=external_kbnSharedDeps_React_default.a.createElement(series_editor_SeriesEditor,{colorPicker:false,fields:this.props.fields,model:this.props.model,name:this.props.name,onChange:this.props.onChange})}else{view=external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbPanelConfig__container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.dataLabel",defaultMessage:"Data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(index_pattern_IndexPattern,{fields:this.props.fields,model:this.props.model,onChange:this.props.onChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:htmlId("panelFilter"),label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.panelFilterLabel",defaultMessage:"Panel filter"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(QueryBarWrapper,{query:{language:model.filter.language?model.filter.language:getDefaultQueryLanguage(),query:model.filter.query||""},onChange:function onChange(filter){return _this3.props.onChange({filter:filter})},indexPatterns:[model.index_pattern||model.default_index_pattern]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.ignoreGlobalFilterLabel",defaultMessage:"Ignore global filter?"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.ignore_global_filter,name:"ignore_global_filter",onChange:this.props.onChange})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.styleLabel",defaultMessage:"Style"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,wrap:true,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.backgroundColorLabel",defaultMessage:"Background color:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(ColorPicker,{onChange:this.props.onChange,name:"background_color",value:model.background_color})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.showScrollbarsLabel",defaultMessage:"Show scrollbars?"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.markdown_scrollbars,name:"markdown_scrollbars",onChange:this.props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.openLinksInNewTab",defaultMessage:"Open links in new tab?"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(YesNo,{value:model.markdown_openLinksInNewTab,name:"markdown_openLinksInNewTab",onChange:this.props.onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],{htmlFor:htmlId("valign")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.verticalAlignmentLabel",defaultMessage:"Vertical alignment:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{id:htmlId("valign"),isClearable:false,options:alignOptions,selectedOptions:selectedAlignOption?[selectedAlignOption]:[],onChange:handleSelectChange("markdown_vertical_align"),singleSelection:{asPlainText:true}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.customCSSLabel",defaultMessage:"Custom CSS (supports Less)",description:"CSS and Less are names of technologies and should not be translated."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{mode:"less",theme:"github",width:"100%",name:"ace-css-".concat(model.id),setOptions:{fontSize:"14px"},value:model.markdown_less,onChange:this.handleCSSChange})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="markdown",onClick:function onClick(){return _this3.switchTab("markdown")},"data-test-subj":"markdown-subtab"},"Markdown"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":"data-subtab",isSelected:selectedTab==="data",onClick:function onClick(){return _this3.switchTab("data")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.dataTab.dataButtonLabel",defaultMessage:"Data"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{isSelected:selectedTab==="options",onClick:function onClick(){return _this3.switchTab("options")},"data-test-subj":"options-subtab"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.markdown.optionsTab.panelOptionsButtonLabel",defaultMessage:"Panel options"}))),view)}}]);return MarkdownPanelConfigUi}(external_kbnSharedDeps_React_["Component"]);var MarkdownPanelConfig=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(markdown_MarkdownPanelConfigUi);function panel_config_slicedToArray(arr,i){return panel_config_arrayWithHoles(arr)||panel_config_iterableToArrayLimit(arr,i)||panel_config_unsupportedIterableToArray(arr,i)||panel_config_nonIterableRest()}function panel_config_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function panel_config_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return panel_config_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return panel_config_arrayLikeToArray(o,minLen)}function panel_config_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function panel_config_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function panel_config_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var panel_config_types={timeseries:TimeseriesPanelConfig,table:table_TablePanelConfig,metric:metric_MetricPanelConfig,top_n:top_n_TopNPanelConfig,gauge:GaugePanelConfig,markdown:MarkdownPanelConfig};var checkModelValidity=function checkModelValidity(validationResults){return Boolean(Object.values(validationResults).every((function(isValid){return isValid})))};function PanelConfig(props){var model=props.model;var Component=panel_config_types[model.type];var _useState=Object(external_kbnSharedDeps_React_["useState"])({}),_useState2=panel_config_slicedToArray(_useState,1),formValidationResults=_useState2[0];var _useState3=Object(external_kbnSharedDeps_React_["useState"])({}),_useState4=panel_config_slicedToArray(_useState3,2),visData=_useState4[0],setVisData=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){model.isModelInvalid=!checkModelValidity(formValidationResults)}));Object(external_kbnSharedDeps_React_["useEffect"])((function(){var visDataSubscription=props.visData$.subscribe((function(){var visData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return setVisData(visData)}));return function cleanup(){visDataSubscription.unsubscribe()}}),[model.id,props.visData$]);var updateControlValidity=function updateControlValidity(controlKey,isControlValid){formValidationResults[controlKey]=isControlValid};if(Component){return external_kbnSharedDeps_React_default.a.createElement(FormValidationContext.Provider,{value:updateControlValidity},external_kbnSharedDeps_React_default.a.createElement(VisDataContext.Provider,{value:visData},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"tvbPanelConfig__".concat(model.type)},external_kbnSharedDeps_React_default.a.createElement(Component,props))))}return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.missingPanelConfigDescription",defaultMessage:"Missing panel config for “{modelType}”",values:{modelType:model.type}}))}var createBrushHandler=function createBrushHandler(applyFilter){return function(gte,lte){return applyFilter({timeFieldName:"*",filters:[{range:{"*":{gte:gte,lte:lte}}}]})}};var fetch_fields=__webpack_require__(14);var extract_index_patterns=__webpack_require__(15);var kibanaUtils_public_=__webpack_require__(3);function vis_editor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function vis_editor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){vis_editor_ownKeys(Object(source),true).forEach((function(key){vis_editor_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{vis_editor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function vis_editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function vis_editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function vis_editor_createClass(Constructor,protoProps,staticProps){if(protoProps)vis_editor_defineProperties(Constructor.prototype,protoProps);if(staticProps)vis_editor_defineProperties(Constructor,staticProps);return Constructor}function vis_editor_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)vis_editor_setPrototypeOf(subClass,superClass)}function vis_editor_setPrototypeOf(o,p){vis_editor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return vis_editor_setPrototypeOf(o,p)}function vis_editor_createSuper(Derived){var hasNativeReflectConstruct=vis_editor_isNativeReflectConstruct();return function _createSuperInternal(){var Super=vis_editor_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=vis_editor_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return vis_editor_possibleConstructorReturn(this,result)}}function vis_editor_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return vis_editor_assertThisInitialized(self)}function vis_editor_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function vis_editor_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function vis_editor_getPrototypeOf(o){vis_editor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return vis_editor_getPrototypeOf(o)}function vis_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var VIS_STATE_DEBOUNCE_DELAY=200;var APP_NAME="VisEditor";var vis_editor_VisEditor=function(_Component){vis_editor_inherits(VisEditor,_Component);var _super=vis_editor_createSuper(VisEditor);function VisEditor(props){var _this;vis_editor_classCallCheck(this,VisEditor);_this=_super.call(this,props);vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"getConfig",(function(){var _this$props$config;return(_this$props$config=_this.props.config).get.apply(_this$props$config,arguments)}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"handleUiState",(function(field,value){_this.props.vis.uiState.set(field,value);_this.props.vis.uiState.emit("reload")}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"updateVisState",Object(external_kbnSharedDeps_Lodash_["debounce"])((function(){_this.props.vis.params=_this.state.model;_this.props.embeddableHandler.reload();_this.props.eventEmitter.emit("dirtyStateChange",{isDirty:false})}),VIS_STATE_DEBOUNCE_DELAY));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"handleChange",(function(partialModel){if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(partialModel)){return}var hasTypeChanged=partialModel.type&&_this.state.model.type!==partialModel.type;var nextModel=vis_editor_objectSpread(vis_editor_objectSpread({},_this.state.model),partialModel);var dirty=true;if(_this.state.autoApply||hasTypeChanged){_this.updateVisState();dirty=false}if(_this.props.isEditorMode){var extractedIndexPatterns=Object(extract_index_patterns["a"])(nextModel);if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(_this.state.extractedIndexPatterns,extractedIndexPatterns)){Object(fetch_fields["a"])(extractedIndexPatterns).then((function(visFields){return _this.setState({visFields:visFields,extractedIndexPatterns:extractedIndexPatterns})}))}}_this.setState({dirty:dirty,model:nextModel})}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"updateModel",(function(){var _this$props$vis$clone=_this.props.vis.clone(),params=_this$props$vis$clone.params;_this.setState({model:params})}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"handleCommit",(function(){_this.updateVisState();_this.setState({dirty:false})}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"handleAutoApplyToggle",(function(event){_this.setState({autoApply:event.target.checked})}));vis_editor_defineProperty(vis_editor_assertThisInitialized(_this),"onDataChange",(function(_ref){var visData=_ref.visData;_this.visDataSubject.next(visData)}));_this.localStorage=new kibanaUtils_public_["Storage"](window.localStorage);_this.state={model:props.visParams,dirty:false,autoApply:true,visFields:props.visFields,extractedIndexPatterns:[""]};_this.onBrush=createBrushHandler((function(data){return props.vis.API.events.applyFilter(data)}));_this.visDataSubject=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](_this.props.visData);_this.visData$=_this.visDataSubject.asObservable().pipe(Object(external_kbnSharedDeps_RxjsOperators_["share"])());_this.coreContext={appName:APP_NAME,uiSettings:Object(services["g"])(),savedObjectsClient:Object(services["f"])(),store:_this.localStorage};return _this}vis_editor_createClass(VisEditor,[{key:"render",value:function render(){if(!this.props.isEditorMode){if(!this.props.visParams||!this.props.visData){return null}return external_kbnSharedDeps_React_default.a.createElement(Visualization,{dateFormat:this.props.config.get("dateFormat"),onBrush:this.onBrush,onUiState:this.handleUiState,uiState:this.uiState,model:this.props.visParams,visData:this.props.visData,getConfig:this.getConfig})}var model=this.state.model;if(model){return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["KibanaContextProvider"],{services:vis_editor_objectSpread({appName:APP_NAME,storage:this.localStorage,data:Object(services["c"])()},Object(services["b"])())},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbEditor","data-test-subj":"tvbVisEditor"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},external_kbnSharedDeps_React_default.a.createElement(VisPicker,{model:model,onChange:this.handleChange})),external_kbnSharedDeps_React_default.a.createElement(VisEditorVisualization,{dirty:this.state.dirty,autoApply:this.state.autoApply,model:model,embeddableHandler:this.props.embeddableHandler,eventEmitter:this.props.eventEmitter,vis:this.props.vis,timeRange:this.props.timeRange,uiState:this.uiState,onCommit:this.handleCommit,onToggleAutoApply:this.handleAutoApplyToggle,title:this.props.vis.title,description:this.props.vis.description,onDataChange:this.onDataChange}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbEditor--hideForReporting"},external_kbnSharedDeps_React_default.a.createElement(CoreStartContextProvider,{value:this.coreContext},external_kbnSharedDeps_React_default.a.createElement(PanelConfig,{fields:this.state.visFields,model:model,visData$:this.visData$,dateFormat:this.props.config.get("dateFormat"),onChange:this.handleChange,getConfig:this.getConfig})))))}return null}},{key:"componentDidMount",value:function componentDidMount(){this.props.renderComplete();if(this.props.isEditorMode&&this.props.eventEmitter){this.props.eventEmitter.on("updateEditor",this.updateModel)}}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.props.renderComplete()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.updateVisState.cancel();if(this.props.isEditorMode&&this.props.eventEmitter){this.props.eventEmitter.off("updateEditor",this.updateModel)}}},{key:"uiState",get:function get(){return this.props.vis.uiState}}]);return VisEditor}(external_kbnSharedDeps_React_["Component"]);vis_editor_VisEditor.defaultProps={visData:{}}}}]);