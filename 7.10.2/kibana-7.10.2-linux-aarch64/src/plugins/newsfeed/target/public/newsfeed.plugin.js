(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=12)})([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){var getRandomValues=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function whatwgRNG(){getRandomValues(rnds8);return rnds8}}else{var rnds=new Array(16);module.exports=function mathRNG(){for(var i=0,r;i<16;i++){if((i&3)===0)r=Math.random()*4294967296;rnds[i]=r>>>((i&3)<<3)&255}return rnds}}},function(module,exports){var byteToHex=[];for(var i=0;i<256;++i){byteToHex[i]=(i+256).toString(16).substr(1)}function bytesToUuid(buf,offset){var i=offset||0;var bth=byteToHex;return[bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]]].join("")}module.exports=bytesToUuid},function(module,exports,__webpack_require__){var v1=__webpack_require__(14);var v4=__webpack_require__(15);var uuid=v4;uuid.v1=v1;uuid.v4=v4;module.exports=uuid},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_newsfeed_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13);var _node_modules_val_loader_dist_cjs_js_key_newsfeed_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_newsfeed_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/newsfeed/public",__webpack_require__,16)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["newsfeed"]},function(module,exports,__webpack_require__){var rng=__webpack_require__(9);var bytesToUuid=__webpack_require__(10);var _nodeId;var _clockseq;var _lastMSecs=0;var _lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||[];options=options||{};var node=options.node||_nodeId;var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;if(node==null||clockseq==null){var seedBytes=rng();if(node==null){node=_nodeId=[seedBytes[0]|1,seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]}if(clockseq==null){clockseq=_clockseq=(seedBytes[6]<<8|seedBytes[7])&16383}}var msecs=options.msecs!==undefined?options.msecs:(new Date).getTime();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;for(var n=0;n<6;++n){b[i+n]=node[n]}return buf?buf:bytesToUuid(b)}module.exports=v1},function(module,exports,__webpack_require__){var rng=__webpack_require__(9);var bytesToUuid=__webpack_require__(10);function v4(options,buf,offset){var i=buf&&offset||0;if(typeof options=="string"){buf=options==="binary"?new Array(16):null;options=null}options=options||{};var rnds=options.random||(options.rng||rng)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){for(var ii=0;ii<16;++ii){buf[i+ii]=rnds[ii]}}return buf||bytesToUuid(rnds)}module.exports=v4},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"NewsfeedPublicPluginSetup",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"NewsfeedPublicPluginStart",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"FetchResult",(function(){return types["FetchResult"]}));__webpack_require__.d(__webpack_exports__,"NewsfeedItem",(function(){return types["NewsfeedItem"]}));__webpack_require__.d(__webpack_exports__,"NewsfeedApiEndpoint",(function(){return NewsfeedApiEndpoint}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(5);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(4);var external_kbnSharedDeps_ReactDom_=__webpack_require__(8);var external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_Moment_=__webpack_require__(2);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(3);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(6);var empty_news_NewsEmptyPrompt=function NewsEmptyPrompt(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"documents",titleSize:"s","data-test-subj":"emptyNewsfeed",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.emptyPrompt.noNewsTitle",defaultMessage:"No news?"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.emptyPrompt.noNewsText",defaultMessage:"If your Kibana instance doesn’t have internet access, ask your administrator to disable this feature. Otherwise, we’ll keep trying to fetch the news."}))})};var loading_news_NewsLoadingPrompt=function NewsLoadingPrompt(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingElastic"],{size:"xl"}),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.loadingPrompt.gettingNewsText",defaultMessage:"Getting the latest news..."}))})};var flyout_list_NewsfeedFlyout=function NewsfeedFlyout(){var _useContext=Object(external_kbnSharedDeps_React_["useContext"])(NewsfeedContext),newsFetchResult=_useContext.newsFetchResult,setFlyoutVisible=_useContext.setFlyoutVisible;var closeFlyout=Object(external_kbnSharedDeps_React_["useCallback"])((function(){return setFlyoutVisible(false)}),[setFlyoutVisible]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPortal"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyout"],{onClose:closeFlyout,size:"s","aria-labelledby":"flyoutSmallTitle",className:"kbnNews__flyout","data-test-subj":"NewsfeedFlyout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutHeader"],{hasBorder:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"flyoutSmallTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.flyoutList.whatsNewTitle",defaultMessage:"What's new at Elastic"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutBody"],{className:"kbnNews__flyoutAlerts"},!newsFetchResult?external_kbnSharedDeps_React_default.a.createElement(loading_news_NewsLoadingPrompt,null):newsFetchResult.feedItems.length>0?newsFetchResult.feedItems.map((function(item){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHeaderAlert"],{key:item.hash,title:item.title,text:item.description,"data-test-subj":"newsHeadAlert",action:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{target:"_blank",href:item.linkUrl,external:true},item.linkText),date:item.publishOn.format("DD MMMM YYYY"),badge:item.badge?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},item.badge):undefined})})):external_kbnSharedDeps_React_default.a.createElement(empty_news_NewsEmptyPrompt,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlyoutFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"cross",onClick:closeFlyout,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.flyoutList.closeButtonLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},newsFetchResult?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"newsfeed.flyoutList.versionTextLabel",defaultMessage:"{version}",values:{version:"Version ".concat(newsFetchResult.kibanaVersion)}}))):null)))))};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var NewsfeedContext=external_kbnSharedDeps_React_default.a.createContext({});var newsfeed_header_nav_button_NewsfeedNavButton=function NewsfeedNavButton(_ref){var apiFetchResult=_ref.apiFetchResult;var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=_slicedToArray(_useState,2),showBadge=_useState2[0],setShowBadge=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=_slicedToArray(_useState3,2),flyoutVisible=_useState4[0],setFlyoutVisible=_useState4[1];var _useState5=Object(external_kbnSharedDeps_React_["useState"])(null),_useState6=_slicedToArray(_useState5,2),newsFetchResult=_useState6[0],setNewsFetchResult=_useState6[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){function handleStatusChange(fetchResult){if(fetchResult){setShowBadge(fetchResult.hasNew)}setNewsFetchResult(fetchResult)}var subscription=apiFetchResult.subscribe((function(res){return handleStatusChange(res)}));return function(){return subscription.unsubscribe()}}),[apiFetchResult]);function showFlyout(){setShowBadge(false);setFlyoutVisible(!flyoutVisible)}return external_kbnSharedDeps_React_default.a.createElement(NewsfeedContext.Provider,{value:{setFlyoutVisible:setFlyoutVisible,newsFetchResult:newsFetchResult}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHeaderSectionItemButton"],{"data-test-subj":"newsfeed","aria-controls":"keyPadMenu","aria-expanded":flyoutVisible,"aria-haspopup":"true","aria-label":showBadge?external_kbnSharedDeps_KbnI18n_["i18n"].translate("newsfeed.headerButton.unreadAriaLabel",{defaultMessage:"Newsfeed menu - unread items available"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("newsfeed.headerButton.readAriaLabel",{defaultMessage:"Newsfeed menu - all items read"}),notification:showBadge?true:null,onClick:showFlyout},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"cheer",size:"m"})),flyoutVisible?external_kbnSharedDeps_React_default.a.createElement(flyout_list_NewsfeedFlyout,null):null))};var uuid=__webpack_require__(11);var uuid_default=__webpack_require__.n(uuid);var NEWSFEED_FALLBACK_LANGUAGE="en";var NEWSFEED_FALLBACK_FETCH_INTERVAL=864e5;var NEWSFEED_FALLBACK_MAIN_INTERVAL=12e4;var NEWSFEED_LAST_FETCH_STORAGE_KEY="newsfeed.lastfetchtime";var NEWSFEED_HASH_SET_STORAGE_KEY="newsfeed.hashes";var NEWSFEED_DEFAULT_SERVICE_BASE_URL="https://feeds.elastic.co";var NEWSFEED_DEV_SERVICE_BASE_URL="https://feeds-staging.elastic.co";var NEWSFEED_DEFAULT_SERVICE_PATH="/kibana/v{VERSION}.json";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||api_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function api_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return api_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return api_arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return api_arrayLikeToArray(arr)}function api_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var NewsfeedApiEndpoint;(function(NewsfeedApiEndpoint){NewsfeedApiEndpoint["KIBANA"]="kibana";NewsfeedApiEndpoint["KIBANA_ANALYTICS"]="kibana-analytics";NewsfeedApiEndpoint["SECURITY_SOLUTION"]="security-solution";NewsfeedApiEndpoint["OBSERVABILITY"]="observability"})(NewsfeedApiEndpoint||(NewsfeedApiEndpoint={}));var api_NewsfeedApiDriver=function(){function NewsfeedApiDriver(kibanaVersion,userLanguage,fetchInterval){_classCallCheck(this,NewsfeedApiDriver);this.userLanguage=userLanguage;this.fetchInterval=fetchInterval;_defineProperty(this,"id",uuid_default.a.v4());_defineProperty(this,"kibanaVersion",void 0);_defineProperty(this,"loadedTime",external_kbnSharedDeps_Moment_default()().utc());_defineProperty(this,"lastFetchStorageKey",void 0);_defineProperty(this,"hashSetStorageKey",void 0);this.kibanaVersion=kibanaVersion.replace(/^(\d+\.\d+\.\d+).*/,"$1");this.lastFetchStorageKey="".concat(NEWSFEED_LAST_FETCH_STORAGE_KEY,".").concat(this.id);this.hashSetStorageKey="".concat(NEWSFEED_HASH_SET_STORAGE_KEY,".").concat(this.id)}_createClass(NewsfeedApiDriver,[{key:"shouldFetch",value:function shouldFetch(){var lastFetchUtc=sessionStorage.getItem(this.lastFetchStorageKey);if(lastFetchUtc==null){return true}var last=external_kbnSharedDeps_Moment_default()(lastFetchUtc,"x");if(this.loadedTime.diff(last)>0){return true}var now=external_kbnSharedDeps_Moment_default.a.utc();var duration=external_kbnSharedDeps_Moment_default.a.duration(now.diff(last));return duration.asMilliseconds()>this.fetchInterval}},{key:"updateLastFetch",value:function updateLastFetch(){sessionStorage.setItem(this.lastFetchStorageKey,Date.now().toString())}},{key:"updateHashes",value:function updateHashes(items){var stored=localStorage.getItem(this.hashSetStorageKey);var old=[];if(stored!=null){old=stored.split(",")}var newHashes=items.map((function(i){return i.hash}));var updatedHashes=_toConsumableArray(new Set(old.concat(newHashes)));localStorage.setItem(this.hashSetStorageKey,updatedHashes.join(","));return{previous:old,current:updatedHashes}}},{key:"fetchNewsfeedItems",value:function fetchNewsfeedItems(http,config){var _this=this;var urlPath=config.pathTemplate.replace("{VERSION}",this.kibanaVersion);var fullUrl=(config.urlRoot||NEWSFEED_DEFAULT_SERVICE_BASE_URL)+urlPath;return external_kbnSharedDeps_Rxjs_["from"](http.fetch(fullUrl,{method:"GET"}).then((function(_ref){var items=_ref.items;return _this.modelItems(items)})))}},{key:"validateItem",value:function validateItem(item){var hasMissing=[item.title,item.description,item.linkText,item.linkUrl,item.publishOn,item.hash].includes(undefined);return!hasMissing}},{key:"modelItems",value:function modelItems(items){var _this2=this;var feedItems=items.reduce((function(accum,it){var chosenLanguage=_this2.userLanguage;var expireOnUtc=it.expire_on,publishOnUtc=it.publish_on,languages=it.languages,title=it.title,description=it.description,linkText=it.link_text,linkUrl=it.link_url,badge=it.badge,hash=it.hash;if(external_kbnSharedDeps_Moment_default()(expireOnUtc).isBefore(Date.now())){return accum}if(external_kbnSharedDeps_Moment_default()(publishOnUtc).isAfter(Date.now())){return accum}if(languages&&!languages.includes(chosenLanguage)){chosenLanguage=NEWSFEED_FALLBACK_LANGUAGE}var tempItem={title:title[chosenLanguage],description:description[chosenLanguage],linkText:linkText!=null?linkText[chosenLanguage]:null,linkUrl:linkUrl[chosenLanguage],badge:badge!=null?badge[chosenLanguage]:null,publishOn:external_kbnSharedDeps_Moment_default()(publishOnUtc),expireOn:external_kbnSharedDeps_Moment_default()(expireOnUtc),hash:hash.slice(0,10)};if(!_this2.validateItem(tempItem)){return accum}return[].concat(_toConsumableArray(accum),[tempItem])}),[]);var _this$updateHashes=this.updateHashes(feedItems),previous=_this$updateHashes.previous,current=_this$updateHashes.current;var hasNew=current.length>previous.length;return{error:null,kibanaVersion:this.kibanaVersion,hasNew:hasNew,feedItems:feedItems}}}]);return NewsfeedApiDriver}();function getApi(http,config,kibanaVersion){var userLanguage=external_kbnSharedDeps_KbnI18n_["i18n"].getLocale();var fetchInterval=config.fetchInterval.asMilliseconds();var mainInterval=config.mainInterval.asMilliseconds();var driver=new api_NewsfeedApiDriver(kibanaVersion,userLanguage,fetchInterval);return external_kbnSharedDeps_Rxjs_["timer"](0,mainInterval).pipe(Object(external_kbnSharedDeps_RxjsOperators_["filter"])((function(){return driver.shouldFetch()})),Object(external_kbnSharedDeps_RxjsOperators_["mergeMap"])((function(){return driver.fetchNewsfeedItems(http,config.service).pipe(Object(external_kbnSharedDeps_RxjsOperators_["catchError"])((function(err){window.console.error(err);return external_kbnSharedDeps_Rxjs_["of"]({error:err,kibanaVersion:kibanaVersion,hasNew:false,feedItems:[]})})))})),Object(external_kbnSharedDeps_RxjsOperators_["tap"])((function(){return driver.updateLastFetch()})))}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){plugin_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function plugin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function plugin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function plugin_createClass(Constructor,protoProps,staticProps){if(protoProps)plugin_defineProperties(Constructor.prototype,protoProps);if(staticProps)plugin_defineProperties(Constructor,staticProps);return Constructor}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var plugin_NewsfeedPublicPlugin=function(){function NewsfeedPublicPlugin(initializerContext){plugin_classCallCheck(this,NewsfeedPublicPlugin);plugin_defineProperty(this,"kibanaVersion",void 0);plugin_defineProperty(this,"config",void 0);plugin_defineProperty(this,"stop$",new external_kbnSharedDeps_Rxjs_["ReplaySubject"](1));this.kibanaVersion=initializerContext.env.packageInfo.version;var config=initializerContext.config.get();this.config=Object.freeze(_objectSpread(_objectSpread({},config),{},{mainInterval:external_kbnSharedDeps_Moment_default.a.duration(config.mainInterval),fetchInterval:external_kbnSharedDeps_Moment_default.a.duration(config.fetchInterval)}))}plugin_createClass(NewsfeedPublicPlugin,[{key:"setup",value:function setup(core){return{}}},{key:"start",value:function start(core){var _this=this;var api$=this.fetchNewsfeed(core,this.config).pipe(Object(external_kbnSharedDeps_RxjsOperators_["share"])());core.chrome.navControls.registerRight({order:1e3,mount:function mount(target){return _this.mount(api$,target)}});return{createNewsFeed$:function createNewsFeed$(endpoint){var config=Object.assign({},_this.config,{service:{pathTemplate:"/".concat(endpoint,"/v{VERSION}.json")}});return _this.fetchNewsfeed(core,config)}}}},{key:"stop",value:function stop(){this.stop$.next()}},{key:"fetchNewsfeed",value:function fetchNewsfeed(core,config){var http=core.http;return getApi(http,config,this.kibanaVersion).pipe(Object(external_kbnSharedDeps_RxjsOperators_["takeUntil"])(this.stop$),Object(external_kbnSharedDeps_RxjsOperators_["catchError"])((function(){return external_kbnSharedDeps_Rxjs_["of"](null)})))}},{key:"mount",value:function mount(api$,targetDomElement){external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(newsfeed_header_nav_button_NewsfeedNavButton,{apiFetchResult:api$})),targetDomElement);return function(){return external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(targetDomElement)}}}]);return NewsfeedPublicPlugin}();var types=__webpack_require__(7);function public_plugin(initializerContext){return new plugin_NewsfeedPublicPlugin(initializerContext)}}]);